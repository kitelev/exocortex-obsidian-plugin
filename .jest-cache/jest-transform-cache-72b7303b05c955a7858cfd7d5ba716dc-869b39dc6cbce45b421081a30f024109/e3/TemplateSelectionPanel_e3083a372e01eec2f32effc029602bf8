1f9f61573f919a1345fc39f05c52dd78
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.TemplateSelectionPanel = void 0;
const tslib_1 = require("tslib");
const QueryTemplate_1 = require("../../domain/visual/QueryTemplate");
class TemplateSelectionPanel {
    constructor(parentElement, templateRepository, options = {}) {
        this.parentElement = parentElement;
        this.templateRepository = templateRepository;
        this.options = options;
        this.templates = [];
        this.filteredTemplates = [];
        this.createPanel();
        this.loadTemplates();
    }
    createPanel() {
        this.container = document.createElement('div');
        this.container.className = 'template-selection-panel';
        this.container.style.cssText = `
            position: relative;
            background: var(--background-primary);
            border: 1px solid var(--background-modifier-border);
            border-radius: var(--radius-m);
            padding: 16px;
            max-height: ${this.options.maxHeight || 500}px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            gap: 12px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
        `;
        this.createHeader();
        this.createSearchAndFilter();
        if (this.options.showPreview) {
            this.createMainContent();
        }
        else {
            this.createTemplateList();
        }
        this.parentElement.appendChild(this.container);
    }
    createHeader() {
        const header = document.createElement('div');
        header.className = 'template-panel-header';
        header.style.cssText = `
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        `;
        const title = document.createElement('h3');
        title.textContent = 'Query Templates';
        title.style.cssText = `
            margin: 0;
            color: var(--text-normal);
            font-size: 16px;
            font-weight: 600;
        `;
        const closeButton = document.createElement('button');
        closeButton.textContent = 'Ã—';
        closeButton.className = 'template-close-btn';
        closeButton.style.cssText = `
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: var(--text-muted);
            padding: 4px 8px;
            border-radius: var(--radius-s);
            transition: all 0.15s ease;
        `;
        closeButton.addEventListener('mouseenter', () => {
            closeButton.style.background = 'var(--background-modifier-hover)';
            closeButton.style.color = 'var(--text-normal)';
        });
        closeButton.addEventListener('mouseleave', () => {
            closeButton.style.background = 'none';
            closeButton.style.color = 'var(--text-muted)';
        });
        closeButton.addEventListener('click', () => {
            var _a, _b;
            (_b = (_a = this.options).onClose) === null || _b === void 0 ? void 0 : _b.call(_a);
            this.destroy();
        });
        header.appendChild(title);
        header.appendChild(closeButton);
        this.container.appendChild(header);
    }
    createSearchAndFilter() {
        const filterContainer = document.createElement('div');
        filterContainer.className = 'template-filter-container';
        filterContainer.style.cssText = `
            display: flex;
            gap: 8px;
            align-items: center;
        `;
        // Search input
        this.searchInput = document.createElement('input');
        this.searchInput.type = 'text';
        this.searchInput.placeholder = 'Search templates...';
        this.searchInput.className = 'template-search';
        this.searchInput.style.cssText = `
            flex: 1;
            padding: 8px 12px;
            border: 1px solid var(--background-modifier-border);
            border-radius: var(--radius-s);
            background: var(--background-secondary);
            color: var(--text-normal);
            font-size: 14px;
        `;
        this.searchInput.addEventListener('input', () => this.filterTemplates());
        // Category filter
        this.categoryFilter = document.createElement('select');
        this.categoryFilter.className = 'template-category-filter';
        this.categoryFilter.style.cssText = `
            padding: 8px 12px;
            border: 1px solid var(--background-modifier-border);
            border-radius: var(--radius-s);
            background: var(--background-secondary);
            color: var(--text-normal);
            font-size: 14px;
        `;
        // Add category options
        const allOption = document.createElement('option');
        allOption.value = '';
        allOption.textContent = 'All Categories';
        this.categoryFilter.appendChild(allOption);
        Object.values(QueryTemplate_1.TemplateCategory).forEach(category => {
            const option = document.createElement('option');
            option.value = category;
            option.textContent = this.formatCategoryName(category);
            this.categoryFilter.appendChild(option);
        });
        this.categoryFilter.addEventListener('change', () => this.filterTemplates());
        filterContainer.appendChild(this.searchInput);
        filterContainer.appendChild(this.categoryFilter);
        this.container.appendChild(filterContainer);
    }
    createMainContent() {
        const mainContent = document.createElement('div');
        mainContent.className = 'template-main-content';
        mainContent.style.cssText = `
            display: flex;
            gap: 12px;
            flex: 1;
            overflow: hidden;
        `;
        this.createTemplateList(mainContent);
        this.createPreviewPane(mainContent);
        this.container.appendChild(mainContent);
    }
    createTemplateList(parent) {
        const listContainer = document.createElement('div');
        listContainer.className = 'template-list-container';
        listContainer.style.cssText = `
            ${this.options.showPreview ? 'flex: 0 0 300px;' : 'flex: 1;'}
            display: flex;
            flex-direction: column;
            gap: 8px;
            overflow-y: auto;
            padding-right: 4px;
        `;
        this.templateList = document.createElement('div');
        this.templateList.className = 'template-list';
        this.templateList.style.cssText = `
            display: flex;
            flex-direction: column;
            gap: 4px;
        `;
        listContainer.appendChild(this.templateList);
        (parent || this.container).appendChild(listContainer);
    }
    createPreviewPane(parent) {
        this.previewPane = document.createElement('div');
        this.previewPane.className = 'template-preview-pane';
        this.previewPane.style.cssText = `
            flex: 1;
            border: 1px solid var(--background-modifier-border);
            border-radius: var(--radius-s);
            padding: 16px;
            background: var(--background-secondary);
            overflow-y: auto;
        `;
        const emptyState = document.createElement('div');
        emptyState.className = 'preview-empty-state';
        emptyState.style.cssText = `
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: var(--text-muted);
            font-style: italic;
        `;
        emptyState.textContent = 'Select a template to preview';
        this.previewPane.appendChild(emptyState);
        parent.appendChild(this.previewPane);
    }
    loadTemplates() {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            try {
                this.templates = yield this.templateRepository.findAll();
                this.filterTemplates();
            }
            catch (error) {
                console.error('Failed to load templates:', error);
                this.showError('Failed to load templates');
            }
        });
    }
    filterTemplates() {
        const searchTerm = this.searchInput.value.toLowerCase();
        const selectedCategory = this.categoryFilter.value || undefined;
        this.filteredTemplates = this.templates.filter(template => {
            const metadata = template.getMetadata();
            // Category filter
            if (selectedCategory && metadata.category !== selectedCategory) {
                return false;
            }
            // Apply category restrictions from options
            if (this.options.filterByCategory &&
                !this.options.filterByCategory.includes(metadata.category)) {
                return false;
            }
            // Custom template filter
            if (this.options.allowCustomTemplates === false && !template.isBuiltInTemplate()) {
                return false;
            }
            // Search filter
            if (searchTerm) {
                const nameMatch = metadata.name.toLowerCase().includes(searchTerm);
                const descMatch = metadata.description.toLowerCase().includes(searchTerm);
                const tagMatch = metadata.tags.some(tag => tag.toLowerCase().includes(searchTerm));
                if (!nameMatch && !descMatch && !tagMatch) {
                    return false;
                }
            }
            return true;
        });
        this.renderTemplateList();
    }
    renderTemplateList() {
        this.templateList.innerHTML = '';
        if (this.filteredTemplates.length === 0) {
            const emptyState = document.createElement('div');
            emptyState.className = 'template-list-empty';
            emptyState.style.cssText = `
                text-align: center;
                padding: 24px;
                color: var(--text-muted);
                font-style: italic;
            `;
            emptyState.textContent = 'No templates match your criteria';
            this.templateList.appendChild(emptyState);
            return;
        }
        this.filteredTemplates.forEach(template => {
            const templateItem = this.createTemplateItem(template);
            this.templateList.appendChild(templateItem);
        });
    }
    createTemplateItem(template) {
        const metadata = template.getMetadata();
        const item = document.createElement('div');
        item.className = 'template-item';
        item.style.cssText = `
            padding: 12px;
            border: 1px solid var(--background-modifier-border);
            border-radius: var(--radius-s);
            cursor: pointer;
            transition: all 0.15s ease;
            background: var(--background-secondary);
        `;
        const header = document.createElement('div');
        header.className = 'template-item-header';
        header.style.cssText = `
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 4px;
        `;
        const name = document.createElement('div');
        name.className = 'template-item-name';
        name.textContent = metadata.name;
        name.style.cssText = `
            font-weight: 500;
            color: var(--text-normal);
            font-size: 14px;
        `;
        const badges = document.createElement('div');
        badges.className = 'template-badges';
        badges.style.cssText = `
            display: flex;
            gap: 4px;
            flex-shrink: 0;
        `;
        // Category badge
        const categoryBadge = this.createBadge(this.formatCategoryName(metadata.category), 'category');
        badges.appendChild(categoryBadge);
        // Difficulty badge
        const difficultyBadge = this.createBadge(metadata.difficulty, 'difficulty');
        badges.appendChild(difficultyBadge);
        // Built-in badge
        if (template.isBuiltInTemplate()) {
            const builtInBadge = this.createBadge('Built-in', 'builtin');
            badges.appendChild(builtInBadge);
        }
        header.appendChild(name);
        header.appendChild(badges);
        const description = document.createElement('div');
        description.className = 'template-item-description';
        description.textContent = metadata.description;
        description.style.cssText = `
            color: var(--text-muted);
            font-size: 12px;
            line-height: 1.4;
            margin-bottom: 8px;
        `;
        const tags = document.createElement('div');
        tags.className = 'template-item-tags';
        tags.style.cssText = `
            display: flex;
            gap: 4px;
            flex-wrap: wrap;
        `;
        metadata.tags.forEach(tag => {
            const tagBadge = this.createBadge(tag, 'tag');
            tags.appendChild(tagBadge);
        });
        item.appendChild(header);
        item.appendChild(description);
        if (metadata.tags.length > 0) {
            item.appendChild(tags);
        }
        // Event handlers
        item.addEventListener('mouseenter', () => {
            var _a, _b;
            item.style.background = 'var(--background-modifier-hover)';
            item.style.borderColor = 'var(--background-modifier-border-hover)';
            if (this.options.showPreview) {
                this.selectedTemplate = template;
                this.updatePreview(template);
                (_b = (_a = this.options).onTemplatePreview) === null || _b === void 0 ? void 0 : _b.call(_a, template);
            }
        });
        item.addEventListener('mouseleave', () => {
            item.style.background = 'var(--background-secondary)';
            item.style.borderColor = 'var(--background-modifier-border)';
        });
        item.addEventListener('click', () => {
            var _a, _b;
            (_b = (_a = this.options).onTemplateSelect) === null || _b === void 0 ? void 0 : _b.call(_a, template);
        });
        return item;
    }
    createBadge(text, type) {
        const badge = document.createElement('span');
        badge.className = `template-badge template-badge-${type}`;
        badge.textContent = text;
        const colors = {
            category: { bg: 'rgba(59, 130, 246, 0.15)', color: '#3b82f6', border: '#3b82f6' },
            difficulty: { bg: 'rgba(168, 85, 247, 0.15)', color: '#a855f7', border: '#a855f7' },
            builtin: { bg: 'rgba(34, 197, 94, 0.15)', color: '#22c55e', border: '#22c55e' },
            tag: { bg: 'rgba(107, 114, 128, 0.15)', color: '#6b7280', border: '#6b7280' }
        };
        const style = colors[type] || colors.tag;
        badge.style.cssText = `
            display: inline-block;
            padding: 2px 6px;
            font-size: 10px;
            font-weight: 500;
            border-radius: 4px;
            background: ${style.bg};
            color: ${style.color};
            border: 1px solid ${style.border}40;
            white-space: nowrap;
        `;
        return badge;
    }
    updatePreview(template) {
        if (!this.previewPane)
            return;
        const metadata = template.getMetadata();
        this.previewPane.innerHTML = '';
        const header = document.createElement('div');
        header.className = 'preview-header';
        header.style.cssText = `
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--background-modifier-border);
        `;
        const title = document.createElement('h4');
        title.textContent = metadata.name;
        title.style.cssText = `
            margin: 0 0 8px 0;
            color: var(--text-normal);
            font-size: 16px;
        `;
        const description = document.createElement('p');
        description.textContent = metadata.description;
        description.style.cssText = `
            margin: 0;
            color: var(--text-muted);
            font-size: 14px;
            line-height: 1.5;
        `;
        header.appendChild(title);
        header.appendChild(description);
        const content = document.createElement('div');
        content.className = 'preview-content';
        if (metadata.exampleUsage) {
            const exampleSection = this.createPreviewSection('Example Usage', metadata.exampleUsage);
            content.appendChild(exampleSection);
        }
        if (metadata.sparqlPattern) {
            const sparqlSection = this.createPreviewSection('SPARQL Pattern', metadata.sparqlPattern, true);
            content.appendChild(sparqlSection);
        }
        const parameters = template.getParameters();
        if (parameters.length > 0) {
            const parametersSection = this.createParametersSection(parameters);
            content.appendChild(parametersSection);
        }
        const useButton = document.createElement('button');
        useButton.textContent = 'Use This Template';
        useButton.className = 'mod-cta';
        useButton.style.cssText = `
            margin-top: 16px;
            padding: 8px 16px;
            width: 100%;
        `;
        useButton.addEventListener('click', () => {
            var _a, _b;
            (_b = (_a = this.options).onTemplateSelect) === null || _b === void 0 ? void 0 : _b.call(_a, template);
        });
        this.previewPane.appendChild(header);
        this.previewPane.appendChild(content);
        this.previewPane.appendChild(useButton);
    }
    createPreviewSection(title, content, isCode = false) {
        const section = document.createElement('div');
        section.className = 'preview-section';
        section.style.cssText = 'margin-bottom: 16px;';
        const sectionTitle = document.createElement('h5');
        sectionTitle.textContent = title;
        sectionTitle.style.cssText = `
            margin: 0 0 8px 0;
            color: var(--text-normal);
            font-size: 14px;
            font-weight: 500;
        `;
        const sectionContent = document.createElement(isCode ? 'pre' : 'p');
        sectionContent.textContent = content;
        sectionContent.style.cssText = `
            margin: 0;
            color: var(--text-muted);
            font-size: 13px;
            line-height: 1.4;
            ${isCode ? 'background: var(--background-primary); padding: 8px; border-radius: 4px; overflow-x: auto; font-family: var(--font-monospace);' : ''}
        `;
        section.appendChild(sectionTitle);
        section.appendChild(sectionContent);
        return section;
    }
    createParametersSection(parameters) {
        const section = document.createElement('div');
        section.className = 'preview-parameters';
        const title = document.createElement('h5');
        title.textContent = 'Parameters';
        title.style.cssText = `
            margin: 0 0 8px 0;
            color: var(--text-normal);
            font-size: 14px;
            font-weight: 500;
        `;
        const paramList = document.createElement('div');
        paramList.className = 'parameter-list';
        paramList.style.cssText = 'display: flex; flex-direction: column; gap: 8px;';
        parameters.forEach(param => {
            const paramItem = document.createElement('div');
            paramItem.className = 'parameter-item';
            paramItem.style.cssText = `
                padding: 8px;
                background: var(--background-primary);
                border-radius: 4px;
                border: 1px solid var(--background-modifier-border);
            `;
            const paramHeader = document.createElement('div');
            paramHeader.style.cssText = 'display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;';
            const paramName = document.createElement('span');
            paramName.textContent = param.name;
            paramName.style.cssText = 'font-weight: 500; color: var(--text-normal); font-size: 12px;';
            const paramType = document.createElement('span');
            paramType.textContent = param.type;
            paramType.style.cssText = `
                font-size: 10px;
                padding: 2px 4px;
                background: var(--background-secondary);
                border-radius: 2px;
                color: var(--text-muted);
            `;
            if (param.required) {
                const requiredBadge = document.createElement('span');
                requiredBadge.textContent = 'required';
                requiredBadge.style.cssText = `
                    font-size: 10px;
                    padding: 2px 4px;
                    background: rgba(239, 68, 68, 0.15);
                    color: #ef4444;
                    border-radius: 2px;
                    margin-left: 4px;
                `;
                paramType.appendChild(requiredBadge);
            }
            const paramDescription = document.createElement('div');
            paramDescription.textContent = param.description;
            paramDescription.style.cssText = 'color: var(--text-muted); font-size: 11px; line-height: 1.3;';
            paramHeader.appendChild(paramName);
            paramHeader.appendChild(paramType);
            paramItem.appendChild(paramHeader);
            paramItem.appendChild(paramDescription);
            if (param.defaultValue) {
                const defaultValue = document.createElement('div');
                defaultValue.textContent = `Default: ${param.defaultValue}`;
                defaultValue.style.cssText = 'color: var(--text-muted); font-size: 10px; margin-top: 4px; font-style: italic;';
                paramItem.appendChild(defaultValue);
            }
            paramList.appendChild(paramItem);
        });
        section.appendChild(title);
        section.appendChild(paramList);
        return section;
    }
    formatCategoryName(category) {
        return category.charAt(0).toUpperCase() + category.slice(1);
    }
    showError(message) {
        const error = document.createElement('div');
        error.className = 'template-error';
        error.style.cssText = `
            padding: 12px;
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: var(--radius-s);
            text-align: center;
            font-size: 14px;
        `;
        error.textContent = message;
        this.templateList.innerHTML = '';
        this.templateList.appendChild(error);
    }
    getSelectedTemplate() {
        return this.selectedTemplate;
    }
    refresh() {
        this.loadTemplates();
    }
    destroy() {
        if (this.container && this.container.parentNode) {
            this.container.parentNode.removeChild(this.container);
        }
    }
}
exports.TemplateSelectionPanel = TemplateSelectionPanel;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2tpdGVsZXYvRG9jdW1lbnRzL2V4b2NvcnRleC1vYnNpZGlhbi1wbHVnaW4vc3JjL3ByZXNlbnRhdGlvbi9jb21wb25lbnRzL1RlbXBsYXRlU2VsZWN0aW9uUGFuZWwudHMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBLHFFQUF1RztBQWF2RyxNQUFhLHNCQUFzQjtJQVUvQixZQUNxQixhQUEwQixFQUMxQixrQkFBNEMsRUFDNUMsVUFBb0MsRUFBRTtRQUZ0QyxrQkFBYSxHQUFiLGFBQWEsQ0FBYTtRQUMxQix1QkFBa0IsR0FBbEIsa0JBQWtCLENBQTBCO1FBQzVDLFlBQU8sR0FBUCxPQUFPLENBQStCO1FBUG5ELGNBQVMsR0FBb0IsRUFBRSxDQUFDO1FBQ2hDLHNCQUFpQixHQUFvQixFQUFFLENBQUM7UUFRNUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ25CLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUN6QixDQUFDO0lBRU8sV0FBVztRQUNmLElBQUksQ0FBQyxTQUFTLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUMvQyxJQUFJLENBQUMsU0FBUyxDQUFDLFNBQVMsR0FBRywwQkFBMEIsQ0FBQztRQUN0RCxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxPQUFPLEdBQUc7Ozs7OzswQkFNYixJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsSUFBSSxHQUFHOzs7Ozs7U0FNOUMsQ0FBQztRQUVGLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQztRQUNwQixJQUFJLENBQUMscUJBQXFCLEVBQUUsQ0FBQztRQUU3QixJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFO1lBQzFCLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1NBQzVCO2FBQU07WUFDSCxJQUFJLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztTQUM3QjtRQUVELElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUNu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ZXgtb2JzaWRpYW4tcGx1Z2luL3NyYy9wcmVzZW50YXRpb24vY29tcG9uZW50cy9UZW1wbGF0ZVNlbGVjdGlvblBhbmVsLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFF1ZXJ5VGVtcGxhdGUsIFRlbXBsYXRlQ2F0ZWdvcnksIFRlbXBsYXRlUGFyYW1ldGVyIH0gZnJvbSAnLi4vLi4vZG9tYWluL3Zpc3VhbC9RdWVyeVRlbXBsYXRlJztcbmltcG9ydCB7IElRdWVyeVRlbXBsYXRlUmVwb3NpdG9yeSB9IGZyb20gJy4uLy4uL2RvbWFpbi9yZXBvc2l0b3JpZXMvSVF1ZXJ5VGVtcGxhdGVSZXBvc2l0b3J5JztcblxuZXhwb3J0IGludGVyZmFjZSBUZW1wbGF0ZVNlbGVjdGlvbk9wdGlvbnMge1xuICAgIG9uVGVtcGxhdGVTZWxlY3Q/OiAodGVtcGxhdGU6IFF1ZXJ5VGVtcGxhdGUpID0+IHZvaWQ7XG4gICAgb25UZW1wbGF0ZVByZXZpZXc/OiAodGVtcGxhdGU6IFF1ZXJ5VGVtcGxhdGUpID0+IHZvaWQ7XG4gICAgb25DbG9zZT86ICgpID0+IHZvaWQ7XG4gICAgc2hvd1ByZXZpZXc/OiBib29sZWFuO1xuICAgIGFsbG93Q3VzdG9tVGVtcGxhdGVzPzogYm9vbGVhbjtcbiAgICBmaWx0ZXJCeUNhdGVnb3J5PzogVGVtcGxhdGVDYXRlZ29yeVtdO1xuICAgIG1heEhlaWdodD86IG51bWJlcjtcbn1cblxuZXhwb3J0IGNsYXNzIFRlbXBsYXRlU2VsZWN0aW9uUGFuZWwge1xuICAgIHByaXZhdGUgY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudDtcbiAgICBwcml2YXRlIHNlYXJjaElucHV0OiBIVE1MSW5wdXRFbGVtZW50O1xuICAgIHByaXZhdGUgY2F0ZWdvcnlGaWx0ZXI6IEhUTUxTZWxlY3RFbGVtZW50O1xuICAgIHByaXZhdGUgdGVtcGxhdGVMaXN0OiBIVE1MRGl2RWxlbWVudDtcbiAgICBwcml2YXRlIHByZXZpZXdQYW5lPzogSFRNTERpdkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSB0ZW1wbGF0ZXM6IFF1ZXJ5VGVtcGxhdGVbXSA9IFtdO1xuICAgIHByaXZhdGUgZmlsdGVyZWRUZW1wbGF0ZXM6IFF1ZXJ5VGVtcGxhdGVbXSA9IFtdO1xuICAgIHByaXZhdGUgc2VsZWN0ZWRUZW1wbGF0ZT86IFF1ZXJ5VGVtcGxhdGU7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSByZWFkb25seSBwYXJlbnRFbGVtZW50OiBIVE1MRWxlbWVudCxcbiAgICAgICAgcHJpdmF0ZSByZWFkb25seSB0ZW1wbGF0ZVJlcG9zaXRvcnk6IElRdWVyeVRlbXBsYXRlUmVwb3NpdG9yeSxcbiAgICAgICAgcHJpdmF0ZSByZWFkb25seSBvcHRpb25zOiBUZW1wbGF0ZVNlbGVjdGlvbk9wdGlvbnMgPSB7fVxuICAgICkge1xuICAgICAgICB0aGlzLmNyZWF0ZVBhbmVsKCk7XG4gICAgICAgIHRoaXMubG9hZFRlbXBsYXRlcygpO1xuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlUGFuZWwoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRoaXMuY29udGFpbmVyLmNsYXNzTmFtZSA9ICd0ZW1wbGF0ZS1zZWxlY3Rpb24tcGFuZWwnO1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcbiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1tKTtcbiAgICAgICAgICAgIHBhZGRpbmc6IDE2cHg7XG4gICAgICAgICAgICBtYXgtaGVpZ2h0OiAke3RoaXMub3B0aW9ucy5tYXhIZWlnaHQgfHwgNTAwfXB4O1xuICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICAgICAgZ2FwOiAxMnB4O1xuICAgICAgICAgICAgYm94LXNoYWRvdzogMCA0cHggMTZweCByZ2JhKDAsIDAsIDAsIDAuMTUpO1xuICAgICAgICBgO1xuXG4gICAgICAgIHRoaXMuY3JlYXRlSGVhZGVyKCk7XG4gICAgICAgIHRoaXMuY3JlYXRlU2VhcmNoQW5kRmlsdGVyKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnNob3dQcmV2aWV3KSB7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZU1haW5Db250ZW50KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZVRlbXBsYXRlTGlzdCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5wYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuY29udGFpbmVyKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUhlYWRlcigpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgaGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGhlYWRlci5jbGFzc05hbWUgPSAndGVtcGxhdGUtcGFuZWwtaGVhZGVyJztcbiAgICAgICAgaGVhZGVyLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDhweDtcbiAgICAgICAgYDtcblxuICAgICAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XG4gICAgICAgIHRpdGxlLnRleHRDb250ZW50ID0gJ1F1ZXJ5IFRlbXBsYXRlcyc7XG4gICAgICAgIHRpdGxlLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICBtYXJnaW46IDA7XG4gICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuICAgICAgICAgICAgZm9udC1zaXplOiAxNnB4O1xuICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDtcbiAgICAgICAgYDtcblxuICAgICAgICBjb25zdCBjbG9zZUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgICAgICBjbG9zZUJ1dHRvbi50ZXh0Q29udGVudCA9ICfDlyc7XG4gICAgICAgIGNsb3NlQnV0dG9uLmNsYXNzTmFtZSA9ICd0ZW1wbGF0ZS1jbG9zZS1idG4nO1xuICAgICAgICBjbG9zZUJ1dHRvbi5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgYmFja2dyb3VuZDogbm9uZTtcbiAgICAgICAgICAgIGJvcmRlcjogbm9uZTtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMjBweDtcbiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgICAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcbiAgICAgICAgICAgIHBhZGRpbmc6IDRweCA4cHg7XG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG4gICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4xNXMgZWFzZTtcbiAgICAgICAgYDtcblxuICAgICAgICBjbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuICAgICAgICAgICAgY2xvc2VCdXR0b24uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKSc7XG4gICAgICAgICAgICBjbG9zZUJ1dHRvbi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LW5vcm1hbCknO1xuICAgICAgICB9KTtcblxuICAgICAgICBjbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuICAgICAgICAgICAgY2xvc2VCdXR0b24uc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcbiAgICAgICAgICAgIGNsb3NlQnV0dG9uLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtbXV0ZWQpJztcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMub25DbG9zZT8uKCk7XG4gICAgICAgICAgICB0aGlzLmRlc3Ryb3koKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaGVhZGVyLmFwcGVuZENoaWxkKHRpdGxlKTtcbiAgICAgICAgaGVhZGVyLmFwcGVuZENoaWxkKGNsb3NlQnV0dG9uKTtcbiAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQoaGVhZGVyKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZVNlYXJjaEFuZEZpbHRlcigpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmlsdGVyQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGZpbHRlckNvbnRhaW5lci5jbGFzc05hbWUgPSAndGVtcGxhdGUtZmlsdGVyLWNvbnRhaW5lcic7XG4gICAgICAgIGZpbHRlckNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgIGdhcDogOHB4O1xuICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgYDtcblxuICAgICAgICAvLyBTZWFyY2ggaW5wdXRcbiAgICAgICAgdGhpcy5zZWFyY2hJbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgICAgIHRoaXMuc2VhcmNoSW5wdXQudHlwZSA9ICd0ZXh0JztcbiAgICAgICAgdGhpcy5zZWFyY2hJbnB1dC5wbGFjZWhvbGRlciA9ICdTZWFyY2ggdGVtcGxhdGVzLi4uJztcbiAgICAgICAgdGhpcy5zZWFyY2hJbnB1dC5jbGFzc05hbWUgPSAndGVtcGxhdGUtc2VhcmNoJztcbiAgICAgICAgdGhpcy5zZWFyY2hJbnB1dC5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgZmxleDogMTtcbiAgICAgICAgICAgIHBhZGRpbmc6IDhweCAxMnB4O1xuICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1zZWNvbmRhcnkpO1xuICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweDtcbiAgICAgICAgYDtcblxuICAgICAgICB0aGlzLnNlYXJjaElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4gdGhpcy5maWx0ZXJUZW1wbGF0ZXMoKSk7XG5cbiAgICAgICAgLy8gQ2F0ZWdvcnkgZmlsdGVyXG4gICAgICAgIHRoaXMuY2F0ZWdvcnlGaWx0ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzZWxlY3QnKTtcbiAgICAgICAgdGhpcy5jYXRlZ29yeUZpbHRlci5jbGFzc05hbWUgPSAndGVtcGxhdGUtY2F0ZWdvcnktZmlsdGVyJztcbiAgICAgICAgdGhpcy5jYXRlZ29yeUZpbHRlci5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgcGFkZGluZzogOHB4IDEycHg7XG4gICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXNlY29uZGFyeSk7XG4gICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuICAgICAgICAgICAgZm9udC1zaXplOiAxNHB4O1xuICAgICAgICBgO1xuXG4gICAgICAgIC8vIEFkZCBjYXRlZ29yeSBvcHRpb25zXG4gICAgICAgIGNvbnN0IGFsbE9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xuICAgICAgICBhbGxPcHRpb24udmFsdWUgPSAnJztcbiAgICAgICAgYWxsT3B0aW9uLnRleHRDb250ZW50ID0gJ0FsbCBDYXRlZ29yaWVzJztcbiAgICAgICAgdGhpcy5jYXRlZ29yeUZpbHRlci5hcHBlbmRDaGlsZChhbGxPcHRpb24pO1xuXG4gICAgICAgIE9iamVjdC52YWx1ZXMoVGVtcGxhdGVDYXRlZ29yeSkuZm9yRWFjaChjYXRlZ29yeSA9PiB7XG4gICAgICAgICAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcbiAgICAgICAgICAgIG9wdGlvbi52YWx1ZSA9IGNhdGVnb3J5O1xuICAgICAgICAgICAgb3B0aW9uLnRleHRDb250ZW50ID0gdGhpcy5mb3JtYXRDYXRlZ29yeU5hbWUoY2F0ZWdvcnkpO1xuICAgICAgICAgICAgdGhpcy5jYXRlZ29yeUZpbHRlci5hcHBlbmRDaGlsZChvcHRpb24pO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmNhdGVnb3J5RmlsdGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHRoaXMuZmlsdGVyVGVtcGxhdGVzKCkpO1xuXG4gICAgICAgIGZpbHRlckNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLnNlYXJjaElucHV0KTtcbiAgICAgICAgZmlsdGVyQ29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuY2F0ZWdvcnlGaWx0ZXIpO1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmRDaGlsZChmaWx0ZXJDb250YWluZXIpO1xuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlTWFpbkNvbnRlbnQoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1haW5Db250ZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIG1haW5Db250ZW50LmNsYXNzTmFtZSA9ICd0ZW1wbGF0ZS1tYWluLWNvbnRlbnQnO1xuICAgICAgICBtYWluQ29udGVudC5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgIGdhcDogMTJweDtcbiAgICAgICAgICAgIGZsZXg6IDE7XG4gICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuO1xuICAgICAgICBgO1xuXG4gICAgICAgIHRoaXMuY3JlYXRlVGVtcGxhdGVMaXN0KG1haW5Db250ZW50KTtcbiAgICAgICAgdGhpcy5jcmVhdGVQcmV2aWV3UGFuZShtYWluQ29udGVudCk7XG5cbiAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQobWFpbkNvbnRlbnQpO1xuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlVGVtcGxhdGVMaXN0KHBhcmVudD86IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGxpc3RDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgbGlzdENvbnRhaW5lci5jbGFzc05hbWUgPSAndGVtcGxhdGUtbGlzdC1jb250YWluZXInO1xuICAgICAgICBsaXN0Q29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICAke3RoaXMub3B0aW9ucy5zaG93UHJldmlldyA/ICdmbGV4OiAwIDAgMzAwcHg7JyA6ICdmbGV4OiAxOyd9XG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICAgICAgICAgIGdhcDogOHB4O1xuICAgICAgICAgICAgb3ZlcmZsb3cteTogYXV0bztcbiAgICAgICAgICAgIHBhZGRpbmctcmlnaHQ6IDRweDtcbiAgICAgICAgYDtcblxuICAgICAgICB0aGlzLnRlbXBsYXRlTGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0aGlzLnRlbXBsYXRlTGlzdC5jbGFzc05hbWUgPSAndGVtcGxhdGUtbGlzdCc7XG4gICAgICAgIHRoaXMudGVtcGxhdGVMaXN0LnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICAgICAgICAgIGdhcDogNHB4O1xuICAgICAgICBgO1xuXG4gICAgICAgIGxpc3RDb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy50ZW1wbGF0ZUxpc3QpO1xuICAgICAgICAocGFyZW50IHx8IHRoaXMuY29udGFpbmVyKS5hcHBlbmRDaGlsZChsaXN0Q29udGFpbmVyKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZVByZXZpZXdQYW5lKHBhcmVudDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5wcmV2aWV3UGFuZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0aGlzLnByZXZpZXdQYW5lLmNsYXNzTmFtZSA9ICd0ZW1wbGF0ZS1wcmV2aWV3LXBhbmUnO1xuICAgICAgICB0aGlzLnByZXZpZXdQYW5lLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICBmbGV4OiAxO1xuICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuICAgICAgICAgICAgcGFkZGluZzogMTZweDtcbiAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtc2Vjb25kYXJ5KTtcbiAgICAgICAgICAgIG92ZXJmbG93LXk6IGF1dG87XG4gICAgICAgIGA7XG5cbiAgICAgICAgY29uc3QgZW1wdHlTdGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBlbXB0eVN0YXRlLmNsYXNzTmFtZSA9ICdwcmV2aWV3LWVtcHR5LXN0YXRlJztcbiAgICAgICAgZW1wdHlTdGF0ZS5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgICAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcbiAgICAgICAgICAgIGZvbnQtc3R5bGU6IGl0YWxpYztcbiAgICAgICAgYDtcbiAgICAgICAgZW1wdHlTdGF0ZS50ZXh0Q29udGVudCA9ICdTZWxlY3QgYSB0ZW1wbGF0ZSB0byBwcmV2aWV3JztcblxuICAgICAgICB0aGlzLnByZXZpZXdQYW5lLmFwcGVuZENoaWxkKGVtcHR5U3RhdGUpO1xuICAgICAgICBwYXJlbnQuYXBwZW5kQ2hpbGQodGhpcy5wcmV2aWV3UGFuZSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBsb2FkVGVtcGxhdGVzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZXMgPSBhd2FpdCB0aGlzLnRlbXBsYXRlUmVwb3NpdG9yeS5maW5kQWxsKCk7XG4gICAgICAgICAgICB0aGlzLmZpbHRlclRlbXBsYXRlcygpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgdGVtcGxhdGVzOicsIGVycm9yKTtcbiAgICAgICAgICAgIHRoaXMuc2hvd0Vycm9yKCdGYWlsZWQgdG8gbG9hZCB0ZW1wbGF0ZXMnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgZmlsdGVyVGVtcGxhdGVzKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBzZWFyY2hUZXJtID0gdGhpcy5zZWFyY2hJbnB1dC52YWx1ZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBjb25zdCBzZWxlY3RlZENhdGVnb3J5ID0gdGhpcy5jYXRlZ29yeUZpbHRlci52YWx1ZSBhcyBUZW1wbGF0ZUNhdGVnb3J5IHx8IHVuZGVmaW5lZDtcblxuICAgICAgICB0aGlzLmZpbHRlcmVkVGVtcGxhdGVzID0gdGhpcy50ZW1wbGF0ZXMuZmlsdGVyKHRlbXBsYXRlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG1ldGFkYXRhID0gdGVtcGxhdGUuZ2V0TWV0YWRhdGEoKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ2F0ZWdvcnkgZmlsdGVyXG4gICAgICAgICAgICBpZiAoc2VsZWN0ZWRDYXRlZ29yeSAmJiBtZXRhZGF0YS5jYXRlZ29yeSAhPT0gc2VsZWN0ZWRDYXRlZ29yeSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQXBwbHkgY2F0ZWdvcnkgcmVzdHJpY3Rpb25zIGZyb20gb3B0aW9uc1xuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5maWx0ZXJCeUNhdGVnb3J5ICYmIFxuICAgICAgICAgICAgICAgICF0aGlzLm9wdGlvbnMuZmlsdGVyQnlDYXRlZ29yeS5pbmNsdWRlcyhtZXRhZGF0YS5jYXRlZ29yeSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEN1c3RvbSB0ZW1wbGF0ZSBmaWx0ZXJcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuYWxsb3dDdXN0b21UZW1wbGF0ZXMgPT09IGZhbHNlICYmICF0ZW1wbGF0ZS5pc0J1aWx0SW5UZW1wbGF0ZSgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBTZWFyY2ggZmlsdGVyXG4gICAgICAgICAgICBpZiAoc2VhcmNoVGVybSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5hbWVNYXRjaCA9IG1ldGFkYXRhLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hUZXJtKTtcbiAgICAgICAgICAgICAgICBjb25zdCBkZXNjTWF0Y2ggPSBtZXRhZGF0YS5kZXNjcmlwdGlvbi50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaFRlcm0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhZ01hdGNoID0gbWV0YWRhdGEudGFncy5zb21lKHRhZyA9PiB0YWcudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hUZXJtKSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKCFuYW1lTWF0Y2ggJiYgIWRlc2NNYXRjaCAmJiAhdGFnTWF0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMucmVuZGVyVGVtcGxhdGVMaXN0KCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZW5kZXJUZW1wbGF0ZUxpc3QoKTogdm9pZCB7XG4gICAgICAgIHRoaXMudGVtcGxhdGVMaXN0LmlubmVySFRNTCA9ICcnO1xuXG4gICAgICAgIGlmICh0aGlzLmZpbHRlcmVkVGVtcGxhdGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgY29uc3QgZW1wdHlTdGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgZW1wdHlTdGF0ZS5jbGFzc05hbWUgPSAndGVtcGxhdGUtbGlzdC1lbXB0eSc7XG4gICAgICAgICAgICBlbXB0eVN0YXRlLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICAgICAgICAgIHBhZGRpbmc6IDI0cHg7XG4gICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuICAgICAgICAgICAgICAgIGZvbnQtc3R5bGU6IGl0YWxpYztcbiAgICAgICAgICAgIGA7XG4gICAgICAgICAgICBlbXB0eVN0YXRlLnRleHRDb250ZW50ID0gJ05vIHRlbXBsYXRlcyBtYXRjaCB5b3VyIGNyaXRlcmlhJztcbiAgICAgICAgICAgIHRoaXMudGVtcGxhdGVMaXN0LmFwcGVuZENoaWxkKGVtcHR5U3RhdGUpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5maWx0ZXJlZFRlbXBsYXRlcy5mb3JFYWNoKHRlbXBsYXRlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRlbXBsYXRlSXRlbSA9IHRoaXMuY3JlYXRlVGVtcGxhdGVJdGVtKHRlbXBsYXRlKTtcbiAgICAgICAgICAgIHRoaXMudGVtcGxhdGVMaXN0LmFwcGVuZENoaWxkKHRlbXBsYXRlSXRlbSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlVGVtcGxhdGVJdGVtKHRlbXBsYXRlOiBRdWVyeVRlbXBsYXRlKTogSFRNTERpdkVsZW1lbnQge1xuICAgICAgICBjb25zdCBtZXRhZGF0YSA9IHRlbXBsYXRlLmdldE1ldGFkYXRhKCk7XG4gICAgICAgIGNvbnN0IGl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgaXRlbS5jbGFzc05hbWUgPSAndGVtcGxhdGUtaXRlbSc7XG4gICAgICAgIGl0ZW0uc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgIHBhZGRpbmc6IDEycHg7XG4gICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG4gICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4xNXMgZWFzZTtcbiAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtc2Vjb25kYXJ5KTtcbiAgICAgICAgYDtcblxuICAgICAgICBjb25zdCBoZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgaGVhZGVyLmNsYXNzTmFtZSA9ICd0ZW1wbGF0ZS1pdGVtLWhlYWRlcic7XG4gICAgICAgIGhlYWRlci5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcbiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0O1xuICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogNHB4O1xuICAgICAgICBgO1xuXG4gICAgICAgIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgbmFtZS5jbGFzc05hbWUgPSAndGVtcGxhdGUtaXRlbS1uYW1lJztcbiAgICAgICAgbmFtZS50ZXh0Q29udGVudCA9IG1ldGFkYXRhLm5hbWU7XG4gICAgICAgIG5hbWUuc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA1MDA7XG4gICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuICAgICAgICAgICAgZm9udC1zaXplOiAxNHB4O1xuICAgICAgICBgO1xuXG4gICAgICAgIGNvbnN0IGJhZGdlcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBiYWRnZXMuY2xhc3NOYW1lID0gJ3RlbXBsYXRlLWJhZGdlcyc7XG4gICAgICAgIGJhZGdlcy5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgIGdhcDogNHB4O1xuICAgICAgICAgICAgZmxleC1zaHJpbms6IDA7XG4gICAgICAgIGA7XG5cbiAgICAgICAgLy8gQ2F0ZWdvcnkgYmFkZ2VcbiAgICAgICAgY29uc3QgY2F0ZWdvcnlCYWRnZSA9IHRoaXMuY3JlYXRlQmFkZ2UodGhpcy5mb3JtYXRDYXRlZ29yeU5hbWUobWV0YWRhdGEuY2F0ZWdvcnkpLCAnY2F0ZWdvcnknKTtcbiAgICAgICAgYmFkZ2VzLmFwcGVuZENoaWxkKGNhdGVnb3J5QmFkZ2UpO1xuXG4gICAgICAgIC8vIERpZmZpY3VsdHkgYmFkZ2VcbiAgICAgICAgY29uc3QgZGlmZmljdWx0eUJhZGdlID0gdGhpcy5jcmVhdGVCYWRnZShtZXRhZGF0YS5kaWZmaWN1bHR5LCAnZGlmZmljdWx0eScpO1xuICAgICAgICBiYWRnZXMuYXBwZW5kQ2hpbGQoZGlmZmljdWx0eUJhZGdlKTtcblxuICAgICAgICAvLyBCdWlsdC1pbiBiYWRnZVxuICAgICAgICBpZiAodGVtcGxhdGUuaXNCdWlsdEluVGVtcGxhdGUoKSkge1xuICAgICAgICAgICAgY29uc3QgYnVpbHRJbkJhZGdlID0gdGhpcy5jcmVhdGVCYWRnZSgnQnVpbHQtaW4nLCAnYnVpbHRpbicpO1xuICAgICAgICAgICAgYmFkZ2VzLmFwcGVuZENoaWxkKGJ1aWx0SW5CYWRnZSk7XG4gICAgICAgIH1cblxuICAgICAgICBoZWFkZXIuYXBwZW5kQ2hpbGQobmFtZSk7XG4gICAgICAgIGhlYWRlci5hcHBlbmRDaGlsZChiYWRnZXMpO1xuXG4gICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGRlc2NyaXB0aW9uLmNsYXNzTmFtZSA9ICd0ZW1wbGF0ZS1pdGVtLWRlc2NyaXB0aW9uJztcbiAgICAgICAgZGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBtZXRhZGF0YS5kZXNjcmlwdGlvbjtcbiAgICAgICAgZGVzY3JpcHRpb24uc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTJweDtcbiAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxLjQ7XG4gICAgICAgICAgICBtYXJnaW4tYm90dG9tOiA4cHg7XG4gICAgICAgIGA7XG5cbiAgICAgICAgY29uc3QgdGFncyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0YWdzLmNsYXNzTmFtZSA9ICd0ZW1wbGF0ZS1pdGVtLXRhZ3MnO1xuICAgICAgICB0YWdzLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgZ2FwOiA0cHg7XG4gICAgICAgICAgICBmbGV4LXdyYXA6IHdyYXA7XG4gICAgICAgIGA7XG5cbiAgICAgICAgbWV0YWRhdGEudGFncy5mb3JFYWNoKHRhZyA9PiB7XG4gICAgICAgICAgICBjb25zdCB0YWdCYWRnZSA9IHRoaXMuY3JlYXRlQmFkZ2UodGFnLCAndGFnJyk7XG4gICAgICAgICAgICB0YWdzLmFwcGVuZENoaWxkKHRhZ0JhZGdlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXRlbS5hcHBlbmRDaGlsZChoZWFkZXIpO1xuICAgICAgICBpdGVtLmFwcGVuZENoaWxkKGRlc2NyaXB0aW9uKTtcbiAgICAgICAgaWYgKG1ldGFkYXRhLnRhZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgaXRlbS5hcHBlbmRDaGlsZCh0YWdzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEV2ZW50IGhhbmRsZXJzXG4gICAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcbiAgICAgICAgICAgIGl0ZW0uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKSc7XG4gICAgICAgICAgICBpdGVtLnN0eWxlLmJvcmRlckNvbG9yID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyLWhvdmVyKSc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2hvd1ByZXZpZXcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkVGVtcGxhdGUgPSB0ZW1wbGF0ZTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVByZXZpZXcodGVtcGxhdGUpO1xuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5vblRlbXBsYXRlUHJldmlldz8uKHRlbXBsYXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuICAgICAgICAgICAgaXRlbS5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtc2Vjb25kYXJ5KSc7XG4gICAgICAgICAgICBpdGVtLnN0eWxlLmJvcmRlckNvbG9yID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKSc7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMub25UZW1wbGF0ZVNlbGVjdD8uKHRlbXBsYXRlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVCYWRnZSh0ZXh0OiBzdHJpbmcsIHR5cGU6IHN0cmluZyk6IEhUTUxTcGFuRWxlbWVudCB7XG4gICAgICAgIGNvbnN0IGJhZGdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICBiYWRnZS5jbGFzc05hbWUgPSBgdGVtcGxhdGUtYmFkZ2UgdGVtcGxhdGUtYmFkZ2UtJHt0eXBlfWA7XG4gICAgICAgIGJhZGdlLnRleHRDb250ZW50ID0gdGV4dDtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGNvbG9ycyA9IHtcbiAgICAgICAgICAgIGNhdGVnb3J5OiB7IGJnOiAncmdiYSg1OSwgMTMwLCAyNDYsIDAuMTUpJywgY29sb3I6ICcjM2I4MmY2JywgYm9yZGVyOiAnIzNiODJmNicgfSxcbiAgICAgICAgICAgIGRpZmZpY3VsdHk6IHsgYmc6ICdyZ2JhKDE2OCwgODUsIDI0NywgMC4xNSknLCBjb2xvcjogJyNhODU1ZjcnLCBib3JkZXI6ICcjYTg1NWY3JyB9LFxuICAgICAgICAgICAgYnVpbHRpbjogeyBiZzogJ3JnYmEoMzQsIDE5NywgOTQsIDAuMTUpJywgY29sb3I6ICcjMjJjNTVlJywgYm9yZGVyOiAnIzIyYzU1ZScgfSxcbiAgICAgICAgICAgIHRhZzogeyBiZzogJ3JnYmEoMTA3LCAxMTQsIDEyOCwgMC4xNSknLCBjb2xvcjogJyM2YjcyODAnLCBib3JkZXI6ICcjNmI3MjgwJyB9XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3Qgc3R5bGUgPSBjb2xvcnNbdHlwZSBhcyBrZXlvZiB0eXBlb2YgY29sb3JzXSB8fCBjb2xvcnMudGFnO1xuXG4gICAgICAgIGJhZGdlLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gICAgICAgICAgICBwYWRkaW5nOiAycHggNnB4O1xuICAgICAgICAgICAgZm9udC1zaXplOiAxMHB4O1xuICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgICAgICAgICAgIGJhY2tncm91bmQ6ICR7c3R5bGUuYmd9O1xuICAgICAgICAgICAgY29sb3I6ICR7c3R5bGUuY29sb3J9O1xuICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgJHtzdHlsZS5ib3JkZXJ9NDA7XG4gICAgICAgICAgICB3aGl0ZS1zcGFjZTogbm93cmFwO1xuICAgICAgICBgO1xuXG4gICAgICAgIHJldHVybiBiYWRnZTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHVwZGF0ZVByZXZpZXcodGVtcGxhdGU6IFF1ZXJ5VGVtcGxhdGUpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLnByZXZpZXdQYW5lKSByZXR1cm47XG5cbiAgICAgICAgY29uc3QgbWV0YWRhdGEgPSB0ZW1wbGF0ZS5nZXRNZXRhZGF0YSgpO1xuICAgICAgICB0aGlzLnByZXZpZXdQYW5lLmlubmVySFRNTCA9ICcnO1xuXG4gICAgICAgIGNvbnN0IGhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBoZWFkZXIuY2xhc3NOYW1lID0gJ3ByZXZpZXctaGVhZGVyJztcbiAgICAgICAgaGVhZGVyLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAxNnB4O1xuICAgICAgICAgICAgcGFkZGluZy1ib3R0b206IDEycHg7XG4gICAgICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuICAgICAgICBgO1xuXG4gICAgICAgIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDQnKTtcbiAgICAgICAgdGl0bGUudGV4dENvbnRlbnQgPSBtZXRhZGF0YS5uYW1lO1xuICAgICAgICB0aXRsZS5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgbWFyZ2luOiAwIDAgOHB4IDA7XG4gICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuICAgICAgICAgICAgZm9udC1zaXplOiAxNnB4O1xuICAgICAgICBgO1xuXG4gICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICAgICAgICBkZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IG1ldGFkYXRhLmRlc2NyaXB0aW9uO1xuICAgICAgICBkZXNjcmlwdGlvbi5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgbWFyZ2luOiAwO1xuICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuICAgICAgICAgICAgZm9udC1zaXplOiAxNHB4O1xuICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDEuNTtcbiAgICAgICAgYDtcblxuICAgICAgICBoZWFkZXIuYXBwZW5kQ2hpbGQodGl0bGUpO1xuICAgICAgICBoZWFkZXIuYXBwZW5kQ2hpbGQoZGVzY3JpcHRpb24pO1xuXG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgY29udGVudC5jbGFzc05hbWUgPSAncHJldmlldy1jb250ZW50JztcblxuICAgICAgICBpZiAobWV0YWRhdGEuZXhhbXBsZVVzYWdlKSB7XG4gICAgICAgICAgICBjb25zdCBleGFtcGxlU2VjdGlvbiA9IHRoaXMuY3JlYXRlUHJldmlld1NlY3Rpb24oJ0V4YW1wbGUgVXNhZ2UnLCBtZXRhZGF0YS5leGFtcGxlVXNhZ2UpO1xuICAgICAgICAgICAgY29udGVudC5hcHBlbmRDaGlsZChleGFtcGxlU2VjdGlvbik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobWV0YWRhdGEuc3BhcnFsUGF0dGVybikge1xuICAgICAgICAgICAgY29uc3Qgc3BhcnFsU2VjdGlvbiA9IHRoaXMuY3JlYXRlUHJldmlld1NlY3Rpb24oJ1NQQVJRTCBQYXR0ZXJuJywgbWV0YWRhdGEuc3BhcnFsUGF0dGVybiwgdHJ1ZSk7XG4gICAgICAgICAgICBjb250ZW50LmFwcGVuZENoaWxkKHNwYXJxbFNlY3Rpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcGFyYW1ldGVycyA9IHRlbXBsYXRlLmdldFBhcmFtZXRlcnMoKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgcGFyYW1ldGVyc1NlY3Rpb24gPSB0aGlzLmNyZWF0ZVBhcmFtZXRlcnNTZWN0aW9uKHBhcmFtZXRlcnMpO1xuICAgICAgICAgICAgY29udGVudC5hcHBlbmRDaGlsZChwYXJhbWV0ZXJzU2VjdGlvbik7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB1c2VCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICAgICAgdXNlQnV0dG9uLnRleHRDb250ZW50ID0gJ1VzZSBUaGlzIFRlbXBsYXRlJztcbiAgICAgICAgdXNlQnV0dG9uLmNsYXNzTmFtZSA9ICdtb2QtY3RhJztcbiAgICAgICAgdXNlQnV0dG9uLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICBtYXJnaW4tdG9wOiAxNnB4O1xuICAgICAgICAgICAgcGFkZGluZzogOHB4IDE2cHg7XG4gICAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgYDtcblxuICAgICAgICB1c2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMub25UZW1wbGF0ZVNlbGVjdD8uKHRlbXBsYXRlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5wcmV2aWV3UGFuZS5hcHBlbmRDaGlsZChoZWFkZXIpO1xuICAgICAgICB0aGlzLnByZXZpZXdQYW5lLmFwcGVuZENoaWxkKGNvbnRlbnQpO1xuICAgICAgICB0aGlzLnByZXZpZXdQYW5lLmFwcGVuZENoaWxkKHVzZUJ1dHRvbik7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVQcmV2aWV3U2VjdGlvbih0aXRsZTogc3RyaW5nLCBjb250ZW50OiBzdHJpbmcsIGlzQ29kZSA9IGZhbHNlKTogSFRNTERpdkVsZW1lbnQge1xuICAgICAgICBjb25zdCBzZWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHNlY3Rpb24uY2xhc3NOYW1lID0gJ3ByZXZpZXctc2VjdGlvbic7XG4gICAgICAgIHNlY3Rpb24uc3R5bGUuY3NzVGV4dCA9ICdtYXJnaW4tYm90dG9tOiAxNnB4Oyc7XG5cbiAgICAgICAgY29uc3Qgc2VjdGlvblRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDUnKTtcbiAgICAgICAgc2VjdGlvblRpdGxlLnRleHRDb250ZW50ID0gdGl0bGU7XG4gICAgICAgIHNlY3Rpb25UaXRsZS5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgbWFyZ2luOiAwIDAgOHB4IDA7XG4gICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuICAgICAgICAgICAgZm9udC1zaXplOiAxNHB4O1xuICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDtcbiAgICAgICAgYDtcblxuICAgICAgICBjb25zdCBzZWN0aW9uQ29udGVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaXNDb2RlID8gJ3ByZScgOiAncCcpO1xuICAgICAgICBzZWN0aW9uQ29udGVudC50ZXh0Q29udGVudCA9IGNvbnRlbnQ7XG4gICAgICAgIHNlY3Rpb25Db250ZW50LnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICBtYXJnaW46IDA7XG4gICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG4gICAgICAgICAgICBmb250LXNpemU6IDEzcHg7XG4gICAgICAgICAgICBsaW5lLWhlaWdodDogMS40O1xuICAgICAgICAgICAgJHtpc0NvZGUgPyAnYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTsgcGFkZGluZzogOHB4OyBib3JkZXItcmFkaXVzOiA0cHg7IG92ZXJmbG93LXg6IGF1dG87IGZvbnQtZmFtaWx5OiB2YXIoLS1mb250LW1vbm9zcGFjZSk7JyA6ICcnfVxuICAgICAgICBgO1xuXG4gICAgICAgIHNlY3Rpb24uYXBwZW5kQ2hpbGQoc2VjdGlvblRpdGxlKTtcbiAgICAgICAgc2VjdGlvbi5hcHBlbmRDaGlsZChzZWN0aW9uQ29udGVudCk7XG5cbiAgICAgICAgcmV0dXJuIHNlY3Rpb247XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVQYXJhbWV0ZXJzU2VjdGlvbihwYXJhbWV0ZXJzOiBUZW1wbGF0ZVBhcmFtZXRlcltdKTogSFRNTERpdkVsZW1lbnQge1xuICAgICAgICBjb25zdCBzZWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHNlY3Rpb24uY2xhc3NOYW1lID0gJ3ByZXZpZXctcGFyYW1ldGVycyc7XG5cbiAgICAgICAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoNScpO1xuICAgICAgICB0aXRsZS50ZXh0Q29udGVudCA9ICdQYXJhbWV0ZXJzJztcbiAgICAgICAgdGl0bGUuc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgIG1hcmdpbjogMCAwIDhweCAwO1xuICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweDtcbiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA1MDA7XG4gICAgICAgIGA7XG5cbiAgICAgICAgY29uc3QgcGFyYW1MaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHBhcmFtTGlzdC5jbGFzc05hbWUgPSAncGFyYW1ldGVyLWxpc3QnO1xuICAgICAgICBwYXJhbUxpc3Quc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBmbGV4OyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyBnYXA6IDhweDsnO1xuXG4gICAgICAgIHBhcmFtZXRlcnMuZm9yRWFjaChwYXJhbSA9PiB7XG4gICAgICAgICAgICBjb25zdCBwYXJhbUl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIHBhcmFtSXRlbS5jbGFzc05hbWUgPSAncGFyYW1ldGVyLWl0ZW0nO1xuICAgICAgICAgICAgcGFyYW1JdGVtLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICAgICAgcGFkZGluZzogOHB4O1xuICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG4gICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4O1xuICAgICAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcbiAgICAgICAgICAgIGA7XG5cbiAgICAgICAgICAgIGNvbnN0IHBhcmFtSGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBwYXJhbUhlYWRlci5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsgYWxpZ24taXRlbXM6IGNlbnRlcjsgbWFyZ2luLWJvdHRvbTogNHB4Oyc7XG5cbiAgICAgICAgICAgIGNvbnN0IHBhcmFtTmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgICAgIHBhcmFtTmFtZS50ZXh0Q29udGVudCA9IHBhcmFtLm5hbWU7XG4gICAgICAgICAgICBwYXJhbU5hbWUuc3R5bGUuY3NzVGV4dCA9ICdmb250LXdlaWdodDogNTAwOyBjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpOyBmb250LXNpemU6IDEycHg7JztcblxuICAgICAgICAgICAgY29uc3QgcGFyYW1UeXBlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICAgICAgcGFyYW1UeXBlLnRleHRDb250ZW50ID0gcGFyYW0udHlwZTtcbiAgICAgICAgICAgIHBhcmFtVHlwZS5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMTBweDtcbiAgICAgICAgICAgICAgICBwYWRkaW5nOiAycHggNHB4O1xuICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtc2Vjb25kYXJ5KTtcbiAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiAycHg7XG4gICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuICAgICAgICAgICAgYDtcblxuICAgICAgICAgICAgaWYgKHBhcmFtLnJlcXVpcmVkKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVxdWlyZWRCYWRnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgICAgICAgICByZXF1aXJlZEJhZGdlLnRleHRDb250ZW50ID0gJ3JlcXVpcmVkJztcbiAgICAgICAgICAgICAgICByZXF1aXJlZEJhZGdlLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMTBweDtcbiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMnB4IDRweDtcbiAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyMzksIDY4LCA2OCwgMC4xNSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiAjZWY0NDQ0O1xuICAgICAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiAycHg7XG4gICAgICAgICAgICAgICAgICAgIG1hcmdpbi1sZWZ0OiA0cHg7XG4gICAgICAgICAgICAgICAgYDtcbiAgICAgICAgICAgICAgICBwYXJhbVR5cGUuYXBwZW5kQ2hpbGQocmVxdWlyZWRCYWRnZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHBhcmFtRGVzY3JpcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIHBhcmFtRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBwYXJhbS5kZXNjcmlwdGlvbjtcbiAgICAgICAgICAgIHBhcmFtRGVzY3JpcHRpb24uc3R5bGUuY3NzVGV4dCA9ICdjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGZvbnQtc2l6ZTogMTFweDsgbGluZS1oZWlnaHQ6IDEuMzsnO1xuXG4gICAgICAgICAgICBwYXJhbUhlYWRlci5hcHBlbmRDaGlsZChwYXJhbU5hbWUpO1xuICAgICAgICAgICAgcGFyYW1IZWFkZXIuYXBwZW5kQ2hpbGQocGFyYW1UeXBlKTtcbiAgICAgICAgICAgIHBhcmFtSXRlbS5hcHBlbmRDaGlsZChwYXJhbUhlYWRlcik7XG4gICAgICAgICAgICBwYXJhbUl0ZW0uYXBwZW5kQ2hpbGQocGFyYW1EZXNjcmlwdGlvbik7XG5cbiAgICAgICAgICAgIGlmIChwYXJhbS5kZWZhdWx0VmFsdWUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkZWZhdWx0VmFsdWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWUudGV4dENvbnRlbnQgPSBgRGVmYXVsdDogJHtwYXJhbS5kZWZhdWx0VmFsdWV9YDtcbiAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWUuc3R5bGUuY3NzVGV4dCA9ICdjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGZvbnQtc2l6ZTogMTBweDsgbWFyZ2luLXRvcDogNHB4OyBmb250LXN0eWxlOiBpdGFsaWM7JztcbiAgICAgICAgICAgICAgICBwYXJhbUl0ZW0uYXBwZW5kQ2hpbGQoZGVmYXVsdFZhbHVlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcGFyYW1MaXN0LmFwcGVuZENoaWxkKHBhcmFtSXRlbSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHNlY3Rpb24uYXBwZW5kQ2hpbGQodGl0bGUpO1xuICAgICAgICBzZWN0aW9uLmFwcGVuZENoaWxkKHBhcmFtTGlzdCk7XG5cbiAgICAgICAgcmV0dXJuIHNlY3Rpb247XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBmb3JtYXRDYXRlZ29yeU5hbWUoY2F0ZWdvcnk6IFRlbXBsYXRlQ2F0ZWdvcnkpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gY2F0ZWdvcnkuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBjYXRlZ29yeS5zbGljZSgxKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNob3dFcnJvcihtZXNzYWdlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZXJyb3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZXJyb3IuY2xhc3NOYW1lID0gJ3RlbXBsYXRlLWVycm9yJztcbiAgICAgICAgZXJyb3Iuc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgIHBhZGRpbmc6IDEycHg7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDIzOSwgNjgsIDY4LCAwLjEpO1xuICAgICAgICAgICAgY29sb3I6ICNlZjQ0NDQ7XG4gICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDIzOSwgNjgsIDY4LCAwLjMpO1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICAgICAgZm9udC1zaXplOiAxNHB4O1xuICAgICAgICBgO1xuICAgICAgICBlcnJvci50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XG5cbiAgICAgICAgdGhpcy50ZW1wbGF0ZUxpc3QuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgIHRoaXMudGVtcGxhdGVMaXN0LmFwcGVuZENoaWxkKGVycm9yKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0U2VsZWN0ZWRUZW1wbGF0ZSgpOiBRdWVyeVRlbXBsYXRlIHwgdW5kZWZpbmVkIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0ZWRUZW1wbGF0ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgcmVmcmVzaCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5sb2FkVGVtcGxhdGVzKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmNvbnRhaW5lciAmJiB0aGlzLmNvbnRhaW5lci5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuY29udGFpbmVyKTtcbiAgICAgICAgfVxuICAgIH1cbn0iXSwidmVyc2lvbiI6M30=