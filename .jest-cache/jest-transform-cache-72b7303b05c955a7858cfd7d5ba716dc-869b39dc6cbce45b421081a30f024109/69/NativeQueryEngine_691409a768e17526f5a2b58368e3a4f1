7cfd7a0fc771c58834f2efd903f7a71e
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.NativeQueryEngine = void 0;
const obsidian_1 = require("obsidian");
const Result_1 = require("../../domain/core/Result");
/**
 * Native query engine that works without Dataview/Datacore dependencies.
 * Optimized for iOS and mobile environments with limited resources.
 */
class NativeQueryEngine {
    constructor(app) {
        this.cacheTimeout = 5000; // 5 seconds cache
        this.app = app;
        this.metadataCache = app?.metadataCache;
        this.vault = app?.vault;
        this.queryCache = new Map();
    }
    getName() {
        return "native";
    }
    getType() {
        return "native";
    }
    isAvailable() {
        // Native engine is available when app is provided
        return this.app != null;
    }
    async executeQuery(query, context) {
        try {
            // Check cache first
            const cached = this.getCachedResult(query);
            if (cached) {
                return Result_1.Result.ok(cached);
            }
            // Parse query type
            const queryType = this.parseQueryType(query);
            let result;
            switch (queryType.type) {
                case "table":
                    result = await this.executeTableQuery(queryType.query, context);
                    break;
                case "list":
                    result = await this.executeListQuery(queryType.query, context);
                    break;
                case "task":
                    result = await this.executeTaskQuery(queryType.query, context);
                    break;
                case "calendar":
                    result = await this.executeCalendarQuery(queryType.query, context);
                    break;
                default:
                    result = await this.executeCustomQuery(query, context);
            }
            // Cache the result
            this.cacheResult(query, result);
            return Result_1.Result.ok(result);
        }
        catch (error) {
            return Result_1.Result.fail(`Native query execution failed: ${error.message}`);
        }
    }
    parseQueryType(query) {
        const lowerQuery = query.toLowerCase().trim();
        if (lowerQuery.startsWith("table")) {
            return { type: "table", query: query.substring(5).trim() };
        }
        else if (lowerQuery.startsWith("list")) {
            return { type: "list", query: query.substring(4).trim() };
        }
        else if (lowerQuery.startsWith("task")) {
            return { type: "task", query: query.substring(4).trim() };
        }
        else if (lowerQuery.startsWith("calendar")) {
            return { type: "calendar", query: query.substring(8).trim() };
        }
        return { type: "custom", query };
    }
    async executeTableQuery(query, context) {
        // Parse table query: "columns FROM source WHERE conditions"
        const tableRegex = /^(.+?)\s+from\s+"([^"]+)"(?:\s+where\s+(.+))?$/i;
        const match = query.match(tableRegex);
        if (!match) {
            throw new Error("Invalid table query format: missing FROM clause");
        }
        const [, columns, source, conditions] = match;
        const files = await this.getFilesFromSource(source, conditions);
        const columnList = columns.split(",").map((c) => c.trim());
        const rows = await Promise.all(files.map(async (file) => {
            const metadata = this.metadataCache.getFileCache(file);
            const row = {};
            for (const col of columnList) {
                row[col] = await this.extractProperty(file, metadata, col);
            }
            return row;
        }));
        return {
            type: "table",
            data: rows,
            columns: columnList,
            metadata: {
                renderHtml: this.renderTable(columnList, rows),
                where: conditions || undefined,
            },
        };
    }
    async executeListQuery(query, context) {
        // Parse list query: "FROM source WHERE conditions"
        const listRegex = /^from\s+"([^"]+)"(?:\s+where\s+(.+))?$/i;
        const match = query.match(listRegex);
        if (!match) {
            throw new Error("Invalid list query format: missing FROM clause");
        }
        const [, source, conditions] = match;
        const files = await this.getFilesFromSource(source, conditions);
        const items = files.map((file) => ({
            text: file.basename,
            link: `[[${file.path}]]`,
        }));
        return {
            type: "list",
            data: items,
            metadata: { renderHtml: this.renderList(items) },
        };
    }
    async executeTaskQuery(query, context) {
        // Find all tasks in vault
        const tasks = [];
        if (!this.vault) {
            return {
                type: "task",
                data: [],
                metadata: { renderHtml: this.renderTasks([]) },
            };
        }
        // Parse query to determine which files to check
        let targetFiles = [];
        if (query.includes('from "')) {
            // Extract source from query
            const sourceMatch = query.match(/from\s+"([^"]+)"/);
            if (sourceMatch) {
                const source = sourceMatch[1];
                targetFiles = await this.getFilesFromSource(source);
            }
        }
        else {
            // Check all files if no source specified
            targetFiles = this.vault.getMarkdownFiles();
        }
        for (const file of targetFiles) {
            try {
                const content = await this.vault.cachedRead(file);
                const taskRegex = /^[\s]*- \[(.)\] (.+)$/gm;
                let match;
                while ((match = taskRegex.exec(content)) !== null) {
                    const [, status, text] = match;
                    tasks.push({
                        status: status === "x" ? "completed" : "pending",
                        completed: status === "x",
                        text,
                        file: file.path,
                    });
                }
            }
            catch (error) {
                // Skip files that can't be read and return empty tasks for that file
                console.warn(`Failed to read file ${file.path} for task query:`, error);
                continue;
            }
        }
        // Apply filters if specified in query
        const filteredTasks = this.filterTasks(tasks, query);
        return {
            type: "task",
            data: filteredTasks,
            metadata: { renderHtml: this.renderTasks(filteredTasks) },
        };
    }
    async executeCalendarQuery(query, context) {
        // Find all files with dates
        const events = [];
        if (!this.vault || !this.metadataCache) {
            return {
                type: "calendar",
                data: events,
                metadata: { renderHtml: this.renderCalendar(events) },
            };
        }
        const files = this.vault.getMarkdownFiles();
        for (const file of files) {
            const metadata = this.metadataCache.getFileCache(file);
            if (metadata?.frontmatter?.date || metadata?.frontmatter?.dueDate) {
                events.push({
                    title: file.basename,
                    date: metadata.frontmatter.date || metadata.frontmatter.dueDate,
                    file: file.path,
                });
            }
        }
        return {
            type: "calendar",
            data: events,
            metadata: { renderHtml: this.renderCalendar(events) },
        };
    }
    async executeCustomQuery(query, context) {
        // Handle custom queries with basic pattern matching
        const files = this.vault.getMarkdownFiles();
        const results = [];
        for (const file of files) {
            const metadata = this.metadataCache.getFileCache(file);
            if (this.matchesQuery(file, metadata, query)) {
                results.push({
                    file: file.path,
                    title: file.basename,
                });
            }
        }
        return {
            type: "raw",
            data: results,
            metadata: { renderHtml: this.renderCustom(results) },
        };
    }
    async getFilesFromSource(source, conditions) {
        let files = [];
        if (!this.vault) {
            return files;
        }
        if (source === "" || source === "#" || source === "/") {
            // All files in vault
            files = this.vault.getMarkdownFiles();
        }
        else if (source.startsWith("#")) {
            // Files with tag
            const tag = source.substring(1);
            files = this.getFilesWithTag(tag);
        }
        else {
            // Files in folder - check both exact match and folder contains file
            const allFiles = this.vault.getMarkdownFiles();
            files = allFiles.filter((file) => {
                return file.path.startsWith(source) || file.path.includes(source);
            });
            // If no files found with folder logic, try direct folder lookup
            if (files.length === 0) {
                const folder = this.vault.getAbstractFileByPath(source);
                if (folder instanceof obsidian_1.TFolder) {
                    files = this.getFilesInFolder(folder);
                }
            }
        }
        // Apply conditions if present
        if (conditions) {
            files = await this.filterFiles(files, conditions);
        }
        return files;
    }
    getFilesWithTag(tag) {
        const files = [];
        if (!this.vault || !this.metadataCache) {
            return files;
        }
        const allFiles = this.vault.getMarkdownFiles();
        for (const file of allFiles) {
            const metadata = this.metadataCache.getFileCache(file);
            // Check both explicit tags and hashtags in metadata
            const hasTag = metadata?.tags?.some((t) => t.tag === `#${tag}` || t.tag === tag) ||
                false;
            // Also check frontmatter tags
            const frontmatterTags = metadata?.frontmatter?.tags || [];
            const hasFrontmatterTag = Array.isArray(frontmatterTags)
                ? frontmatterTags.includes(tag) || frontmatterTags.includes(`#${tag}`)
                : false;
            if (hasTag || hasFrontmatterTag) {
                files.push(file);
            }
        }
        return files;
    }
    getFilesInFolder(folder) {
        const files = [];
        const traverse = (abstractFile) => {
            for (const child of abstractFile.children) {
                if (child instanceof obsidian_1.TFile && child.extension === "md") {
                    files.push(child);
                }
                else if (child instanceof obsidian_1.TFolder) {
                    traverse(child);
                }
            }
        };
        traverse(folder);
        return files;
    }
    async filterFiles(files, conditions) {
        // Simple condition parsing for common patterns
        const filtered = [];
        for (const file of files) {
            const metadata = this.metadataCache.getFileCache(file);
            if (await this.evaluateCondition(file, metadata, conditions)) {
                filtered.push(file);
            }
        }
        return filtered;
    }
    async evaluateCondition(file, metadata, condition) {
        // Basic condition evaluation
        // Support patterns like: "status = 'active'", "priority > 3", etc.
        const comparisonRegex = /(\w+)\s*(=|!=|>|<|>=|<=)\s*['"]?([^'"]+)['"]?/;
        const match = condition.match(comparisonRegex);
        if (!match)
            return true;
        const [, property, operator, value] = match;
        const actualValue = await this.extractProperty(file, metadata, property);
        return this.compareValues(actualValue, operator, value);
    }
    compareValues(actual, operator, expected) {
        switch (operator) {
            case "=":
            case "==":
                return String(actual) === expected;
            case "!=":
                return String(actual) !== expected;
            case ">":
                return Number(actual) > Number(expected);
            case "<":
                return Number(actual) < Number(expected);
            case ">=":
                return Number(actual) >= Number(expected);
            case "<=":
                return Number(actual) <= Number(expected);
            default:
                return false;
        }
    }
    async extractProperty(file, metadata, property) {
        // Extract property from file or metadata
        const lowerProp = property.toLowerCase();
        switch (lowerProp) {
            case "file.name":
            case "name":
                return file.basename;
            case "file.path":
            case "path":
                return file.path;
            case "file.size":
            case "size":
                return file.stat.size;
            case "file.mtime":
            case "modified":
                return file.stat.mtime;
            case "file.ctime":
            case "created":
                return file.stat.ctime;
            default:
                // Check frontmatter
                if (metadata?.frontmatter?.[property]) {
                    return metadata.frontmatter[property];
                }
                return ""; // Return empty string instead of null for better compatibility
        }
    }
    filterTasks(tasks, query) {
        // Filter tasks based on query parameters
        if (query.includes("not done")) {
            return tasks.filter((t) => t.status !== "completed");
        }
        else if (query.includes("done")) {
            return tasks.filter((t) => t.status === "completed");
        }
        // By default, return only incomplete tasks
        return tasks.filter((t) => t.status !== "completed");
    }
    matchesQuery(file, metadata, query) {
        // Basic pattern matching for custom queries
        const searchTerm = query.toLowerCase();
        // Check filename
        if (file.basename.toLowerCase().includes(searchTerm)) {
            return true;
        }
        // Check tags
        if (metadata?.tags?.some((t) => t.tag.toLowerCase().includes(searchTerm))) {
            return true;
        }
        // Check frontmatter
        if (metadata?.frontmatter) {
            for (const value of Object.values(metadata.frontmatter)) {
                if (String(value).toLowerCase().includes(searchTerm)) {
                    return true;
                }
            }
        }
        return false;
    }
    // Rendering methods for different query types
    renderTable(headers, rows) {
        let html = '<table class="exo-native-table"><thead><tr>';
        for (const header of headers) {
            html += `<th>${header}</th>`;
        }
        html += "</tr></thead><tbody>";
        for (const row of rows) {
            html += "<tr>";
            for (const header of headers) {
                html += `<td>${row[header] || ""}</td>`;
            }
            html += "</tr>";
        }
        html += "</tbody></table>";
        return html;
    }
    renderList(items) {
        let html = '<ul class="exo-native-list">';
        for (const item of items) {
            html += `<li>${item.link || item.text}</li>`;
        }
        html += "</ul>";
        return html;
    }
    renderTasks(tasks) {
        let html = '<div class="exo-native-tasks">';
        for (const task of tasks) {
            const checked = task.status === "completed" ? "checked" : "";
            html += `
                <div class="task-item">
                    <input type="checkbox" ${checked} disabled>
                    <span>${task.text}</span>
                    <small>(${task.file})</small>
                </div>
            `;
        }
        html += "</div>";
        return html;
    }
    renderCalendar(events) {
        let html = '<div class="exo-native-calendar">';
        // Sort events by date
        events.sort((a, b) => new Date(a.date).getTime() - new Date(b.date).getTime());
        for (const event of events) {
            html += `
                <div class="calendar-event">
                    <span class="event-date">${event.date}</span>
                    <span class="event-title">${event.title}</span>
                </div>
            `;
        }
        html += "</div>";
        return html;
    }
    renderCustom(results) {
        let html = '<div class="exo-native-custom">';
        for (const result of results) {
            html += `<div class="custom-result">[[${result.file}|${result.title}]]</div>`;
        }
        html += "</div>";
        return html;
    }
    // Cache management
    getCachedResult(query) {
        const cached = this.queryCache.get(query);
        if (cached && Date.now() - cached.timestamp < this.cacheTimeout) {
            return cached.result;
        }
        return null;
    }
    cacheResult(query, result) {
        this.queryCache.set(query, {
            result,
            timestamp: Date.now(),
        });
        // Clean old cache entries
        if (this.queryCache.size > 100) {
            const oldestKey = this.queryCache.keys().next().value;
            this.queryCache.delete(oldestKey);
        }
    }
    /**
     * Executes a query and renders the result to a container
     */
    async renderQuery(container, query, context) {
        try {
            const result = await this.executeQuery(query, context);
            if (!result.isSuccess) {
                return Result_1.Result.fail(result.getErrorMessage());
            }
            const queryResult = result.getValue();
            // Check if result is empty and render appropriate message
            if (!queryResult ||
                !queryResult.data ||
                (Array.isArray(queryResult.data) && queryResult.data.length === 0)) {
                container.innerHTML =
                    '<div class="exo-native-empty">No results found</div>';
                return Result_1.Result.ok();
            }
            if (queryResult?.metadata?.renderHtml) {
                container.innerHTML = queryResult.metadata.renderHtml;
            }
            else {
                // Fallback rendering
                container.innerHTML = this.renderFallback(queryResult);
            }
            return Result_1.Result.ok();
        }
        catch (error) {
            return Result_1.Result.fail(`Failed to render query: ${error.message}`);
        }
    }
    /**
     * Gets pages/files matching the given source expression
     */
    async getPages(source) {
        try {
            const cleanSource = source.replace(/['"]/g, ""); // Remove quotes
            const files = await this.getFilesFromSource(cleanSource);
            const pages = await Promise.all(files.map(async (file) => {
                const metadata = this.metadataCache?.getFileCache(file);
                return {
                    file: {
                        path: file.path,
                        name: file.basename,
                        size: file.stat.size,
                        mtime: file.stat.mtime,
                        ctime: file.stat.ctime,
                    },
                    ...metadata?.frontmatter,
                };
            }));
            return Result_1.Result.ok(pages);
        }
        catch (error) {
            return Result_1.Result.fail(`Failed to get pages: ${error.message}`);
        }
    }
    /**
     * Gets metadata for a specific page/file
     */
    async getPageMetadata(path) {
        try {
            const file = this.vault?.getAbstractFileByPath(path);
            if (!file || !(file instanceof obsidian_1.TFile)) {
                return Result_1.Result.fail(`File not found: ${path}`);
            }
            const metadata = this.metadataCache?.getFileCache(file);
            const result = {
                file: {
                    path: file.path,
                    name: file.basename,
                    size: file.stat.size,
                    mtime: file.stat.mtime,
                    ctime: file.stat.ctime,
                    extension: file.extension,
                },
                frontmatter: metadata?.frontmatter || {},
                tags: metadata?.tags?.map((t) => t.tag) || [],
                links: metadata?.links?.map((l) => l.link) || [],
                headings: metadata?.headings?.map((h) => ({
                    level: h.level,
                    heading: h.heading,
                })) || [],
            };
            return Result_1.Result.ok(result);
        }
        catch (error) {
            return Result_1.Result.fail(`Failed to get page metadata: ${error.message}`);
        }
    }
    /**
     * Validates if a query string is syntactically correct
     */
    validateQuery(query) {
        try {
            if (!query || typeof query !== "string") {
                return Result_1.Result.fail("Query must be a non-empty string");
            }
            const trimmed = query.trim();
            if (trimmed.length === 0) {
                return Result_1.Result.fail("Query cannot be empty");
            }
            // Basic validation - check for dangerous patterns
            const dangerousPatterns = [/<script/i, /javascript:/i, /on\w+\s*=/i];
            for (const pattern of dangerousPatterns) {
                if (pattern.test(trimmed)) {
                    return Result_1.Result.fail("Query contains potentially unsafe content");
                }
            }
            // Check for valid query keywords
            const lowerQuery = trimmed.toLowerCase();
            const validKeywords = ["table", "list", "task", "calendar"];
            const hasValidKeyword = validKeywords.some((keyword) => lowerQuery.startsWith(keyword));
            if (!hasValidKeyword) {
                return Result_1.Result.fail("Query must start with a valid keyword (table, list, task, calendar)");
            }
            return Result_1.Result.ok(true);
        }
        catch (error) {
            return Result_1.Result.fail(`Query validation failed: ${error.message}`);
        }
    }
    renderFallback(queryResult) {
        if (!queryResult ||
            !queryResult.data ||
            (Array.isArray(queryResult.data) && queryResult.data.length === 0)) {
            return '<div class="exo-native-empty">No results found</div>';
        }
        const items = Array.isArray(queryResult.data)
            ? queryResult.data
            : [queryResult.data];
        if (items.length === 0) {
            return '<div class="exo-native-empty">No results found</div>';
        }
        return `
            <div class="exo-native-fallback">
                ${items.map((item) => `<div class="result-item">${JSON.stringify(item)}</div>`).join("")}
            </div>
        `;
    }
    /**
     * Clear the query cache
     */
    clearCache() {
        this.queryCache.clear();
    }
    /**
     * Clear all caches (alias for compatibility)
     */
    clearCaches() {
        this.queryCache.clear();
    }
    /**
     * Get cache statistics
     */
    getCacheStats() {
        return {
            queryCache: this.queryCache.size,
            metadataCache: 0, // Metadata cache is managed by Obsidian
        };
    }
}
exports.NativeQueryEngine = NativeQueryEngine;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2tpdGVsZXYvRG9jdW1lbnRzL2V4b2NvcnRleC1vYnNpZGlhbi1wbHVnaW4vc3JjL2luZnJhc3RydWN0dXJlL3F1ZXJ5LWVuZ2luZXMvTmF0aXZlUXVlcnlFbmdpbmUudHMiLCJtYXBwaW5ncyI6Ijs7O0FBTUEsdUNBQXFFO0FBQ3JFLHFEQUFrRDtBQUVsRDs7O0dBR0c7QUFDSCxNQUFhLGlCQUFpQjtJQU81QixZQUFZLEdBQVE7UUFGWixpQkFBWSxHQUFXLElBQUksQ0FBQyxDQUFDLGtCQUFrQjtRQUdyRCxJQUFJLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQztRQUNmLElBQUksQ0FBQyxhQUFhLEdBQUcsR0FBRyxFQUFFLGFBQWEsQ0FBQztRQUN4QyxJQUFJLENBQUMsS0FBSyxHQUFHLEdBQUcsRUFBRSxLQUFLLENBQUM7UUFDeEIsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLEdBQUcsRUFBRSxDQUFDO0lBQzlCLENBQUM7SUFFRCxPQUFPO1FBQ0wsT0FBTyxRQUFRLENBQUM7SUFDbEIsQ0FBQztJQUVELE9BQU87UUFDTCxPQUFPLFFBQVEsQ0FBQztJQUNsQixDQUFDO0lBRUQsV0FBVztRQUNULGtEQUFrRDtRQUNsRCxPQUFPLElBQUksQ0FBQyxHQUFHLElBQUksSUFBSSxDQUFDO0lBQzFCLENBQUM7SUFFRCxLQUFLLENBQUMsWUFBWSxDQUNoQixLQUFhLEVBQ2IsT0FBYTtRQUViLElBQUk7WUFDRixvQkFBb0I7WUFDcEIsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMzQyxJQUFJLE1BQU0sRUFBRTtnQkFDVixPQUFPLGVBQU0sQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLENBQUM7YUFDMUI7WUFFRCxtQkFBbUI7WUFDbkIsTUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUM3QyxJQUFJLE1BQW1CLENBQUM7WUFFeEIsUUFBUSxTQUFTLENBQUMsSUFBSSxFQUFFO2dCQUN0QixL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O0lBRUQ7O09BRUc7SUFDSSxVQUFVO1FBQ2YsSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUMxQixDQUFDO0lBRUQ7O09BRUc7SUFDSSxXQUFXO1FBQ2hCLElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDMUIsQ0FBQztJQUVEOztPQUVHO0lBQ0ksYUFBYTtRQUNsQixPQUFPO1lBQ0wsVUFBVSxFQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSTtZQUNoQyxhQUFhLEVBQUUsQ0FBQyxFQUFFLHdDQUF3QztTQUMzRCxDQUFDO0lBQ0osQ0FBQztDQUNGO0FBenhCRCw4Q0F5eEJDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9raXRlbGV2L0RvY3VtZW50cy9leG9jb3J0ZXgtb2JzaWRpYW4tcGx1Z2luL3NyYy9pbmZyYXN0cnVjdHVyZS9xdWVyeS1lbmdpbmVzL05hdGl2ZVF1ZXJ5RW5naW5lLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIElRdWVyeUVuZ2luZSxcbiAgUXVlcnlSZXN1bHQsXG4gIFF1ZXJ5RW5naW5lVHlwZSxcbiAgUXVlcnlDb250ZXh0LFxufSBmcm9tIFwiLi4vLi4vZG9tYWluL3BvcnRzL0lRdWVyeUVuZ2luZVwiO1xuaW1wb3J0IHsgQXBwLCBURmlsZSwgVEZvbGRlciwgTWV0YWRhdGFDYWNoZSwgVmF1bHQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IFJlc3VsdCB9IGZyb20gXCIuLi8uLi9kb21haW4vY29yZS9SZXN1bHRcIjtcblxuLyoqXG4gKiBOYXRpdmUgcXVlcnkgZW5naW5lIHRoYXQgd29ya3Mgd2l0aG91dCBEYXRhdmlldy9EYXRhY29yZSBkZXBlbmRlbmNpZXMuXG4gKiBPcHRpbWl6ZWQgZm9yIGlPUyBhbmQgbW9iaWxlIGVudmlyb25tZW50cyB3aXRoIGxpbWl0ZWQgcmVzb3VyY2VzLlxuICovXG5leHBvcnQgY2xhc3MgTmF0aXZlUXVlcnlFbmdpbmUgaW1wbGVtZW50cyBJUXVlcnlFbmdpbmUge1xuICBwcml2YXRlIGFwcDogQXBwO1xuICBwcml2YXRlIG1ldGFkYXRhQ2FjaGU6IE1ldGFkYXRhQ2FjaGU7XG4gIHByaXZhdGUgdmF1bHQ6IFZhdWx0O1xuICBwcml2YXRlIHF1ZXJ5Q2FjaGU6IE1hcDxzdHJpbmcsIHsgcmVzdWx0OiBRdWVyeVJlc3VsdDsgdGltZXN0YW1wOiBudW1iZXIgfT47XG4gIHByaXZhdGUgY2FjaGVUaW1lb3V0OiBudW1iZXIgPSA1MDAwOyAvLyA1IHNlY29uZHMgY2FjaGVcblxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCkge1xuICAgIHRoaXMuYXBwID0gYXBwO1xuICAgIHRoaXMubWV0YWRhdGFDYWNoZSA9IGFwcD8ubWV0YWRhdGFDYWNoZTtcbiAgICB0aGlzLnZhdWx0ID0gYXBwPy52YXVsdDtcbiAgICB0aGlzLnF1ZXJ5Q2FjaGUgPSBuZXcgTWFwKCk7XG4gIH1cblxuICBnZXROYW1lKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIFwibmF0aXZlXCI7XG4gIH1cblxuICBnZXRUeXBlKCk6IFF1ZXJ5RW5naW5lVHlwZSB7XG4gICAgcmV0dXJuIFwibmF0aXZlXCI7XG4gIH1cblxuICBpc0F2YWlsYWJsZSgpOiBib29sZWFuIHtcbiAgICAvLyBOYXRpdmUgZW5naW5lIGlzIGF2YWlsYWJsZSB3aGVuIGFwcCBpcyBwcm92aWRlZFxuICAgIHJldHVybiB0aGlzLmFwcCAhPSBudWxsO1xuICB9XG5cbiAgYXN5bmMgZXhlY3V0ZVF1ZXJ5KFxuICAgIHF1ZXJ5OiBzdHJpbmcsXG4gICAgY29udGV4dD86IGFueSxcbiAgKTogUHJvbWlzZTxSZXN1bHQ8UXVlcnlSZXN1bHQ+PiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIENoZWNrIGNhY2hlIGZpcnN0XG4gICAgICBjb25zdCBjYWNoZWQgPSB0aGlzLmdldENhY2hlZFJlc3VsdChxdWVyeSk7XG4gICAgICBpZiAoY2FjaGVkKSB7XG4gICAgICAgIHJldHVybiBSZXN1bHQub2soY2FjaGVkKTtcbiAgICAgIH1cblxuICAgICAgLy8gUGFyc2UgcXVlcnkgdHlwZVxuICAgICAgY29uc3QgcXVlcnlUeXBlID0gdGhpcy5wYXJzZVF1ZXJ5VHlwZShxdWVyeSk7XG4gICAgICBsZXQgcmVzdWx0OiBRdWVyeVJlc3VsdDtcblxuICAgICAgc3dpdGNoIChxdWVyeVR5cGUudHlwZSkge1xuICAgICAgICBjYXNlIFwidGFibGVcIjpcbiAgICAgICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVUYWJsZVF1ZXJ5KHF1ZXJ5VHlwZS5xdWVyeSwgY29udGV4dCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJsaXN0XCI6XG4gICAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlTGlzdFF1ZXJ5KHF1ZXJ5VHlwZS5xdWVyeSwgY29udGV4dCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJ0YXNrXCI6XG4gICAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlVGFza1F1ZXJ5KHF1ZXJ5VHlwZS5xdWVyeSwgY29udGV4dCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJjYWxlbmRhclwiOlxuICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZUNhbGVuZGFyUXVlcnkocXVlcnlUeXBlLnF1ZXJ5LCBjb250ZXh0KTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVDdXN0b21RdWVyeShxdWVyeSwgY29udGV4dCk7XG4gICAgICB9XG5cbiAgICAgIC8vIENhY2hlIHRoZSByZXN1bHRcbiAgICAgIHRoaXMuY2FjaGVSZXN1bHQocXVlcnksIHJlc3VsdCk7XG4gICAgICByZXR1cm4gUmVzdWx0Lm9rKHJlc3VsdCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiBSZXN1bHQuZmFpbChgTmF0aXZlIHF1ZXJ5IGV4ZWN1dGlvbiBmYWlsZWQ6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHBhcnNlUXVlcnlUeXBlKHF1ZXJ5OiBzdHJpbmcpOiB7IHR5cGU6IHN0cmluZzsgcXVlcnk6IHN0cmluZyB9IHtcbiAgICBjb25zdCBsb3dlclF1ZXJ5ID0gcXVlcnkudG9Mb3dlckNhc2UoKS50cmltKCk7XG5cbiAgICBpZiAobG93ZXJRdWVyeS5zdGFydHNXaXRoKFwidGFibGVcIikpIHtcbiAgICAgIHJldHVybiB7IHR5cGU6IFwidGFibGVcIiwgcXVlcnk6IHF1ZXJ5LnN1YnN0cmluZyg1KS50cmltKCkgfTtcbiAgICB9IGVsc2UgaWYgKGxvd2VyUXVlcnkuc3RhcnRzV2l0aChcImxpc3RcIikpIHtcbiAgICAgIHJldHVybiB7IHR5cGU6IFwibGlzdFwiLCBxdWVyeTogcXVlcnkuc3Vic3RyaW5nKDQpLnRyaW0oKSB9O1xuICAgIH0gZWxzZSBpZiAobG93ZXJRdWVyeS5zdGFydHNXaXRoKFwidGFza1wiKSkge1xuICAgICAgcmV0dXJuIHsgdHlwZTogXCJ0YXNrXCIsIHF1ZXJ5OiBxdWVyeS5zdWJzdHJpbmcoNCkudHJpbSgpIH07XG4gICAgfSBlbHNlIGlmIChsb3dlclF1ZXJ5LnN0YXJ0c1dpdGgoXCJjYWxlbmRhclwiKSkge1xuICAgICAgcmV0dXJuIHsgdHlwZTogXCJjYWxlbmRhclwiLCBxdWVyeTogcXVlcnkuc3Vic3RyaW5nKDgpLnRyaW0oKSB9O1xuICAgIH1cblxuICAgIHJldHVybiB7IHR5cGU6IFwiY3VzdG9tXCIsIHF1ZXJ5IH07XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVUYWJsZVF1ZXJ5KFxuICAgIHF1ZXJ5OiBzdHJpbmcsXG4gICAgY29udGV4dD86IGFueSxcbiAgKTogUHJvbWlzZTxRdWVyeVJlc3VsdD4ge1xuICAgIC8vIFBhcnNlIHRhYmxlIHF1ZXJ5OiBcImNvbHVtbnMgRlJPTSBzb3VyY2UgV0hFUkUgY29uZGl0aW9uc1wiXG4gICAgY29uc3QgdGFibGVSZWdleCA9IC9eKC4rPylcXHMrZnJvbVxccytcIihbXlwiXSspXCIoPzpcXHMrd2hlcmVcXHMrKC4rKSk/JC9pO1xuICAgIGNvbnN0IG1hdGNoID0gcXVlcnkubWF0Y2godGFibGVSZWdleCk7XG5cbiAgICBpZiAoIW1hdGNoKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHRhYmxlIHF1ZXJ5IGZvcm1hdDogbWlzc2luZyBGUk9NIGNsYXVzZVwiKTtcbiAgICB9XG5cbiAgICBjb25zdCBbLCBjb2x1bW5zLCBzb3VyY2UsIGNvbmRpdGlvbnNdID0gbWF0Y2g7XG4gICAgY29uc3QgZmlsZXMgPSBhd2FpdCB0aGlzLmdldEZpbGVzRnJvbVNvdXJjZShzb3VyY2UsIGNvbmRpdGlvbnMpO1xuICAgIGNvbnN0IGNvbHVtbkxpc3QgPSBjb2x1bW5zLnNwbGl0KFwiLFwiKS5tYXAoKGMpID0+IGMudHJpbSgpKTtcblxuICAgIGNvbnN0IHJvd3MgPSBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgIGZpbGVzLm1hcChhc3luYyAoZmlsZSkgPT4ge1xuICAgICAgICBjb25zdCBtZXRhZGF0YSA9IHRoaXMubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG4gICAgICAgIGNvbnN0IHJvdzogYW55ID0ge307XG5cbiAgICAgICAgZm9yIChjb25zdCBjb2wgb2YgY29sdW1uTGlzdCkge1xuICAgICAgICAgIHJvd1tjb2xdID0gYXdhaXQgdGhpcy5leHRyYWN0UHJvcGVydHkoZmlsZSwgbWV0YWRhdGEsIGNvbCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcm93O1xuICAgICAgfSksXG4gICAgKTtcblxuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBcInRhYmxlXCIsXG4gICAgICBkYXRhOiByb3dzLFxuICAgICAgY29sdW1uczogY29sdW1uTGlzdCxcbiAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgIHJlbmRlckh0bWw6IHRoaXMucmVuZGVyVGFibGUoY29sdW1uTGlzdCwgcm93cyksXG4gICAgICAgIHdoZXJlOiBjb25kaXRpb25zIHx8IHVuZGVmaW5lZCxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZXhlY3V0ZUxpc3RRdWVyeShcbiAgICBxdWVyeTogc3RyaW5nLFxuICAgIGNvbnRleHQ/OiBhbnksXG4gICk6IFByb21pc2U8UXVlcnlSZXN1bHQ+IHtcbiAgICAvLyBQYXJzZSBsaXN0IHF1ZXJ5OiBcIkZST00gc291cmNlIFdIRVJFIGNvbmRpdGlvbnNcIlxuICAgIGNvbnN0IGxpc3RSZWdleCA9IC9eZnJvbVxccytcIihbXlwiXSspXCIoPzpcXHMrd2hlcmVcXHMrKC4rKSk/JC9pO1xuICAgIGNvbnN0IG1hdGNoID0gcXVlcnkubWF0Y2gobGlzdFJlZ2V4KTtcblxuICAgIGlmICghbWF0Y2gpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgbGlzdCBxdWVyeSBmb3JtYXQ6IG1pc3NpbmcgRlJPTSBjbGF1c2VcIik7XG4gICAgfVxuXG4gICAgY29uc3QgWywgc291cmNlLCBjb25kaXRpb25zXSA9IG1hdGNoO1xuICAgIGNvbnN0IGZpbGVzID0gYXdhaXQgdGhpcy5nZXRGaWxlc0Zyb21Tb3VyY2Uoc291cmNlLCBjb25kaXRpb25zKTtcblxuICAgIGNvbnN0IGl0ZW1zID0gZmlsZXMubWFwKChmaWxlKSA9PiAoe1xuICAgICAgdGV4dDogZmlsZS5iYXNlbmFtZSxcbiAgICAgIGxpbms6IGBbWyR7ZmlsZS5wYXRofV1dYCxcbiAgICB9KSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogXCJsaXN0XCIsXG4gICAgICBkYXRhOiBpdGVtcyxcbiAgICAgIG1ldGFkYXRhOiB7IHJlbmRlckh0bWw6IHRoaXMucmVuZGVyTGlzdChpdGVtcykgfSxcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBleGVjdXRlVGFza1F1ZXJ5KFxuICAgIHF1ZXJ5OiBzdHJpbmcsXG4gICAgY29udGV4dD86IGFueSxcbiAgKTogUHJvbWlzZTxRdWVyeVJlc3VsdD4ge1xuICAgIC8vIEZpbmQgYWxsIHRhc2tzIGluIHZhdWx0XG4gICAgY29uc3QgdGFza3M6IGFueVtdID0gW107XG5cbiAgICBpZiAoIXRoaXMudmF1bHQpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6IFwidGFza1wiLFxuICAgICAgICBkYXRhOiBbXSxcbiAgICAgICAgbWV0YWRhdGE6IHsgcmVuZGVySHRtbDogdGhpcy5yZW5kZXJUYXNrcyhbXSkgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gUGFyc2UgcXVlcnkgdG8gZGV0ZXJtaW5lIHdoaWNoIGZpbGVzIHRvIGNoZWNrXG4gICAgbGV0IHRhcmdldEZpbGVzOiBURmlsZVtdID0gW107XG5cbiAgICBpZiAocXVlcnkuaW5jbHVkZXMoJ2Zyb20gXCInKSkge1xuICAgICAgLy8gRXh0cmFjdCBzb3VyY2UgZnJvbSBxdWVyeVxuICAgICAgY29uc3Qgc291cmNlTWF0Y2ggPSBxdWVyeS5tYXRjaCgvZnJvbVxccytcIihbXlwiXSspXCIvKTtcbiAgICAgIGlmIChzb3VyY2VNYXRjaCkge1xuICAgICAgICBjb25zdCBzb3VyY2UgPSBzb3VyY2VNYXRjaFsxXTtcbiAgICAgICAgdGFyZ2V0RmlsZXMgPSBhd2FpdCB0aGlzLmdldEZpbGVzRnJvbVNvdXJjZShzb3VyY2UpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBDaGVjayBhbGwgZmlsZXMgaWYgbm8gc291cmNlIHNwZWNpZmllZFxuICAgICAgdGFyZ2V0RmlsZXMgPSB0aGlzLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcbiAgICB9XG5cbiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgdGFyZ2V0RmlsZXMpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLnZhdWx0LmNhY2hlZFJlYWQoZmlsZSk7XG4gICAgICAgIGNvbnN0IHRhc2tSZWdleCA9IC9eW1xcc10qLSBcXFsoLilcXF0gKC4rKSQvZ207XG4gICAgICAgIGxldCBtYXRjaDtcblxuICAgICAgICB3aGlsZSAoKG1hdGNoID0gdGFza1JlZ2V4LmV4ZWMoY29udGVudCkpICE9PSBudWxsKSB7XG4gICAgICAgICAgY29uc3QgWywgc3RhdHVzLCB0ZXh0XSA9IG1hdGNoO1xuICAgICAgICAgIHRhc2tzLnB1c2goe1xuICAgICAgICAgICAgc3RhdHVzOiBzdGF0dXMgPT09IFwieFwiID8gXCJjb21wbGV0ZWRcIiA6IFwicGVuZGluZ1wiLFxuICAgICAgICAgICAgY29tcGxldGVkOiBzdGF0dXMgPT09IFwieFwiLFxuICAgICAgICAgICAgdGV4dCxcbiAgICAgICAgICAgIGZpbGU6IGZpbGUucGF0aCxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgLy8gU2tpcCBmaWxlcyB0aGF0IGNhbid0IGJlIHJlYWQgYW5kIHJldHVybiBlbXB0eSB0YXNrcyBmb3IgdGhhdCBmaWxlXG4gICAgICAgIGNvbnNvbGUud2FybihgRmFpbGVkIHRvIHJlYWQgZmlsZSAke2ZpbGUucGF0aH0gZm9yIHRhc2sgcXVlcnk6YCwgZXJyb3IpO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBBcHBseSBmaWx0ZXJzIGlmIHNwZWNpZmllZCBpbiBxdWVyeVxuICAgIGNvbnN0IGZpbHRlcmVkVGFza3MgPSB0aGlzLmZpbHRlclRhc2tzKHRhc2tzLCBxdWVyeSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogXCJ0YXNrXCIsXG4gICAgICBkYXRhOiBmaWx0ZXJlZFRhc2tzLFxuICAgICAgbWV0YWRhdGE6IHsgcmVuZGVySHRtbDogdGhpcy5yZW5kZXJUYXNrcyhmaWx0ZXJlZFRhc2tzKSB9LFxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVDYWxlbmRhclF1ZXJ5KFxuICAgIHF1ZXJ5OiBzdHJpbmcsXG4gICAgY29udGV4dD86IGFueSxcbiAgKTogUHJvbWlzZTxRdWVyeVJlc3VsdD4ge1xuICAgIC8vIEZpbmQgYWxsIGZpbGVzIHdpdGggZGF0ZXNcbiAgICBjb25zdCBldmVudHM6IGFueVtdID0gW107XG5cbiAgICBpZiAoIXRoaXMudmF1bHQgfHwgIXRoaXMubWV0YWRhdGFDYWNoZSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogXCJjYWxlbmRhclwiLFxuICAgICAgICBkYXRhOiBldmVudHMsXG4gICAgICAgIG1ldGFkYXRhOiB7IHJlbmRlckh0bWw6IHRoaXMucmVuZGVyQ2FsZW5kYXIoZXZlbnRzKSB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBjb25zdCBmaWxlcyA9IHRoaXMudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuXG4gICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XG4gICAgICBjb25zdCBtZXRhZGF0YSA9IHRoaXMubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG4gICAgICBpZiAobWV0YWRhdGE/LmZyb250bWF0dGVyPy5kYXRlIHx8IG1ldGFkYXRhPy5mcm9udG1hdHRlcj8uZHVlRGF0ZSkge1xuICAgICAgICBldmVudHMucHVzaCh7XG4gICAgICAgICAgdGl0bGU6IGZpbGUuYmFzZW5hbWUsXG4gICAgICAgICAgZGF0ZTogbWV0YWRhdGEuZnJvbnRtYXR0ZXIuZGF0ZSB8fCBtZXRhZGF0YS5mcm9udG1hdHRlci5kdWVEYXRlLFxuICAgICAgICAgIGZpbGU6IGZpbGUucGF0aCxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IFwiY2FsZW5kYXJcIixcbiAgICAgIGRhdGE6IGV2ZW50cyxcbiAgICAgIG1ldGFkYXRhOiB7IHJlbmRlckh0bWw6IHRoaXMucmVuZGVyQ2FsZW5kYXIoZXZlbnRzKSB9LFxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVDdXN0b21RdWVyeShcbiAgICBxdWVyeTogc3RyaW5nLFxuICAgIGNvbnRleHQ/OiBhbnksXG4gICk6IFByb21pc2U8UXVlcnlSZXN1bHQ+IHtcbiAgICAvLyBIYW5kbGUgY3VzdG9tIHF1ZXJpZXMgd2l0aCBiYXNpYyBwYXR0ZXJuIG1hdGNoaW5nXG4gICAgY29uc3QgZmlsZXMgPSB0aGlzLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcbiAgICBjb25zdCByZXN1bHRzOiBhbnlbXSA9IFtdO1xuXG4gICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XG4gICAgICBjb25zdCBtZXRhZGF0YSA9IHRoaXMubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG4gICAgICBpZiAodGhpcy5tYXRjaGVzUXVlcnkoZmlsZSwgbWV0YWRhdGEsIHF1ZXJ5KSkge1xuICAgICAgICByZXN1bHRzLnB1c2goe1xuICAgICAgICAgIGZpbGU6IGZpbGUucGF0aCxcbiAgICAgICAgICB0aXRsZTogZmlsZS5iYXNlbmFtZSxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IFwicmF3XCIsXG4gICAgICBkYXRhOiByZXN1bHRzLFxuICAgICAgbWV0YWRhdGE6IHsgcmVuZGVySHRtbDogdGhpcy5yZW5kZXJDdXN0b20ocmVzdWx0cykgfSxcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZXRGaWxlc0Zyb21Tb3VyY2UoXG4gICAgc291cmNlOiBzdHJpbmcsXG4gICAgY29uZGl0aW9ucz86IHN0cmluZyxcbiAgKTogUHJvbWlzZTxURmlsZVtdPiB7XG4gICAgbGV0IGZpbGVzOiBURmlsZVtdID0gW107XG5cbiAgICBpZiAoIXRoaXMudmF1bHQpIHtcbiAgICAgIHJldHVybiBmaWxlcztcbiAgICB9XG5cbiAgICBpZiAoc291cmNlID09PSBcIlwiIHx8IHNvdXJjZSA9PT0gXCIjXCIgfHwgc291cmNlID09PSBcIi9cIikge1xuICAgICAgLy8gQWxsIGZpbGVzIGluIHZhdWx0XG4gICAgICBmaWxlcyA9IHRoaXMudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICAgIH0gZWxzZSBpZiAoc291cmNlLnN0YXJ0c1dpdGgoXCIjXCIpKSB7XG4gICAgICAvLyBGaWxlcyB3aXRoIHRhZ1xuICAgICAgY29uc3QgdGFnID0gc291cmNlLnN1YnN0cmluZygxKTtcbiAgICAgIGZpbGVzID0gdGhpcy5nZXRGaWxlc1dpdGhUYWcodGFnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRmlsZXMgaW4gZm9sZGVyIC0gY2hlY2sgYm90aCBleGFjdCBtYXRjaCBhbmQgZm9sZGVyIGNvbnRhaW5zIGZpbGVcbiAgICAgIGNvbnN0IGFsbEZpbGVzID0gdGhpcy52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG4gICAgICBmaWxlcyA9IGFsbEZpbGVzLmZpbHRlcigoZmlsZSkgPT4ge1xuICAgICAgICByZXR1cm4gZmlsZS5wYXRoLnN0YXJ0c1dpdGgoc291cmNlKSB8fCBmaWxlLnBhdGguaW5jbHVkZXMoc291cmNlKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBJZiBubyBmaWxlcyBmb3VuZCB3aXRoIGZvbGRlciBsb2dpYywgdHJ5IGRpcmVjdCBmb2xkZXIgbG9va3VwXG4gICAgICBpZiAoZmlsZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGNvbnN0IGZvbGRlciA9IHRoaXMudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHNvdXJjZSk7XG4gICAgICAgIGlmIChmb2xkZXIgaW5zdGFuY2VvZiBURm9sZGVyKSB7XG4gICAgICAgICAgZmlsZXMgPSB0aGlzLmdldEZpbGVzSW5Gb2xkZXIoZm9sZGVyKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEFwcGx5IGNvbmRpdGlvbnMgaWYgcHJlc2VudFxuICAgIGlmIChjb25kaXRpb25zKSB7XG4gICAgICBmaWxlcyA9IGF3YWl0IHRoaXMuZmlsdGVyRmlsZXMoZmlsZXMsIGNvbmRpdGlvbnMpO1xuICAgIH1cblxuICAgIHJldHVybiBmaWxlcztcbiAgfVxuXG4gIHByaXZhdGUgZ2V0RmlsZXNXaXRoVGFnKHRhZzogc3RyaW5nKTogVEZpbGVbXSB7XG4gICAgY29uc3QgZmlsZXM6IFRGaWxlW10gPSBbXTtcblxuICAgIGlmICghdGhpcy52YXVsdCB8fCAhdGhpcy5tZXRhZGF0YUNhY2hlKSB7XG4gICAgICByZXR1cm4gZmlsZXM7XG4gICAgfVxuXG4gICAgY29uc3QgYWxsRmlsZXMgPSB0aGlzLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcblxuICAgIGZvciAoY29uc3QgZmlsZSBvZiBhbGxGaWxlcykge1xuICAgICAgY29uc3QgbWV0YWRhdGEgPSB0aGlzLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuICAgICAgLy8gQ2hlY2sgYm90aCBleHBsaWNpdCB0YWdzIGFuZCBoYXNodGFncyBpbiBtZXRhZGF0YVxuICAgICAgY29uc3QgaGFzVGFnID1cbiAgICAgICAgbWV0YWRhdGE/LnRhZ3M/LnNvbWUoKHQpID0+IHQudGFnID09PSBgIyR7dGFnfWAgfHwgdC50YWcgPT09IHRhZykgfHxcbiAgICAgICAgZmFsc2U7XG5cbiAgICAgIC8vIEFsc28gY2hlY2sgZnJvbnRtYXR0ZXIgdGFnc1xuICAgICAgY29uc3QgZnJvbnRtYXR0ZXJUYWdzID0gbWV0YWRhdGE/LmZyb250bWF0dGVyPy50YWdzIHx8IFtdO1xuICAgICAgY29uc3QgaGFzRnJvbnRtYXR0ZXJUYWcgPSBBcnJheS5pc0FycmF5KGZyb250bWF0dGVyVGFncylcbiAgICAgICAgPyBmcm9udG1hdHRlclRhZ3MuaW5jbHVkZXModGFnKSB8fCBmcm9udG1hdHRlclRhZ3MuaW5jbHVkZXMoYCMke3RhZ31gKVxuICAgICAgICA6IGZhbHNlO1xuXG4gICAgICBpZiAoaGFzVGFnIHx8IGhhc0Zyb250bWF0dGVyVGFnKSB7XG4gICAgICAgIGZpbGVzLnB1c2goZmlsZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZpbGVzO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRGaWxlc0luRm9sZGVyKGZvbGRlcjogVEZvbGRlcik6IFRGaWxlW10ge1xuICAgIGNvbnN0IGZpbGVzOiBURmlsZVtdID0gW107XG5cbiAgICBjb25zdCB0cmF2ZXJzZSA9IChhYnN0cmFjdEZpbGU6IFRGb2xkZXIpID0+IHtcbiAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgYWJzdHJhY3RGaWxlLmNoaWxkcmVuKSB7XG4gICAgICAgIGlmIChjaGlsZCBpbnN0YW5jZW9mIFRGaWxlICYmIGNoaWxkLmV4dGVuc2lvbiA9PT0gXCJtZFwiKSB7XG4gICAgICAgICAgZmlsZXMucHVzaChjaGlsZCk7XG4gICAgICAgIH0gZWxzZSBpZiAoY2hpbGQgaW5zdGFuY2VvZiBURm9sZGVyKSB7XG4gICAgICAgICAgdHJhdmVyc2UoY2hpbGQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIHRyYXZlcnNlKGZvbGRlcik7XG4gICAgcmV0dXJuIGZpbGVzO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBmaWx0ZXJGaWxlcyhcbiAgICBmaWxlczogVEZpbGVbXSxcbiAgICBjb25kaXRpb25zOiBzdHJpbmcsXG4gICk6IFByb21pc2U8VEZpbGVbXT4ge1xuICAgIC8vIFNpbXBsZSBjb25kaXRpb24gcGFyc2luZyBmb3IgY29tbW9uIHBhdHRlcm5zXG4gICAgY29uc3QgZmlsdGVyZWQ6IFRGaWxlW10gPSBbXTtcblxuICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xuICAgICAgY29uc3QgbWV0YWRhdGEgPSB0aGlzLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuICAgICAgaWYgKGF3YWl0IHRoaXMuZXZhbHVhdGVDb25kaXRpb24oZmlsZSwgbWV0YWRhdGEsIGNvbmRpdGlvbnMpKSB7XG4gICAgICAgIGZpbHRlcmVkLnB1c2goZmlsZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZpbHRlcmVkO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBldmFsdWF0ZUNvbmRpdGlvbihcbiAgICBmaWxlOiBURmlsZSxcbiAgICBtZXRhZGF0YTogYW55LFxuICAgIGNvbmRpdGlvbjogc3RyaW5nLFxuICApOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAvLyBCYXNpYyBjb25kaXRpb24gZXZhbHVhdGlvblxuICAgIC8vIFN1cHBvcnQgcGF0dGVybnMgbGlrZTogXCJzdGF0dXMgPSAnYWN0aXZlJ1wiLCBcInByaW9yaXR5ID4gM1wiLCBldGMuXG5cbiAgICBjb25zdCBjb21wYXJpc29uUmVnZXggPSAvKFxcdyspXFxzKig9fCE9fD58PHw+PXw8PSlcXHMqWydcIl0/KFteJ1wiXSspWydcIl0/LztcbiAgICBjb25zdCBtYXRjaCA9IGNvbmRpdGlvbi5tYXRjaChjb21wYXJpc29uUmVnZXgpO1xuXG4gICAgaWYgKCFtYXRjaCkgcmV0dXJuIHRydWU7XG5cbiAgICBjb25zdCBbLCBwcm9wZXJ0eSwgb3BlcmF0b3IsIHZhbHVlXSA9IG1hdGNoO1xuICAgIGNvbnN0IGFjdHVhbFZhbHVlID0gYXdhaXQgdGhpcy5leHRyYWN0UHJvcGVydHkoZmlsZSwgbWV0YWRhdGEsIHByb3BlcnR5KTtcblxuICAgIHJldHVybiB0aGlzLmNvbXBhcmVWYWx1ZXMoYWN0dWFsVmFsdWUsIG9wZXJhdG9yLCB2YWx1ZSk7XG4gIH1cblxuICBwcml2YXRlIGNvbXBhcmVWYWx1ZXMoXG4gICAgYWN0dWFsOiBhbnksXG4gICAgb3BlcmF0b3I6IHN0cmluZyxcbiAgICBleHBlY3RlZDogc3RyaW5nLFxuICApOiBib29sZWFuIHtcbiAgICBzd2l0Y2ggKG9wZXJhdG9yKSB7XG4gICAgICBjYXNlIFwiPVwiOlxuICAgICAgY2FzZSBcIj09XCI6XG4gICAgICAgIHJldHVybiBTdHJpbmcoYWN0dWFsKSA9PT0gZXhwZWN0ZWQ7XG4gICAgICBjYXNlIFwiIT1cIjpcbiAgICAgICAgcmV0dXJuIFN0cmluZyhhY3R1YWwpICE9PSBleHBlY3RlZDtcbiAgICAgIGNhc2UgXCI+XCI6XG4gICAgICAgIHJldHVybiBOdW1iZXIoYWN0dWFsKSA+IE51bWJlcihleHBlY3RlZCk7XG4gICAgICBjYXNlIFwiPFwiOlxuICAgICAgICByZXR1cm4gTnVtYmVyKGFjdHVhbCkgPCBOdW1iZXIoZXhwZWN0ZWQpO1xuICAgICAgY2FzZSBcIj49XCI6XG4gICAgICAgIHJldHVybiBOdW1iZXIoYWN0dWFsKSA+PSBOdW1iZXIoZXhwZWN0ZWQpO1xuICAgICAgY2FzZSBcIjw9XCI6XG4gICAgICAgIHJldHVybiBOdW1iZXIoYWN0dWFsKSA8PSBOdW1iZXIoZXhwZWN0ZWQpO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZXh0cmFjdFByb3BlcnR5KFxuICAgIGZpbGU6IFRGaWxlLFxuICAgIG1ldGFkYXRhOiBhbnksXG4gICAgcHJvcGVydHk6IHN0cmluZyxcbiAgKTogUHJvbWlzZTxhbnk+IHtcbiAgICAvLyBFeHRyYWN0IHByb3BlcnR5IGZyb20gZmlsZSBvciBtZXRhZGF0YVxuICAgIGNvbnN0IGxvd2VyUHJvcCA9IHByb3BlcnR5LnRvTG93ZXJDYXNlKCk7XG5cbiAgICBzd2l0Y2ggKGxvd2VyUHJvcCkge1xuICAgICAgY2FzZSBcImZpbGUubmFtZVwiOlxuICAgICAgY2FzZSBcIm5hbWVcIjpcbiAgICAgICAgcmV0dXJuIGZpbGUuYmFzZW5hbWU7XG4gICAgICBjYXNlIFwiZmlsZS5wYXRoXCI6XG4gICAgICBjYXNlIFwicGF0aFwiOlxuICAgICAgICByZXR1cm4gZmlsZS5wYXRoO1xuICAgICAgY2FzZSBcImZpbGUuc2l6ZVwiOlxuICAgICAgY2FzZSBcInNpemVcIjpcbiAgICAgICAgcmV0dXJuIGZpbGUuc3RhdC5zaXplO1xuICAgICAgY2FzZSBcImZpbGUubXRpbWVcIjpcbiAgICAgIGNhc2UgXCJtb2RpZmllZFwiOlxuICAgICAgICByZXR1cm4gZmlsZS5zdGF0Lm10aW1lO1xuICAgICAgY2FzZSBcImZpbGUuY3RpbWVcIjpcbiAgICAgIGNhc2UgXCJjcmVhdGVkXCI6XG4gICAgICAgIHJldHVybiBmaWxlLnN0YXQuY3RpbWU7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICAvLyBDaGVjayBmcm9udG1hdHRlclxuICAgICAgICBpZiAobWV0YWRhdGE/LmZyb250bWF0dGVyPy5bcHJvcGVydHldKSB7XG4gICAgICAgICAgcmV0dXJuIG1ldGFkYXRhLmZyb250bWF0dGVyW3Byb3BlcnR5XTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXCJcIjsgLy8gUmV0dXJuIGVtcHR5IHN0cmluZyBpbnN0ZWFkIG9mIG51bGwgZm9yIGJldHRlciBjb21wYXRpYmlsaXR5XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBmaWx0ZXJUYXNrcyh0YXNrczogYW55W10sIHF1ZXJ5OiBzdHJpbmcpOiBhbnlbXSB7XG4gICAgLy8gRmlsdGVyIHRhc2tzIGJhc2VkIG9uIHF1ZXJ5IHBhcmFtZXRlcnNcbiAgICBpZiAocXVlcnkuaW5jbHVkZXMoXCJub3QgZG9uZVwiKSkge1xuICAgICAgcmV0dXJuIHRhc2tzLmZpbHRlcigodCkgPT4gdC5zdGF0dXMgIT09IFwiY29tcGxldGVkXCIpO1xuICAgIH0gZWxzZSBpZiAocXVlcnkuaW5jbHVkZXMoXCJkb25lXCIpKSB7XG4gICAgICByZXR1cm4gdGFza3MuZmlsdGVyKCh0KSA9PiB0LnN0YXR1cyA9PT0gXCJjb21wbGV0ZWRcIik7XG4gICAgfVxuICAgIC8vIEJ5IGRlZmF1bHQsIHJldHVybiBvbmx5IGluY29tcGxldGUgdGFza3NcbiAgICByZXR1cm4gdGFza3MuZmlsdGVyKCh0KSA9PiB0LnN0YXR1cyAhPT0gXCJjb21wbGV0ZWRcIik7XG4gIH1cblxuICBwcml2YXRlIG1hdGNoZXNRdWVyeShmaWxlOiBURmlsZSwgbWV0YWRhdGE6IGFueSwgcXVlcnk6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIC8vIEJhc2ljIHBhdHRlcm4gbWF0Y2hpbmcgZm9yIGN1c3RvbSBxdWVyaWVzXG4gICAgY29uc3Qgc2VhcmNoVGVybSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XG5cbiAgICAvLyBDaGVjayBmaWxlbmFtZVxuICAgIGlmIChmaWxlLmJhc2VuYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoVGVybSkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8vIENoZWNrIHRhZ3NcbiAgICBpZiAoXG4gICAgICBtZXRhZGF0YT8udGFncz8uc29tZSgodDogYW55KSA9PiB0LnRhZy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaFRlcm0pKVxuICAgICkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZnJvbnRtYXR0ZXJcbiAgICBpZiAobWV0YWRhdGE/LmZyb250bWF0dGVyKSB7XG4gICAgICBmb3IgKGNvbnN0IHZhbHVlIG9mIE9iamVjdC52YWx1ZXMobWV0YWRhdGEuZnJvbnRtYXR0ZXIpKSB7XG4gICAgICAgIGlmIChTdHJpbmcodmFsdWUpLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoVGVybSkpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8vIFJlbmRlcmluZyBtZXRob2RzIGZvciBkaWZmZXJlbnQgcXVlcnkgdHlwZXNcbiAgcHJpdmF0ZSByZW5kZXJUYWJsZShoZWFkZXJzOiBzdHJpbmdbXSwgcm93czogYW55W10pOiBzdHJpbmcge1xuICAgIGxldCBodG1sID0gJzx0YWJsZSBjbGFzcz1cImV4by1uYXRpdmUtdGFibGVcIj48dGhlYWQ+PHRyPic7XG5cbiAgICBmb3IgKGNvbnN0IGhlYWRlciBvZiBoZWFkZXJzKSB7XG4gICAgICBodG1sICs9IGA8dGg+JHtoZWFkZXJ9PC90aD5gO1xuICAgIH1cblxuICAgIGh0bWwgKz0gXCI8L3RyPjwvdGhlYWQ+PHRib2R5PlwiO1xuXG4gICAgZm9yIChjb25zdCByb3cgb2Ygcm93cykge1xuICAgICAgaHRtbCArPSBcIjx0cj5cIjtcbiAgICAgIGZvciAoY29uc3QgaGVhZGVyIG9mIGhlYWRlcnMpIHtcbiAgICAgICAgaHRtbCArPSBgPHRkPiR7cm93W2hlYWRlcl0gfHwgXCJcIn08L3RkPmA7XG4gICAgICB9XG4gICAgICBodG1sICs9IFwiPC90cj5cIjtcbiAgICB9XG5cbiAgICBodG1sICs9IFwiPC90Ym9keT48L3RhYmxlPlwiO1xuICAgIHJldHVybiBodG1sO1xuICB9XG5cbiAgcHJpdmF0ZSByZW5kZXJMaXN0KGl0ZW1zOiBhbnlbXSk6IHN0cmluZyB7XG4gICAgbGV0IGh0bWwgPSAnPHVsIGNsYXNzPVwiZXhvLW5hdGl2ZS1saXN0XCI+JztcblxuICAgIGZvciAoY29uc3QgaXRlbSBvZiBpdGVtcykge1xuICAgICAgaHRtbCArPSBgPGxpPiR7aXRlbS5saW5rIHx8IGl0ZW0udGV4dH08L2xpPmA7XG4gICAgfVxuXG4gICAgaHRtbCArPSBcIjwvdWw+XCI7XG4gICAgcmV0dXJuIGh0bWw7XG4gIH1cblxuICBwcml2YXRlIHJlbmRlclRhc2tzKHRhc2tzOiBhbnlbXSk6IHN0cmluZyB7XG4gICAgbGV0IGh0bWwgPSAnPGRpdiBjbGFzcz1cImV4by1uYXRpdmUtdGFza3NcIj4nO1xuXG4gICAgZm9yIChjb25zdCB0YXNrIG9mIHRhc2tzKSB7XG4gICAgICBjb25zdCBjaGVja2VkID0gdGFzay5zdGF0dXMgPT09IFwiY29tcGxldGVkXCIgPyBcImNoZWNrZWRcIiA6IFwiXCI7XG4gICAgICBodG1sICs9IGBcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFzay1pdGVtXCI+XG4gICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiAke2NoZWNrZWR9IGRpc2FibGVkPlxuICAgICAgICAgICAgICAgICAgICA8c3Bhbj4ke3Rhc2sudGV4dH08L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgIDxzbWFsbD4oJHt0YXNrLmZpbGV9KTwvc21hbGw+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICBgO1xuICAgIH1cblxuICAgIGh0bWwgKz0gXCI8L2Rpdj5cIjtcbiAgICByZXR1cm4gaHRtbDtcbiAgfVxuXG4gIHByaXZhdGUgcmVuZGVyQ2FsZW5kYXIoZXZlbnRzOiBhbnlbXSk6IHN0cmluZyB7XG4gICAgbGV0IGh0bWwgPSAnPGRpdiBjbGFzcz1cImV4by1uYXRpdmUtY2FsZW5kYXJcIj4nO1xuXG4gICAgLy8gU29ydCBldmVudHMgYnkgZGF0ZVxuICAgIGV2ZW50cy5zb3J0KFxuICAgICAgKGEsIGIpID0+IG5ldyBEYXRlKGEuZGF0ZSkuZ2V0VGltZSgpIC0gbmV3IERhdGUoYi5kYXRlKS5nZXRUaW1lKCksXG4gICAgKTtcblxuICAgIGZvciAoY29uc3QgZXZlbnQgb2YgZXZlbnRzKSB7XG4gICAgICBodG1sICs9IGBcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY2FsZW5kYXItZXZlbnRcIj5cbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJldmVudC1kYXRlXCI+JHtldmVudC5kYXRlfTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJldmVudC10aXRsZVwiPiR7ZXZlbnQudGl0bGV9PC9zcGFuPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgYDtcbiAgICB9XG5cbiAgICBodG1sICs9IFwiPC9kaXY+XCI7XG4gICAgcmV0dXJuIGh0bWw7XG4gIH1cblxuICBwcml2YXRlIHJlbmRlckN1c3RvbShyZXN1bHRzOiBhbnlbXSk6IHN0cmluZyB7XG4gICAgbGV0IGh0bWwgPSAnPGRpdiBjbGFzcz1cImV4by1uYXRpdmUtY3VzdG9tXCI+JztcblxuICAgIGZvciAoY29uc3QgcmVzdWx0IG9mIHJlc3VsdHMpIHtcbiAgICAgIGh0bWwgKz0gYDxkaXYgY2xhc3M9XCJjdXN0b20tcmVzdWx0XCI+W1ske3Jlc3VsdC5maWxlfXwke3Jlc3VsdC50aXRsZX1dXTwvZGl2PmA7XG4gICAgfVxuXG4gICAgaHRtbCArPSBcIjwvZGl2PlwiO1xuICAgIHJldHVybiBodG1sO1xuICB9XG5cbiAgLy8gQ2FjaGUgbWFuYWdlbWVudFxuICBwcml2YXRlIGdldENhY2hlZFJlc3VsdChxdWVyeTogc3RyaW5nKTogUXVlcnlSZXN1bHQgfCBudWxsIHtcbiAgICBjb25zdCBjYWNoZWQgPSB0aGlzLnF1ZXJ5Q2FjaGUuZ2V0KHF1ZXJ5KTtcblxuICAgIGlmIChjYWNoZWQgJiYgRGF0ZS5ub3coKSAtIGNhY2hlZC50aW1lc3RhbXAgPCB0aGlzLmNhY2hlVGltZW91dCkge1xuICAgICAgcmV0dXJuIGNhY2hlZC5yZXN1bHQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBwcml2YXRlIGNhY2hlUmVzdWx0KHF1ZXJ5OiBzdHJpbmcsIHJlc3VsdDogUXVlcnlSZXN1bHQpOiB2b2lkIHtcbiAgICB0aGlzLnF1ZXJ5Q2FjaGUuc2V0KHF1ZXJ5LCB7XG4gICAgICByZXN1bHQsXG4gICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgfSk7XG5cbiAgICAvLyBDbGVhbiBvbGQgY2FjaGUgZW50cmllc1xuICAgIGlmICh0aGlzLnF1ZXJ5Q2FjaGUuc2l6ZSA+IDEwMCkge1xuICAgICAgY29uc3Qgb2xkZXN0S2V5ID0gdGhpcy5xdWVyeUNhY2hlLmtleXMoKS5uZXh0KCkudmFsdWU7XG4gICAgICB0aGlzLnF1ZXJ5Q2FjaGUuZGVsZXRlKG9sZGVzdEtleSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEV4ZWN1dGVzIGEgcXVlcnkgYW5kIHJlbmRlcnMgdGhlIHJlc3VsdCB0byBhIGNvbnRhaW5lclxuICAgKi9cbiAgYXN5bmMgcmVuZGVyUXVlcnkoXG4gICAgY29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICBxdWVyeTogc3RyaW5nLFxuICAgIGNvbnRleHQ/OiBRdWVyeUNvbnRleHQsXG4gICk6IFByb21pc2U8UmVzdWx0PHZvaWQ+PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVF1ZXJ5KHF1ZXJ5LCBjb250ZXh0KTtcbiAgICAgIGlmICghcmVzdWx0LmlzU3VjY2Vzcykge1xuICAgICAgICByZXR1cm4gUmVzdWx0LmZhaWwocmVzdWx0LmdldEVycm9yTWVzc2FnZSgpKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcXVlcnlSZXN1bHQgPSByZXN1bHQuZ2V0VmFsdWUoKTtcblxuICAgICAgLy8gQ2hlY2sgaWYgcmVzdWx0IGlzIGVtcHR5IGFuZCByZW5kZXIgYXBwcm9wcmlhdGUgbWVzc2FnZVxuICAgICAgaWYgKFxuICAgICAgICAhcXVlcnlSZXN1bHQgfHxcbiAgICAgICAgIXF1ZXJ5UmVzdWx0LmRhdGEgfHxcbiAgICAgICAgKEFycmF5LmlzQXJyYXkocXVlcnlSZXN1bHQuZGF0YSkgJiYgcXVlcnlSZXN1bHQuZGF0YS5sZW5ndGggPT09IDApXG4gICAgICApIHtcbiAgICAgICAgY29udGFpbmVyLmlubmVySFRNTCA9XG4gICAgICAgICAgJzxkaXYgY2xhc3M9XCJleG8tbmF0aXZlLWVtcHR5XCI+Tm8gcmVzdWx0cyBmb3VuZDwvZGl2Pic7XG4gICAgICAgIHJldHVybiBSZXN1bHQub2soKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHF1ZXJ5UmVzdWx0Py5tZXRhZGF0YT8ucmVuZGVySHRtbCkge1xuICAgICAgICBjb250YWluZXIuaW5uZXJIVE1MID0gcXVlcnlSZXN1bHQubWV0YWRhdGEucmVuZGVySHRtbDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEZhbGxiYWNrIHJlbmRlcmluZ1xuICAgICAgICBjb250YWluZXIuaW5uZXJIVE1MID0gdGhpcy5yZW5kZXJGYWxsYmFjayhxdWVyeVJlc3VsdCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBSZXN1bHQub2soKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIFJlc3VsdC5mYWlsKGBGYWlsZWQgdG8gcmVuZGVyIHF1ZXJ5OiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgcGFnZXMvZmlsZXMgbWF0Y2hpbmcgdGhlIGdpdmVuIHNvdXJjZSBleHByZXNzaW9uXG4gICAqL1xuICBhc3luYyBnZXRQYWdlcyhzb3VyY2U6IHN0cmluZyk6IFByb21pc2U8UmVzdWx0PGFueVtdPj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjbGVhblNvdXJjZSA9IHNvdXJjZS5yZXBsYWNlKC9bJ1wiXS9nLCBcIlwiKTsgLy8gUmVtb3ZlIHF1b3Rlc1xuICAgICAgY29uc3QgZmlsZXMgPSBhd2FpdCB0aGlzLmdldEZpbGVzRnJvbVNvdXJjZShjbGVhblNvdXJjZSk7XG4gICAgICBjb25zdCBwYWdlcyA9IGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgICBmaWxlcy5tYXAoYXN5bmMgKGZpbGUpID0+IHtcbiAgICAgICAgICBjb25zdCBtZXRhZGF0YSA9IHRoaXMubWV0YWRhdGFDYWNoZT8uZ2V0RmlsZUNhY2hlKGZpbGUpO1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBmaWxlOiB7XG4gICAgICAgICAgICAgIHBhdGg6IGZpbGUucGF0aCxcbiAgICAgICAgICAgICAgbmFtZTogZmlsZS5iYXNlbmFtZSxcbiAgICAgICAgICAgICAgc2l6ZTogZmlsZS5zdGF0LnNpemUsXG4gICAgICAgICAgICAgIG10aW1lOiBmaWxlLnN0YXQubXRpbWUsXG4gICAgICAgICAgICAgIGN0aW1lOiBmaWxlLnN0YXQuY3RpbWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLi4ubWV0YWRhdGE/LmZyb250bWF0dGVyLFxuICAgICAgICAgIH07XG4gICAgICAgIH0pLFxuICAgICAgKTtcblxuICAgICAgcmV0dXJuIFJlc3VsdC5vayhwYWdlcyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiBSZXN1bHQuZmFpbChgRmFpbGVkIHRvIGdldCBwYWdlczogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIG1ldGFkYXRhIGZvciBhIHNwZWNpZmljIHBhZ2UvZmlsZVxuICAgKi9cbiAgYXN5bmMgZ2V0UGFnZU1ldGFkYXRhKHBhdGg6IHN0cmluZyk6IFByb21pc2U8UmVzdWx0PFJlY29yZDxzdHJpbmcsIGFueT4+PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnZhdWx0Py5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocGF0aCk7XG4gICAgICBpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG4gICAgICAgIHJldHVybiBSZXN1bHQuZmFpbChgRmlsZSBub3QgZm91bmQ6ICR7cGF0aH1gKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgbWV0YWRhdGEgPSB0aGlzLm1ldGFkYXRhQ2FjaGU/LmdldEZpbGVDYWNoZShmaWxlKTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgZmlsZToge1xuICAgICAgICAgIHBhdGg6IGZpbGUucGF0aCxcbiAgICAgICAgICBuYW1lOiBmaWxlLmJhc2VuYW1lLFxuICAgICAgICAgIHNpemU6IGZpbGUuc3RhdC5zaXplLFxuICAgICAgICAgIG10aW1lOiBmaWxlLnN0YXQubXRpbWUsXG4gICAgICAgICAgY3RpbWU6IGZpbGUuc3RhdC5jdGltZSxcbiAgICAgICAgICBleHRlbnNpb246IGZpbGUuZXh0ZW5zaW9uLFxuICAgICAgICB9LFxuICAgICAgICBmcm9udG1hdHRlcjogbWV0YWRhdGE/LmZyb250bWF0dGVyIHx8IHt9LFxuICAgICAgICB0YWdzOiBtZXRhZGF0YT8udGFncz8ubWFwKCh0KSA9PiB0LnRhZykgfHwgW10sXG4gICAgICAgIGxpbmtzOiBtZXRhZGF0YT8ubGlua3M/Lm1hcCgobCkgPT4gbC5saW5rKSB8fCBbXSxcbiAgICAgICAgaGVhZGluZ3M6XG4gICAgICAgICAgbWV0YWRhdGE/LmhlYWRpbmdzPy5tYXAoKGgpID0+ICh7XG4gICAgICAgICAgICBsZXZlbDogaC5sZXZlbCxcbiAgICAgICAgICAgIGhlYWRpbmc6IGguaGVhZGluZyxcbiAgICAgICAgICB9KSkgfHwgW10sXG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gUmVzdWx0Lm9rKHJlc3VsdCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiBSZXN1bHQuZmFpbChgRmFpbGVkIHRvIGdldCBwYWdlIG1ldGFkYXRhOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXRlcyBpZiBhIHF1ZXJ5IHN0cmluZyBpcyBzeW50YWN0aWNhbGx5IGNvcnJlY3RcbiAgICovXG4gIHZhbGlkYXRlUXVlcnkocXVlcnk6IHN0cmluZyk6IFJlc3VsdDxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICghcXVlcnkgfHwgdHlwZW9mIHF1ZXJ5ICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIHJldHVybiBSZXN1bHQuZmFpbChcIlF1ZXJ5IG11c3QgYmUgYSBub24tZW1wdHkgc3RyaW5nXCIpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB0cmltbWVkID0gcXVlcnkudHJpbSgpO1xuICAgICAgaWYgKHRyaW1tZWQubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBSZXN1bHQuZmFpbChcIlF1ZXJ5IGNhbm5vdCBiZSBlbXB0eVwiKTtcbiAgICAgIH1cblxuICAgICAgLy8gQmFzaWMgdmFsaWRhdGlvbiAtIGNoZWNrIGZvciBkYW5nZXJvdXMgcGF0dGVybnNcbiAgICAgIGNvbnN0IGRhbmdlcm91c1BhdHRlcm5zID0gWy88c2NyaXB0L2ksIC9qYXZhc2NyaXB0Oi9pLCAvb25cXHcrXFxzKj0vaV07XG5cbiAgICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiBkYW5nZXJvdXNQYXR0ZXJucykge1xuICAgICAgICBpZiAocGF0dGVybi50ZXN0KHRyaW1tZWQpKSB7XG4gICAgICAgICAgcmV0dXJuIFJlc3VsdC5mYWlsKFwiUXVlcnkgY29udGFpbnMgcG90ZW50aWFsbHkgdW5zYWZlIGNvbnRlbnRcIik7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgZm9yIHZhbGlkIHF1ZXJ5IGtleXdvcmRzXG4gICAgICBjb25zdCBsb3dlclF1ZXJ5ID0gdHJpbW1lZC50b0xvd2VyQ2FzZSgpO1xuICAgICAgY29uc3QgdmFsaWRLZXl3b3JkcyA9IFtcInRhYmxlXCIsIFwibGlzdFwiLCBcInRhc2tcIiwgXCJjYWxlbmRhclwiXTtcbiAgICAgIGNvbnN0IGhhc1ZhbGlkS2V5d29yZCA9IHZhbGlkS2V5d29yZHMuc29tZSgoa2V5d29yZCkgPT5cbiAgICAgICAgbG93ZXJRdWVyeS5zdGFydHNXaXRoKGtleXdvcmQpLFxuICAgICAgKTtcblxuICAgICAgaWYgKCFoYXNWYWxpZEtleXdvcmQpIHtcbiAgICAgICAgcmV0dXJuIFJlc3VsdC5mYWlsKFxuICAgICAgICAgIFwiUXVlcnkgbXVzdCBzdGFydCB3aXRoIGEgdmFsaWQga2V5d29yZCAodGFibGUsIGxpc3QsIHRhc2ssIGNhbGVuZGFyKVwiLFxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gUmVzdWx0Lm9rKHRydWUpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4gUmVzdWx0LmZhaWwoYFF1ZXJ5IHZhbGlkYXRpb24gZmFpbGVkOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSByZW5kZXJGYWxsYmFjayhxdWVyeVJlc3VsdDogUXVlcnlSZXN1bHQgfCBudWxsKTogc3RyaW5nIHtcbiAgICBpZiAoXG4gICAgICAhcXVlcnlSZXN1bHQgfHxcbiAgICAgICFxdWVyeVJlc3VsdC5kYXRhIHx8XG4gICAgICAoQXJyYXkuaXNBcnJheShxdWVyeVJlc3VsdC5kYXRhKSAmJiBxdWVyeVJlc3VsdC5kYXRhLmxlbmd0aCA9PT0gMClcbiAgICApIHtcbiAgICAgIHJldHVybiAnPGRpdiBjbGFzcz1cImV4by1uYXRpdmUtZW1wdHlcIj5ObyByZXN1bHRzIGZvdW5kPC9kaXY+JztcbiAgICB9XG5cbiAgICBjb25zdCBpdGVtcyA9IEFycmF5LmlzQXJyYXkocXVlcnlSZXN1bHQuZGF0YSlcbiAgICAgID8gcXVlcnlSZXN1bHQuZGF0YVxuICAgICAgOiBbcXVlcnlSZXN1bHQuZGF0YV07XG5cbiAgICBpZiAoaXRlbXMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gJzxkaXYgY2xhc3M9XCJleG8tbmF0aXZlLWVtcHR5XCI+Tm8gcmVzdWx0cyBmb3VuZDwvZGl2Pic7XG4gICAgfVxuXG4gICAgcmV0dXJuIGBcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJleG8tbmF0aXZlLWZhbGxiYWNrXCI+XG4gICAgICAgICAgICAgICAgJHtpdGVtcy5tYXAoKGl0ZW0pID0+IGA8ZGl2IGNsYXNzPVwicmVzdWx0LWl0ZW1cIj4ke0pTT04uc3RyaW5naWZ5KGl0ZW0pfTwvZGl2PmApLmpvaW4oXCJcIil9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgYDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhciB0aGUgcXVlcnkgY2FjaGVcbiAgICovXG4gIHB1YmxpYyBjbGVhckNhY2hlKCk6IHZvaWQge1xuICAgIHRoaXMucXVlcnlDYWNoZS5jbGVhcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIENsZWFyIGFsbCBjYWNoZXMgKGFsaWFzIGZvciBjb21wYXRpYmlsaXR5KVxuICAgKi9cbiAgcHVibGljIGNsZWFyQ2FjaGVzKCk6IHZvaWQge1xuICAgIHRoaXMucXVlcnlDYWNoZS5jbGVhcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjYWNoZSBzdGF0aXN0aWNzXG4gICAqL1xuICBwdWJsaWMgZ2V0Q2FjaGVTdGF0cygpOiB7IHF1ZXJ5Q2FjaGU6IG51bWJlcjsgbWV0YWRhdGFDYWNoZTogbnVtYmVyIH0ge1xuICAgIHJldHVybiB7XG4gICAgICBxdWVyeUNhY2hlOiB0aGlzLnF1ZXJ5Q2FjaGUuc2l6ZSxcbiAgICAgIG1ldGFkYXRhQ2FjaGU6IDAsIC8vIE1ldGFkYXRhIGNhY2hlIGlzIG1hbmFnZWQgYnkgT2JzaWRpYW5cbiAgICB9O1xuICB9XG59XG4iXSwidmVyc2lvbiI6M30=