bb486ee35bacb75cf1115536b1c23691
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.DIContainer = void 0;
const tslib_1 = require("tslib");
const Container_1 = require("../../application/core/Container");
const ObsidianAssetRepository_1 = require("../repositories/ObsidianAssetRepository");
const ObsidianOntologyRepository_1 = require("../repositories/ObsidianOntologyRepository");
const ObsidianClassViewRepository_1 = require("../repositories/ObsidianClassViewRepository");
const ObsidianButtonRepository_1 = require("../repositories/ObsidianButtonRepository");
const ObsidianClassLayoutRepository_1 = require("../repositories/ObsidianClassLayoutRepository");
// Use Cases
const CreateAssetUseCase_1 = require("../../application/use-cases/CreateAssetUseCase");
const RenderClassButtonsUseCase_1 = require("../../application/use-cases/RenderClassButtonsUseCase");
const ExecuteButtonCommandUseCase_1 = require("../../application/use-cases/ExecuteButtonCommandUseCase");
const PropertyEditingUseCase_1 = require("../../application/use-cases/PropertyEditingUseCase");
const QueryTemplateUseCase_1 = require("../../application/use-cases/QueryTemplateUseCase");
const ObsidianCommandExecutor_1 = require("../services/ObsidianCommandExecutor");
const ErrorHandlerService_1 = require("../../application/services/ErrorHandlerService");
const SPARQLAutocompleteService_1 = require("../../application/services/SPARQLAutocompleteService");
const GraphSuggestionRepository_1 = require("../repositories/GraphSuggestionRepository");
const ObsidianQueryTemplateRepository_1 = require("../repositories/ObsidianQueryTemplateRepository");
// Presentation
const ButtonRenderer_1 = require("../../presentation/components/ButtonRenderer");
const PropertyRenderer_1 = require("../../presentation/components/PropertyRenderer");
const LayoutRenderer_1 = require("../../presentation/renderers/LayoutRenderer");
/**
 * Dependency Injection Container Setup
 * Following Clean Architecture - wires up all dependencies
 */
class DIContainer {
    constructor(app) {
        this.app = app;
        this.container = Container_1.Container.getInstance();
        this.registerDependencies();
    }
    static initialize(app, plugin) {
        if (!DIContainer.instance) {
            DIContainer.instance = new DIContainer(app);
        }
        else {
            // Always update app and plugin references
            DIContainer.instance.app = app;
            if (plugin) {
                DIContainer.instance.plugin = plugin;
            }
            // Re-register dependencies to ensure they use the new app instance
            DIContainer.instance.container.clear();
            DIContainer.instance.registerDependencies();
        }
        if (plugin && !DIContainer.instance.plugin) {
            DIContainer.instance.plugin = plugin;
        }
        return DIContainer.instance;
    }
    static getInstance() {
        if (!DIContainer.instance) {
            throw new Error('DIContainer not initialized. Call initialize(app) first.');
        }
        return DIContainer.instance;
    }
    /**
     * Async initialize method for backward compatibility
     */
    initialize(app) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            // Already initialized in constructor, this is for backward compatibility
            return Promise.resolve();
        });
    }
    /**
     * Reset the container instance (for testing purposes)
     */
    static reset() {
        DIContainer.instance = null;
    }
    registerDependencies() {
        // Register Obsidian App
        this.container.register('App', () => this.app);
        // Register Repositories
        this.container.register('IAssetRepository', () => new ObsidianAssetRepository_1.ObsidianAssetRepository(this.app));
        this.container.register('IOntologyRepository', () => new ObsidianOntologyRepository_1.ObsidianOntologyRepository(this.app));
        this.container.register('IClassViewRepository', () => new ObsidianClassViewRepository_1.ObsidianClassViewRepository(this.app));
        this.container.register('IButtonRepository', () => new ObsidianButtonRepository_1.ObsidianButtonRepository(this.app));
        this.container.register('IClassLayoutRepository', () => {
            var _a, _b;
            return new ObsidianClassLayoutRepository_1.ObsidianClassLayoutRepository(this.app, ((_b = (_a = this.plugin) === null || _a === void 0 ? void 0 : _a.settings) === null || _b === void 0 ? void 0 : _b.layoutsFolderPath) || 'layouts');
        });
        this.container.register('IQueryTemplateRepository', () => {
            var _a, _b, _c, _d;
            return new ObsidianQueryTemplateRepository_1.ObsidianQueryTemplateRepository(this.app, ((_b = (_a = this.plugin) === null || _a === void 0 ? void 0 : _a.settings) === null || _b === void 0 ? void 0 : _b.templatesPath) || '.exocortex/templates', ((_d = (_c = this.plugin) === null || _c === void 0 ? void 0 : _c.settings) === null || _d === void 0 ? void 0 : _d.templateUsageDataPath) || '.exocortex/template-usage.json');
        });
        // Register Services
        this.container.register('ICommandExecutor', () => new ObsidianCommandExecutor_1.ObsidianCommandExecutor(this.app, this.container.resolve('IAssetRepository')));
        // Register Error Handler Service
        this.container.register('ErrorHandlerService', () => new ErrorHandlerService_1.ErrorHandlerService({
            showUserNotification: true,
            logToConsole: true,
            trackMetrics: true,
            autoRecover: false
        }));
        // Register Autocomplete Services
        this.container.register('ISuggestionRepository', () => {
            var _a;
            // Need to get graph instance - will be provided by plugin
            const graph = ((_a = this.plugin) === null || _a === void 0 ? void 0 : _a.graph) || null;
            return new GraphSuggestionRepository_1.GraphSuggestionRepository(graph);
        });
        this.container.register('SPARQLAutocompleteService', () => {
            var _a;
            return new SPARQLAutocompleteService_1.SPARQLAutocompleteService(this.container.resolve('ISuggestionRepository'), ((_a = this.plugin) === null || _a === void 0 ? void 0 : _a.graph) || null);
        });
        // Register Use Cases
        this.container.register('CreateAssetUseCase', () => new CreateAssetUseCase_1.CreateAssetUseCase(this.container.resolve('IAssetRepository'), this.container.resolve('IOntologyRepository')));
        this.container.register('RenderClassButtonsUseCase', () => new RenderClassButtonsUseCase_1.RenderClassButtonsUseCase(this.container.resolve('IClassViewRepository'), this.container.resolve('IButtonRepository')));
        this.container.register('ExecuteButtonCommandUseCase', () => new ExecuteButtonCommandUseCase_1.ExecuteButtonCommandUseCase(this.container.resolve('IButtonRepository'), this.container.resolve('ICommandExecutor')));
        this.container.register('PropertyEditingUseCase', () => new PropertyEditingUseCase_1.PropertyEditingUseCase(this.container.resolve('IAssetRepository'), this.plugin || this.app // Use plugin if available, otherwise app
        ));
        this.container.register('QueryTemplateUseCase', () => new QueryTemplateUseCase_1.QueryTemplateUseCase(this.container.resolve('IQueryTemplateRepository')));
        // Register Presentation Components
        this.container.register('ButtonRenderer', () => new ButtonRenderer_1.ButtonRenderer(this.app, this.container.resolve('RenderClassButtonsUseCase'), this.container.resolve('ExecuteButtonCommandUseCase')));
        this.container.register('PropertyRenderer', () => new PropertyRenderer_1.PropertyRenderer(this.app, this.container.resolve('PropertyEditingUseCase')));
        this.container.register('LayoutRenderer', () => new LayoutRenderer_1.LayoutRenderer(this.app, this.container.resolve('IClassLayoutRepository'), this.container.resolve('PropertyRenderer')));
    }
    /**
     * Resolve a dependency from the container
     */
    resolve(token) {
        return this.container.resolve(token);
    }
    /**
     * Get specific use cases for common operations
     */
    getCreateAssetUseCase() {
        return this.resolve('CreateAssetUseCase');
    }
    getRenderButtonsUseCase() {
        return this.resolve('RenderClassButtonsUseCase');
    }
    getExecuteButtonCommandUseCase() {
        return this.resolve('ExecuteButtonCommandUseCase');
    }
    getButtonRenderer() {
        return this.resolve('ButtonRenderer');
    }
    getPropertyRenderer() {
        return this.resolve('PropertyRenderer');
    }
    getLayoutRenderer() {
        return this.resolve('LayoutRenderer');
    }
    getPropertyEditingUseCase() {
        return this.resolve('PropertyEditingUseCase');
    }
    getQueryTemplateUseCase() {
        return this.resolve('QueryTemplateUseCase');
    }
    getQueryTemplateRepository() {
        return this.resolve('IQueryTemplateRepository');
    }
    /**
     * Clean up resources
     */
    dispose() {
        // Clean up any resources if needed
        this.container.clear();
    }
}
exports.DIContainer = DIContainer;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2tpdGVsZXYvRG9jdW1lbnRzL2V4b2NvcnRleC1vYnNpZGlhbi1wbHVnaW4vc3JjL2luZnJhc3RydWN0dXJlL2NvbnRhaW5lci9ESUNvbnRhaW5lci50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQ0EsZ0VBQTZEO0FBUTdELHFGQUFrRjtBQUNsRiwyRkFBd0Y7QUFDeEYsNkZBQTBGO0FBQzFGLHVGQUFvRjtBQUNwRixpR0FBOEY7QUFFOUYsWUFBWTtBQUNaLHVGQUFvRjtBQUNwRixxR0FBa0c7QUFDbEcseUdBQXNHO0FBQ3RHLCtGQUE0RjtBQUM1RiwyRkFBd0Y7QUFJeEYsaUZBQThFO0FBQzlFLHdGQUFxRjtBQUNyRixvR0FBaUc7QUFFakcseUZBQXNGO0FBRXRGLHFHQUFrRztBQUVsRyxlQUFlO0FBQ2YsaUZBQThFO0FBQzlFLHFGQUFrRjtBQUNsRixnRkFBNkU7QUFFN0U7OztHQUdHO0FBQ0gsTUFBYSxXQUFXO0lBTXBCLFlBQTRCLEdBQVE7UUFBUixRQUFHLEdBQUgsR0FBRyxDQUFLO1FBQ2hDLElBQUksQ0FBQyxTQUFTLEdBQUcscUJBQVMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUN6QyxJQUFJLENBQUMsb0JBQW9CLEVBQUUsQ0FBQztJQUNoQyxDQUFDO0lBRU0sTUFBTSxDQUFDLFVBQVUsQ0FBQyxHQUFRLEVBQUUsTUFBWTtRQUMzQyxJQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsRUFBRTtZQUN2QixXQUFXLENBQUMsUUFBUSxHQUFHLElBQUksV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQy9DO2FBQU07WUFDSCwwQ0FBMEM7WUFDMUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxHQUFHLEdBQUcsR0FBRyxDQUFDO1lBQy9CLElBQUksTUFBTSxFQUFFO2dCQUNSLFdBQVcsQ0FBQyxRQUFRLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQzthQUN4QztZQUNELG1FQUFtRTtZQUNuRSxXQUFXLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUN2QyxXQUFX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QzFCLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBdUIsc0JBQXNCLENBQUMsQ0FBQztJQUN0RSxDQUFDO0lBRU0sMEJBQTBCO1FBQzdCLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBMkIsMEJBQTBCLENBQUMsQ0FBQztJQUM5RSxDQUFDO0lBRUQ7O09BRUc7SUFDSSxPQUFPO1FBQ1YsbUNBQW1DO1FBQ25DLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDM0IsQ0FBQztDQUNKO0FBN1BELGtDQTZQQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMva2l0ZWxldi9Eb2N1bWVudHMvZXhvY29ydGV4LW9ic2lkaWFuLXBsdWdpbi9zcmMvaW5mcmFzdHJ1Y3R1cmUvY29udGFpbmVyL0RJQ29udGFpbmVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IENvbnRhaW5lciB9IGZyb20gJy4uLy4uL2FwcGxpY2F0aW9uL2NvcmUvQ29udGFpbmVyJztcblxuLy8gUmVwb3NpdG9yaWVzXG5pbXBvcnQgeyBJQXNzZXRSZXBvc2l0b3J5IH0gZnJvbSAnLi4vLi4vZG9tYWluL3JlcG9zaXRvcmllcy9JQXNzZXRSZXBvc2l0b3J5JztcbmltcG9ydCB7IElPbnRvbG9neVJlcG9zaXRvcnkgfSBmcm9tICcuLi8uLi9kb21haW4vcmVwb3NpdG9yaWVzL0lPbnRvbG9neVJlcG9zaXRvcnknO1xuaW1wb3J0IHsgSUNsYXNzVmlld1JlcG9zaXRvcnkgfSBmcm9tICcuLi8uLi9kb21haW4vcmVwb3NpdG9yaWVzL0lDbGFzc1ZpZXdSZXBvc2l0b3J5JztcbmltcG9ydCB7IElCdXR0b25SZXBvc2l0b3J5IH0gZnJvbSAnLi4vLi4vZG9tYWluL3JlcG9zaXRvcmllcy9JQnV0dG9uUmVwb3NpdG9yeSc7XG5pbXBvcnQgeyBJQ2xhc3NMYXlvdXRSZXBvc2l0b3J5IH0gZnJvbSAnLi4vLi4vZG9tYWluL3JlcG9zaXRvcmllcy9JQ2xhc3NMYXlvdXRSZXBvc2l0b3J5JztcbmltcG9ydCB7IE9ic2lkaWFuQXNzZXRSZXBvc2l0b3J5IH0gZnJvbSAnLi4vcmVwb3NpdG9yaWVzL09ic2lkaWFuQXNzZXRSZXBvc2l0b3J5JztcbmltcG9ydCB7IE9ic2lkaWFuT250b2xvZ3lSZXBvc2l0b3J5IH0gZnJvbSAnLi4vcmVwb3NpdG9yaWVzL09ic2lkaWFuT250b2xvZ3lSZXBvc2l0b3J5JztcbmltcG9ydCB7IE9ic2lkaWFuQ2xhc3NWaWV3UmVwb3NpdG9yeSB9IGZyb20gJy4uL3JlcG9zaXRvcmllcy9PYnNpZGlhbkNsYXNzVmlld1JlcG9zaXRvcnknO1xuaW1wb3J0IHsgT2JzaWRpYW5CdXR0b25SZXBvc2l0b3J5IH0gZnJvbSAnLi4vcmVwb3NpdG9yaWVzL09ic2lkaWFuQnV0dG9uUmVwb3NpdG9yeSc7XG5pbXBvcnQgeyBPYnNpZGlhbkNsYXNzTGF5b3V0UmVwb3NpdG9yeSB9IGZyb20gJy4uL3JlcG9zaXRvcmllcy9PYnNpZGlhbkNsYXNzTGF5b3V0UmVwb3NpdG9yeSc7XG5cbi8vIFVzZSBDYXNlc1xuaW1wb3J0IHsgQ3JlYXRlQXNzZXRVc2VDYXNlIH0gZnJvbSAnLi4vLi4vYXBwbGljYXRpb24vdXNlLWNhc2VzL0NyZWF0ZUFzc2V0VXNlQ2FzZSc7XG5pbXBvcnQgeyBSZW5kZXJDbGFzc0J1dHRvbnNVc2VDYXNlIH0gZnJvbSAnLi4vLi4vYXBwbGljYXRpb24vdXNlLWNhc2VzL1JlbmRlckNsYXNzQnV0dG9uc1VzZUNhc2UnO1xuaW1wb3J0IHsgRXhlY3V0ZUJ1dHRvbkNvbW1hbmRVc2VDYXNlIH0gZnJvbSAnLi4vLi4vYXBwbGljYXRpb24vdXNlLWNhc2VzL0V4ZWN1dGVCdXR0b25Db21tYW5kVXNlQ2FzZSc7XG5pbXBvcnQgeyBQcm9wZXJ0eUVkaXRpbmdVc2VDYXNlIH0gZnJvbSAnLi4vLi4vYXBwbGljYXRpb24vdXNlLWNhc2VzL1Byb3BlcnR5RWRpdGluZ1VzZUNhc2UnO1xuaW1wb3J0IHsgUXVlcnlUZW1wbGF0ZVVzZUNhc2UgfSBmcm9tICcuLi8uLi9hcHBsaWNhdGlvbi91c2UtY2FzZXMvUXVlcnlUZW1wbGF0ZVVzZUNhc2UnO1xuXG4vLyBTZXJ2aWNlc1xuaW1wb3J0IHsgSUNvbW1hbmRFeGVjdXRvciB9IGZyb20gJy4uLy4uL2FwcGxpY2F0aW9uL3NlcnZpY2VzL0lDb21tYW5kRXhlY3V0b3InO1xuaW1wb3J0IHsgT2JzaWRpYW5Db21tYW5kRXhlY3V0b3IgfSBmcm9tICcuLi9zZXJ2aWNlcy9PYnNpZGlhbkNvbW1hbmRFeGVjdXRvcic7XG5pbXBvcnQgeyBFcnJvckhhbmRsZXJTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vYXBwbGljYXRpb24vc2VydmljZXMvRXJyb3JIYW5kbGVyU2VydmljZSc7XG5pbXBvcnQgeyBTUEFSUUxBdXRvY29tcGxldGVTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vYXBwbGljYXRpb24vc2VydmljZXMvU1BBUlFMQXV0b2NvbXBsZXRlU2VydmljZSc7XG5pbXBvcnQgeyBJU3VnZ2VzdGlvblJlcG9zaXRvcnkgfSBmcm9tICcuLi8uLi9kb21haW4vcmVwb3NpdG9yaWVzL0lTdWdnZXN0aW9uUmVwb3NpdG9yeSc7XG5pbXBvcnQgeyBHcmFwaFN1Z2dlc3Rpb25SZXBvc2l0b3J5IH0gZnJvbSAnLi4vcmVwb3NpdG9yaWVzL0dyYXBoU3VnZ2VzdGlvblJlcG9zaXRvcnknO1xuaW1wb3J0IHsgSVF1ZXJ5VGVtcGxhdGVSZXBvc2l0b3J5IH0gZnJvbSAnLi4vLi4vZG9tYWluL3JlcG9zaXRvcmllcy9JUXVlcnlUZW1wbGF0ZVJlcG9zaXRvcnknO1xuaW1wb3J0IHsgT2JzaWRpYW5RdWVyeVRlbXBsYXRlUmVwb3NpdG9yeSB9IGZyb20gJy4uL3JlcG9zaXRvcmllcy9PYnNpZGlhblF1ZXJ5VGVtcGxhdGVSZXBvc2l0b3J5JztcblxuLy8gUHJlc2VudGF0aW9uXG5pbXBvcnQgeyBCdXR0b25SZW5kZXJlciB9IGZyb20gJy4uLy4uL3ByZXNlbnRhdGlvbi9jb21wb25lbnRzL0J1dHRvblJlbmRlcmVyJztcbmltcG9ydCB7IFByb3BlcnR5UmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wcmVzZW50YXRpb24vY29tcG9uZW50cy9Qcm9wZXJ0eVJlbmRlcmVyJztcbmltcG9ydCB7IExheW91dFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcHJlc2VudGF0aW9uL3JlbmRlcmVycy9MYXlvdXRSZW5kZXJlcic7XG5cbi8qKlxuICogRGVwZW5kZW5jeSBJbmplY3Rpb24gQ29udGFpbmVyIFNldHVwXG4gKiBGb2xsb3dpbmcgQ2xlYW4gQXJjaGl0ZWN0dXJlIC0gd2lyZXMgdXAgYWxsIGRlcGVuZGVuY2llc1xuICovXG5leHBvcnQgY2xhc3MgRElDb250YWluZXIge1xuICAgIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBESUNvbnRhaW5lcjtcbiAgICBwcml2YXRlIGNvbnRhaW5lcjogQ29udGFpbmVyO1xuXG4gICAgcHJpdmF0ZSBwbHVnaW46IGFueTtcblxuICAgIHByaXZhdGUgY29uc3RydWN0b3IocHJpdmF0ZSBhcHA6IEFwcCkge1xuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IENvbnRhaW5lci5nZXRJbnN0YW5jZSgpO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyRGVwZW5kZW5jaWVzKCk7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBpbml0aWFsaXplKGFwcDogQXBwLCBwbHVnaW4/OiBhbnkpOiBESUNvbnRhaW5lciB7XG4gICAgICAgIGlmICghRElDb250YWluZXIuaW5zdGFuY2UpIHtcbiAgICAgICAgICAgIERJQ29udGFpbmVyLmluc3RhbmNlID0gbmV3IERJQ29udGFpbmVyKGFwcCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBBbHdheXMgdXBkYXRlIGFwcCBhbmQgcGx1Z2luIHJlZmVyZW5jZXNcbiAgICAgICAgICAgIERJQ29udGFpbmVyLmluc3RhbmNlLmFwcCA9IGFwcDtcbiAgICAgICAgICAgIGlmIChwbHVnaW4pIHtcbiAgICAgICAgICAgICAgICBESUNvbnRhaW5lci5pbnN0YW5jZS5wbHVnaW4gPSBwbHVnaW47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBSZS1yZWdpc3RlciBkZXBlbmRlbmNpZXMgdG8gZW5zdXJlIHRoZXkgdXNlIHRoZSBuZXcgYXBwIGluc3RhbmNlXG4gICAgICAgICAgICBESUNvbnRhaW5lci5pbnN0YW5jZS5jb250YWluZXIuY2xlYXIoKTtcbiAgICAgICAgICAgIERJQ29udGFpbmVyLmluc3RhbmNlLnJlZ2lzdGVyRGVwZW5kZW5jaWVzKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsdWdpbiAmJiAhRElDb250YWluZXIuaW5zdGFuY2UucGx1Z2luKSB7XG4gICAgICAgICAgICBESUNvbnRhaW5lci5pbnN0YW5jZS5wbHVnaW4gPSBwbHVnaW47XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIERJQ29udGFpbmVyLmluc3RhbmNlO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogRElDb250YWluZXIge1xuICAgICAgICBpZiAoIURJQ29udGFpbmVyLmluc3RhbmNlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0RJQ29udGFpbmVyIG5vdCBpbml0aWFsaXplZC4gQ2FsbCBpbml0aWFsaXplKGFwcCkgZmlyc3QuJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIERJQ29udGFpbmVyLmluc3RhbmNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFzeW5jIGluaXRpYWxpemUgbWV0aG9kIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5XG4gICAgICovXG4gICAgcHVibGljIGFzeW5jIGluaXRpYWxpemUoYXBwOiBBcHApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy8gQWxyZWFkeSBpbml0aWFsaXplZCBpbiBjb25zdHJ1Y3RvciwgdGhpcyBpcyBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIFJlc2V0IHRoZSBjb250YWluZXIgaW5zdGFuY2UgKGZvciB0ZXN0aW5nIHB1cnBvc2VzKVxuICAgICAqL1xuICAgIHB1YmxpYyBzdGF0aWMgcmVzZXQoKTogdm9pZCB7XG4gICAgICAgIERJQ29udGFpbmVyLmluc3RhbmNlID0gbnVsbCBhcyBhbnk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZWdpc3RlckRlcGVuZGVuY2llcygpOiB2b2lkIHtcbiAgICAgICAgLy8gUmVnaXN0ZXIgT2JzaWRpYW4gQXBwXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnJlZ2lzdGVyKCdBcHAnLCAoKSA9PiB0aGlzLmFwcCk7XG5cbiAgICAgICAgLy8gUmVnaXN0ZXIgUmVwb3NpdG9yaWVzXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnJlZ2lzdGVyPElBc3NldFJlcG9zaXRvcnk+KFxuICAgICAgICAgICAgJ0lBc3NldFJlcG9zaXRvcnknLFxuICAgICAgICAgICAgKCkgPT4gbmV3IE9ic2lkaWFuQXNzZXRSZXBvc2l0b3J5KHRoaXMuYXBwKVxuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnJlZ2lzdGVyPElPbnRvbG9neVJlcG9zaXRvcnk+KFxuICAgICAgICAgICAgJ0lPbnRvbG9neVJlcG9zaXRvcnknLFxuICAgICAgICAgICAgKCkgPT4gbmV3IE9ic2lkaWFuT250b2xvZ3lSZXBvc2l0b3J5KHRoaXMuYXBwKVxuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnJlZ2lzdGVyPElDbGFzc1ZpZXdSZXBvc2l0b3J5PihcbiAgICAgICAgICAgICdJQ2xhc3NWaWV3UmVwb3NpdG9yeScsXG4gICAgICAgICAgICAoKSA9PiBuZXcgT2JzaWRpYW5DbGFzc1ZpZXdSZXBvc2l0b3J5KHRoaXMuYXBwKVxuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnJlZ2lzdGVyPElCdXR0b25SZXBvc2l0b3J5PihcbiAgICAgICAgICAgICdJQnV0dG9uUmVwb3NpdG9yeScsXG4gICAgICAgICAgICAoKSA9PiBuZXcgT2JzaWRpYW5CdXR0b25SZXBvc2l0b3J5KHRoaXMuYXBwKVxuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnJlZ2lzdGVyPElDbGFzc0xheW91dFJlcG9zaXRvcnk+KFxuICAgICAgICAgICAgJ0lDbGFzc0xheW91dFJlcG9zaXRvcnknLFxuICAgICAgICAgICAgKCkgPT4gbmV3IE9ic2lkaWFuQ2xhc3NMYXlvdXRSZXBvc2l0b3J5KFxuICAgICAgICAgICAgICAgIHRoaXMuYXBwLFxuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luPy5zZXR0aW5ncz8ubGF5b3V0c0ZvbGRlclBhdGggfHwgJ2xheW91dHMnXG4gICAgICAgICAgICApXG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5jb250YWluZXIucmVnaXN0ZXI8SVF1ZXJ5VGVtcGxhdGVSZXBvc2l0b3J5PihcbiAgICAgICAgICAgICdJUXVlcnlUZW1wbGF0ZVJlcG9zaXRvcnknLFxuICAgICAgICAgICAgKCkgPT4gbmV3IE9ic2lkaWFuUXVlcnlUZW1wbGF0ZVJlcG9zaXRvcnkoXG4gICAgICAgICAgICAgICAgdGhpcy5hcHAsXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4/LnNldHRpbmdzPy50ZW1wbGF0ZXNQYXRoIHx8ICcuZXhvY29ydGV4L3RlbXBsYXRlcycsXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4/LnNldHRpbmdzPy50ZW1wbGF0ZVVzYWdlRGF0YVBhdGggfHwgJy5leG9jb3J0ZXgvdGVtcGxhdGUtdXNhZ2UuanNvbidcbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBSZWdpc3RlciBTZXJ2aWNlc1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5yZWdpc3RlcjxJQ29tbWFuZEV4ZWN1dG9yPihcbiAgICAgICAgICAgICdJQ29tbWFuZEV4ZWN1dG9yJyxcbiAgICAgICAgICAgICgpID0+IG5ldyBPYnNpZGlhbkNvbW1hbmRFeGVjdXRvcihcbiAgICAgICAgICAgICAgICB0aGlzLmFwcCxcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5yZXNvbHZlPElBc3NldFJlcG9zaXRvcnk+KCdJQXNzZXRSZXBvc2l0b3J5JylcbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBSZWdpc3RlciBFcnJvciBIYW5kbGVyIFNlcnZpY2VcbiAgICAgICAgdGhpcy5jb250YWluZXIucmVnaXN0ZXI8RXJyb3JIYW5kbGVyU2VydmljZT4oXG4gICAgICAgICAgICAnRXJyb3JIYW5kbGVyU2VydmljZScsXG4gICAgICAgICAgICAoKSA9PiBuZXcgRXJyb3JIYW5kbGVyU2VydmljZSh7XG4gICAgICAgICAgICAgICAgc2hvd1VzZXJOb3RpZmljYXRpb246IHRydWUsXG4gICAgICAgICAgICAgICAgbG9nVG9Db25zb2xlOiB0cnVlLFxuICAgICAgICAgICAgICAgIHRyYWNrTWV0cmljczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBhdXRvUmVjb3ZlcjogZmFsc2VcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gUmVnaXN0ZXIgQXV0b2NvbXBsZXRlIFNlcnZpY2VzXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnJlZ2lzdGVyPElTdWdnZXN0aW9uUmVwb3NpdG9yeT4oXG4gICAgICAgICAgICAnSVN1Z2dlc3Rpb25SZXBvc2l0b3J5JyxcbiAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBOZWVkIHRvIGdldCBncmFwaCBpbnN0YW5jZSAtIHdpbGwgYmUgcHJvdmlkZWQgYnkgcGx1Z2luXG4gICAgICAgICAgICAgICAgY29uc3QgZ3JhcGggPSAodGhpcy5wbHVnaW4gYXMgYW55KT8uZ3JhcGggfHwgbnVsbDtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEdyYXBoU3VnZ2VzdGlvblJlcG9zaXRvcnkoZ3JhcGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnJlZ2lzdGVyPFNQQVJRTEF1dG9jb21wbGV0ZVNlcnZpY2U+KFxuICAgICAgICAgICAgJ1NQQVJRTEF1dG9jb21wbGV0ZVNlcnZpY2UnLFxuICAgICAgICAgICAgKCkgPT4gbmV3IFNQQVJRTEF1dG9jb21wbGV0ZVNlcnZpY2UoXG4gICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXIucmVzb2x2ZTxJU3VnZ2VzdGlvblJlcG9zaXRvcnk+KCdJU3VnZ2VzdGlvblJlcG9zaXRvcnknKSxcbiAgICAgICAgICAgICAgICAodGhpcy5wbHVnaW4gYXMgYW55KT8uZ3JhcGggfHwgbnVsbFxuICAgICAgICAgICAgKVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIFJlZ2lzdGVyIFVzZSBDYXNlc1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5yZWdpc3RlcjxDcmVhdGVBc3NldFVzZUNhc2U+KFxuICAgICAgICAgICAgJ0NyZWF0ZUFzc2V0VXNlQ2FzZScsXG4gICAgICAgICAgICAoKSA9PiBuZXcgQ3JlYXRlQXNzZXRVc2VDYXNlKFxuICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLnJlc29sdmU8SUFzc2V0UmVwb3NpdG9yeT4oJ0lBc3NldFJlcG9zaXRvcnknKSxcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5yZXNvbHZlPElPbnRvbG9neVJlcG9zaXRvcnk+KCdJT250b2xvZ3lSZXBvc2l0b3J5JylcbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcblxuICAgICAgICB0aGlzLmNvbnRhaW5lci5yZWdpc3RlcjxSZW5kZXJDbGFzc0J1dHRvbnNVc2VDYXNlPihcbiAgICAgICAgICAgICdSZW5kZXJDbGFzc0J1dHRvbnNVc2VDYXNlJyxcbiAgICAgICAgICAgICgpID0+IG5ldyBSZW5kZXJDbGFzc0J1dHRvbnNVc2VDYXNlKFxuICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLnJlc29sdmU8SUNsYXNzVmlld1JlcG9zaXRvcnk+KCdJQ2xhc3NWaWV3UmVwb3NpdG9yeScpLFxuICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLnJlc29sdmU8SUJ1dHRvblJlcG9zaXRvcnk+KCdJQnV0dG9uUmVwb3NpdG9yeScpXG4gICAgICAgICAgICApXG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5jb250YWluZXIucmVnaXN0ZXI8RXhlY3V0ZUJ1dHRvbkNvbW1hbmRVc2VDYXNlPihcbiAgICAgICAgICAgICdFeGVjdXRlQnV0dG9uQ29tbWFuZFVzZUNhc2UnLFxuICAgICAgICAgICAgKCkgPT4gbmV3IEV4ZWN1dGVCdXR0b25Db21tYW5kVXNlQ2FzZShcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5yZXNvbHZlPElCdXR0b25SZXBvc2l0b3J5PignSUJ1dHRvblJlcG9zaXRvcnknKSxcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5yZXNvbHZlPElDb21tYW5kRXhlY3V0b3I+KCdJQ29tbWFuZEV4ZWN1dG9yJylcbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcblxuICAgICAgICB0aGlzLmNvbnRhaW5lci5yZWdpc3RlcjxQcm9wZXJ0eUVkaXRpbmdVc2VDYXNlPihcbiAgICAgICAgICAgICdQcm9wZXJ0eUVkaXRpbmdVc2VDYXNlJyxcbiAgICAgICAgICAgICgpID0+IG5ldyBQcm9wZXJ0eUVkaXRpbmdVc2VDYXNlKFxuICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLnJlc29sdmU8SUFzc2V0UmVwb3NpdG9yeT4oJ0lBc3NldFJlcG9zaXRvcnknKSxcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbiB8fCB0aGlzLmFwcCAvLyBVc2UgcGx1Z2luIGlmIGF2YWlsYWJsZSwgb3RoZXJ3aXNlIGFwcFxuICAgICAgICAgICAgKVxuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnJlZ2lzdGVyPFF1ZXJ5VGVtcGxhdGVVc2VDYXNlPihcbiAgICAgICAgICAgICdRdWVyeVRlbXBsYXRlVXNlQ2FzZScsXG4gICAgICAgICAgICAoKSA9PiBuZXcgUXVlcnlUZW1wbGF0ZVVzZUNhc2UoXG4gICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXIucmVzb2x2ZTxJUXVlcnlUZW1wbGF0ZVJlcG9zaXRvcnk+KCdJUXVlcnlUZW1wbGF0ZVJlcG9zaXRvcnknKVxuICAgICAgICAgICAgKVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIFJlZ2lzdGVyIFByZXNlbnRhdGlvbiBDb21wb25lbnRzXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnJlZ2lzdGVyPEJ1dHRvblJlbmRlcmVyPihcbiAgICAgICAgICAgICdCdXR0b25SZW5kZXJlcicsXG4gICAgICAgICAgICAoKSA9PiBuZXcgQnV0dG9uUmVuZGVyZXIoXG4gICAgICAgICAgICAgICAgdGhpcy5hcHAsXG4gICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXIucmVzb2x2ZTxSZW5kZXJDbGFzc0J1dHRvbnNVc2VDYXNlPignUmVuZGVyQ2xhc3NCdXR0b25zVXNlQ2FzZScpLFxuICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLnJlc29sdmU8RXhlY3V0ZUJ1dHRvbkNvbW1hbmRVc2VDYXNlPignRXhlY3V0ZUJ1dHRvbkNvbW1hbmRVc2VDYXNlJylcbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcblxuICAgICAgICB0aGlzLmNvbnRhaW5lci5yZWdpc3RlcjxQcm9wZXJ0eVJlbmRlcmVyPihcbiAgICAgICAgICAgICdQcm9wZXJ0eVJlbmRlcmVyJyxcbiAgICAgICAgICAgICgpID0+IG5ldyBQcm9wZXJ0eVJlbmRlcmVyKFxuICAgICAgICAgICAgICAgIHRoaXMuYXBwLFxuICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLnJlc29sdmU8UHJvcGVydHlFZGl0aW5nVXNlQ2FzZT4oJ1Byb3BlcnR5RWRpdGluZ1VzZUNhc2UnKVxuICAgICAgICAgICAgKVxuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnJlZ2lzdGVyPExheW91dFJlbmRlcmVyPihcbiAgICAgICAgICAgICdMYXlvdXRSZW5kZXJlcicsXG4gICAgICAgICAgICAoKSA9PiBuZXcgTGF5b3V0UmVuZGVyZXIoXG4gICAgICAgICAgICAgICAgdGhpcy5hcHAsXG4gICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXIucmVzb2x2ZTxJQ2xhc3NMYXlvdXRSZXBvc2l0b3J5PignSUNsYXNzTGF5b3V0UmVwb3NpdG9yeScpLFxuICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLnJlc29sdmU8UHJvcGVydHlSZW5kZXJlcj4oJ1Byb3BlcnR5UmVuZGVyZXInKVxuICAgICAgICAgICAgKVxuICAgICAgICApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlc29sdmUgYSBkZXBlbmRlbmN5IGZyb20gdGhlIGNvbnRhaW5lclxuICAgICAqL1xuICAgIHB1YmxpYyByZXNvbHZlPFQ+KHRva2VuOiBzdHJpbmcpOiBUIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGFpbmVyLnJlc29sdmU8VD4odG9rZW4pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBzcGVjaWZpYyB1c2UgY2FzZXMgZm9yIGNvbW1vbiBvcGVyYXRpb25zXG4gICAgICovXG4gICAgcHVibGljIGdldENyZWF0ZUFzc2V0VXNlQ2FzZSgpOiBDcmVhdGVBc3NldFVzZUNhc2Uge1xuICAgICAgICByZXR1cm4gdGhpcy5yZXNvbHZlPENyZWF0ZUFzc2V0VXNlQ2FzZT4oJ0NyZWF0ZUFzc2V0VXNlQ2FzZScpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRSZW5kZXJCdXR0b25zVXNlQ2FzZSgpOiBSZW5kZXJDbGFzc0J1dHRvbnNVc2VDYXNlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVzb2x2ZTxSZW5kZXJDbGFzc0J1dHRvbnNVc2VDYXNlPignUmVuZGVyQ2xhc3NCdXR0b25zVXNlQ2FzZScpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRFeGVjdXRlQnV0dG9uQ29tbWFuZFVzZUNhc2UoKTogRXhlY3V0ZUJ1dHRvbkNvbW1hbmRVc2VDYXNlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVzb2x2ZTxFeGVjdXRlQnV0dG9uQ29tbWFuZFVzZUNhc2U+KCdFeGVjdXRlQnV0dG9uQ29tbWFuZFVzZUNhc2UnKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0QnV0dG9uUmVuZGVyZXIoKTogQnV0dG9uUmVuZGVyZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5yZXNvbHZlPEJ1dHRvblJlbmRlcmVyPignQnV0dG9uUmVuZGVyZXInKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0UHJvcGVydHlSZW5kZXJlcigpOiBQcm9wZXJ0eVJlbmRlcmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVzb2x2ZTxQcm9wZXJ0eVJlbmRlcmVyPignUHJvcGVydHlSZW5kZXJlcicpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRMYXlvdXRSZW5kZXJlcigpOiBMYXlvdXRSZW5kZXJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlc29sdmU8TGF5b3V0UmVuZGVyZXI+KCdMYXlvdXRSZW5kZXJlcicpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRQcm9wZXJ0eUVkaXRpbmdVc2VDYXNlKCk6IFByb3BlcnR5RWRpdGluZ1VzZUNhc2Uge1xuICAgICAgICByZXR1cm4gdGhpcy5yZXNvbHZlPFByb3BlcnR5RWRpdGluZ1VzZUNhc2U+KCdQcm9wZXJ0eUVkaXRpbmdVc2VDYXNlJyk7XG4gICAgfVxuXG4gICAgcHVibGljIGdldFF1ZXJ5VGVtcGxhdGVVc2VDYXNlKCk6IFF1ZXJ5VGVtcGxhdGVVc2VDYXNlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVzb2x2ZTxRdWVyeVRlbXBsYXRlVXNlQ2FzZT4oJ1F1ZXJ5VGVtcGxhdGVVc2VDYXNlJyk7XG4gICAgfVxuXG4gICAgcHVibGljIGdldFF1ZXJ5VGVtcGxhdGVSZXBvc2l0b3J5KCk6IElRdWVyeVRlbXBsYXRlUmVwb3NpdG9yeSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlc29sdmU8SVF1ZXJ5VGVtcGxhdGVSZXBvc2l0b3J5PignSVF1ZXJ5VGVtcGxhdGVSZXBvc2l0b3J5Jyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYW4gdXAgcmVzb3VyY2VzXG4gICAgICovXG4gICAgcHVibGljIGRpc3Bvc2UoKTogdm9pZCB7XG4gICAgICAgIC8vIENsZWFuIHVwIGFueSByZXNvdXJjZXMgaWYgbmVlZGVkXG4gICAgICAgIHRoaXMuY29udGFpbmVyLmNsZWFyKCk7XG4gICAgfVxufSJdLCJ2ZXJzaW9uIjozfQ==