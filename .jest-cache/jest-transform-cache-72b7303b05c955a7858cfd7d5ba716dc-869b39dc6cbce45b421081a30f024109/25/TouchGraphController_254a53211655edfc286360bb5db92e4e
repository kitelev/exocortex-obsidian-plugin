b1c0d7a1bd4b7b6b3c7599ae2d32ce5d
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createTouchGraphController = exports.TouchGraphController = void 0;
const PlatformDetector_1 = require("../../infrastructure/utils/PlatformDetector");
/**
 * Touch controller for graph visualizations with iOS-optimized gestures
 * Implements pinch-to-zoom, pan, tap, and long-press interactions
 */
class TouchGraphController {
    constructor(element, config = {}, callbacks = {}) {
        this.defaultConfig = {
            enablePinchZoom: true,
            enablePanGesture: true,
            enableTapGestures: true,
            enableLongPress: true,
            zoomSensitivity: 1.0,
            panSensitivity: 1.0,
            minZoom: 0.1,
            maxZoom: 5.0,
            doubleTapZoomFactor: 2.0,
            longPressDuration: 500,
            momentumDecay: 0.95,
            bounceBack: true,
        };
        this.element = element;
        this.config = { ...this.defaultConfig, ...config };
        this.callbacks = callbacks;
        this.gestureState = this.createInitialGestureState();
        this.initializeHapticFeedback();
        this.attachEventListeners();
        this.setupElementStyles();
    }
    /**
     * Create initial gesture state
     */
    createInitialGestureState() {
        return {
            isActive: false,
            type: "none",
            startTime: 0,
            touches: new Map(),
            tapCount: 0,
            lastTapTime: 0,
        };
    }
    /**
     * Initialize haptic feedback for iOS
     */
    initializeHapticFeedback() {
        if (PlatformDetector_1.PlatformDetector.isIOS() && "vibrate" in navigator) {
            this.hapticFeedback = {
                light: () => navigator.vibrate?.(10),
                medium: () => navigator.vibrate?.(20),
                heavy: () => navigator.vibrate?.(30),
                selection: () => navigator.vibrate?.(5),
            };
        }
    }
    /**
     * Setup element styles for touch interaction
     */
    setupElementStyles() {
        this.element.style.touchAction = "none";
        this.element.style.userSelect = "none";
        this.element.style.webkitUserSelect = "none";
        this.element.style.cursor = "grab";
    }
    /**
     * Attach touch and pointer event listeners
     */
    attachEventListeners() {
        // Touch events (primary for mobile)
        this.element.addEventListener("touchstart", this.handleTouchStart.bind(this), { passive: false });
        this.element.addEventListener("touchmove", this.handleTouchMove.bind(this), { passive: false });
        this.element.addEventListener("touchend", this.handleTouchEnd.bind(this), {
            passive: false,
        });
        this.element.addEventListener("touchcancel", this.handleTouchCancel.bind(this), { passive: false });
        // Pointer events (for hybrid devices)
        if ("PointerEvent" in window) {
            this.element.addEventListener("pointerdown", this.handlePointerDown.bind(this));
            this.element.addEventListener("pointermove", this.handlePointerMove.bind(this));
            this.element.addEventListener("pointerup", this.handlePointerUp.bind(this));
            this.element.addEventListener("pointercancel", this.handlePointerCancel.bind(this));
        }
        // Mouse events (fallback for desktop)
        if (!PlatformDetector_1.PlatformDetector.hasTouch()) {
            this.element.addEventListener("mousedown", this.handleMouseDown.bind(this));
            this.element.addEventListener("mousemove", this.handleMouseMove.bind(this));
            this.element.addEventListener("mouseup", this.handleMouseUp.bind(this));
            this.element.addEventListener("wheel", this.handleWheel.bind(this), {
                passive: false,
            });
        }
        // Prevent context menu on long press
        this.element.addEventListener("contextmenu", (e) => {
            if (PlatformDetector_1.PlatformDetector.hasTouch()) {
                e.preventDefault();
            }
        });
    }
    /**
     * Handle touch start event
     */
    handleTouchStart(event) {
        event.preventDefault();
        const touches = Array.from(event.touches);
        const currentTime = Date.now();
        // Update touch tracking
        touches.forEach((touch) => {
            this.gestureState.touches.set(touch.identifier, {
                id: touch.identifier,
                x: touch.clientX,
                y: touch.clientY,
                timestamp: currentTime,
            });
        });
        if (touches.length === 1) {
            this.handleSingleTouchStart(touches[0], currentTime);
        }
        else if (touches.length === 2) {
            this.handlePinchStart(touches, currentTime);
        }
    }
    /**
     * Handle single touch start (tap, pan, long press)
     */
    handleSingleTouchStart(touch, timestamp) {
        const rect = this.element.getBoundingClientRect();
        const x = touch.clientX - rect.left;
        const y = touch.clientY - rect.top;
        // Check for double tap
        if (this.config.enableTapGestures) {
            const timeSinceLastTap = timestamp - this.gestureState.lastTapTime;
            if (timeSinceLastTap < 300) {
                this.gestureState.tapCount++;
                if (this.gestureState.tapCount === 2) {
                    this.handleDoubleTap(x, y);
                    this.resetTapState();
                    return;
                }
            }
            else {
                this.gestureState.tapCount = 1;
            }
            this.gestureState.lastTapTime = timestamp;
        }
        // Setup for potential pan gesture
        if (this.config.enablePanGesture) {
            this.gestureState.lastPanPosition = { x, y };
            this.gestureState.panVelocity = { x: 0, y: 0 };
        }
        // Setup long press timer
        if (this.config.enableLongPress) {
            this.gestureState.longPressTimer = window.setTimeout(() => {
                if (this.gestureState.touches.size === 1 &&
                    !this.gestureState.isActive) {
                    this.handleLongPress(x, y);
                }
            }, this.config.longPressDuration);
        }
        this.gestureState.startTime = timestamp;
    }
    /**
     * Handle pinch gesture start
     */
    handlePinchStart(touches, timestamp) {
        if (!this.config.enablePinchZoom)
            return;
        this.clearLongPressTimer();
        this.resetTapState();
        const distance = this.calculateDistance(touches[0], touches[1]);
        const center = this.calculateCenter(touches[0], touches[1]);
        this.gestureState.isActive = true;
        this.gestureState.type = "pinch";
        this.gestureState.initialDistance = distance;
        this.gestureState.initialCenter = center;
        this.gestureState.startTime = timestamp;
        this.triggerHaptic("light");
        this.callbacks.onPinchStart?.(1.0);
    }
    /**
     * Handle touch move event
     */
    handleTouchMove(event) {
        event.preventDefault();
        const touches = Array.from(event.touches);
        const currentTime = Date.now();
        // Update touch positions
        touches.forEach((touch) => {
            const existing = this.gestureState.touches.get(touch.identifier);
            if (existing) {
                existing.x = touch.clientX;
                existing.y = touch.clientY;
                existing.timestamp = currentTime;
            }
        });
        if (touches.length === 1) {
            this.handleSingleTouchMove(touches[0], currentTime);
        }
        else if (touches.length === 2 && this.gestureState.type === "pinch") {
            this.handlePinchMove(touches, currentTime);
        }
    }
    /**
     * Handle single touch move (pan gesture)
     */
    handleSingleTouchMove(touch, timestamp) {
        if (!this.config.enablePanGesture || !this.gestureState.lastPanPosition)
            return;
        const rect = this.element.getBoundingClientRect();
        const x = touch.clientX - rect.left;
        const y = touch.clientY - rect.top;
        const deltaX = (x - this.gestureState.lastPanPosition.x) * this.config.panSensitivity;
        const deltaY = (y - this.gestureState.lastPanPosition.y) * this.config.panSensitivity;
        // Start pan gesture if moved enough
        if (!this.gestureState.isActive &&
            (Math.abs(deltaX) > 5 || Math.abs(deltaY) > 5)) {
            this.gestureState.isActive = true;
            this.gestureState.type = "pan";
            this.clearLongPressTimer();
            this.resetTapState();
            this.element.style.cursor = "grabbing";
            this.callbacks.onPanStart?.(x, y);
        }
        if (this.gestureState.type === "pan") {
            // Update velocity for momentum
            const timeDelta = timestamp - this.gestureState.startTime;
            if (timeDelta > 0) {
                this.gestureState.panVelocity = {
                    x: (deltaX / timeDelta) * 1000,
                    y: (deltaY / timeDelta) * 1000,
                };
            }
            this.callbacks.onPanMove?.(deltaX, deltaY);
        }
        this.gestureState.lastPanPosition = { x, y };
    }
    /**
     * Handle pinch gesture move
     */
    handlePinchMove(touches, timestamp) {
        if (!this.config.enablePinchZoom ||
            !this.gestureState.initialDistance ||
            !this.gestureState.initialCenter) {
            return;
        }
        const distance = this.calculateDistance(touches[0], touches[1]);
        const center = this.calculateCenter(touches[0], touches[1]);
        let scale = distance / this.gestureState.initialDistance;
        scale *= this.config.zoomSensitivity;
        // Apply zoom constraints
        scale = Math.max(this.config.minZoom, Math.min(this.config.maxZoom, scale));
        const rect = this.element.getBoundingClientRect();
        const centerX = center.x - rect.left;
        const centerY = center.y - rect.top;
        this.callbacks.onPinchMove?.(scale, centerX, centerY);
    }
    /**
     * Handle touch end event
     */
    handleTouchEnd(event) {
        event.preventDefault();
        const currentTime = Date.now();
        const remainingTouches = Array.from(event.touches);
        // Remove ended touches
        Array.from(event.changedTouches).forEach((touch) => {
            this.gestureState.touches.delete(touch.identifier);
        });
        if (remainingTouches.length === 0) {
            this.handleAllTouchesEnd(currentTime);
        }
        else if (remainingTouches.length === 1 &&
            this.gestureState.type === "pinch") {
            // Transition from pinch to pan
            this.handlePinchToPanTransition(remainingTouches[0], currentTime);
        }
    }
    /**
     * Handle all touches ending
     */
    handleAllTouchesEnd(timestamp) {
        this.clearLongPressTimer();
        this.element.style.cursor = "grab";
        if (this.gestureState.type === "pan") {
            const velocity = this.gestureState.panVelocity;
            this.callbacks.onPanEnd?.(velocity?.x || 0, velocity?.y || 0);
            // Apply momentum scrolling
            if (velocity &&
                (Math.abs(velocity.x) > 100 || Math.abs(velocity.y) > 100)) {
                this.startMomentumAnimation(velocity);
            }
        }
        else if (this.gestureState.type === "pinch") {
            this.callbacks.onPinchEnd?.(1.0);
        }
        else if (this.gestureState.tapCount === 1 &&
            !this.gestureState.isActive) {
            // Single tap
            setTimeout(() => {
                if (this.gestureState.tapCount === 1) {
                    const touch = this.gestureState.touches.values().next().value;
                    if (touch) {
                        const rect = this.element.getBoundingClientRect();
                        this.callbacks.onTap?.(touch.x - rect.left, touch.y - rect.top);
                    }
                    this.resetTapState();
                }
            }, 300);
        }
        this.resetGestureState();
    }
    /**
     * Handle transition from pinch to pan
     */
    handlePinchToPanTransition(touch, timestamp) {
        this.callbacks.onPinchEnd?.(1.0);
        // Reset for pan gesture
        const rect = this.element.getBoundingClientRect();
        this.gestureState.type = "pan";
        this.gestureState.lastPanPosition = {
            x: touch.clientX - rect.left,
            y: touch.clientY - rect.top,
        };
        this.gestureState.panVelocity = { x: 0, y: 0 };
        this.callbacks.onPanStart?.(this.gestureState.lastPanPosition.x, this.gestureState.lastPanPosition.y);
    }
    /**
     * Handle touch cancel event
     */
    handleTouchCancel(event) {
        this.handleTouchEnd(event);
    }
    /**
     * Handle double tap gesture
     */
    handleDoubleTap(x, y) {
        this.triggerHaptic("medium");
        this.callbacks.onDoubleTap?.(x, y);
    }
    /**
     * Handle long press gesture
     */
    handleLongPress(x, y) {
        this.triggerHaptic("heavy");
        this.callbacks.onLongPress?.(x, y);
    }
    /**
     * Start momentum animation for smooth scrolling
     */
    startMomentumAnimation(velocity) {
        this.cancelMomentumAnimation();
        let currentVelocity = { ...velocity };
        const animate = () => {
            // Apply momentum step
            this.callbacks.onPanMove?.(currentVelocity.x / 60, // 60fps
            currentVelocity.y / 60);
            // Decay velocity
            currentVelocity.x *= this.config.momentumDecay;
            currentVelocity.y *= this.config.momentumDecay;
            // Continue if velocity is significant
            if (Math.abs(currentVelocity.x) > 1 || Math.abs(currentVelocity.y) > 1) {
                this.momentumAnimation = requestAnimationFrame(animate);
            }
        };
        this.momentumAnimation = requestAnimationFrame(animate);
    }
    /**
     * Cancel momentum animation
     */
    cancelMomentumAnimation() {
        if (this.momentumAnimation) {
            cancelAnimationFrame(this.momentumAnimation);
            this.momentumAnimation = undefined;
        }
    }
    /**
     * Calculate distance between two touches
     */
    calculateDistance(touch1, touch2) {
        const dx = touch2.clientX - touch1.clientX;
        const dy = touch2.clientY - touch1.clientY;
        return Math.sqrt(dx * dx + dy * dy);
    }
    /**
     * Calculate center point between two touches
     */
    calculateCenter(touch1, touch2) {
        return {
            x: (touch1.clientX + touch2.clientX) / 2,
            y: (touch1.clientY + touch2.clientY) / 2,
        };
    }
    /**
     * Clear long press timer
     */
    clearLongPressTimer() {
        if (this.gestureState.longPressTimer) {
            clearTimeout(this.gestureState.longPressTimer);
            this.gestureState.longPressTimer = undefined;
        }
    }
    /**
     * Reset tap state
     */
    resetTapState() {
        this.gestureState.tapCount = 0;
        this.gestureState.lastTapTime = 0;
    }
    /**
     * Reset gesture state
     */
    resetGestureState() {
        this.gestureState.isActive = false;
        this.gestureState.type = "none";
        this.gestureState.touches.clear();
        this.gestureState.initialDistance = undefined;
        this.gestureState.initialCenter = undefined;
        this.gestureState.lastPanPosition = undefined;
        this.gestureState.panVelocity = undefined;
    }
    /**
     * Trigger haptic feedback
     */
    triggerHaptic(type) {
        if (this.hapticFeedback && this.hapticFeedback[type]) {
            this.hapticFeedback[type]();
        }
    }
    /**
     * Pointer event handlers (for hybrid devices)
     */
    handlePointerDown(event) {
        if (event.pointerType === "touch") {
            // Convert to touch-like handling
            const fakeTouch = this.createFakeTouchEvent("touchstart", [event]);
            this.handleTouchStart(fakeTouch);
        }
    }
    handlePointerMove(event) {
        if (event.pointerType === "touch") {
            const fakeTouch = this.createFakeTouchEvent("touchmove", [event]);
            this.handleTouchMove(fakeTouch);
        }
    }
    handlePointerUp(event) {
        if (event.pointerType === "touch") {
            const fakeTouch = this.createFakeTouchEvent("touchend", [event]);
            this.handleTouchEnd(fakeTouch);
        }
    }
    handlePointerCancel(event) {
        if (event.pointerType === "touch") {
            const fakeTouch = this.createFakeTouchEvent("touchcancel", [event]);
            this.handleTouchCancel(fakeTouch);
        }
    }
    /**
     * Mouse event handlers (fallback for desktop)
     */
    handleMouseDown(event) {
        if (event.button === 0) {
            // Left mouse button
            const fakeTouch = this.createFakeTouchEvent("touchstart", [event]);
            this.handleTouchStart(fakeTouch);
        }
    }
    handleMouseMove(event) {
        if (this.gestureState.isActive) {
            const fakeTouch = this.createFakeTouchEvent("touchmove", [event]);
            this.handleTouchMove(fakeTouch);
        }
    }
    handleMouseUp(event) {
        if (this.gestureState.isActive) {
            const fakeTouch = this.createFakeTouchEvent("touchend", [event]);
            this.handleTouchEnd(fakeTouch);
        }
    }
    handleWheel(event) {
        if (!this.config.enablePinchZoom)
            return;
        event.preventDefault();
        const rect = this.element.getBoundingClientRect();
        const centerX = event.clientX - rect.left;
        const centerY = event.clientY - rect.top;
        const scale = event.deltaY > 0 ? 0.9 : 1.1;
        this.callbacks.onPinchStart?.(1.0);
        this.callbacks.onPinchMove?.(scale, centerX, centerY);
        this.callbacks.onPinchEnd?.(scale);
    }
    /**
     * Create fake touch event from mouse/pointer event
     */
    createFakeTouchEvent(type, events) {
        const touches = events.map((event, index) => ({
            identifier: event.pointerId || 0,
            clientX: event.clientX,
            clientY: event.clientY,
            pageX: event.pageX,
            pageY: event.pageY,
            screenX: event.screenX,
            screenY: event.screenY,
            target: event.target,
        }));
        return {
            type,
            touches,
            changedTouches: touches,
            targetTouches: touches,
            preventDefault: () => { },
            stopPropagation: () => { },
        };
    }
    /**
     * Update configuration
     */
    updateConfig(newConfig) {
        this.config = { ...this.config, ...newConfig };
    }
    /**
     * Update callbacks
     */
    updateCallbacks(newCallbacks) {
        this.callbacks = { ...this.callbacks, ...newCallbacks };
    }
    /**
     * Enable/disable gestures
     */
    setEnabled(enabled) {
        if (enabled) {
            this.element.style.pointerEvents = "";
            this.element.style.touchAction = "none";
        }
        else {
            this.element.style.pointerEvents = "none";
            this.element.style.touchAction = "auto";
            this.resetGestureState();
            this.cancelMomentumAnimation();
        }
    }
    /**
     * Get current gesture state
     */
    getGestureState() {
        return this.gestureState;
    }
    /**
     * Destroy controller and cleanup
     */
    destroy() {
        this.cancelMomentumAnimation();
        this.clearLongPressTimer();
        this.resetGestureState();
        // Remove all event listeners
        this.element.removeEventListener("touchstart", this.handleTouchStart.bind(this));
        this.element.removeEventListener("touchmove", this.handleTouchMove.bind(this));
        this.element.removeEventListener("touchend", this.handleTouchEnd.bind(this));
        this.element.removeEventListener("touchcancel", this.handleTouchCancel.bind(this));
        if ("PointerEvent" in window) {
            this.element.removeEventListener("pointerdown", this.handlePointerDown.bind(this));
            this.element.removeEventListener("pointermove", this.handlePointerMove.bind(this));
            this.element.removeEventListener("pointerup", this.handlePointerUp.bind(this));
            this.element.removeEventListener("pointercancel", this.handlePointerCancel.bind(this));
        }
        this.element.removeEventListener("mousedown", this.handleMouseDown.bind(this));
        this.element.removeEventListener("mousemove", this.handleMouseMove.bind(this));
        this.element.removeEventListener("mouseup", this.handleMouseUp.bind(this));
        this.element.removeEventListener("wheel", this.handleWheel.bind(this));
        // Restore element styles
        this.element.style.touchAction = "";
        this.element.style.userSelect = "";
        this.element.style.webkitUserSelect = "";
        this.element.style.cursor = "";
    }
}
exports.TouchGraphController = TouchGraphController;
/**
 * Factory function to create touch controller for VisualQueryCanvas
 */
function createTouchGraphController(canvas, element, config = {}) {
    const callbacks = {
        onTap: (x, y) => {
            // Handle node selection on tap
            console.log("Graph tap at:", x, y);
        },
        onDoubleTap: (x, y) => {
            // Zoom to fit or zoom to point
            if (canvas.zoomToFit) {
                canvas.zoomToFit();
            }
        },
        onLongPress: (x, y) => {
            // Show context menu or node creation
            console.log("Graph long press at:", x, y);
        },
        onPinchMove: (scale, centerX, centerY) => {
            // Apply zoom with scale and center
            const currentState = canvas.getCurrentCanvasState?.();
            if (currentState) {
                const newZoom = Math.max(0.1, Math.min(5.0, currentState.viewport.zoom * scale));
                // Apply zoom transformation
                console.log("Applying zoom:", newZoom, "at center:", centerX, centerY);
            }
        },
        onPanMove: (deltaX, deltaY) => {
            // Apply pan transformation
            const currentState = canvas.getCurrentCanvasState?.();
            if (currentState) {
                // Update viewport position
                console.log("Applying pan:", deltaX, deltaY);
            }
        },
    };
    return new TouchGraphController(element, config, callbacks);
}
exports.createTouchGraphController = createTouchGraphController;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2tpdGVsZXYvRG9jdW1lbnRzL2V4b2NvcnRleC1vYnNpZGlhbi1wbHVnaW4vc3JjL3ByZXNlbnRhdGlvbi9tb2JpbGUvVG91Y2hHcmFwaENvbnRyb2xsZXIudHMiLCJtYXBwaW5ncyI6Ijs7O0FBQUEsa0ZBQStFO0FBaUUvRTs7O0dBR0c7QUFDSCxNQUFhLG9CQUFvQjtJQXVCL0IsWUFDRSxPQUFvQixFQUNwQixTQUE2QixFQUFFLEVBQy9CLFlBQW1DLEVBQUU7UUFsQnRCLGtCQUFhLEdBQWlDO1lBQzdELGVBQWUsRUFBRSxJQUFJO1lBQ3JCLGdCQUFnQixFQUFFLElBQUk7WUFDdEIsaUJBQWlCLEVBQUUsSUFBSTtZQUN2QixlQUFlLEVBQUUsSUFBSTtZQUNyQixlQUFlLEVBQUUsR0FBRztZQUNwQixjQUFjLEVBQUUsR0FBRztZQUNuQixPQUFPLEVBQUUsR0FBRztZQUNaLE9BQU8sRUFBRSxHQUFHO1lBQ1osbUJBQW1CLEVBQUUsR0FBRztZQUN4QixpQkFBaUIsRUFBRSxHQUFHO1lBQ3RCLGFBQWEsRUFBRSxJQUFJO1lBQ25CLFVBQVUsRUFBRSxJQUFJO1NBQ2pCLENBQUM7UUFPQSxJQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztRQUN2QixJQUFJLENBQUMsTUFBTSxHQUFHLEVBQUUsR0FBRyxJQUFJLENBQUMsYUFBYSxFQUFFLEdBQUcsTUFBTSxFQUFFLENBQUM7UUFDbkQsSUFBSSxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUM7UUFFM0IsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMseUJBQXlCLEVBQUUsQ0FBQztRQUVyRCxJQUFJLENBQUMsd0JBQXdCLEVBQUUsQ0FBQztRQUNoQyxJQUFJLENBQUMsb0JBQW9CLEVBQUUsQ0FBQztRQUM1QixJQUFJLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztJQUM1QixDQUFDO0lBRUQ7O09BRUc7SUFDSyx5QkFBeUI7UUFDL0IsT0FBTztZQUNMLFFBQVEsRUFBRSxLQUFLO1lBQ2YsSUFBSSxFQUFFLE1BQU07WUFDWixTQUFT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LEVBQUUsWUFBWSxFQUFFLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQzthQUN4RTtRQUNILENBQUM7UUFFRCxTQUFTLEVBQUUsQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLEVBQUU7WUFDNUIsMkJBQTJCO1lBQzNCLE1BQU0sWUFBWSxHQUFJLE1BQWMsQ0FBQyxxQkFBcUIsRUFBRSxFQUFFLENBQUM7WUFDL0QsSUFBSSxZQUFZLEVBQUU7Z0JBQ2hCLDJCQUEyQjtnQkFDM0IsT0FBTyxDQUFDLEdBQUcsQ0FBQyxlQUFlLEVBQUUsTUFBTSxFQUFFLE1BQU0sQ0FBQyxDQUFDO2FBQzlDO1FBQ0gsQ0FBQztLQUNGLENBQUM7SUFFRixPQUFPLElBQUksb0JBQW9CLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxTQUFTLENBQUMsQ0FBQztBQUM5RCxDQUFDO0FBL0NELGdFQStDQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMva2l0ZWxldi9Eb2N1bWVudHMvZXhvY29ydGV4LW9ic2lkaWFuLXBsdWdpbi9zcmMvcHJlc2VudGF0aW9uL21vYmlsZS9Ub3VjaEdyYXBoQ29udHJvbGxlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQbGF0Zm9ybURldGVjdG9yIH0gZnJvbSBcIi4uLy4uL2luZnJhc3RydWN0dXJlL3V0aWxzL1BsYXRmb3JtRGV0ZWN0b3JcIjtcbmltcG9ydCB7IFZpc3VhbFF1ZXJ5Q2FudmFzIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvVmlzdWFsUXVlcnlDYW52YXNcIjtcblxuLyoqXG4gKiBUb3VjaCBnZXN0dXJlIGNvbmZpZ3VyYXRpb25cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBUb3VjaEdlc3R1cmVDb25maWcge1xuICBlbmFibGVQaW5jaFpvb20/OiBib29sZWFuO1xuICBlbmFibGVQYW5HZXN0dXJlPzogYm9vbGVhbjtcbiAgZW5hYmxlVGFwR2VzdHVyZXM/OiBib29sZWFuO1xuICBlbmFibGVMb25nUHJlc3M/OiBib29sZWFuO1xuICB6b29tU2Vuc2l0aXZpdHk/OiBudW1iZXI7XG4gIHBhblNlbnNpdGl2aXR5PzogbnVtYmVyO1xuICBtaW5ab29tPzogbnVtYmVyO1xuICBtYXhab29tPzogbnVtYmVyO1xuICBkb3VibGVUYXBab29tRmFjdG9yPzogbnVtYmVyO1xuICBsb25nUHJlc3NEdXJhdGlvbj86IG51bWJlcjtcbiAgbW9tZW50dW1EZWNheT86IG51bWJlcjtcbiAgYm91bmNlQmFjaz86IGJvb2xlYW47XG59XG5cbi8qKlxuICogVG91Y2ggZ2VzdHVyZSBjYWxsYmFja3NcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBUb3VjaEdlc3R1cmVDYWxsYmFja3Mge1xuICBvblRhcD86ICh4OiBudW1iZXIsIHk6IG51bWJlcikgPT4gdm9pZDtcbiAgb25Eb3VibGVUYXA/OiAoeDogbnVtYmVyLCB5OiBudW1iZXIpID0+IHZvaWQ7XG4gIG9uTG9uZ1ByZXNzPzogKHg6IG51bWJlciwgeTogbnVtYmVyKSA9PiB2b2lkO1xuICBvblBpbmNoU3RhcnQ/OiAoc2NhbGU6IG51bWJlcikgPT4gdm9pZDtcbiAgb25QaW5jaE1vdmU/OiAoc2NhbGU6IG51bWJlciwgY2VudGVyWDogbnVtYmVyLCBjZW50ZXJZOiBudW1iZXIpID0+IHZvaWQ7XG4gIG9uUGluY2hFbmQ/OiAoc2NhbGU6IG51bWJlcikgPT4gdm9pZDtcbiAgb25QYW5TdGFydD86ICh4OiBudW1iZXIsIHk6IG51bWJlcikgPT4gdm9pZDtcbiAgb25QYW5Nb3ZlPzogKGRlbHRhWDogbnVtYmVyLCBkZWx0YVk6IG51bWJlcikgPT4gdm9pZDtcbiAgb25QYW5FbmQ/OiAodmVsb2NpdHlYOiBudW1iZXIsIHZlbG9jaXR5WTogbnVtYmVyKSA9PiB2b2lkO1xuICBvblpvb21DaGFuZ2U/OiAoem9vbTogbnVtYmVyKSA9PiB2b2lkO1xufVxuXG4vKipcbiAqIFRvdWNoIHBvaW50IGRhdGFcbiAqL1xuaW50ZXJmYWNlIFRvdWNoUG9pbnQge1xuICBpZDogbnVtYmVyO1xuICB4OiBudW1iZXI7XG4gIHk6IG51bWJlcjtcbiAgdGltZXN0YW1wOiBudW1iZXI7XG59XG5cbi8qKlxuICogR2VzdHVyZSBzdGF0ZVxuICovXG5pbnRlcmZhY2UgR2VzdHVyZVN0YXRlIHtcbiAgaXNBY3RpdmU6IGJvb2xlYW47XG4gIHR5cGU6IFwibm9uZVwiIHwgXCJwYW5cIiB8IFwicGluY2hcIiB8IFwidGFwXCIgfCBcImxvbmdwcmVzc1wiO1xuICBzdGFydFRpbWU6IG51bWJlcjtcbiAgdG91Y2hlczogTWFwPG51bWJlciwgVG91Y2hQb2ludD47XG4gIGluaXRpYWxEaXN0YW5jZT86IG51bWJlcjtcbiAgaW5pdGlhbENlbnRlcj86IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfTtcbiAgaW5pdGlhbFpvb20/OiBudW1iZXI7XG4gIGxhc3RQYW5Qb3NpdGlvbj86IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfTtcbiAgcGFuVmVsb2NpdHk/OiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH07XG4gIHRhcENvdW50OiBudW1iZXI7XG4gIGxhc3RUYXBUaW1lOiBudW1iZXI7XG4gIGxvbmdQcmVzc1RpbWVyPzogbnVtYmVyO1xufVxuXG4vKipcbiAqIFRvdWNoIGNvbnRyb2xsZXIgZm9yIGdyYXBoIHZpc3VhbGl6YXRpb25zIHdpdGggaU9TLW9wdGltaXplZCBnZXN0dXJlc1xuICogSW1wbGVtZW50cyBwaW5jaC10by16b29tLCBwYW4sIHRhcCwgYW5kIGxvbmctcHJlc3MgaW50ZXJhY3Rpb25zXG4gKi9cbmV4cG9ydCBjbGFzcyBUb3VjaEdyYXBoQ29udHJvbGxlciB7XG4gIHByaXZhdGUgZWxlbWVudDogSFRNTEVsZW1lbnQ7XG4gIHByaXZhdGUgY29uZmlnOiBSZXF1aXJlZDxUb3VjaEdlc3R1cmVDb25maWc+O1xuICBwcml2YXRlIGNhbGxiYWNrczogVG91Y2hHZXN0dXJlQ2FsbGJhY2tzO1xuICBwcml2YXRlIGdlc3R1cmVTdGF0ZTogR2VzdHVyZVN0YXRlO1xuICBwcml2YXRlIG1vbWVudHVtQW5pbWF0aW9uPzogbnVtYmVyO1xuICBwcml2YXRlIGhhcHRpY0ZlZWRiYWNrPzogYW55O1xuXG4gIHByaXZhdGUgcmVhZG9ubHkgZGVmYXVsdENvbmZpZzogUmVxdWlyZWQ8VG91Y2hHZXN0dXJlQ29uZmlnPiA9IHtcbiAgICBlbmFibGVQaW5jaFpvb206IHRydWUsXG4gICAgZW5hYmxlUGFuR2VzdHVyZTogdHJ1ZSxcbiAgICBlbmFibGVUYXBHZXN0dXJlczogdHJ1ZSxcbiAgICBlbmFibGVMb25nUHJlc3M6IHRydWUsXG4gICAgem9vbVNlbnNpdGl2aXR5OiAxLjAsXG4gICAgcGFuU2Vuc2l0aXZpdHk6IDEuMCxcbiAgICBtaW5ab29tOiAwLjEsXG4gICAgbWF4Wm9vbTogNS4wLFxuICAgIGRvdWJsZVRhcFpvb21GYWN0b3I6IDIuMCxcbiAgICBsb25nUHJlc3NEdXJhdGlvbjogNTAwLFxuICAgIG1vbWVudHVtRGVjYXk6IDAuOTUsXG4gICAgYm91bmNlQmFjazogdHJ1ZSxcbiAgfTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBlbGVtZW50OiBIVE1MRWxlbWVudCxcbiAgICBjb25maWc6IFRvdWNoR2VzdHVyZUNvbmZpZyA9IHt9LFxuICAgIGNhbGxiYWNrczogVG91Y2hHZXN0dXJlQ2FsbGJhY2tzID0ge30sXG4gICkge1xuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgdGhpcy5jb25maWcgPSB7IC4uLnRoaXMuZGVmYXVsdENvbmZpZywgLi4uY29uZmlnIH07XG4gICAgdGhpcy5jYWxsYmFja3MgPSBjYWxsYmFja3M7XG5cbiAgICB0aGlzLmdlc3R1cmVTdGF0ZSA9IHRoaXMuY3JlYXRlSW5pdGlhbEdlc3R1cmVTdGF0ZSgpO1xuXG4gICAgdGhpcy5pbml0aWFsaXplSGFwdGljRmVlZGJhY2soKTtcbiAgICB0aGlzLmF0dGFjaEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5zZXR1cEVsZW1lbnRTdHlsZXMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgaW5pdGlhbCBnZXN0dXJlIHN0YXRlXG4gICAqL1xuICBwcml2YXRlIGNyZWF0ZUluaXRpYWxHZXN0dXJlU3RhdGUoKTogR2VzdHVyZVN0YXRlIHtcbiAgICByZXR1cm4ge1xuICAgICAgaXNBY3RpdmU6IGZhbHNlLFxuICAgICAgdHlwZTogXCJub25lXCIsXG4gICAgICBzdGFydFRpbWU6IDAsXG4gICAgICB0b3VjaGVzOiBuZXcgTWFwKCksXG4gICAgICB0YXBDb3VudDogMCxcbiAgICAgIGxhc3RUYXBUaW1lOiAwLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogSW5pdGlhbGl6ZSBoYXB0aWMgZmVlZGJhY2sgZm9yIGlPU1xuICAgKi9cbiAgcHJpdmF0ZSBpbml0aWFsaXplSGFwdGljRmVlZGJhY2soKTogdm9pZCB7XG4gICAgaWYgKFBsYXRmb3JtRGV0ZWN0b3IuaXNJT1MoKSAmJiBcInZpYnJhdGVcIiBpbiBuYXZpZ2F0b3IpIHtcbiAgICAgIHRoaXMuaGFwdGljRmVlZGJhY2sgPSB7XG4gICAgICAgIGxpZ2h0OiAoKSA9PiBuYXZpZ2F0b3IudmlicmF0ZT8uKDEwKSxcbiAgICAgICAgbWVkaXVtOiAoKSA9PiBuYXZpZ2F0b3IudmlicmF0ZT8uKDIwKSxcbiAgICAgICAgaGVhdnk6ICgpID0+IG5hdmlnYXRvci52aWJyYXRlPy4oMzApLFxuICAgICAgICBzZWxlY3Rpb246ICgpID0+IG5hdmlnYXRvci52aWJyYXRlPy4oNSksXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTZXR1cCBlbGVtZW50IHN0eWxlcyBmb3IgdG91Y2ggaW50ZXJhY3Rpb25cbiAgICovXG4gIHByaXZhdGUgc2V0dXBFbGVtZW50U3R5bGVzKCk6IHZvaWQge1xuICAgIHRoaXMuZWxlbWVudC5zdHlsZS50b3VjaEFjdGlvbiA9IFwibm9uZVwiO1xuICAgIHRoaXMuZWxlbWVudC5zdHlsZS51c2VyU2VsZWN0ID0gXCJub25lXCI7XG4gICAgdGhpcy5lbGVtZW50LnN0eWxlLndlYmtpdFVzZXJTZWxlY3QgPSBcIm5vbmVcIjtcbiAgICB0aGlzLmVsZW1lbnQuc3R5bGUuY3Vyc29yID0gXCJncmFiXCI7XG4gIH1cblxuICAvKipcbiAgICogQXR0YWNoIHRvdWNoIGFuZCBwb2ludGVyIGV2ZW50IGxpc3RlbmVyc1xuICAgKi9cbiAgcHJpdmF0ZSBhdHRhY2hFdmVudExpc3RlbmVycygpOiB2b2lkIHtcbiAgICAvLyBUb3VjaCBldmVudHMgKHByaW1hcnkgZm9yIG1vYmlsZSlcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgIFwidG91Y2hzdGFydFwiLFxuICAgICAgdGhpcy5oYW5kbGVUb3VjaFN0YXJ0LmJpbmQodGhpcyksXG4gICAgICB7IHBhc3NpdmU6IGZhbHNlIH0sXG4gICAgKTtcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgIFwidG91Y2htb3ZlXCIsXG4gICAgICB0aGlzLmhhbmRsZVRvdWNoTW92ZS5iaW5kKHRoaXMpLFxuICAgICAgeyBwYXNzaXZlOiBmYWxzZSB9LFxuICAgICk7XG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCB0aGlzLmhhbmRsZVRvdWNoRW5kLmJpbmQodGhpcyksIHtcbiAgICAgIHBhc3NpdmU6IGZhbHNlLFxuICAgIH0pO1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgXCJ0b3VjaGNhbmNlbFwiLFxuICAgICAgdGhpcy5oYW5kbGVUb3VjaENhbmNlbC5iaW5kKHRoaXMpLFxuICAgICAgeyBwYXNzaXZlOiBmYWxzZSB9LFxuICAgICk7XG5cbiAgICAvLyBQb2ludGVyIGV2ZW50cyAoZm9yIGh5YnJpZCBkZXZpY2VzKVxuICAgIGlmIChcIlBvaW50ZXJFdmVudFwiIGluIHdpbmRvdykge1xuICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgIFwicG9pbnRlcmRvd25cIixcbiAgICAgICAgdGhpcy5oYW5kbGVQb2ludGVyRG93bi5iaW5kKHRoaXMpLFxuICAgICAgKTtcbiAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICBcInBvaW50ZXJtb3ZlXCIsXG4gICAgICAgIHRoaXMuaGFuZGxlUG9pbnRlck1vdmUuYmluZCh0aGlzKSxcbiAgICAgICk7XG4gICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgXCJwb2ludGVydXBcIixcbiAgICAgICAgdGhpcy5oYW5kbGVQb2ludGVyVXAuYmluZCh0aGlzKSxcbiAgICAgICk7XG4gICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgXCJwb2ludGVyY2FuY2VsXCIsXG4gICAgICAgIHRoaXMuaGFuZGxlUG9pbnRlckNhbmNlbC5iaW5kKHRoaXMpLFxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBNb3VzZSBldmVudHMgKGZhbGxiYWNrIGZvciBkZXNrdG9wKVxuICAgIGlmICghUGxhdGZvcm1EZXRlY3Rvci5oYXNUb3VjaCgpKSB7XG4gICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgXCJtb3VzZWRvd25cIixcbiAgICAgICAgdGhpcy5oYW5kbGVNb3VzZURvd24uYmluZCh0aGlzKSxcbiAgICAgICk7XG4gICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgXCJtb3VzZW1vdmVcIixcbiAgICAgICAgdGhpcy5oYW5kbGVNb3VzZU1vdmUuYmluZCh0aGlzKSxcbiAgICAgICk7XG4gICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgdGhpcy5oYW5kbGVNb3VzZVVwLmJpbmQodGhpcykpO1xuICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ3aGVlbFwiLCB0aGlzLmhhbmRsZVdoZWVsLmJpbmQodGhpcyksIHtcbiAgICAgICAgcGFzc2l2ZTogZmFsc2UsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBQcmV2ZW50IGNvbnRleHQgbWVudSBvbiBsb25nIHByZXNzXG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCAoZSkgPT4ge1xuICAgICAgaWYgKFBsYXRmb3JtRGV0ZWN0b3IuaGFzVG91Y2goKSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlIHRvdWNoIHN0YXJ0IGV2ZW50XG4gICAqL1xuICBwcml2YXRlIGhhbmRsZVRvdWNoU3RhcnQoZXZlbnQ6IFRvdWNoRXZlbnQpOiB2b2lkIHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgY29uc3QgdG91Y2hlcyA9IEFycmF5LmZyb20oZXZlbnQudG91Y2hlcyk7XG4gICAgY29uc3QgY3VycmVudFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgLy8gVXBkYXRlIHRvdWNoIHRyYWNraW5nXG4gICAgdG91Y2hlcy5mb3JFYWNoKCh0b3VjaCkgPT4ge1xuICAgICAgdGhpcy5nZXN0dXJlU3RhdGUudG91Y2hlcy5zZXQodG91Y2guaWRlbnRpZmllciwge1xuICAgICAgICBpZDogdG91Y2guaWRlbnRpZmllcixcbiAgICAgICAgeDogdG91Y2guY2xpZW50WCxcbiAgICAgICAgeTogdG91Y2guY2xpZW50WSxcbiAgICAgICAgdGltZXN0YW1wOiBjdXJyZW50VGltZSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaWYgKHRvdWNoZXMubGVuZ3RoID09PSAxKSB7XG4gICAgICB0aGlzLmhhbmRsZVNpbmdsZVRvdWNoU3RhcnQodG91Y2hlc1swXSwgY3VycmVudFRpbWUpO1xuICAgIH0gZWxzZSBpZiAodG91Y2hlcy5sZW5ndGggPT09IDIpIHtcbiAgICAgIHRoaXMuaGFuZGxlUGluY2hTdGFydCh0b3VjaGVzLCBjdXJyZW50VGltZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZSBzaW5nbGUgdG91Y2ggc3RhcnQgKHRhcCwgcGFuLCBsb25nIHByZXNzKVxuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVTaW5nbGVUb3VjaFN0YXJ0KHRvdWNoOiBUb3VjaCwgdGltZXN0YW1wOiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCByZWN0ID0gdGhpcy5lbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIGNvbnN0IHggPSB0b3VjaC5jbGllbnRYIC0gcmVjdC5sZWZ0O1xuICAgIGNvbnN0IHkgPSB0b3VjaC5jbGllbnRZIC0gcmVjdC50b3A7XG5cbiAgICAvLyBDaGVjayBmb3IgZG91YmxlIHRhcFxuICAgIGlmICh0aGlzLmNvbmZpZy5lbmFibGVUYXBHZXN0dXJlcykge1xuICAgICAgY29uc3QgdGltZVNpbmNlTGFzdFRhcCA9IHRpbWVzdGFtcCAtIHRoaXMuZ2VzdHVyZVN0YXRlLmxhc3RUYXBUaW1lO1xuICAgICAgaWYgKHRpbWVTaW5jZUxhc3RUYXAgPCAzMDApIHtcbiAgICAgICAgdGhpcy5nZXN0dXJlU3RhdGUudGFwQ291bnQrKztcbiAgICAgICAgaWYgKHRoaXMuZ2VzdHVyZVN0YXRlLnRhcENvdW50ID09PSAyKSB7XG4gICAgICAgICAgdGhpcy5oYW5kbGVEb3VibGVUYXAoeCwgeSk7XG4gICAgICAgICAgdGhpcy5yZXNldFRhcFN0YXRlKCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmdlc3R1cmVTdGF0ZS50YXBDb3VudCA9IDE7XG4gICAgICB9XG4gICAgICB0aGlzLmdlc3R1cmVTdGF0ZS5sYXN0VGFwVGltZSA9IHRpbWVzdGFtcDtcbiAgICB9XG5cbiAgICAvLyBTZXR1cCBmb3IgcG90ZW50aWFsIHBhbiBnZXN0dXJlXG4gICAgaWYgKHRoaXMuY29uZmlnLmVuYWJsZVBhbkdlc3R1cmUpIHtcbiAgICAgIHRoaXMuZ2VzdHVyZVN0YXRlLmxhc3RQYW5Qb3NpdGlvbiA9IHsgeCwgeSB9O1xuICAgICAgdGhpcy5nZXN0dXJlU3RhdGUucGFuVmVsb2NpdHkgPSB7IHg6IDAsIHk6IDAgfTtcbiAgICB9XG5cbiAgICAvLyBTZXR1cCBsb25nIHByZXNzIHRpbWVyXG4gICAgaWYgKHRoaXMuY29uZmlnLmVuYWJsZUxvbmdQcmVzcykge1xuICAgICAgdGhpcy5nZXN0dXJlU3RhdGUubG9uZ1ByZXNzVGltZXIgPSB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICB0aGlzLmdlc3R1cmVTdGF0ZS50b3VjaGVzLnNpemUgPT09IDEgJiZcbiAgICAgICAgICAhdGhpcy5nZXN0dXJlU3RhdGUuaXNBY3RpdmVcbiAgICAgICAgKSB7XG4gICAgICAgICAgdGhpcy5oYW5kbGVMb25nUHJlc3MoeCwgeSk7XG4gICAgICAgIH1cbiAgICAgIH0sIHRoaXMuY29uZmlnLmxvbmdQcmVzc0R1cmF0aW9uKTtcbiAgICB9XG5cbiAgICB0aGlzLmdlc3R1cmVTdGF0ZS5zdGFydFRpbWUgPSB0aW1lc3RhbXA7XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlIHBpbmNoIGdlc3R1cmUgc3RhcnRcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlUGluY2hTdGFydCh0b3VjaGVzOiBUb3VjaFtdLCB0aW1lc3RhbXA6IG51bWJlcik6IHZvaWQge1xuICAgIGlmICghdGhpcy5jb25maWcuZW5hYmxlUGluY2hab29tKSByZXR1cm47XG5cbiAgICB0aGlzLmNsZWFyTG9uZ1ByZXNzVGltZXIoKTtcbiAgICB0aGlzLnJlc2V0VGFwU3RhdGUoKTtcblxuICAgIGNvbnN0IGRpc3RhbmNlID0gdGhpcy5jYWxjdWxhdGVEaXN0YW5jZSh0b3VjaGVzWzBdLCB0b3VjaGVzWzFdKTtcbiAgICBjb25zdCBjZW50ZXIgPSB0aGlzLmNhbGN1bGF0ZUNlbnRlcih0b3VjaGVzWzBdLCB0b3VjaGVzWzFdKTtcblxuICAgIHRoaXMuZ2VzdHVyZVN0YXRlLmlzQWN0aXZlID0gdHJ1ZTtcbiAgICB0aGlzLmdlc3R1cmVTdGF0ZS50eXBlID0gXCJwaW5jaFwiO1xuICAgIHRoaXMuZ2VzdHVyZVN0YXRlLmluaXRpYWxEaXN0YW5jZSA9IGRpc3RhbmNlO1xuICAgIHRoaXMuZ2VzdHVyZVN0YXRlLmluaXRpYWxDZW50ZXIgPSBjZW50ZXI7XG4gICAgdGhpcy5nZXN0dXJlU3RhdGUuc3RhcnRUaW1lID0gdGltZXN0YW1wO1xuXG4gICAgdGhpcy50cmlnZ2VySGFwdGljKFwibGlnaHRcIik7XG4gICAgdGhpcy5jYWxsYmFja3Mub25QaW5jaFN0YXJ0Py4oMS4wKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGUgdG91Y2ggbW92ZSBldmVudFxuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVUb3VjaE1vdmUoZXZlbnQ6IFRvdWNoRXZlbnQpOiB2b2lkIHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgY29uc3QgdG91Y2hlcyA9IEFycmF5LmZyb20oZXZlbnQudG91Y2hlcyk7XG4gICAgY29uc3QgY3VycmVudFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgLy8gVXBkYXRlIHRvdWNoIHBvc2l0aW9uc1xuICAgIHRvdWNoZXMuZm9yRWFjaCgodG91Y2gpID0+IHtcbiAgICAgIGNvbnN0IGV4aXN0aW5nID0gdGhpcy5nZXN0dXJlU3RhdGUudG91Y2hlcy5nZXQodG91Y2guaWRlbnRpZmllcik7XG4gICAgICBpZiAoZXhpc3RpbmcpIHtcbiAgICAgICAgZXhpc3RpbmcueCA9IHRvdWNoLmNsaWVudFg7XG4gICAgICAgIGV4aXN0aW5nLnkgPSB0b3VjaC5jbGllbnRZO1xuICAgICAgICBleGlzdGluZy50aW1lc3RhbXAgPSBjdXJyZW50VGltZTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmICh0b3VjaGVzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgdGhpcy5oYW5kbGVTaW5nbGVUb3VjaE1vdmUodG91Y2hlc1swXSwgY3VycmVudFRpbWUpO1xuICAgIH0gZWxzZSBpZiAodG91Y2hlcy5sZW5ndGggPT09IDIgJiYgdGhpcy5nZXN0dXJlU3RhdGUudHlwZSA9PT0gXCJwaW5jaFwiKSB7XG4gICAgICB0aGlzLmhhbmRsZVBpbmNoTW92ZSh0b3VjaGVzLCBjdXJyZW50VGltZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZSBzaW5nbGUgdG91Y2ggbW92ZSAocGFuIGdlc3R1cmUpXG4gICAqL1xuICBwcml2YXRlIGhhbmRsZVNpbmdsZVRvdWNoTW92ZSh0b3VjaDogVG91Y2gsIHRpbWVzdGFtcDogbnVtYmVyKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmNvbmZpZy5lbmFibGVQYW5HZXN0dXJlIHx8ICF0aGlzLmdlc3R1cmVTdGF0ZS5sYXN0UGFuUG9zaXRpb24pXG4gICAgICByZXR1cm47XG5cbiAgICBjb25zdCByZWN0ID0gdGhpcy5lbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIGNvbnN0IHggPSB0b3VjaC5jbGllbnRYIC0gcmVjdC5sZWZ0O1xuICAgIGNvbnN0IHkgPSB0b3VjaC5jbGllbnRZIC0gcmVjdC50b3A7XG5cbiAgICBjb25zdCBkZWx0YVggPVxuICAgICAgKHggLSB0aGlzLmdlc3R1cmVTdGF0ZS5sYXN0UGFuUG9zaXRpb24ueCkgKiB0aGlzLmNvbmZpZy5wYW5TZW5zaXRpdml0eTtcbiAgICBjb25zdCBkZWx0YVkgPVxuICAgICAgKHkgLSB0aGlzLmdlc3R1cmVTdGF0ZS5sYXN0UGFuUG9zaXRpb24ueSkgKiB0aGlzLmNvbmZpZy5wYW5TZW5zaXRpdml0eTtcblxuICAgIC8vIFN0YXJ0IHBhbiBnZXN0dXJlIGlmIG1vdmVkIGVub3VnaFxuICAgIGlmIChcbiAgICAgICF0aGlzLmdlc3R1cmVTdGF0ZS5pc0FjdGl2ZSAmJlxuICAgICAgKE1hdGguYWJzKGRlbHRhWCkgPiA1IHx8IE1hdGguYWJzKGRlbHRhWSkgPiA1KVxuICAgICkge1xuICAgICAgdGhpcy5nZXN0dXJlU3RhdGUuaXNBY3RpdmUgPSB0cnVlO1xuICAgICAgdGhpcy5nZXN0dXJlU3RhdGUudHlwZSA9IFwicGFuXCI7XG4gICAgICB0aGlzLmNsZWFyTG9uZ1ByZXNzVGltZXIoKTtcbiAgICAgIHRoaXMucmVzZXRUYXBTdGF0ZSgpO1xuICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLmN1cnNvciA9IFwiZ3JhYmJpbmdcIjtcbiAgICAgIHRoaXMuY2FsbGJhY2tzLm9uUGFuU3RhcnQ/Lih4LCB5KTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5nZXN0dXJlU3RhdGUudHlwZSA9PT0gXCJwYW5cIikge1xuICAgICAgLy8gVXBkYXRlIHZlbG9jaXR5IGZvciBtb21lbnR1bVxuICAgICAgY29uc3QgdGltZURlbHRhID0gdGltZXN0YW1wIC0gdGhpcy5nZXN0dXJlU3RhdGUuc3RhcnRUaW1lO1xuICAgICAgaWYgKHRpbWVEZWx0YSA+IDApIHtcbiAgICAgICAgdGhpcy5nZXN0dXJlU3RhdGUucGFuVmVsb2NpdHkgPSB7XG4gICAgICAgICAgeDogKGRlbHRhWCAvIHRpbWVEZWx0YSkgKiAxMDAwLCAvLyBwaXhlbHMgcGVyIHNlY29uZFxuICAgICAgICAgIHk6IChkZWx0YVkgLyB0aW1lRGVsdGEpICogMTAwMCxcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5jYWxsYmFja3Mub25QYW5Nb3ZlPy4oZGVsdGFYLCBkZWx0YVkpO1xuICAgIH1cblxuICAgIHRoaXMuZ2VzdHVyZVN0YXRlLmxhc3RQYW5Qb3NpdGlvbiA9IHsgeCwgeSB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZSBwaW5jaCBnZXN0dXJlIG1vdmVcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlUGluY2hNb3ZlKHRvdWNoZXM6IFRvdWNoW10sIHRpbWVzdGFtcDogbnVtYmVyKTogdm9pZCB7XG4gICAgaWYgKFxuICAgICAgIXRoaXMuY29uZmlnLmVuYWJsZVBpbmNoWm9vbSB8fFxuICAgICAgIXRoaXMuZ2VzdHVyZVN0YXRlLmluaXRpYWxEaXN0YW5jZSB8fFxuICAgICAgIXRoaXMuZ2VzdHVyZVN0YXRlLmluaXRpYWxDZW50ZXJcbiAgICApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBkaXN0YW5jZSA9IHRoaXMuY2FsY3VsYXRlRGlzdGFuY2UodG91Y2hlc1swXSwgdG91Y2hlc1sxXSk7XG4gICAgY29uc3QgY2VudGVyID0gdGhpcy5jYWxjdWxhdGVDZW50ZXIodG91Y2hlc1swXSwgdG91Y2hlc1sxXSk7XG5cbiAgICBsZXQgc2NhbGUgPSBkaXN0YW5jZSAvIHRoaXMuZ2VzdHVyZVN0YXRlLmluaXRpYWxEaXN0YW5jZTtcbiAgICBzY2FsZSAqPSB0aGlzLmNvbmZpZy56b29tU2Vuc2l0aXZpdHk7XG5cbiAgICAvLyBBcHBseSB6b29tIGNvbnN0cmFpbnRzXG4gICAgc2NhbGUgPSBNYXRoLm1heCh0aGlzLmNvbmZpZy5taW5ab29tLCBNYXRoLm1pbih0aGlzLmNvbmZpZy5tYXhab29tLCBzY2FsZSkpO1xuXG4gICAgY29uc3QgcmVjdCA9IHRoaXMuZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBjb25zdCBjZW50ZXJYID0gY2VudGVyLnggLSByZWN0LmxlZnQ7XG4gICAgY29uc3QgY2VudGVyWSA9IGNlbnRlci55IC0gcmVjdC50b3A7XG5cbiAgICB0aGlzLmNhbGxiYWNrcy5vblBpbmNoTW92ZT8uKHNjYWxlLCBjZW50ZXJYLCBjZW50ZXJZKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGUgdG91Y2ggZW5kIGV2ZW50XG4gICAqL1xuICBwcml2YXRlIGhhbmRsZVRvdWNoRW5kKGV2ZW50OiBUb3VjaEV2ZW50KTogdm9pZCB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgIGNvbnN0IGN1cnJlbnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICBjb25zdCByZW1haW5pbmdUb3VjaGVzID0gQXJyYXkuZnJvbShldmVudC50b3VjaGVzKTtcblxuICAgIC8vIFJlbW92ZSBlbmRlZCB0b3VjaGVzXG4gICAgQXJyYXkuZnJvbShldmVudC5jaGFuZ2VkVG91Y2hlcykuZm9yRWFjaCgodG91Y2gpID0+IHtcbiAgICAgIHRoaXMuZ2VzdHVyZVN0YXRlLnRvdWNoZXMuZGVsZXRlKHRvdWNoLmlkZW50aWZpZXIpO1xuICAgIH0pO1xuXG4gICAgaWYgKHJlbWFpbmluZ1RvdWNoZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aGlzLmhhbmRsZUFsbFRvdWNoZXNFbmQoY3VycmVudFRpbWUpO1xuICAgIH0gZWxzZSBpZiAoXG4gICAgICByZW1haW5pbmdUb3VjaGVzLmxlbmd0aCA9PT0gMSAmJlxuICAgICAgdGhpcy5nZXN0dXJlU3RhdGUudHlwZSA9PT0gXCJwaW5jaFwiXG4gICAgKSB7XG4gICAgICAvLyBUcmFuc2l0aW9uIGZyb20gcGluY2ggdG8gcGFuXG4gICAgICB0aGlzLmhhbmRsZVBpbmNoVG9QYW5UcmFuc2l0aW9uKHJlbWFpbmluZ1RvdWNoZXNbMF0sIGN1cnJlbnRUaW1lKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlIGFsbCB0b3VjaGVzIGVuZGluZ1xuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVBbGxUb3VjaGVzRW5kKHRpbWVzdGFtcDogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5jbGVhckxvbmdQcmVzc1RpbWVyKCk7XG4gICAgdGhpcy5lbGVtZW50LnN0eWxlLmN1cnNvciA9IFwiZ3JhYlwiO1xuXG4gICAgaWYgKHRoaXMuZ2VzdHVyZVN0YXRlLnR5cGUgPT09IFwicGFuXCIpIHtcbiAgICAgIGNvbnN0IHZlbG9jaXR5ID0gdGhpcy5nZXN0dXJlU3RhdGUucGFuVmVsb2NpdHk7XG4gICAgICB0aGlzLmNhbGxiYWNrcy5vblBhbkVuZD8uKHZlbG9jaXR5Py54IHx8IDAsIHZlbG9jaXR5Py55IHx8IDApO1xuXG4gICAgICAvLyBBcHBseSBtb21lbnR1bSBzY3JvbGxpbmdcbiAgICAgIGlmIChcbiAgICAgICAgdmVsb2NpdHkgJiZcbiAgICAgICAgKE1hdGguYWJzKHZlbG9jaXR5LngpID4gMTAwIHx8IE1hdGguYWJzKHZlbG9jaXR5LnkpID4gMTAwKVxuICAgICAgKSB7XG4gICAgICAgIHRoaXMuc3RhcnRNb21lbnR1bUFuaW1hdGlvbih2ZWxvY2l0eSk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0aGlzLmdlc3R1cmVTdGF0ZS50eXBlID09PSBcInBpbmNoXCIpIHtcbiAgICAgIHRoaXMuY2FsbGJhY2tzLm9uUGluY2hFbmQ/LigxLjApO1xuICAgIH0gZWxzZSBpZiAoXG4gICAgICB0aGlzLmdlc3R1cmVTdGF0ZS50YXBDb3VudCA9PT0gMSAmJlxuICAgICAgIXRoaXMuZ2VzdHVyZVN0YXRlLmlzQWN0aXZlXG4gICAgKSB7XG4gICAgICAvLyBTaW5nbGUgdGFwXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuZ2VzdHVyZVN0YXRlLnRhcENvdW50ID09PSAxKSB7XG4gICAgICAgICAgY29uc3QgdG91Y2ggPSB0aGlzLmdlc3R1cmVTdGF0ZS50b3VjaGVzLnZhbHVlcygpLm5leHQoKS52YWx1ZTtcbiAgICAgICAgICBpZiAodG91Y2gpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlY3QgPSB0aGlzLmVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrcy5vblRhcD8uKHRvdWNoLnggLSByZWN0LmxlZnQsIHRvdWNoLnkgLSByZWN0LnRvcCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMucmVzZXRUYXBTdGF0ZSgpO1xuICAgICAgICB9XG4gICAgICB9LCAzMDApO1xuICAgIH1cblxuICAgIHRoaXMucmVzZXRHZXN0dXJlU3RhdGUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGUgdHJhbnNpdGlvbiBmcm9tIHBpbmNoIHRvIHBhblxuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVQaW5jaFRvUGFuVHJhbnNpdGlvbih0b3VjaDogVG91Y2gsIHRpbWVzdGFtcDogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5jYWxsYmFja3Mub25QaW5jaEVuZD8uKDEuMCk7XG5cbiAgICAvLyBSZXNldCBmb3IgcGFuIGdlc3R1cmVcbiAgICBjb25zdCByZWN0ID0gdGhpcy5lbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIHRoaXMuZ2VzdHVyZVN0YXRlLnR5cGUgPSBcInBhblwiO1xuICAgIHRoaXMuZ2VzdHVyZVN0YXRlLmxhc3RQYW5Qb3NpdGlvbiA9IHtcbiAgICAgIHg6IHRvdWNoLmNsaWVudFggLSByZWN0LmxlZnQsXG4gICAgICB5OiB0b3VjaC5jbGllbnRZIC0gcmVjdC50b3AsXG4gICAgfTtcbiAgICB0aGlzLmdlc3R1cmVTdGF0ZS5wYW5WZWxvY2l0eSA9IHsgeDogMCwgeTogMCB9O1xuXG4gICAgdGhpcy5jYWxsYmFja3Mub25QYW5TdGFydD8uKFxuICAgICAgdGhpcy5nZXN0dXJlU3RhdGUubGFzdFBhblBvc2l0aW9uLngsXG4gICAgICB0aGlzLmdlc3R1cmVTdGF0ZS5sYXN0UGFuUG9zaXRpb24ueSxcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZSB0b3VjaCBjYW5jZWwgZXZlbnRcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlVG91Y2hDYW5jZWwoZXZlbnQ6IFRvdWNoRXZlbnQpOiB2b2lkIHtcbiAgICB0aGlzLmhhbmRsZVRvdWNoRW5kKGV2ZW50KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGUgZG91YmxlIHRhcCBnZXN0dXJlXG4gICAqL1xuICBwcml2YXRlIGhhbmRsZURvdWJsZVRhcCh4OiBudW1iZXIsIHk6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMudHJpZ2dlckhhcHRpYyhcIm1lZGl1bVwiKTtcbiAgICB0aGlzLmNhbGxiYWNrcy5vbkRvdWJsZVRhcD8uKHgsIHkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZSBsb25nIHByZXNzIGdlc3R1cmVcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlTG9uZ1ByZXNzKHg6IG51bWJlciwgeTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy50cmlnZ2VySGFwdGljKFwiaGVhdnlcIik7XG4gICAgdGhpcy5jYWxsYmFja3Mub25Mb25nUHJlc3M/Lih4LCB5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdGFydCBtb21lbnR1bSBhbmltYXRpb24gZm9yIHNtb290aCBzY3JvbGxpbmdcbiAgICovXG4gIHByaXZhdGUgc3RhcnRNb21lbnR1bUFuaW1hdGlvbih2ZWxvY2l0eTogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9KTogdm9pZCB7XG4gICAgdGhpcy5jYW5jZWxNb21lbnR1bUFuaW1hdGlvbigpO1xuXG4gICAgbGV0IGN1cnJlbnRWZWxvY2l0eSA9IHsgLi4udmVsb2NpdHkgfTtcblxuICAgIGNvbnN0IGFuaW1hdGUgPSAoKSA9PiB7XG4gICAgICAvLyBBcHBseSBtb21lbnR1bSBzdGVwXG4gICAgICB0aGlzLmNhbGxiYWNrcy5vblBhbk1vdmU/LihcbiAgICAgICAgY3VycmVudFZlbG9jaXR5LnggLyA2MCwgLy8gNjBmcHNcbiAgICAgICAgY3VycmVudFZlbG9jaXR5LnkgLyA2MCxcbiAgICAgICk7XG5cbiAgICAgIC8vIERlY2F5IHZlbG9jaXR5XG4gICAgICBjdXJyZW50VmVsb2NpdHkueCAqPSB0aGlzLmNvbmZpZy5tb21lbnR1bURlY2F5O1xuICAgICAgY3VycmVudFZlbG9jaXR5LnkgKj0gdGhpcy5jb25maWcubW9tZW50dW1EZWNheTtcblxuICAgICAgLy8gQ29udGludWUgaWYgdmVsb2NpdHkgaXMgc2lnbmlmaWNhbnRcbiAgICAgIGlmIChNYXRoLmFicyhjdXJyZW50VmVsb2NpdHkueCkgPiAxIHx8IE1hdGguYWJzKGN1cnJlbnRWZWxvY2l0eS55KSA+IDEpIHtcbiAgICAgICAgdGhpcy5tb21lbnR1bUFuaW1hdGlvbiA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRlKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5tb21lbnR1bUFuaW1hdGlvbiA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYW5jZWwgbW9tZW50dW0gYW5pbWF0aW9uXG4gICAqL1xuICBwcml2YXRlIGNhbmNlbE1vbWVudHVtQW5pbWF0aW9uKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLm1vbWVudHVtQW5pbWF0aW9uKSB7XG4gICAgICBjYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLm1vbWVudHVtQW5pbWF0aW9uKTtcbiAgICAgIHRoaXMubW9tZW50dW1BbmltYXRpb24gPSB1bmRlZmluZWQ7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZSBkaXN0YW5jZSBiZXR3ZWVuIHR3byB0b3VjaGVzXG4gICAqL1xuICBwcml2YXRlIGNhbGN1bGF0ZURpc3RhbmNlKHRvdWNoMTogVG91Y2gsIHRvdWNoMjogVG91Y2gpOiBudW1iZXIge1xuICAgIGNvbnN0IGR4ID0gdG91Y2gyLmNsaWVudFggLSB0b3VjaDEuY2xpZW50WDtcbiAgICBjb25zdCBkeSA9IHRvdWNoMi5jbGllbnRZIC0gdG91Y2gxLmNsaWVudFk7XG4gICAgcmV0dXJuIE1hdGguc3FydChkeCAqIGR4ICsgZHkgKiBkeSk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlIGNlbnRlciBwb2ludCBiZXR3ZWVuIHR3byB0b3VjaGVzXG4gICAqL1xuICBwcml2YXRlIGNhbGN1bGF0ZUNlbnRlcihcbiAgICB0b3VjaDE6IFRvdWNoLFxuICAgIHRvdWNoMjogVG91Y2gsXG4gICk6IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHg6ICh0b3VjaDEuY2xpZW50WCArIHRvdWNoMi5jbGllbnRYKSAvIDIsXG4gICAgICB5OiAodG91Y2gxLmNsaWVudFkgKyB0b3VjaDIuY2xpZW50WSkgLyAyLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ2xlYXIgbG9uZyBwcmVzcyB0aW1lclxuICAgKi9cbiAgcHJpdmF0ZSBjbGVhckxvbmdQcmVzc1RpbWVyKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmdlc3R1cmVTdGF0ZS5sb25nUHJlc3NUaW1lcikge1xuICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuZ2VzdHVyZVN0YXRlLmxvbmdQcmVzc1RpbWVyKTtcbiAgICAgIHRoaXMuZ2VzdHVyZVN0YXRlLmxvbmdQcmVzc1RpbWVyID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXNldCB0YXAgc3RhdGVcbiAgICovXG4gIHByaXZhdGUgcmVzZXRUYXBTdGF0ZSgpOiB2b2lkIHtcbiAgICB0aGlzLmdlc3R1cmVTdGF0ZS50YXBDb3VudCA9IDA7XG4gICAgdGhpcy5nZXN0dXJlU3RhdGUubGFzdFRhcFRpbWUgPSAwO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlc2V0IGdlc3R1cmUgc3RhdGVcbiAgICovXG4gIHByaXZhdGUgcmVzZXRHZXN0dXJlU3RhdGUoKTogdm9pZCB7XG4gICAgdGhpcy5nZXN0dXJlU3RhdGUuaXNBY3RpdmUgPSBmYWxzZTtcbiAgICB0aGlzLmdlc3R1cmVTdGF0ZS50eXBlID0gXCJub25lXCI7XG4gICAgdGhpcy5nZXN0dXJlU3RhdGUudG91Y2hlcy5jbGVhcigpO1xuICAgIHRoaXMuZ2VzdHVyZVN0YXRlLmluaXRpYWxEaXN0YW5jZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmdlc3R1cmVTdGF0ZS5pbml0aWFsQ2VudGVyID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuZ2VzdHVyZVN0YXRlLmxhc3RQYW5Qb3NpdGlvbiA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmdlc3R1cmVTdGF0ZS5wYW5WZWxvY2l0eSA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBUcmlnZ2VyIGhhcHRpYyBmZWVkYmFja1xuICAgKi9cbiAgcHJpdmF0ZSB0cmlnZ2VySGFwdGljKFxuICAgIHR5cGU6IFwibGlnaHRcIiB8IFwibWVkaXVtXCIgfCBcImhlYXZ5XCIgfCBcInNlbGVjdGlvblwiLFxuICApOiB2b2lkIHtcbiAgICBpZiAodGhpcy5oYXB0aWNGZWVkYmFjayAmJiB0aGlzLmhhcHRpY0ZlZWRiYWNrW3R5cGVdKSB7XG4gICAgICB0aGlzLmhhcHRpY0ZlZWRiYWNrW3R5cGVdKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFBvaW50ZXIgZXZlbnQgaGFuZGxlcnMgKGZvciBoeWJyaWQgZGV2aWNlcylcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlUG9pbnRlckRvd24oZXZlbnQ6IFBvaW50ZXJFdmVudCk6IHZvaWQge1xuICAgIGlmIChldmVudC5wb2ludGVyVHlwZSA9PT0gXCJ0b3VjaFwiKSB7XG4gICAgICAvLyBDb252ZXJ0IHRvIHRvdWNoLWxpa2UgaGFuZGxpbmdcbiAgICAgIGNvbnN0IGZha2VUb3VjaCA9IHRoaXMuY3JlYXRlRmFrZVRvdWNoRXZlbnQoXCJ0b3VjaHN0YXJ0XCIsIFtldmVudF0pO1xuICAgICAgdGhpcy5oYW5kbGVUb3VjaFN0YXJ0KGZha2VUb3VjaCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVQb2ludGVyTW92ZShldmVudDogUG9pbnRlckV2ZW50KTogdm9pZCB7XG4gICAgaWYgKGV2ZW50LnBvaW50ZXJUeXBlID09PSBcInRvdWNoXCIpIHtcbiAgICAgIGNvbnN0IGZha2VUb3VjaCA9IHRoaXMuY3JlYXRlRmFrZVRvdWNoRXZlbnQoXCJ0b3VjaG1vdmVcIiwgW2V2ZW50XSk7XG4gICAgICB0aGlzLmhhbmRsZVRvdWNoTW92ZShmYWtlVG91Y2gpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlUG9pbnRlclVwKGV2ZW50OiBQb2ludGVyRXZlbnQpOiB2b2lkIHtcbiAgICBpZiAoZXZlbnQucG9pbnRlclR5cGUgPT09IFwidG91Y2hcIikge1xuICAgICAgY29uc3QgZmFrZVRvdWNoID0gdGhpcy5jcmVhdGVGYWtlVG91Y2hFdmVudChcInRvdWNoZW5kXCIsIFtldmVudF0pO1xuICAgICAgdGhpcy5oYW5kbGVUb3VjaEVuZChmYWtlVG91Y2gpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlUG9pbnRlckNhbmNlbChldmVudDogUG9pbnRlckV2ZW50KTogdm9pZCB7XG4gICAgaWYgKGV2ZW50LnBvaW50ZXJUeXBlID09PSBcInRvdWNoXCIpIHtcbiAgICAgIGNvbnN0IGZha2VUb3VjaCA9IHRoaXMuY3JlYXRlRmFrZVRvdWNoRXZlbnQoXCJ0b3VjaGNhbmNlbFwiLCBbZXZlbnRdKTtcbiAgICAgIHRoaXMuaGFuZGxlVG91Y2hDYW5jZWwoZmFrZVRvdWNoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTW91c2UgZXZlbnQgaGFuZGxlcnMgKGZhbGxiYWNrIGZvciBkZXNrdG9wKVxuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVNb3VzZURvd24oZXZlbnQ6IE1vdXNlRXZlbnQpOiB2b2lkIHtcbiAgICBpZiAoZXZlbnQuYnV0dG9uID09PSAwKSB7XG4gICAgICAvLyBMZWZ0IG1vdXNlIGJ1dHRvblxuICAgICAgY29uc3QgZmFrZVRvdWNoID0gdGhpcy5jcmVhdGVGYWtlVG91Y2hFdmVudChcInRvdWNoc3RhcnRcIiwgW2V2ZW50XSk7XG4gICAgICB0aGlzLmhhbmRsZVRvdWNoU3RhcnQoZmFrZVRvdWNoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGhhbmRsZU1vdXNlTW92ZShldmVudDogTW91c2VFdmVudCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmdlc3R1cmVTdGF0ZS5pc0FjdGl2ZSkge1xuICAgICAgY29uc3QgZmFrZVRvdWNoID0gdGhpcy5jcmVhdGVGYWtlVG91Y2hFdmVudChcInRvdWNobW92ZVwiLCBbZXZlbnRdKTtcbiAgICAgIHRoaXMuaGFuZGxlVG91Y2hNb3ZlKGZha2VUb3VjaCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVNb3VzZVVwKGV2ZW50OiBNb3VzZUV2ZW50KTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZ2VzdHVyZVN0YXRlLmlzQWN0aXZlKSB7XG4gICAgICBjb25zdCBmYWtlVG91Y2ggPSB0aGlzLmNyZWF0ZUZha2VUb3VjaEV2ZW50KFwidG91Y2hlbmRcIiwgW2V2ZW50XSk7XG4gICAgICB0aGlzLmhhbmRsZVRvdWNoRW5kKGZha2VUb3VjaCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVXaGVlbChldmVudDogV2hlZWxFdmVudCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5jb25maWcuZW5hYmxlUGluY2hab29tKSByZXR1cm47XG5cbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgY29uc3QgcmVjdCA9IHRoaXMuZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBjb25zdCBjZW50ZXJYID0gZXZlbnQuY2xpZW50WCAtIHJlY3QubGVmdDtcbiAgICBjb25zdCBjZW50ZXJZID0gZXZlbnQuY2xpZW50WSAtIHJlY3QudG9wO1xuXG4gICAgY29uc3Qgc2NhbGUgPSBldmVudC5kZWx0YVkgPiAwID8gMC45IDogMS4xO1xuXG4gICAgdGhpcy5jYWxsYmFja3Mub25QaW5jaFN0YXJ0Py4oMS4wKTtcbiAgICB0aGlzLmNhbGxiYWNrcy5vblBpbmNoTW92ZT8uKHNjYWxlLCBjZW50ZXJYLCBjZW50ZXJZKTtcbiAgICB0aGlzLmNhbGxiYWNrcy5vblBpbmNoRW5kPy4oc2NhbGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBmYWtlIHRvdWNoIGV2ZW50IGZyb20gbW91c2UvcG9pbnRlciBldmVudFxuICAgKi9cbiAgcHJpdmF0ZSBjcmVhdGVGYWtlVG91Y2hFdmVudChcbiAgICB0eXBlOiBzdHJpbmcsXG4gICAgZXZlbnRzOiAoTW91c2VFdmVudCB8IFBvaW50ZXJFdmVudClbXSxcbiAgKTogVG91Y2hFdmVudCB7XG4gICAgY29uc3QgdG91Y2hlcyA9IGV2ZW50cy5tYXAoKGV2ZW50LCBpbmRleCkgPT4gKHtcbiAgICAgIGlkZW50aWZpZXI6IChldmVudCBhcyBQb2ludGVyRXZlbnQpLnBvaW50ZXJJZCB8fCAwLFxuICAgICAgY2xpZW50WDogZXZlbnQuY2xpZW50WCxcbiAgICAgIGNsaWVudFk6IGV2ZW50LmNsaWVudFksXG4gICAgICBwYWdlWDogZXZlbnQucGFnZVgsXG4gICAgICBwYWdlWTogZXZlbnQucGFnZVksXG4gICAgICBzY3JlZW5YOiBldmVudC5zY3JlZW5YLFxuICAgICAgc2NyZWVuWTogZXZlbnQuc2NyZWVuWSxcbiAgICAgIHRhcmdldDogZXZlbnQudGFyZ2V0LFxuICAgIH0pKSBhcyBhbnk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgdHlwZSxcbiAgICAgIHRvdWNoZXMsXG4gICAgICBjaGFuZ2VkVG91Y2hlczogdG91Y2hlcyxcbiAgICAgIHRhcmdldFRvdWNoZXM6IHRvdWNoZXMsXG4gICAgICBwcmV2ZW50RGVmYXVsdDogKCkgPT4ge30sXG4gICAgICBzdG9wUHJvcGFnYXRpb246ICgpID0+IHt9LFxuICAgIH0gYXMgVG91Y2hFdmVudDtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgY29uZmlndXJhdGlvblxuICAgKi9cbiAgdXBkYXRlQ29uZmlnKG5ld0NvbmZpZzogUGFydGlhbDxUb3VjaEdlc3R1cmVDb25maWc+KTogdm9pZCB7XG4gICAgdGhpcy5jb25maWcgPSB7IC4uLnRoaXMuY29uZmlnLCAuLi5uZXdDb25maWcgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgY2FsbGJhY2tzXG4gICAqL1xuICB1cGRhdGVDYWxsYmFja3MobmV3Q2FsbGJhY2tzOiBQYXJ0aWFsPFRvdWNoR2VzdHVyZUNhbGxiYWNrcz4pOiB2b2lkIHtcbiAgICB0aGlzLmNhbGxiYWNrcyA9IHsgLi4udGhpcy5jYWxsYmFja3MsIC4uLm5ld0NhbGxiYWNrcyB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEVuYWJsZS9kaXNhYmxlIGdlc3R1cmVzXG4gICAqL1xuICBzZXRFbmFibGVkKGVuYWJsZWQ6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICBpZiAoZW5hYmxlZCkge1xuICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcIlwiO1xuICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLnRvdWNoQWN0aW9uID0gXCJub25lXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJub25lXCI7XG4gICAgICB0aGlzLmVsZW1lbnQuc3R5bGUudG91Y2hBY3Rpb24gPSBcImF1dG9cIjtcbiAgICAgIHRoaXMucmVzZXRHZXN0dXJlU3RhdGUoKTtcbiAgICAgIHRoaXMuY2FuY2VsTW9tZW50dW1BbmltYXRpb24oKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IGN1cnJlbnQgZ2VzdHVyZSBzdGF0ZVxuICAgKi9cbiAgZ2V0R2VzdHVyZVN0YXRlKCk6IFJlYWRvbmx5PEdlc3R1cmVTdGF0ZT4ge1xuICAgIHJldHVybiB0aGlzLmdlc3R1cmVTdGF0ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZXN0cm95IGNvbnRyb2xsZXIgYW5kIGNsZWFudXBcbiAgICovXG4gIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgdGhpcy5jYW5jZWxNb21lbnR1bUFuaW1hdGlvbigpO1xuICAgIHRoaXMuY2xlYXJMb25nUHJlc3NUaW1lcigpO1xuICAgIHRoaXMucmVzZXRHZXN0dXJlU3RhdGUoKTtcblxuICAgIC8vIFJlbW92ZSBhbGwgZXZlbnQgbGlzdGVuZXJzXG4gICAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICBcInRvdWNoc3RhcnRcIixcbiAgICAgIHRoaXMuaGFuZGxlVG91Y2hTdGFydC5iaW5kKHRoaXMpLFxuICAgICk7XG4gICAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICBcInRvdWNobW92ZVwiLFxuICAgICAgdGhpcy5oYW5kbGVUb3VjaE1vdmUuYmluZCh0aGlzKSxcbiAgICApO1xuICAgIHRoaXMuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFxuICAgICAgXCJ0b3VjaGVuZFwiLFxuICAgICAgdGhpcy5oYW5kbGVUb3VjaEVuZC5iaW5kKHRoaXMpLFxuICAgICk7XG4gICAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICBcInRvdWNoY2FuY2VsXCIsXG4gICAgICB0aGlzLmhhbmRsZVRvdWNoQ2FuY2VsLmJpbmQodGhpcyksXG4gICAgKTtcblxuICAgIGlmIChcIlBvaW50ZXJFdmVudFwiIGluIHdpbmRvdykge1xuICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAgIFwicG9pbnRlcmRvd25cIixcbiAgICAgICAgdGhpcy5oYW5kbGVQb2ludGVyRG93bi5iaW5kKHRoaXMpLFxuICAgICAgKTtcbiAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFxuICAgICAgICBcInBvaW50ZXJtb3ZlXCIsXG4gICAgICAgIHRoaXMuaGFuZGxlUG9pbnRlck1vdmUuYmluZCh0aGlzKSxcbiAgICAgICk7XG4gICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgXCJwb2ludGVydXBcIixcbiAgICAgICAgdGhpcy5oYW5kbGVQb2ludGVyVXAuYmluZCh0aGlzKSxcbiAgICAgICk7XG4gICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgXCJwb2ludGVyY2FuY2VsXCIsXG4gICAgICAgIHRoaXMuaGFuZGxlUG9pbnRlckNhbmNlbC5iaW5kKHRoaXMpLFxuICAgICAgKTtcbiAgICB9XG5cbiAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcbiAgICAgIFwibW91c2Vkb3duXCIsXG4gICAgICB0aGlzLmhhbmRsZU1vdXNlRG93bi5iaW5kKHRoaXMpLFxuICAgICk7XG4gICAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICBcIm1vdXNlbW92ZVwiLFxuICAgICAgdGhpcy5oYW5kbGVNb3VzZU1vdmUuYmluZCh0aGlzKSxcbiAgICApO1xuICAgIHRoaXMuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCB0aGlzLmhhbmRsZU1vdXNlVXAuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ3aGVlbFwiLCB0aGlzLmhhbmRsZVdoZWVsLmJpbmQodGhpcykpO1xuXG4gICAgLy8gUmVzdG9yZSBlbGVtZW50IHN0eWxlc1xuICAgIHRoaXMuZWxlbWVudC5zdHlsZS50b3VjaEFjdGlvbiA9IFwiXCI7XG4gICAgdGhpcy5lbGVtZW50LnN0eWxlLnVzZXJTZWxlY3QgPSBcIlwiO1xuICAgIHRoaXMuZWxlbWVudC5zdHlsZS53ZWJraXRVc2VyU2VsZWN0ID0gXCJcIjtcbiAgICB0aGlzLmVsZW1lbnQuc3R5bGUuY3Vyc29yID0gXCJcIjtcbiAgfVxufVxuXG4vKipcbiAqIEZhY3RvcnkgZnVuY3Rpb24gdG8gY3JlYXRlIHRvdWNoIGNvbnRyb2xsZXIgZm9yIFZpc3VhbFF1ZXJ5Q2FudmFzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVUb3VjaEdyYXBoQ29udHJvbGxlcihcbiAgY2FudmFzOiBWaXN1YWxRdWVyeUNhbnZhcyxcbiAgZWxlbWVudDogSFRNTEVsZW1lbnQsXG4gIGNvbmZpZzogVG91Y2hHZXN0dXJlQ29uZmlnID0ge30sXG4pOiBUb3VjaEdyYXBoQ29udHJvbGxlciB7XG4gIGNvbnN0IGNhbGxiYWNrczogVG91Y2hHZXN0dXJlQ2FsbGJhY2tzID0ge1xuICAgIG9uVGFwOiAoeCwgeSkgPT4ge1xuICAgICAgLy8gSGFuZGxlIG5vZGUgc2VsZWN0aW9uIG9uIHRhcFxuICAgICAgY29uc29sZS5sb2coXCJHcmFwaCB0YXAgYXQ6XCIsIHgsIHkpO1xuICAgIH0sXG5cbiAgICBvbkRvdWJsZVRhcDogKHgsIHkpID0+IHtcbiAgICAgIC8vIFpvb20gdG8gZml0IG9yIHpvb20gdG8gcG9pbnRcbiAgICAgIGlmIChjYW52YXMuem9vbVRvRml0KSB7XG4gICAgICAgIGNhbnZhcy56b29tVG9GaXQoKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgb25Mb25nUHJlc3M6ICh4LCB5KSA9PiB7XG4gICAgICAvLyBTaG93IGNvbnRleHQgbWVudSBvciBub2RlIGNyZWF0aW9uXG4gICAgICBjb25zb2xlLmxvZyhcIkdyYXBoIGxvbmcgcHJlc3MgYXQ6XCIsIHgsIHkpO1xuICAgIH0sXG5cbiAgICBvblBpbmNoTW92ZTogKHNjYWxlLCBjZW50ZXJYLCBjZW50ZXJZKSA9PiB7XG4gICAgICAvLyBBcHBseSB6b29tIHdpdGggc2NhbGUgYW5kIGNlbnRlclxuICAgICAgY29uc3QgY3VycmVudFN0YXRlID0gKGNhbnZhcyBhcyBhbnkpLmdldEN1cnJlbnRDYW52YXNTdGF0ZT8uKCk7XG4gICAgICBpZiAoY3VycmVudFN0YXRlKSB7XG4gICAgICAgIGNvbnN0IG5ld1pvb20gPSBNYXRoLm1heChcbiAgICAgICAgICAwLjEsXG4gICAgICAgICAgTWF0aC5taW4oNS4wLCBjdXJyZW50U3RhdGUudmlld3BvcnQuem9vbSAqIHNjYWxlKSxcbiAgICAgICAgKTtcbiAgICAgICAgLy8gQXBwbHkgem9vbSB0cmFuc2Zvcm1hdGlvblxuICAgICAgICBjb25zb2xlLmxvZyhcIkFwcGx5aW5nIHpvb206XCIsIG5ld1pvb20sIFwiYXQgY2VudGVyOlwiLCBjZW50ZXJYLCBjZW50ZXJZKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgb25QYW5Nb3ZlOiAoZGVsdGFYLCBkZWx0YVkpID0+IHtcbiAgICAgIC8vIEFwcGx5IHBhbiB0cmFuc2Zvcm1hdGlvblxuICAgICAgY29uc3QgY3VycmVudFN0YXRlID0gKGNhbnZhcyBhcyBhbnkpLmdldEN1cnJlbnRDYW52YXNTdGF0ZT8uKCk7XG4gICAgICBpZiAoY3VycmVudFN0YXRlKSB7XG4gICAgICAgIC8vIFVwZGF0ZSB2aWV3cG9ydCBwb3NpdGlvblxuICAgICAgICBjb25zb2xlLmxvZyhcIkFwcGx5aW5nIHBhbjpcIiwgZGVsdGFYLCBkZWx0YVkpO1xuICAgICAgfVxuICAgIH0sXG4gIH07XG5cbiAgcmV0dXJuIG5ldyBUb3VjaEdyYXBoQ29udHJvbGxlcihlbGVtZW50LCBjb25maWcsIGNhbGxiYWNrcyk7XG59XG4iXSwidmVyc2lvbiI6M30=