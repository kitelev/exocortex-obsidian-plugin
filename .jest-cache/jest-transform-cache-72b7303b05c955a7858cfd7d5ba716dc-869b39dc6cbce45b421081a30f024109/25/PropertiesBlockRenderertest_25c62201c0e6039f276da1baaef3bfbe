a5fcb954ef86355e3bbe12b6deff4586
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const PropertiesBlockRenderer_1 = require("../../../../src/presentation/renderers/PropertiesBlockRenderer");
const obsidian_1 = require("../../../__mocks__/obsidian");
describe('PropertiesBlockRenderer', () => {
    let renderer;
    let mockVault;
    let mockApp;
    beforeEach(() => {
        mockVault = new obsidian_1.Vault();
        mockApp = new obsidian_1.App();
        const mockPropertyRenderer = {
            renderPropertiesBlock: jest.fn()
        };
        renderer = new PropertiesBlockRenderer_1.PropertiesBlockRenderer(mockApp, mockPropertyRenderer);
    });
    describe('renderPropertiesBlock', () => {
        it('should render empty properties list', () => {
            const container = document.createElement('div');
            const properties = [];
            renderer.renderPropertiesBlock(properties, container);
            expect(container.children.length).toBe(0);
        });
        it('should render basic properties', () => {
            const container = document.createElement('div');
            const properties = [
                { name: 'title', value: 'Test Title', type: 'string' },
                { name: 'count', value: 42, type: 'number' },
                { name: 'active', value: true, type: 'boolean' }
            ];
            renderer.renderPropertiesBlock(properties, container);
            expect(container.children.length).toBe(3);
            expect(container.textContent).toContain('title');
            expect(container.textContent).toContain('Test Title');
            expect(container.textContent).toContain('count');
            expect(container.textContent).toContain('42');
            expect(container.textContent).toContain('active');
        });
        it('should handle different property types', () => {
            const container = document.createElement('div');
            const properties = [
                { name: 'text', value: 'Sample text', type: 'string' },
                { name: 'date', value: '2024-01-15', type: 'date' },
                { name: 'url', value: 'https://example.com', type: 'url' },
                { name: 'tags', value: ['tag1', 'tag2'], type: 'array' }
            ];
            renderer.renderPropertiesBlock(properties, container);
            expect(container.children.length).toBe(4);
            expect(container.textContent).toContain('Sample text');
            expect(container.textContent).toContain('2024-01-15');
            expect(container.textContent).toContain('https://example.com');
            expect(container.textContent).toContain('tag1');
        });
        it('should handle null and undefined values', () => {
            const container = document.createElement('div');
            const properties = [
                { name: 'nullProp', value: null, type: 'string' },
                { name: 'undefinedProp', value: undefined, type: 'string' },
                { name: 'emptyProp', value: '', type: 'string' }
            ];
            renderer.renderPropertiesBlock(properties, container);
            expect(container.children.length).toBe(3);
            const propertyElements = container.querySelectorAll('.property-item');
            expect(propertyElements.length).toBe(3);
        });
        it('should handle complex nested values', () => {
            const container = document.createElement('div');
            const properties = [
                {
                    name: 'metadata',
                    value: {
                        created: '2024-01-01',
                        modified: '2024-01-15',
                        tags: ['important', 'project']
                    },
                    type: 'object'
                }
            ];
            renderer.renderPropertiesBlock(properties, container);
            expect(container.children.length).toBe(1);
            expect(container.textContent).toContain('metadata');
        });
        it('should apply correct CSS classes', () => {
            const container = document.createElement('div');
            const properties = [
                { name: 'status', value: 'active', type: 'status' }
            ];
            renderer.renderPropertiesBlock(properties, container);
            const propertyElement = container.querySelector('.property-item');
            expect(propertyElement).toBeTruthy();
            expect(propertyElement === null || propertyElement === void 0 ? void 0 : propertyElement.classList.contains('property-item')).toBe(true);
        });
        it('should handle editable properties', () => {
            const container = document.createElement('div');
            const properties = [
                { name: 'editableField', value: 'Edit me', type: 'string', editable: true }
            ];
            renderer.renderPropertiesBlock(properties, container);
            const input = container.querySelector('input, textarea');
            expect(input).toBeTruthy();
        });
        it('should handle readonly properties', () => {
            const container = document.createElement('div');
            const properties = [
                { name: 'readonlyField', value: 'Cannot edit', type: 'string', readonly: true }
            ];
            renderer.renderPropertiesBlock(properties, container);
            const valueElement = container.querySelector('.property-value');
            expect(valueElement).toBeTruthy();
            expect(valueElement === null || valueElement === void 0 ? void 0 : valueElement.textContent).toContain('Cannot edit');
        });
    });
    describe('property formatting', () => {
        it('should format dates correctly', () => {
            const container = document.createElement('div');
            const properties = [
                { name: 'created', value: '2024-01-15T10:30:00Z', type: 'date' }
            ];
            renderer.renderPropertiesBlock(properties, container);
            const dateElement = container.querySelector('.property-value');
            expect(dateElement).toBeTruthy();
        });
        it('should format numbers correctly', () => {
            const container = document.createElement('div');
            const properties = [
                { name: 'price', value: 1234.56, type: 'currency' },
                { name: 'percentage', value: 0.85, type: 'percentage' }
            ];
            renderer.renderPropertiesBlock(properties, container);
            expect(container.textContent).toContain('1234.56');
            expect(container.textContent).toContain('0.85');
        });
        it('should format arrays as lists', () => {
            const container = document.createElement('div');
            const properties = [
                { name: 'tags', value: ['web', 'development', 'javascript'], type: 'tags' }
            ];
            renderer.renderPropertiesBlock(properties, container);
            const tagElements = container.querySelectorAll('.tag');
            expect(tagElements.length).toBeGreaterThan(0);
        });
    });
    describe('error handling', () => {
        it('should handle null container', () => {
            const properties = [{ name: 'test', value: 'value', type: 'string' }];
            expect(() => {
                renderer.renderPropertiesBlock(properties, null);
            }).not.toThrow();
        });
        it('should handle malformed property objects', () => {
            const container = document.createElement('div');
            const properties = [
                null,
                undefined,
                { name: 'incomplete' },
                { value: 'orphaned' },
                'invalid'
            ];
            expect(() => {
                renderer.renderPropertiesBlock(properties, container);
            }).not.toThrow();
        });
        it('should handle invalid property types', () => {
            const container = document.createElement('div');
            const properties = [
                { name: 'test', value: 'value', type: 'nonexistent-type' }
            ];
            expect(() => {
                renderer.renderPropertiesBlock(properties, container);
            }).not.toThrow();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2tpdGVsZXYvRG9jdW1lbnRzL2V4b2NvcnRleC1vYnNpZGlhbi1wbHVnaW4vdGVzdHMvdW5pdC9wcmVzZW50YXRpb24vcmVuZGVyZXJzL1Byb3BlcnRpZXNCbG9ja1JlbmRlcmVyLnRlc3QudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSw0R0FBeUc7QUFDekcsMERBQXlEO0FBRXpELFFBQVEsQ0FBQyx5QkFBeUIsRUFBRSxHQUFHLEVBQUU7SUFDckMsSUFBSSxRQUFpQyxDQUFDO0lBQ3RDLElBQUksU0FBZ0IsQ0FBQztJQUNyQixJQUFJLE9BQVksQ0FBQztJQUVqQixVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ1osU0FBUyxHQUFHLElBQUksZ0JBQUssRUFBRSxDQUFDO1FBQ3hCLE9BQU8sR0FBRyxJQUFJLGNBQUcsRUFBRSxDQUFDO1FBQ3BCLE1BQU0sb0JBQW9CLEdBQUc7WUFDekIscUJBQXFCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtTQUNuQyxDQUFDO1FBQ0YsUUFBUSxHQUFHLElBQUksaURBQXVCLENBQUMsT0FBYyxFQUFFLG9CQUEyQixDQUFDLENBQUM7SUFDeEYsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsdUJBQXVCLEVBQUUsR0FBRyxFQUFFO1FBQ25DLEVBQUUsQ0FBQyxxQ0FBcUMsRUFBRSxHQUFHLEVBQUU7WUFDM0MsTUFBTSxTQUFTLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNoRCxNQUFNLFVBQVUsR0FBVSxFQUFFLENBQUM7WUFFN0IsUUFBUSxDQUFDLHFCQUFxQixDQUFDLFVBQVUsRUFBRSxTQUFTLENBQUMsQ0FBQztZQUV0RCxNQUFNLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDOUMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsZ0NBQWdDLEVBQUUsR0FBRyxFQUFFO1lBQ3RDLE1BQU0sU0FBUyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDaEQsTUFBTSxVQUFVLEdBQUc7Z0JBQ2YsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxZQUFZLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRTtnQkFDdEQsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRTtnQkFDNUMsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRTthQUNuRCxDQUFDO1lBRUYsUUFBUSxDQUFDLHFCQUFxQixDQUFDLFVBQVUsRUFBRSxTQUFTLENBQUMsQ0FBQztZQUV0RCxNQUFNLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDMUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDakQsTUFBTSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxTQUFTLENBQUMsWUFBWSxDQUFDLENBQUM7WUFDdEQsTUFBTSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDakQsTUFBTSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDOUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDdEQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsd0NBQXdDLEVBQUUsR0FBRyxFQUFFO1lBQzlDLE1BQU0sU0FBUyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDaEQsTUFBTSxVQUFVLEdBQUc7Z0JBQ2YsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLEtBQUss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RUFBRTthQUM3RCxDQUFDO1lBRUYsTUFBTSxDQUFDLEdBQUcsRUFBRTtnQkFDUixRQUFRLENBQUMscUJBQXFCLENBQUMsVUFBVSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1lBQzFELENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUNyQixDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2tpdGVsZXYvRG9jdW1lbnRzL2V4b2NvcnRleC1vYnNpZGlhbi1wbHVnaW4vdGVzdHMvdW5pdC9wcmVzZW50YXRpb24vcmVuZGVyZXJzL1Byb3BlcnRpZXNCbG9ja1JlbmRlcmVyLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJvcGVydGllc0Jsb2NrUmVuZGVyZXIgfSBmcm9tICcuLi8uLi8uLi8uLi9zcmMvcHJlc2VudGF0aW9uL3JlbmRlcmVycy9Qcm9wZXJ0aWVzQmxvY2tSZW5kZXJlcic7XG5pbXBvcnQgeyBWYXVsdCwgQXBwIH0gZnJvbSAnLi4vLi4vLi4vX19tb2Nrc19fL29ic2lkaWFuJztcblxuZGVzY3JpYmUoJ1Byb3BlcnRpZXNCbG9ja1JlbmRlcmVyJywgKCkgPT4ge1xuICAgIGxldCByZW5kZXJlcjogUHJvcGVydGllc0Jsb2NrUmVuZGVyZXI7XG4gICAgbGV0IG1vY2tWYXVsdDogVmF1bHQ7XG4gICAgbGV0IG1vY2tBcHA6IEFwcDtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgICBtb2NrVmF1bHQgPSBuZXcgVmF1bHQoKTtcbiAgICAgICAgbW9ja0FwcCA9IG5ldyBBcHAoKTtcbiAgICAgICAgY29uc3QgbW9ja1Byb3BlcnR5UmVuZGVyZXIgPSB7XG4gICAgICAgICAgICByZW5kZXJQcm9wZXJ0aWVzQmxvY2s6IGplc3QuZm4oKVxuICAgICAgICB9O1xuICAgICAgICByZW5kZXJlciA9IG5ldyBQcm9wZXJ0aWVzQmxvY2tSZW5kZXJlcihtb2NrQXBwIGFzIGFueSwgbW9ja1Byb3BlcnR5UmVuZGVyZXIgYXMgYW55KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdyZW5kZXJQcm9wZXJ0aWVzQmxvY2snLCAoKSA9PiB7XG4gICAgICAgIGl0KCdzaG91bGQgcmVuZGVyIGVtcHR5IHByb3BlcnRpZXMgbGlzdCcsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgY29uc3QgcHJvcGVydGllczogYW55W10gPSBbXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmVuZGVyZXIucmVuZGVyUHJvcGVydGllc0Jsb2NrKHByb3BlcnRpZXMsIGNvbnRhaW5lcik7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGV4cGVjdChjb250YWluZXIuY2hpbGRyZW4ubGVuZ3RoKS50b0JlKDApO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIHJlbmRlciBiYXNpYyBwcm9wZXJ0aWVzJywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0aWVzID0gW1xuICAgICAgICAgICAgICAgIHsgbmFtZTogJ3RpdGxlJywgdmFsdWU6ICdUZXN0IFRpdGxlJywgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgICAgICAgICAgICB7IG5hbWU6ICdjb3VudCcsIHZhbHVlOiA0MiwgdHlwZTogJ251bWJlcicgfSxcbiAgICAgICAgICAgICAgICB7IG5hbWU6ICdhY3RpdmUnLCB2YWx1ZTogdHJ1ZSwgdHlwZTogJ2Jvb2xlYW4nIH1cbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJlbmRlcmVyLnJlbmRlclByb3BlcnRpZXNCbG9jayhwcm9wZXJ0aWVzLCBjb250YWluZXIpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBleHBlY3QoY29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aCkudG9CZSgzKTtcbiAgICAgICAgICAgIGV4cGVjdChjb250YWluZXIudGV4dENvbnRlbnQpLnRvQ29udGFpbigndGl0bGUnKTtcbiAgICAgICAgICAgIGV4cGVjdChjb250YWluZXIudGV4dENvbnRlbnQpLnRvQ29udGFpbignVGVzdCBUaXRsZScpO1xuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci50ZXh0Q29udGVudCkudG9Db250YWluKCdjb3VudCcpO1xuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci50ZXh0Q29udGVudCkudG9Db250YWluKCc0MicpO1xuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci50ZXh0Q29udGVudCkudG9Db250YWluKCdhY3RpdmUnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgZGlmZmVyZW50IHByb3BlcnR5IHR5cGVzJywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0aWVzID0gW1xuICAgICAgICAgICAgICAgIHsgbmFtZTogJ3RleHQnLCB2YWx1ZTogJ1NhbXBsZSB0ZXh0JywgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgICAgICAgICAgICB7IG5hbWU6ICdkYXRlJywgdmFsdWU6ICcyMDI0LTAxLTE1JywgdHlwZTogJ2RhdGUnIH0sXG4gICAgICAgICAgICAgICAgeyBuYW1lOiAndXJsJywgdmFsdWU6ICdodHRwczovL2V4YW1wbGUuY29tJywgdHlwZTogJ3VybCcgfSxcbiAgICAgICAgICAgICAgICB7IG5hbWU6ICd0YWdzJywgdmFsdWU6IFsndGFnMScsICd0YWcyJ10sIHR5cGU6ICdhcnJheScgfVxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmVuZGVyZXIucmVuZGVyUHJvcGVydGllc0Jsb2NrKHByb3BlcnRpZXMsIGNvbnRhaW5lcik7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGV4cGVjdChjb250YWluZXIuY2hpbGRyZW4ubGVuZ3RoKS50b0JlKDQpO1xuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci50ZXh0Q29udGVudCkudG9Db250YWluKCdTYW1wbGUgdGV4dCcpO1xuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci50ZXh0Q29udGVudCkudG9Db250YWluKCcyMDI0LTAxLTE1Jyk7XG4gICAgICAgICAgICBleHBlY3QoY29udGFpbmVyLnRleHRDb250ZW50KS50b0NvbnRhaW4oJ2h0dHBzOi8vZXhhbXBsZS5jb20nKTtcbiAgICAgICAgICAgIGV4cGVjdChjb250YWluZXIudGV4dENvbnRlbnQpLnRvQ29udGFpbigndGFnMScpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBudWxsIGFuZCB1bmRlZmluZWQgdmFsdWVzJywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0aWVzID0gW1xuICAgICAgICAgICAgICAgIHsgbmFtZTogJ251bGxQcm9wJywgdmFsdWU6IG51bGwsIHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgICAgICAgICAgeyBuYW1lOiAndW5kZWZpbmVkUHJvcCcsIHZhbHVlOiB1bmRlZmluZWQsIHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgICAgICAgICAgeyBuYW1lOiAnZW1wdHlQcm9wJywgdmFsdWU6ICcnLCB0eXBlOiAnc3RyaW5nJyB9XG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZW5kZXJlci5yZW5kZXJQcm9wZXJ0aWVzQmxvY2socHJvcGVydGllcywgY29udGFpbmVyKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGgpLnRvQmUoMyk7XG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0eUVsZW1lbnRzID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5wcm9wZXJ0eS1pdGVtJyk7XG4gICAgICAgICAgICBleHBlY3QocHJvcGVydHlFbGVtZW50cy5sZW5ndGgpLnRvQmUoMyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbXBsZXggbmVzdGVkIHZhbHVlcycsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgY29uc3QgcHJvcGVydGllcyA9IFtcbiAgICAgICAgICAgICAgICB7IFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnbWV0YWRhdGEnLCBcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHsgXG4gICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVkOiAnMjAyNC0wMS0wMScsXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RpZmllZDogJzIwMjQtMDEtMTUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogWydpbXBvcnRhbnQnLCAncHJvamVjdCddXG4gICAgICAgICAgICAgICAgICAgIH0sIFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnb2JqZWN0JyBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZW5kZXJlci5yZW5kZXJQcm9wZXJ0aWVzQmxvY2socHJvcGVydGllcywgY29udGFpbmVyKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGgpLnRvQmUoMSk7XG4gICAgICAgICAgICBleHBlY3QoY29udGFpbmVyLnRleHRDb250ZW50KS50b0NvbnRhaW4oJ21ldGFkYXRhJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgYXBwbHkgY29ycmVjdCBDU1MgY2xhc3NlcycsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgY29uc3QgcHJvcGVydGllcyA9IFtcbiAgICAgICAgICAgICAgICB7IG5hbWU6ICdzdGF0dXMnLCB2YWx1ZTogJ2FjdGl2ZScsIHR5cGU6ICdzdGF0dXMnIH1cbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJlbmRlcmVyLnJlbmRlclByb3BlcnRpZXNCbG9jayhwcm9wZXJ0aWVzLCBjb250YWluZXIpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0eUVsZW1lbnQgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLnByb3BlcnR5LWl0ZW0nKTtcbiAgICAgICAgICAgIGV4cGVjdChwcm9wZXJ0eUVsZW1lbnQpLnRvQmVUcnV0aHkoKTtcbiAgICAgICAgICAgIGV4cGVjdChwcm9wZXJ0eUVsZW1lbnQ/LmNsYXNzTGlzdC5jb250YWlucygncHJvcGVydHktaXRlbScpKS50b0JlKHRydWUpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBlZGl0YWJsZSBwcm9wZXJ0aWVzJywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0aWVzID0gW1xuICAgICAgICAgICAgICAgIHsgbmFtZTogJ2VkaXRhYmxlRmllbGQnLCB2YWx1ZTogJ0VkaXQgbWUnLCB0eXBlOiAnc3RyaW5nJywgZWRpdGFibGU6IHRydWUgfVxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmVuZGVyZXIucmVuZGVyUHJvcGVydGllc0Jsb2NrKHByb3BlcnRpZXMsIGNvbnRhaW5lcik7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0LCB0ZXh0YXJlYScpO1xuICAgICAgICAgICAgZXhwZWN0KGlucHV0KS50b0JlVHJ1dGh5KCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIHJlYWRvbmx5IHByb3BlcnRpZXMnLCAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGNvbnN0IHByb3BlcnRpZXMgPSBbXG4gICAgICAgICAgICAgICAgeyBuYW1lOiAncmVhZG9ubHlGaWVsZCcsIHZhbHVlOiAnQ2Fubm90IGVkaXQnLCB0eXBlOiAnc3RyaW5nJywgcmVhZG9ubHk6IHRydWUgfVxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmVuZGVyZXIucmVuZGVyUHJvcGVydGllc0Jsb2NrKHByb3BlcnRpZXMsIGNvbnRhaW5lcik7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlRWxlbWVudCA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcucHJvcGVydHktdmFsdWUnKTtcbiAgICAgICAgICAgIGV4cGVjdCh2YWx1ZUVsZW1lbnQpLnRvQmVUcnV0aHkoKTtcbiAgICAgICAgICAgIGV4cGVjdCh2YWx1ZUVsZW1lbnQ/LnRleHRDb250ZW50KS50b0NvbnRhaW4oJ0Nhbm5vdCBlZGl0Jyk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ3Byb3BlcnR5IGZvcm1hdHRpbmcnLCAoKSA9PiB7XG4gICAgICAgIGl0KCdzaG91bGQgZm9ybWF0IGRhdGVzIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgY29uc3QgcHJvcGVydGllcyA9IFtcbiAgICAgICAgICAgICAgICB7IG5hbWU6ICdjcmVhdGVkJywgdmFsdWU6ICcyMDI0LTAxLTE1VDEwOjMwOjAwWicsIHR5cGU6ICdkYXRlJyB9XG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZW5kZXJlci5yZW5kZXJQcm9wZXJ0aWVzQmxvY2socHJvcGVydGllcywgY29udGFpbmVyKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgZGF0ZUVsZW1lbnQgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLnByb3BlcnR5LXZhbHVlJyk7XG4gICAgICAgICAgICBleHBlY3QoZGF0ZUVsZW1lbnQpLnRvQmVUcnV0aHkoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBmb3JtYXQgbnVtYmVycyBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGNvbnN0IHByb3BlcnRpZXMgPSBbXG4gICAgICAgICAgICAgICAgeyBuYW1lOiAncHJpY2UnLCB2YWx1ZTogMTIzNC41NiwgdHlwZTogJ2N1cnJlbmN5JyB9LFxuICAgICAgICAgICAgICAgIHsgbmFtZTogJ3BlcmNlbnRhZ2UnLCB2YWx1ZTogMC44NSwgdHlwZTogJ3BlcmNlbnRhZ2UnIH1cbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJlbmRlcmVyLnJlbmRlclByb3BlcnRpZXNCbG9jayhwcm9wZXJ0aWVzLCBjb250YWluZXIpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBleHBlY3QoY29udGFpbmVyLnRleHRDb250ZW50KS50b0NvbnRhaW4oJzEyMzQuNTYnKTtcbiAgICAgICAgICAgIGV4cGVjdChjb250YWluZXIudGV4dENvbnRlbnQpLnRvQ29udGFpbignMC44NScpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIGZvcm1hdCBhcnJheXMgYXMgbGlzdHMnLCAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGNvbnN0IHByb3BlcnRpZXMgPSBbXG4gICAgICAgICAgICAgICAgeyBuYW1lOiAndGFncycsIHZhbHVlOiBbJ3dlYicsICdkZXZlbG9wbWVudCcsICdqYXZhc2NyaXB0J10sIHR5cGU6ICd0YWdzJyB9XG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZW5kZXJlci5yZW5kZXJQcm9wZXJ0aWVzQmxvY2socHJvcGVydGllcywgY29udGFpbmVyKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgdGFnRWxlbWVudHMgPSBjb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLnRhZycpO1xuICAgICAgICAgICAgZXhwZWN0KHRhZ0VsZW1lbnRzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdlcnJvciBoYW5kbGluZycsICgpID0+IHtcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgbnVsbCBjb250YWluZXInLCAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0aWVzID0gW3sgbmFtZTogJ3Rlc3QnLCB2YWx1ZTogJ3ZhbHVlJywgdHlwZTogJ3N0cmluZycgfV07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgcmVuZGVyZXIucmVuZGVyUHJvcGVydGllc0Jsb2NrKHByb3BlcnRpZXMsIG51bGwgYXMgYW55KTtcbiAgICAgICAgICAgIH0pLm5vdC50b1Rocm93KCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIG1hbGZvcm1lZCBwcm9wZXJ0eSBvYmplY3RzJywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0aWVzID0gW1xuICAgICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHsgbmFtZTogJ2luY29tcGxldGUnIH0sIC8vIG1pc3NpbmcgdmFsdWUgYW5kIHR5cGVcbiAgICAgICAgICAgICAgICB7IHZhbHVlOiAnb3JwaGFuZWQnIH0sIC8vIG1pc3NpbmcgbmFtZSBhbmQgdHlwZVxuICAgICAgICAgICAgICAgICdpbnZhbGlkJyBhcyBhbnlcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgcmVuZGVyZXIucmVuZGVyUHJvcGVydGllc0Jsb2NrKHByb3BlcnRpZXMsIGNvbnRhaW5lcik7XG4gICAgICAgICAgICB9KS5ub3QudG9UaHJvdygpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBpbnZhbGlkIHByb3BlcnR5IHR5cGVzJywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0aWVzID0gW1xuICAgICAgICAgICAgICAgIHsgbmFtZTogJ3Rlc3QnLCB2YWx1ZTogJ3ZhbHVlJywgdHlwZTogJ25vbmV4aXN0ZW50LXR5cGUnIH1cbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgcmVuZGVyZXIucmVuZGVyUHJvcGVydGllc0Jsb2NrKHByb3BlcnRpZXMsIGNvbnRhaW5lcik7XG4gICAgICAgICAgICB9KS5ub3QudG9UaHJvdygpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==