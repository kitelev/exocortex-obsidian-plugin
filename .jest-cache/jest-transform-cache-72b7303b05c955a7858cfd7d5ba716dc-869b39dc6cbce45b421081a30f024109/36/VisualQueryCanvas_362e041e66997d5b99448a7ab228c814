24cf7f1028c56bd190bfe5bf606df154
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.VisualQueryCanvas = void 0;
const tslib_1 = require("tslib");
const VisualQueryNode_1 = require("../../domain/visual/VisualQueryNode");
const VisualQueryEdge_1 = require("../../domain/visual/VisualQueryEdge");
const obsidian_1 = require("obsidian");
const TemplateSelectionPanel_1 = require("./TemplateSelectionPanel");
const TemplateParameterModal_1 = require("../modals/TemplateParameterModal");
const SaveTemplateModal_1 = require("../modals/SaveTemplateModal");
class VisualQueryCanvas {
    constructor(parentElement, optionsOrSparqlProcessor, sparqlProcessorOrOptions) {
        this.parentElement = parentElement;
        this.nodes = new Map();
        this.edges = new Map();
        this.selectedNodes = new Set();
        this.selectedEdges = new Set();
        this.isDragging = false;
        this.isPanning = false;
        this.isConnecting = false;
        this.currentMousePosition = { x: 0, y: 0 };
        this.viewportX = 0;
        this.viewportY = 0;
        this.zoom = 1;
        this.defaultOptions = {
            width: 800,
            height: 600,
            gridSize: 20,
            showGrid: true,
            zoomMin: 0.1,
            zoomMax: 5,
            zoomStep: 0.1,
            onQueryChange: () => { },
            onExecute: () => { },
            enableTemplates: true,
            templateUseCase: undefined,
            appInstance: undefined,
            allowPan: true,
            minZoom: 0.1,
            maxZoom: 5,
            onNodeSelect: () => { },
            onEdgeSelect: () => { },
            onNodeEdit: () => { },
            onEdgeEdit: () => { },
            onQueryGenerated: () => { },
            onExecuteQuery: () => { }
        };
        // Handle multiple constructor signatures for backward compatibility
        let options = {};
        let sparqlProcessor;
        if (optionsOrSparqlProcessor) {
            // Check if first param is SPARQLProcessor (old signature)
            if (typeof optionsOrSparqlProcessor === 'object' && 'executeQuery' in optionsOrSparqlProcessor) {
                sparqlProcessor = optionsOrSparqlProcessor;
                options = sparqlProcessorOrOptions || {};
            }
            // Check if first param is options (new signature: parentElement, options, sparqlProcessor)
            else if (typeof optionsOrSparqlProcessor === 'object') {
                options = optionsOrSparqlProcessor;
                if (sparqlProcessorOrOptions && 'executeQuery' in sparqlProcessorOrOptions) {
                    sparqlProcessor = sparqlProcessorOrOptions;
                }
            }
        }
        this.options = Object.assign(Object.assign({}, this.defaultOptions), options);
        this.sparqlProcessor = sparqlProcessor;
        this.createCanvas();
        this.attachEventListeners();
        this.render();
    }
    createCanvas() {
        this.container = document.createElement('div');
        this.container.className = 'exocortex-visual-query-canvas';
        this.container.style.cssText = `
            position: relative;
            width: ${this.options.width}px;
            height: ${this.options.height}px;
            border: 2px solid var(--background-modifier-border);
            border-radius: var(--radius-m);
            background: var(--background-primary);
            overflow: hidden;
            user-select: none;
        `;
        const svgNS = 'http://www.w3.org/2000/svg';
        this.svg = document.createElementNS(svgNS, 'svg');
        this.svg.setAttribute('width', '100%');
        this.svg.setAttribute('height', '100%');
        this.svg.style.cssText = 'cursor: grab;';
        this.gridGroup = document.createElementNS(svgNS, 'g');
        this.gridGroup.setAttribute('class', 'grid-group');
        this.svg.appendChild(this.gridGroup);
        this.edgesGroup = document.createElementNS(svgNS, 'g');
        this.edgesGroup.setAttribute('class', 'edges-group');
        this.svg.appendChild(this.edgesGroup);
        this.nodesGroup = document.createElementNS(svgNS, 'g');
        this.nodesGroup.setAttribute('class', 'nodes-group');
        this.svg.appendChild(this.nodesGroup);
        this.overlayGroup = document.createElementNS(svgNS, 'g');
        this.overlayGroup.setAttribute('class', 'overlay-group');
        this.svg.appendChild(this.overlayGroup);
        this.container.appendChild(this.svg);
        this.createControls();
        this.parentElement.appendChild(this.container);
        if (this.options.showGrid) {
            this.drawGrid();
        }
    }
    createControls() {
        const controls = document.createElement('div');
        controls.className = 'canvas-toolbar';
        controls.style.cssText = `
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 8px;
            padding: 8px;
            background: var(--background-secondary);
            border-radius: var(--radius-s);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            flex-wrap: wrap;
            max-width: 300px;
        `;
        // Template controls (if enabled)
        if (this.options.enableTemplates && this.options.templateUseCase) {
            const templatesBtn = this.createControlButton('Templates', () => this.showTemplateSelection());
            const saveTemplateBtn = this.createControlButton('Save Template', () => this.showSaveTemplateModal());
            controls.appendChild(templatesBtn);
            controls.appendChild(saveTemplateBtn);
            const templateSeparator = document.createElement('div');
            templateSeparator.style.cssText = 'width: 1px; background: var(--background-modifier-border); margin: 0 4px;';
            controls.appendChild(templateSeparator);
        }
        const addEntityBtn = this.createControlButton('Entity', () => this.addNode(VisualQueryNode_1.NodeType.ENTITY));
        const addVariableBtn = this.createControlButton('Variable', () => this.addNode(VisualQueryNode_1.NodeType.VARIABLE));
        const addLiteralBtn = this.createControlButton('Literal', () => this.addNode(VisualQueryNode_1.NodeType.LITERAL));
        const addFilterBtn = this.createControlButton('Filter', () => this.addNode(VisualQueryNode_1.NodeType.FILTER));
        const generateBtn = this.createControlButton('Generate', () => this.generateSPARQL());
        const executeBtn = this.createControlButton('Execute', () => this.executeQuery(), true);
        const clearBtn = this.createControlButton('Clear', () => this.clearCanvas());
        controls.appendChild(addEntityBtn);
        controls.appendChild(addVariableBtn);
        controls.appendChild(addLiteralBtn);
        controls.appendChild(addFilterBtn);
        controls.appendChild(generateBtn);
        controls.appendChild(executeBtn);
        controls.appendChild(clearBtn);
        this.container.appendChild(controls);
        const zoomControls = document.createElement('div');
        zoomControls.className = 'zoom-controls';
        zoomControls.style.cssText = `
            position: absolute;
            bottom: 10px;
            right: 10px;
            display: flex;
            gap: 4px;
            padding: 4px;
            background: var(--background-secondary);
            border-radius: var(--radius-s);
        `;
        const zoomInBtn = this.createZoomButton('+', () => this.zoomIn());
        const zoomOutBtn = this.createZoomButton('-', () => this.zoomOut());
        const zoomResetBtn = this.createZoomButton('âŸ²', () => this.resetZoom());
        zoomControls.appendChild(zoomOutBtn);
        zoomControls.appendChild(zoomResetBtn);
        zoomControls.appendChild(zoomInBtn);
        this.container.appendChild(zoomControls);
    }
    createControlButton(label, onClick, primary = false) {
        const button = document.createElement('button');
        button.textContent = label;
        button.className = primary ? 'mod-cta' : '';
        button.style.cssText = `
            padding: 6px 12px;
            border: none;
            border-radius: var(--radius-s);
            background: ${primary ? 'var(--interactive-accent)' : 'var(--interactive-normal)'};
            color: ${primary ? 'var(--text-on-accent)' : 'var(--text-normal)'};
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: background-color 0.15s ease;
        `;
        button.addEventListener('mouseenter', () => {
            button.style.background = primary ? 'var(--interactive-accent-hover)' : 'var(--interactive-hover)';
        });
        button.addEventListener('mouseleave', () => {
            button.style.background = primary ? 'var(--interactive-accent)' : 'var(--interactive-normal)';
        });
        button.addEventListener('click', onClick);
        return button;
    }
    createZoomButton(label, onClick) {
        const button = document.createElement('button');
        button.textContent = label;
        button.style.cssText = `
            width: 24px;
            height: 24px;
            border: none;
            border-radius: var(--radius-s);
            background: var(--interactive-normal);
            color: var(--text-normal);
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.15s ease;
        `;
        button.addEventListener('mouseenter', () => {
            button.style.background = 'var(--interactive-hover)';
        });
        button.addEventListener('mouseleave', () => {
            button.style.background = 'var(--interactive-normal)';
        });
        button.addEventListener('click', onClick);
        return button;
    }
    drawGrid() {
        const svgNS = 'http://www.w3.org/2000/svg';
        this.gridGroup.innerHTML = '';
        const pattern = document.createElementNS(svgNS, 'pattern');
        pattern.setAttribute('id', 'grid-pattern');
        pattern.setAttribute('width', this.options.gridSize.toString());
        pattern.setAttribute('height', this.options.gridSize.toString());
        pattern.setAttribute('patternUnits', 'userSpaceOnUse');
        const line1 = document.createElementNS(svgNS, 'line');
        line1.setAttribute('x1', '0');
        line1.setAttribute('y1', '0');
        line1.setAttribute('x2', this.options.gridSize.toString());
        line1.setAttribute('y2', '0');
        line1.setAttribute('stroke', 'var(--background-modifier-border)');
        line1.setAttribute('stroke-width', '0.5');
        line1.setAttribute('opacity', '0.3');
        const line2 = document.createElementNS(svgNS, 'line');
        line2.setAttribute('x1', '0');
        line2.setAttribute('y1', '0');
        line2.setAttribute('x2', '0');
        line2.setAttribute('y2', this.options.gridSize.toString());
        line2.setAttribute('stroke', 'var(--background-modifier-border)');
        line2.setAttribute('stroke-width', '0.5');
        line2.setAttribute('opacity', '0.3');
        pattern.appendChild(line1);
        pattern.appendChild(line2);
        const defs = document.createElementNS(svgNS, 'defs');
        defs.appendChild(pattern);
        this.svg.insertBefore(defs, this.svg.firstChild);
        const rect = document.createElementNS(svgNS, 'rect');
        rect.setAttribute('width', '100%');
        rect.setAttribute('height', '100%');
        rect.setAttribute('fill', 'url(#grid-pattern)');
        this.gridGroup.appendChild(rect);
    }
    attachEventListeners() {
        this.svg.addEventListener('mousedown', this.handleMouseDown.bind(this));
        this.svg.addEventListener('mousemove', this.handleMouseMove.bind(this));
        this.svg.addEventListener('mouseup', this.handleMouseUp.bind(this));
        this.svg.addEventListener('wheel', this.handleWheel.bind(this));
        this.svg.addEventListener('contextmenu', this.handleContextMenu.bind(this));
        document.addEventListener('keydown', this.handleKeyDown.bind(this));
    }
    handleMouseDown(e) {
        e.preventDefault();
        const point = this.getMousePosition(e);
        this.dragStartPosition = point;
        if (e.button === 1 || (e.button === 0 && e.shiftKey)) {
            this.isPanning = true;
            this.svg.style.cursor = 'grabbing';
            return;
        }
        const clickedNode = this.getNodeAt(point);
        const clickedEdge = this.getEdgeAt(point);
        if (e.button === 0) {
            if (clickedNode) {
                if (e.ctrlKey) {
                    this.toggleNodeSelection(clickedNode);
                }
                else if (e.altKey) {
                    this.startConnection(clickedNode);
                }
                else {
                    if (!this.selectedNodes.has(clickedNode)) {
                        this.clearSelection();
                        this.selectNode(clickedNode);
                    }
                    this.isDragging = true;
                }
            }
            else if (clickedEdge) {
                this.clearSelection();
                this.selectEdge(clickedEdge);
            }
            else {
                this.clearSelection();
            }
        }
    }
    handleMouseMove(e) {
        const point = this.getMousePosition(e);
        this.currentMousePosition = point;
        if (this.isPanning && this.dragStartPosition) {
            const dx = point.x - this.dragStartPosition.x;
            const dy = point.y - this.dragStartPosition.y;
            this.viewportX += dx / this.zoom;
            this.viewportY += dy / this.zoom;
            this.dragStartPosition = point;
            this.updateTransform();
        }
        else if (this.isDragging && this.dragStartPosition) {
            const dx = (point.x - this.dragStartPosition.x) / this.zoom;
            const dy = (point.y - this.dragStartPosition.y) / this.zoom;
            this.selectedNodes.forEach(nodeId => {
                const node = this.nodes.get(nodeId);
                if (node) {
                    const pos = node.getPosition();
                    node.setPosition({
                        x: pos.x + dx,
                        y: pos.y + dy
                    });
                }
            });
            this.dragStartPosition = point;
            this.render();
        }
        else if (this.isConnecting && this.tempConnectionLine) {
            const svgPoint = this.getSVGPoint(point);
            this.tempConnectionLine.setAttribute('x2', svgPoint.x.toString());
            this.tempConnectionLine.setAttribute('y2', svgPoint.y.toString());
        }
    }
    handleMouseUp(e) {
        if (this.isConnecting) {
            const point = this.getMousePosition(e);
            const targetNode = this.getNodeAt(point);
            if (targetNode && targetNode !== this.connectionSourceNode) {
                this.createEdge(this.connectionSourceNode, targetNode);
            }
            this.endConnection();
        }
        this.isDragging = false;
        this.isPanning = false;
        this.dragStartPosition = undefined;
        this.svg.style.cursor = 'grab';
    }
    handleWheel(e) {
        e.preventDefault();
        const delta = e.deltaY > 0 ? -this.options.zoomStep : this.options.zoomStep;
        const newZoom = Math.max(this.options.zoomMin, Math.min(this.options.zoomMax, this.zoom + delta));
        if (newZoom !== this.zoom) {
            const point = this.getMousePosition(e);
            const scaleFactor = newZoom / this.zoom;
            this.viewportX = point.x - (point.x - this.viewportX) * scaleFactor;
            this.viewportY = point.y - (point.y - this.viewportY) * scaleFactor;
            this.zoom = newZoom;
            this.updateTransform();
        }
    }
    handleContextMenu(e) {
        e.preventDefault();
        const point = this.getMousePosition(e);
        const clickedNode = this.getNodeAt(point);
        const clickedEdge = this.getEdgeAt(point);
        if (clickedNode) {
            this.showNodeContextMenu(clickedNode, point);
        }
        else if (clickedEdge) {
            this.showEdgeContextMenu(clickedEdge, point);
        }
    }
    handleKeyDown(e) {
        if (!this.container.contains(document.activeElement))
            return;
        if (e.key === 'Delete' || e.key === 'Backspace') {
            e.preventDefault();
            this.deleteSelected();
        }
        else if (e.key === 'a' && e.ctrlKey) {
            e.preventDefault();
            this.selectAll();
        }
        else if (e.key === 'Escape') {
            this.clearSelection();
        }
    }
    getMousePosition(e) {
        const rect = this.svg.getBoundingClientRect();
        return {
            x: e.clientX - rect.left,
            y: e.clientY - rect.top
        };
    }
    getSVGPoint(point) {
        return {
            x: (point.x - this.viewportX) / this.zoom,
            y: (point.y - this.viewportY) / this.zoom
        };
    }
    getNodeAt(point) {
        const svgPoint = this.getSVGPoint(point);
        for (const [id, node] of this.nodes) {
            if (node.containsPoint(svgPoint.x, svgPoint.y)) {
                return id;
            }
        }
        return null;
    }
    getEdgeAt(point) {
        const svgPoint = this.getSVGPoint(point);
        const threshold = 5;
        for (const [id, edge] of this.edges) {
            const source = this.nodes.get(edge.getSourceNodeId());
            const target = this.nodes.get(edge.getTargetNodeId());
            if (source && target) {
                const labelPos = edge.getLabelPosition(source, target);
                const distance = Math.sqrt(Math.pow(svgPoint.x - labelPos.x, 2) +
                    Math.pow(svgPoint.y - labelPos.y, 2));
                if (distance < threshold) {
                    return id;
                }
            }
        }
        return null;
    }
    startConnection(nodeId) {
        this.isConnecting = true;
        this.connectionSourceNode = nodeId;
        const node = this.nodes.get(nodeId);
        if (!node)
            return;
        const svgNS = 'http://www.w3.org/2000/svg';
        this.tempConnectionLine = document.createElementNS(svgNS, 'line');
        const sourcePoint = node.getConnectionPoints().right;
        this.tempConnectionLine.setAttribute('x1', sourcePoint.x.toString());
        this.tempConnectionLine.setAttribute('y1', sourcePoint.y.toString());
        this.tempConnectionLine.setAttribute('x2', sourcePoint.x.toString());
        this.tempConnectionLine.setAttribute('y2', sourcePoint.y.toString());
        this.tempConnectionLine.setAttribute('stroke', 'var(--text-accent)');
        this.tempConnectionLine.setAttribute('stroke-width', '2');
        this.tempConnectionLine.setAttribute('stroke-dasharray', '5,5');
        this.tempConnectionLine.setAttribute('opacity', '0.6');
        this.overlayGroup.appendChild(this.tempConnectionLine);
    }
    endConnection() {
        this.isConnecting = false;
        this.connectionSourceNode = undefined;
        if (this.tempConnectionLine) {
            this.tempConnectionLine.remove();
            this.tempConnectionLine = undefined;
        }
    }
    createEdge(sourceId, targetId) {
        const edge = VisualQueryEdge_1.VisualQueryEdge.createProperty(sourceId, targetId, 'property', undefined);
        this.edges.set(edge.getId(), edge);
        this.render();
        this.updateQuery();
    }
    selectNode(nodeId) {
        this.selectedNodes.add(nodeId);
        const node = this.nodes.get(nodeId);
        if (node) {
            node.setSelected(true);
        }
        this.render();
    }
    selectEdge(edgeId) {
        this.selectedEdges.add(edgeId);
        const edge = this.edges.get(edgeId);
        if (edge) {
            edge.setSelected(true);
        }
        this.render();
    }
    toggleNodeSelection(nodeId) {
        if (this.selectedNodes.has(nodeId)) {
            this.selectedNodes.delete(nodeId);
            const node = this.nodes.get(nodeId);
            if (node) {
                node.setSelected(false);
            }
        }
        else {
            this.selectNode(nodeId);
        }
        this.render();
    }
    clearSelection() {
        this.selectedNodes.forEach(id => {
            const node = this.nodes.get(id);
            if (node)
                node.setSelected(false);
        });
        this.selectedEdges.forEach(id => {
            const edge = this.edges.get(id);
            if (edge)
                edge.setSelected(false);
        });
        this.selectedNodes.clear();
        this.selectedEdges.clear();
        this.render();
    }
    selectAll() {
        this.nodes.forEach((node, id) => {
            this.selectedNodes.add(id);
            node.setSelected(true);
        });
        this.edges.forEach((edge, id) => {
            this.selectedEdges.add(id);
            edge.setSelected(true);
        });
        this.render();
    }
    deleteSelected() {
        this.selectedEdges.forEach(id => {
            this.edges.delete(id);
        });
        this.selectedNodes.forEach(id => {
            this.edges.forEach((edge, edgeId) => {
                if (edge.getSourceNodeId() === id || edge.getTargetNodeId() === id) {
                    this.edges.delete(edgeId);
                }
            });
            this.nodes.delete(id);
        });
        this.clearSelection();
        this.render();
        this.updateQuery();
    }
    showNodeContextMenu(nodeId, position) {
        const node = this.nodes.get(nodeId);
        if (!node)
            return;
        const menu = document.createElement('div');
        menu.className = 'context-menu';
        menu.style.cssText = `
            position: absolute;
            left: ${position.x}px;
            top: ${position.y}px;
            background: var(--background-secondary);
            border: 1px solid var(--background-modifier-border);
            border-radius: var(--radius-s);
            padding: 4px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            z-index: 1000;
        `;
        const editOption = this.createMenuOption('Edit Label', () => {
            const newLabel = prompt('Enter new label:', node.getLabel());
            if (newLabel) {
                node.setLabel(newLabel);
                this.render();
                this.updateQuery();
            }
            menu.remove();
        });
        const deleteOption = this.createMenuOption('Delete', () => {
            this.nodes.delete(nodeId);
            this.edges.forEach((edge, id) => {
                if (edge.getSourceNodeId() === nodeId || edge.getTargetNodeId() === nodeId) {
                    this.edges.delete(id);
                }
            });
            this.render();
            this.updateQuery();
            menu.remove();
        });
        menu.appendChild(editOption);
        menu.appendChild(deleteOption);
        this.container.appendChild(menu);
        setTimeout(() => {
            document.addEventListener('click', () => menu.remove(), { once: true });
        }, 10);
    }
    showEdgeContextMenu(edgeId, position) {
        const edge = this.edges.get(edgeId);
        if (!edge)
            return;
        const menu = document.createElement('div');
        menu.className = 'context-menu';
        menu.style.cssText = `
            position: absolute;
            left: ${position.x}px;
            top: ${position.y}px;
            background: var(--background-secondary);
            border: 1px solid var(--background-modifier-border);
            border-radius: var(--radius-s);
            padding: 4px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            z-index: 1000;
        `;
        const editOption = this.createMenuOption('Edit Property', () => {
            const newLabel = prompt('Enter property name:', edge.getLabel());
            if (newLabel) {
                edge.setLabel(newLabel);
                this.render();
                this.updateQuery();
            }
            menu.remove();
        });
        const toggleOptionalOption = this.createMenuOption(edge.isOptional() ? 'Make Required' : 'Make Optional', () => {
            const newEdge = edge.isOptional()
                ? VisualQueryEdge_1.VisualQueryEdge.createProperty(edge.getSourceNodeId(), edge.getTargetNodeId(), edge.getLabel(), edge.getPropertyUri())
                : VisualQueryEdge_1.VisualQueryEdge.createOptional(edge.getSourceNodeId(), edge.getTargetNodeId(), edge.getLabel(), edge.getPropertyUri());
            this.edges.delete(edgeId);
            this.edges.set(newEdge.getId(), newEdge);
            this.render();
            this.updateQuery();
            menu.remove();
        });
        const deleteOption = this.createMenuOption('Delete', () => {
            this.edges.delete(edgeId);
            this.render();
            this.updateQuery();
            menu.remove();
        });
        menu.appendChild(editOption);
        menu.appendChild(toggleOptionalOption);
        menu.appendChild(deleteOption);
        this.container.appendChild(menu);
        setTimeout(() => {
            document.addEventListener('click', () => menu.remove(), { once: true });
        }, 10);
    }
    createMenuOption(label, onClick) {
        const option = document.createElement('div');
        option.textContent = label;
        option.style.cssText = `
            padding: 6px 12px;
            cursor: pointer;
            border-radius: var(--radius-s);
            font-size: 12px;
            transition: background-color 0.15s ease;
        `;
        option.addEventListener('mouseenter', () => {
            option.style.background = 'var(--background-modifier-hover)';
        });
        option.addEventListener('mouseleave', () => {
            option.style.background = '';
        });
        option.addEventListener('click', onClick);
        return option;
    }
    updateTransform() {
        const transform = `translate(${this.viewportX}px, ${this.viewportY}px) scale(${this.zoom})`;
        this.nodesGroup.style.transform = transform;
        this.edgesGroup.style.transform = transform;
        this.gridGroup.style.transform = transform;
    }
    render() {
        this.renderEdges();
        this.renderNodes();
    }
    renderNodes() {
        const svgNS = 'http://www.w3.org/2000/svg';
        this.nodesGroup.innerHTML = '';
        this.nodes.forEach(node => {
            const g = document.createElementNS(svgNS, 'g');
            g.setAttribute('class', 'query-node');
            const pos = node.getPosition();
            const dims = node.getDimensions();
            const rect = document.createElementNS(svgNS, 'rect');
            rect.setAttribute('x', pos.x.toString());
            rect.setAttribute('y', pos.y.toString());
            rect.setAttribute('width', dims.width.toString());
            rect.setAttribute('height', dims.height.toString());
            rect.setAttribute('rx', '4');
            rect.setAttribute('ry', '4');
            const colors = this.getNodeColors(node.getType());
            rect.setAttribute('fill', colors.fill);
            rect.setAttribute('stroke', node.isSelected() ? 'var(--text-accent)' : colors.stroke);
            rect.setAttribute('stroke-width', node.isSelected() ? '2' : '1');
            const text = document.createElementNS(svgNS, 'text');
            text.setAttribute('x', (pos.x + dims.width / 2).toString());
            text.setAttribute('y', (pos.y + dims.height / 2 + 4).toString());
            text.setAttribute('text-anchor', 'middle');
            text.setAttribute('fill', colors.text);
            text.setAttribute('font-size', '12');
            text.setAttribute('font-weight', '500');
            text.textContent = node.getLabel();
            g.appendChild(rect);
            g.appendChild(text);
            this.nodesGroup.appendChild(g);
        });
    }
    renderEdges() {
        const svgNS = 'http://www.w3.org/2000/svg';
        this.edgesGroup.innerHTML = '';
        this.edges.forEach(edge => {
            const source = this.nodes.get(edge.getSourceNodeId());
            const target = this.nodes.get(edge.getTargetNodeId());
            if (!source || !target)
                return;
            const g = document.createElementNS(svgNS, 'g');
            g.setAttribute('class', 'query-edge');
            const path = document.createElementNS(svgNS, 'path');
            path.setAttribute('d', edge.calculatePath(source, target));
            path.setAttribute('fill', 'none');
            path.setAttribute('stroke', edge.isSelected() ? 'var(--text-accent)' : 'var(--text-muted)');
            path.setAttribute('stroke-width', edge.isSelected() ? '2' : '1');
            if (edge.isOptional()) {
                path.setAttribute('stroke-dasharray', '5,5');
            }
            const labelPos = edge.getLabelPosition(source, target);
            const labelBg = document.createElementNS(svgNS, 'rect');
            const labelText = document.createElementNS(svgNS, 'text');
            labelText.setAttribute('x', labelPos.x.toString());
            labelText.setAttribute('y', labelPos.y.toString());
            labelText.setAttribute('text-anchor', 'middle');
            labelText.setAttribute('fill', 'var(--text-normal)');
            labelText.setAttribute('font-size', '10');
            labelText.textContent = edge.getLabel();
            const bbox = { width: edge.getLabel().length * 6 + 8, height: 16 };
            labelBg.setAttribute('x', (labelPos.x - bbox.width / 2).toString());
            labelBg.setAttribute('y', (labelPos.y - bbox.height / 2).toString());
            labelBg.setAttribute('width', bbox.width.toString());
            labelBg.setAttribute('height', bbox.height.toString());
            labelBg.setAttribute('fill', 'var(--background-primary)');
            labelBg.setAttribute('rx', '2');
            g.appendChild(path);
            g.appendChild(labelBg);
            g.appendChild(labelText);
            this.edgesGroup.appendChild(g);
        });
    }
    getNodeColors(type) {
        const isDark = document.body.classList.contains('theme-dark');
        const lightColors = {
            [VisualQueryNode_1.NodeType.ENTITY]: { fill: '#e3f2fd', stroke: '#1976d2', text: '#0d47a1' },
            [VisualQueryNode_1.NodeType.VARIABLE]: { fill: '#fff3e0', stroke: '#f57c00', text: '#e65100' },
            [VisualQueryNode_1.NodeType.LITERAL]: { fill: '#f3e5f5', stroke: '#7b1fa2', text: '#4a148c' },
            [VisualQueryNode_1.NodeType.FILTER]: { fill: '#e8f5e8', stroke: '#388e3c', text: '#1b5e20' }
        };
        const darkColors = {
            [VisualQueryNode_1.NodeType.ENTITY]: { fill: 'rgba(33, 150, 243, 0.2)', stroke: '#2196f3', text: '#90caf9' },
            [VisualQueryNode_1.NodeType.VARIABLE]: { fill: 'rgba(255, 152, 0, 0.2)', stroke: '#ff9800', text: '#ffb74d' },
            [VisualQueryNode_1.NodeType.LITERAL]: { fill: 'rgba(156, 39, 176, 0.2)', stroke: '#9c27b0', text: '#ce93d8' },
            [VisualQueryNode_1.NodeType.FILTER]: { fill: 'rgba(76, 175, 80, 0.2)', stroke: '#4caf50', text: '#81c784' }
        };
        return isDark ? darkColors[type] : lightColors[type];
    }
    addNode(nodeOrType) {
        var _a, _b;
        if (typeof nodeOrType === 'object' && 'getId' in nodeOrType) {
            // Direct node addition for testing/programmatic use
            const node = nodeOrType;
            this.nodes.set(node.getId(), node);
            (_b = (_a = this.options).onNodeSelect) === null || _b === void 0 ? void 0 : _b.call(_a, node);
            this.render();
            this.updateQuery();
            return;
        }
        // Interactive node creation
        const type = nodeOrType;
        const centerX = (this.options.width / 2 - this.viewportX) / this.zoom;
        const centerY = (this.options.height / 2 - this.viewportY) / this.zoom;
        let node;
        switch (type) {
            case VisualQueryNode_1.NodeType.ENTITY:
                const entityName = prompt('Enter entity name:');
                if (!entityName)
                    return;
                node = VisualQueryNode_1.VisualQueryNode.createEntity(entityName, undefined, { x: centerX, y: centerY });
                break;
            case VisualQueryNode_1.NodeType.VARIABLE:
                const varName = prompt('Enter variable name (without ?):');
                if (!varName)
                    return;
                node = VisualQueryNode_1.VisualQueryNode.createVariable(varName, { x: centerX, y: centerY });
                break;
            case VisualQueryNode_1.NodeType.LITERAL:
                const literalValue = prompt('Enter literal value:');
                if (!literalValue)
                    return;
                node = VisualQueryNode_1.VisualQueryNode.createLiteral(literalValue, { x: centerX, y: centerY });
                break;
            case VisualQueryNode_1.NodeType.FILTER:
                const filterExpr = prompt('Enter filter expression:');
                if (!filterExpr)
                    return;
                node = VisualQueryNode_1.VisualQueryNode.createFilter(filterExpr, { x: centerX, y: centerY });
                break;
            default:
                return;
        }
        this.nodes.set(node.getId(), node);
        this.render();
        this.updateQuery();
    }
    addEdge(edge) {
        var _a, _b;
        // Validate that both source and target nodes exist
        const sourceExists = this.nodes.has(edge.getSourceNodeId());
        const targetExists = this.nodes.has(edge.getTargetNodeId());
        if (!sourceExists || !targetExists) {
            console.warn('Cannot add edge: source or target node not found');
            return;
        }
        this.edges.set(edge.getId(), edge);
        (_b = (_a = this.options).onEdgeSelect) === null || _b === void 0 ? void 0 : _b.call(_a, edge);
        this.render();
        this.updateQuery();
    }
    getSelectedNodes() {
        return Array.from(this.selectedNodes);
    }
    getSelectedEdges() {
        return Array.from(this.selectedEdges);
    }
    exportToSVG() {
        const serializer = new XMLSerializer();
        return serializer.serializeToString(this.svg);
    }
    updateQuery() {
        const sparql = this.generateSPARQL();
        this.options.onQueryChange(sparql);
        if (this.options.onQueryGenerated) {
            this.options.onQueryGenerated(sparql);
        }
    }
    generateSPARQL() {
        var _a, _b, _c, _d;
        if (this.nodes.size === 0) {
            const query = 'SELECT *\nWHERE {\n  ?s ?p ?o .\n}';
            (_b = (_a = this.options).onQueryGenerated) === null || _b === void 0 ? void 0 : _b.call(_a, query);
            return query;
        }
        const variables = new Set();
        const patterns = [];
        const filters = [];
        const optionalPatterns = [];
        this.nodes.forEach(node => {
            if (node.getType() === VisualQueryNode_1.NodeType.VARIABLE) {
                variables.add(node.toSPARQLElement());
            }
            else if (node.getType() === VisualQueryNode_1.NodeType.FILTER) {
                filters.push(`FILTER (${node.getLabel()})`);
            }
        });
        this.edges.forEach(edge => {
            const source = this.nodes.get(edge.getSourceNodeId());
            const target = this.nodes.get(edge.getTargetNodeId());
            if (source && target) {
                const pattern = `${source.toSPARQLElement()} ${edge.toSPARQLPredicate()} ${target.toSPARQLElement()}`;
                if (edge.isOptional()) {
                    optionalPatterns.push(pattern);
                }
                else {
                    patterns.push(pattern);
                }
                if (source.getType() === VisualQueryNode_1.NodeType.VARIABLE) {
                    variables.add(source.toSPARQLElement());
                }
                if (target.getType() === VisualQueryNode_1.NodeType.VARIABLE) {
                    variables.add(target.toSPARQLElement());
                }
            }
        });
        if (variables.size === 0 && patterns.length === 0) {
            return '';
        }
        let query = `SELECT ${variables.size > 0 ? Array.from(variables).join(' ') : '*'}\n`;
        query += 'WHERE {\n';
        patterns.forEach(pattern => {
            query += `  ${pattern} .\n`;
        });
        optionalPatterns.forEach(pattern => {
            query += `  OPTIONAL { ${pattern} }\n`;
        });
        filters.forEach(filter => {
            query += `  ${filter}\n`;
        });
        query += '}';
        (_d = (_c = this.options).onQueryGenerated) === null || _d === void 0 ? void 0 : _d.call(_c, query);
        return query;
    }
    executeQuery() {
        var _a, _b;
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            const sparql = this.generateSPARQL();
            if (!sparql) {
                new obsidian_1.Notice('Please create a query first');
                return;
            }
            // Call the execute query callback
            (_b = (_a = this.options).onExecuteQuery) === null || _b === void 0 ? void 0 : _b.call(_a);
            if (this.sparqlProcessor) {
                try {
                    const result = yield this.sparqlProcessor.executeQuery(sparql);
                    this.options.onExecute(sparql);
                    new obsidian_1.Notice(`Query executed: ${result.results.length} results`);
                }
                catch (error) {
                    new obsidian_1.Notice(`Query error: ${error.message}`);
                }
            }
            else {
                this.options.onExecute(sparql);
            }
        });
    }
    clearCanvas() {
        this.nodes.clear();
        this.edges.clear();
        this.clearSelection();
        this.render();
        this.updateQuery();
    }
    zoomIn() {
        this.zoom = Math.min(this.options.zoomMax, this.zoom + this.options.zoomStep);
        this.updateTransform();
    }
    zoomOut() {
        this.zoom = Math.max(this.options.zoomMin, this.zoom - this.options.zoomStep);
        this.updateTransform();
    }
    resetZoom() {
        this.zoom = 1;
        this.viewportX = 0;
        this.viewportY = 0;
        this.updateTransform();
    }
    showTemplateSelection() {
        if (!this.options.templateUseCase) {
            new obsidian_1.Notice('Template functionality not available');
            return;
        }
        const modalContainer = document.createElement('div');
        modalContainer.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        `;
        const templatePanel = new TemplateSelectionPanel_1.TemplateSelectionPanel(modalContainer, this.options.templateUseCase.getTemplateRepository(), {
            showPreview: true,
            allowCustomTemplates: true,
            onTemplateSelect: (template) => {
                this.loadTemplate(template);
                modalContainer.remove();
            },
            onClose: () => {
                modalContainer.remove();
            }
        });
        document.body.appendChild(modalContainer);
        // Close on background click
        modalContainer.addEventListener('click', (e) => {
            if (e.target === modalContainer) {
                modalContainer.remove();
            }
        });
    }
    loadTemplate(template) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            try {
                if (template.getParameters().length > 0) {
                    // Show parameter input modal
                    if (!this.options.appInstance) {
                        new obsidian_1.Notice('Cannot configure template parameters - app instance not available');
                        return;
                    }
                    const parameterModal = new TemplateParameterModal_1.TemplateParameterModal(this.options.appInstance, template, {
                        onSubmit: (configuredTemplate, parameterValues) => tslib_1.__awaiter(this, void 0, void 0, function* () {
                            yield this.instantiateTemplate(configuredTemplate);
                        }),
                        onCancel: () => {
                            // User cancelled parameter configuration
                        }
                    });
                    parameterModal.open();
                }
                else {
                    // Template has no parameters, instantiate directly
                    yield this.instantiateTemplate(template);
                }
            }
            catch (error) {
                console.error('Failed to load template:', error);
                new obsidian_1.Notice(`Failed to load template: ${error.message}`);
            }
        });
    }
    instantiateTemplate(template) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            try {
                const { nodes, edges } = yield this.options.templateUseCase.instantiateTemplate(template);
                // Clear current canvas
                this.clearCanvas();
                // Add nodes to canvas
                nodes.forEach(node => {
                    this.nodes.set(node.getId(), node);
                });
                // Add edges to canvas
                edges.forEach(edge => {
                    this.edges.set(edge.getId(), edge);
                });
                // Update display
                this.render();
                this.updateQuery();
                new obsidian_1.Notice(`Template "${template.getMetadata().name}" loaded successfully`);
            }
            catch (error) {
                console.error('Failed to instantiate template:', error);
                new obsidian_1.Notice(`Failed to apply template: ${error.message}`);
            }
        });
    }
    showSaveTemplateModal() {
        if (!this.options.templateUseCase || !this.options.appInstance) {
            new obsidian_1.Notice('Template functionality not available');
            return;
        }
        if (this.nodes.size === 0) {
            new obsidian_1.Notice('Create a query first before saving as template');
            return;
        }
        const saveModal = new SaveTemplateModal_1.SaveTemplateModal(this.options.appInstance, {
            nodes: this.nodes,
            edges: this.edges,
            viewport: {
                x: this.viewportX,
                y: this.viewportY,
                zoom: this.zoom
            },
            sparqlQuery: this.generateSPARQL(),
            onSave: (templateData) => tslib_1.__awaiter(this, void 0, void 0, function* () {
                try {
                    const template = yield this.options.templateUseCase.createCustomTemplate(this.nodes, this.edges, {
                        x: this.viewportX,
                        y: this.viewportY,
                        zoom: this.zoom
                    }, templateData.name, templateData.description, templateData.category, templateData.tags);
                    new obsidian_1.Notice(`Template "${template.getMetadata().name}" saved successfully`);
                }
                catch (error) {
                    console.error('Failed to save template:', error);
                    new obsidian_1.Notice(`Failed to save template: ${error.message}`);
                }
            }),
            onCancel: () => {
                // User cancelled save
            }
        });
        saveModal.open();
    }
    loadFromTemplate(template) {
        this.loadTemplate(template);
    }
    getCurrentCanvasState() {
        return {
            nodes: new Map(this.nodes),
            edges: new Map(this.edges),
            viewport: {
                x: this.viewportX,
                y: this.viewportY,
                zoom: this.zoom
            }
        };
    }
    // Public getters for testing and external access
    getNodes() {
        return new Map(this.nodes);
    }
    getEdges() {
        return new Map(this.edges);
    }
    removeNode(nodeId) {
        // Remove associated edges first
        this.edges.forEach((edge, edgeId) => {
            if (edge.getSourceNodeId() === nodeId || edge.getTargetNodeId() === nodeId) {
                this.edges.delete(edgeId);
            }
        });
        // Remove the node
        this.nodes.delete(nodeId);
        // Update selection
        this.selectedNodes.delete(nodeId);
        // Re-render and update query
        this.render();
        this.updateQuery();
    }
    removeEdge(edgeId) {
        this.edges.delete(edgeId);
        this.selectedEdges.delete(edgeId);
        this.render();
        this.updateQuery();
    }
    zoomToFit() {
        if (this.nodes.size === 0) {
            this.resetZoom();
            return;
        }
        let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;
        this.nodes.forEach(node => {
            const pos = node.getPosition();
            const dims = node.getDimensions();
            minX = Math.min(minX, pos.x);
            minY = Math.min(minY, pos.y);
            maxX = Math.max(maxX, pos.x + dims.width);
            maxY = Math.max(maxY, pos.y + dims.height);
        });
        const contentWidth = maxX - minX;
        const contentHeight = maxY - minY;
        const centerX = minX + contentWidth / 2;
        const centerY = minY + contentHeight / 2;
        // Calculate zoom to fit with padding
        const padding = 50;
        const availableWidth = this.options.width - 2 * padding;
        const availableHeight = this.options.height - 2 * padding;
        const scaleX = availableWidth / contentWidth;
        const scaleY = availableHeight / contentHeight;
        const newZoom = Math.min(scaleX, scaleY, this.options.zoomMax);
        // Set new zoom and center viewport
        this.zoom = Math.max(this.options.zoomMin, newZoom);
        this.viewportX = this.options.width / 2 - centerX * this.zoom;
        this.viewportY = this.options.height / 2 - centerY * this.zoom;
        this.updateTransform();
    }
    exportToJSON() {
        const canvasData = {
            version: '1.0',
            nodes: Array.from(this.nodes.entries()).map(([id, node]) => ({
                id,
                type: node.getType(),
                label: node.getLabel(),
                position: node.getPosition(),
                uri: node.getEntityUri ? node.getEntityUri() : undefined
            })),
            edges: Array.from(this.edges.entries()).map(([id, edge]) => ({
                id,
                sourceNodeId: edge.getSourceNodeId(),
                targetNodeId: edge.getTargetNodeId(),
                label: edge.getLabel(),
                type: edge.getType(),
                optional: edge.isOptional(),
                propertyUri: edge.getPropertyUri()
            })),
            viewport: {
                x: this.viewportX,
                y: this.viewportY,
                zoom: this.zoom
            }
        };
        return JSON.stringify(canvasData, null, 2);
    }
    importFromJSON(jsonString) {
        try {
            const data = JSON.parse(jsonString);
            // Validate format
            if (!data.nodes || !data.edges) {
                console.warn('Invalid canvas data format');
                return false;
            }
            // Clear current content
            this.clearCanvas();
            // Import nodes
            data.nodes.forEach((nodeData) => {
                try {
                    let node;
                    switch (nodeData.type) {
                        case VisualQueryNode_1.NodeType.ENTITY:
                            node = VisualQueryNode_1.VisualQueryNode.createEntity(nodeData.label, nodeData.uri, nodeData.position);
                            break;
                        case VisualQueryNode_1.NodeType.VARIABLE:
                            node = VisualQueryNode_1.VisualQueryNode.createVariable(nodeData.label, nodeData.position);
                            break;
                        case VisualQueryNode_1.NodeType.LITERAL:
                            node = VisualQueryNode_1.VisualQueryNode.createLiteral(nodeData.label, nodeData.position);
                            break;
                        case VisualQueryNode_1.NodeType.FILTER:
                            node = VisualQueryNode_1.VisualQueryNode.createFilter(nodeData.label, nodeData.position);
                            break;
                        default:
                            console.warn(`Unknown node type: ${nodeData.type}`);
                            return;
                    }
                    this.nodes.set(nodeData.id, node);
                }
                catch (error) {
                    console.warn(`Failed to import node ${nodeData.id}:`, error);
                }
            });
            // Import edges
            data.edges.forEach((edgeData) => {
                try {
                    let edge;
                    if (edgeData.optional) {
                        edge = VisualQueryEdge_1.VisualQueryEdge.createOptional(edgeData.sourceNodeId, edgeData.targetNodeId, edgeData.label, edgeData.propertyUri);
                    }
                    else {
                        edge = VisualQueryEdge_1.VisualQueryEdge.createProperty(edgeData.sourceNodeId, edgeData.targetNodeId, edgeData.label, edgeData.propertyUri);
                    }
                    this.edges.set(edgeData.id, edge);
                }
                catch (error) {
                    console.warn(`Failed to import edge ${edgeData.id}:`, error);
                }
            });
            // Restore viewport
            if (data.viewport) {
                this.viewportX = data.viewport.x || 0;
                this.viewportY = data.viewport.y || 0;
                this.zoom = data.viewport.zoom || 1;
                this.updateTransform();
            }
            // Re-render
            this.render();
            this.updateQuery();
            return true;
        }
        catch (error) {
            console.warn('Failed to import canvas data:', error);
            return false;
        }
    }
    destroy() {
        this.svg.removeEventListener('mousedown', this.handleMouseDown.bind(this));
        this.svg.removeEventListener('mousemove', this.handleMouseMove.bind(this));
        this.svg.removeEventListener('mouseup', this.handleMouseUp.bind(this));
        this.svg.removeEventListener('wheel', this.handleWheel.bind(this));
        this.svg.removeEventListener('contextmenu', this.handleContextMenu.bind(this));
        document.removeEventListener('keydown', this.handleKeyDown.bind(this));
        // Clear all nodes and edges to ensure cleanup
        this.nodes.clear();
        this.edges.clear();
        this.clearSelection();
        if (this.container && this.container.parentNode) {
            this.container.parentNode.removeChild(this.container);
        }
    }
}
exports.VisualQueryCanvas = VisualQueryCanvas;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2tpdGVsZXYvRG9jdW1lbnRzL2V4b2NvcnRleC1vYnNpZGlhbi1wbHVnaW4vc3JjL3ByZXNlbnRhdGlvbi9jb21wb25lbnRzL1Zpc3VhbFF1ZXJ5Q2FudmFzLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQSx5RUFBOEY7QUFDOUYseUVBQWdGO0FBRWhGLHVDQUFrQztBQUVsQyxxRUFBa0U7QUFDbEUsNkVBQTBFO0FBQzFFLG1FQUFnRTtBQTRCaEUsTUFBYSxpQkFBaUI7SUFvRDFCLFlBQ3FCLGFBQTBCLEVBQzNDLHdCQUEwRCxFQUMxRCx3QkFBMEQ7UUFGekMsa0JBQWEsR0FBYixhQUFhLENBQWE7UUE3Q3ZDLFVBQUssR0FBaUMsSUFBSSxHQUFHLEVBQUUsQ0FBQztRQUNoRCxVQUFLLEdBQWlDLElBQUksR0FBRyxFQUFFLENBQUM7UUFDaEQsa0JBQWEsR0FBZ0IsSUFBSSxHQUFHLEVBQUUsQ0FBQztRQUN2QyxrQkFBYSxHQUFnQixJQUFJLEdBQUcsRUFBRSxDQUFDO1FBRXZDLGVBQVUsR0FBRyxLQUFLLENBQUM7UUFDbkIsY0FBUyxHQUFHLEtBQUssQ0FBQztRQUNsQixpQkFBWSxHQUFHLEtBQUssQ0FBQztRQUVyQix5QkFBb0IsR0FBaUIsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQztRQUlwRCxjQUFTLEdBQUcsQ0FBQyxDQUFDO1FBQ2QsY0FBUyxHQUFHLENBQUMsQ0FBQztRQUNkLFNBQUksR0FBRyxDQUFDLENBQUM7UUFFQSxtQkFBYyxHQUE0QjtZQUN2RCxLQUFLLEVBQUUsR0FBRztZQUNWLE1BQU0sRUFBRSxHQUFHO1lBQ1gsUUFBUSxFQUFFLEVBQUU7WUFDWixRQUFRLEVBQUUsSUFBSTtZQUNkLE9BQU8sRUFBRSxHQUFHO1lBQ1osT0FBTyxFQUFFLENBQUM7WUFDVixRQUFRLEVBQUUsR0FBRztZQUNiLGFBQWEsRUFBRSxHQUFHLEVBQUUsR0FBRSxDQUFDO1lBQ3ZCLFNBQVMsRUFBRSxHQUFHLEVBQUUsR0FBRSxDQUFDO1lB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LENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDO1lBQ3pDLElBQUksQ0FBQyxZQUFZLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztZQUNsRCxJQUFJLENBQUMsWUFBWSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUM7WUFDcEQsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDLENBQUM7WUFDN0IsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDLENBQUM7WUFFN0IsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztZQUNsRCxJQUFJLENBQUMsWUFBWSxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDdkMsSUFBSSxDQUFDLFlBQVksQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ3RGLElBQUksQ0FBQyxZQUFZLENBQUMsY0FBYyxFQUFFLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUVqRSxNQUFNLElBQUksR0FBRyxRQUFRLENBQUMsZUFBZSxDQUFDLEtBQUssRUFBRSxNQUFNLENBQW1CLENBQUM7WUFDdkUsSUFBSSxDQUFDLFlBQVksQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztZQUM1RCxJQUFJLENBQUMsWUFBWSxDQUFDLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztZQUNqRSxJQUFJLENBQUMsWUFBWSxDQUFDLGFBQWEsRUFBRSxRQUFRLENBQUMsQ0FBQztZQUMzQyxJQUFJLENBQUMsWUFBWSxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDdkMsSUFBSSxDQUFDLFlBQVksQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLENBQUM7WUFDckMsSUFBSSxDQUFDLFlBQVksQ0FBQyxhQUFhLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDeEMsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7WUFFbkMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNwQixDQUFDLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBRXBCLElBQUksQ0FBQyxVQUFVLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ25DLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVPLFdBQVc7UUFDZixNQUFNLEtBQUssR0FBRyw0QkFBNEIsQ0FBQztRQUMzQyxJQUFJLENBQUMsVUFBVSxDQUFDLFNBQVMsR0FBRyxFQUFFLENBQUM7UUFFL0IsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDdEIsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDLENBQUM7WUFDdEQsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDLENBQUM7WUFFdEQsSUFBSSxDQUFDLE1BQU0sSUFBSSxDQUFDLE1BQU07Z0JBQUUsT0FBTztZQUUvQixNQUFNLENBQUMsR0FBRyxRQUFRLENBQUMsZUFBZSxDQUFDLEtBQUssRUFBRSxHQUFHLENBQWdCLENBQUM7WUFDOUQsQ0FBQyxDQUFDLFlBQVksQ0FBQyxPQUFPLEVBQUUsWUFBWSxDQUFDLENBQUM7WUFFdEMsTUFBTSxJQUFJLEdBQUcsUUFBUSxDQUFDLGVBQWUsQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFtQixDQUFDO1lBQ3ZFLElBQUksQ0FBQyxZQUFZLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxhQUFhLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUM7WUFDM0QsSUFBSSxDQUFDLFlBQVksQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUM7WUFDbEMsSUFBSSxDQUFDLFlBQVksQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLENBQUMsbUJBQW1CLENBQUMsQ0FBQztZQUM1RixJQUFJLENBQUMsWUFBWSxDQUFDLGNBQWMsRUFBRSxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7WUFFakUsSUFBSSxJQUFJLENBQUMsVUFBVSxFQUFFLEVBQUU7Z0JBQ25CLElBQUksQ0FBQyxZQUFZLENBQUMsa0JBQWtCLEVBQUUsS0FBSyxDQUFDLENBQUM7YUFDaEQ7WUFFRCxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1lBQ3ZELE1BQU0sT0FBTyxHQUFHLFFBQVEsQ0FBQyxlQUFlLENBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBbUIsQ0FBQztZQUMxRSxNQUFNLFNBQVMsR0FBRyxRQUFRLENBQUMsZUFBZSxDQUFDLEtBQUssRUFBRSxNQUFNLENBQW1CLENBQUM7WUFFNUUsU0FBUyxDQUFDLFlBQVksQ0FBQyxHQUFHLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDO1lBQ25ELFNBQVMsQ0FBQyxZQUFZLENBQUMsR0FBRyxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztZQUNuRCxTQUFTLENBQUMsWUFBWSxDQUFDLGFBQWEsRUFBRSxRQUFRLENBQUMsQ0FBQztZQUNoRCxTQUFTLENBQUMsWUFBWSxDQUFDLE1BQU0sRUFBRSxvQkFBb0IsQ0FBQyxDQUFDO1lBQ3JELFNBQVMsQ0FBQyxZQUFZLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxDQUFDO1lBQzFDLFNBQVMsQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO1lBRXhDLE1BQU0sSUFBSSxHQUFHLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxHQUFHLENBQUMsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFLENBQUM7WUFDbkUsT0FBTyxDQUFDLFlBQVksQ0FBQyxHQUFHLEVBQUUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztZQUNwRSxPQUFPLENBQUMsWUFBWSxDQUFDLEdBQUcsRUFBRSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDO1lBQ3JFLE9BQU8sQ0FBQyxZQUFZLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztZQUNyRCxPQUFPLENBQUMsWUFBWSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUM7WUFDdkQsT0FBTyxDQUFDLFlBQVksQ0FBQyxNQUFNLEVBQUUsMkJBQTJCLENBQUMsQ0FBQztZQUMxRCxPQUFPLENBQUMsWUFBWSxDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsQ0FBQztZQUVoQyxDQUFDLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3BCLENBQUMsQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDdkIsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUV6QixJQUFJLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNuQyxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFTyxhQUFhLENBQUMsSUFBYztRQUNoQyxNQUFNLE1BQU0sR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDLENBQUM7UUFFOUQsTUFBTSxXQUFXLEdBQUc7WUFDaEIsQ0FBQywwQkFBUSxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUU7WUFDMUUsQ0FBQywwQkFBUSxDQUFDLFFBQVEsQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUU7WUFDNUUsQ0FBQywwQkFBUSxDQUFDLE9BQU8sQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUU7WUFDM0UsQ0FBQywwQkFBUSxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUU7U0FDN0UsQ0FBQztRQUVGLE1BQU0sVUFBVSxHQUFHO1lBQ2YsQ0FBQywwQkFBUSxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLHlCQUF5QixFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRTtZQUMxRixDQUFDLDBCQUFRLENBQUMsUUFBUSxDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsd0JBQXdCLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFO1lBQzNGLENBQUMsMEJBQVEsQ0FBQyxPQUFPLENBQUMsRUFBRSxFQUFFLElBQUksRUFBRSx5QkFBeUIsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUU7WUFDM0YsQ0FBQywwQkFBUSxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLHdCQUF3QixFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRTtTQUM1RixDQUFDO1FBRUYsT0FBTyxNQUFNLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3pELENBQUM7SUFLRCxPQUFPLENBQUMsVUFBc0M7O1FBQzFDLElBQUksT0FBTyxVQUFVLEtBQUssUUFBUSxJQUFJLE9BQU8sSUFBSSxVQUFVLEVBQUU7WUFDekQsb0RBQW9EO1lBQ3BELE1BQU0sSUFBSSxHQUFHLFVBQTZCLENBQUM7WUFDM0MsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxFQUFFLElBQUksQ0FBQyxDQUFDO1lBQ25DLE1BQUEsTUFBQSxJQUFJLENBQUMsT0FBTyxFQUFDLFlBQVksbURBQUcsSUFBSSxDQUFDLENBQUM7WUFDbEMsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDO1lBQ2QsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ25CLE9BQU87U0FDVjtRQUVELDRCQUE0QjtRQUM1QixNQUFNLElBQUksR0FBRyxVQUFzQixDQUFDO1FBQ3BDLE1BQU0sT0FBTyxHQUFHLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO1FBQ3RFLE1BQU0sT0FBTyxHQUFHLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO1FBRXZFLElBQUksSUFBcUIsQ0FBQztRQUUxQixRQUFRLElBQUksRUFBRTtZQUNWLEtBQUssMEJBQVEsQ0FBQyxNQUFNO2dCQUNoQixNQUFNLFVBQVUsR0FBRyxNQUFNLENBQUMsb0JBQW9CLENBQUMsQ0FBQztnQkFDaEQsSUFBSSxDQUFDLFVBQVU7b0JBQUUsT0FBTztnQkFDeEIsSUFBSSxHQUFHLGlDQUFlLENBQUMsWUFBWSxDQUFDLFVBQVUsRUFBRSxTQUFTLEVBQUUsRUFBRSxDQUFDLEVBQUUsT0FBTyxFQUFFLENBQUMsRUFBRSxPQUFPLEVBQUUsQ0FBQyxDQUFDO2dCQUN2RixNQUFNO1lBQ1YsS0FBSywwQkFBUSxDQUFDLFFBQVE7Z0JBQ2xCLE1BQU0sT0FBTyxHQUFHLE1BQU0sQ0FBQyxrQ0FBa0MsQ0FBQyxDQUFDO2dCQUMzRCxJQUFJLENBQUMsT0FBTztvQkFBRSxPQUFPO2dCQUNyQixJQUFJLEdBQUcsaUNBQWUsQ0FBQyxjQUFjLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQyxFQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUUsT0FBTyxFQUFFLENBQUMsQ0FBQztnQkFDM0UsTUFBTTtZQUNWLEtBQUssMEJBQVEsQ0FBQyxPQUFPO2dCQUNqQixNQUFNLFlBQVksR0FBRyxNQUFNLENBQUMsc0JBQXNCLENBQUMsQ0FBQztnQkFDcEQsSUFBSSxDQUFDLFlBQVk7b0JBQUUsT0FBTztnQkFDMUIsSUFBSSxHQUFHLGlDQUFlLENBQUMsYUFBYSxDQUFDLFlBQVksRUFBRSxFQUFFLENBQUMsRUFBRSxPQUFPLEVBQUUsQ0FBQyxFQUFFLE9BQU8sRUFBRSxDQUFDLENBQUM7Z0JBQy9FLE1BQU07WUFDVixLQUFLLDBCQUFRLENBQUMsTUFBTTtnQkFDaEIsTUFBTSxVQUFVLEdBQUcsTUFBTSxDQUFDLDBCQUEwQixDQUFDLENBQUM7Z0JBQ3RELElBQUksQ0FBQyxVQUFVO29CQUFFLE9BQU87Z0JBQ3hCLElBQUksR0FBRyxpQ0FBZSxDQUFDLFlBQVksQ0FBQyxVQUFVLEVBQUUsRUFBRSxDQUFDLEVBQUUsT0FBTyxFQUFFLENBQUMsRUFBRSxPQUFPLEVBQUUsQ0FBQyxDQUFDO2dCQUM1RSxNQUFNO1lBQ1Y7Z0JBQ0ksT0FBTztTQUNkO1FBRUQsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ25DLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNkLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUN2QixDQUFDO0lBRUQsT0FBTyxDQUFDLElBQXFCOztRQUN6QixtREFBbUQ7UUFDbkQsTUFBTSxZQUFZLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDLENBQUM7UUFDNUQsTUFBTSxZQUFZLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDLENBQUM7UUFFNUQsSUFBSSxDQUFDLFlBQVksSUFBSSxDQUFDLFlBQVksRUFBRTtZQUNoQyxPQUFPLENBQUMsSUFBSSxDQUFDLGtEQUFrRCxDQUFDLENBQUM7WUFDakUsT0FBTztTQUNWO1FBRUQsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ25DLE1BQUEsTUFBQSxJQUFJLENBQUMsT0FBTyxFQUFDLFlBQVksbURBQUcsSUFBSSxDQUFDLENBQUM7UUFDbEMsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQ2QsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQ3ZCLENBQUM7SUFFRCxnQkFBZ0I7UUFDWixPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBQzFDLENBQUM7SUFFRCxnQkFBZ0I7UUFDWixPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBQzFDLENBQUM7SUFHRCxXQUFXO1FBQ1AsTUFBTSxVQUFVLEdBQUcsSUFBSSxhQUFhLEVBQUUsQ0FBQztRQUN2QyxPQUFPLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDbEQsQ0FBQztJQUVPLFdBQVc7UUFDZixNQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7UUFDckMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDbkMsSUFBSyxJQUFJLENBQUMsT0FBZSxDQUFDLGdCQUFnQixFQUFFO1lBQ3ZDLElBQUksQ0FBQyxPQUFlLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxDQUFDLENBQUM7U0FDbEQ7SUFDTCxDQUFDO0lBRUQsY0FBYzs7UUFDVixJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxLQUFLLENBQUMsRUFBRTtZQUN2QixNQUFNLEtBQUssR0FBRyxvQ0FBb0MsQ0FBQztZQUNuRCxNQUFBLE1BQUEsSUFBSSxDQUFDLE9BQU8sRUFBQyxnQkFBZ0IsbURBQUcsS0FBSyxDQUFDLENBQUM7WUFDdkMsT0FBTyxLQUFLLENBQUM7U0FDaEI7UUFFRCxNQUFNLFNBQVMsR0FBRyxJQUFJLEdBQUcsRUFBVSxDQUFDO1FBQ3BDLE1BQU0sUUFBUSxHQUFhLEVBQUUsQ0FBQztRQUM5QixNQUFNLE9BQU8sR0FBYSxFQUFFLENBQUM7UUFDN0IsTUFBTSxnQkFBZ0IsR0FBYSxFQUFFLENBQUM7UUFFdEMsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDdEIsSUFBSSxJQUFJLENBQUMsT0FBTyxFQUFFLEtBQUssMEJBQVEsQ0FBQyxRQUFRLEVBQUU7Z0JBQ3RDLFNBQVMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDLENBQUM7YUFDekM7aUJBQU0sSUFBSSxJQUFJLENBQUMsT0FBTyxFQUFFLEtBQUssMEJBQVEsQ0FBQyxNQUFNLEVBQUU7Z0JBQzNDLE9BQU8sQ0FBQyxJQUFJLENBQUMsV0FBVyxJQUFJLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQyxDQUFDO2FBQy9DO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRTtZQUN0QixNQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsZUFBZSxFQUFFLENBQUMsQ0FBQztZQUN0RCxNQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsZUFBZSxFQUFFLENBQUMsQ0FBQztZQUV0RCxJQUFJLE1BQU0sSUFBSSxNQUFNLEVBQUU7Z0JBQ2xCLE1BQU0sT0FBTyxHQUFHLEdBQUcsTUFBTSxDQUFDLGVBQWUsRUFBRSxJQUFJLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxJQUFJLE1BQU0sQ0FBQyxlQUFlLEVBQUUsRUFBRSxDQUFDO2dCQUV0RyxJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUUsRUFBRTtvQkFDbkIsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO2lCQUNsQztxQkFBTTtvQkFDSCxRQUFRLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO2lCQUMxQjtnQkFFRCxJQUFJLE1BQU0sQ0FBQyxPQUFPLEVBQUUsS0FBSywwQkFBUSxDQUFDLFFBQVEsRUFBRTtvQkFDeEMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsZUFBZSxFQUFFLENBQUMsQ0FBQztpQkFDM0M7Z0JBQ0QsSUFBSSxNQUFNLENBQUMsT0FBTyxFQUFFLEtBQUssMEJBQVEsQ0FBQyxRQUFRLEVBQUU7b0JBQ3hDLFNBQVMsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLGVBQWUsRUFBRSxDQUFDLENBQUM7aUJBQzNDO2FBQ0o7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUVILElBQUksU0FBUyxDQUFDLElBQUksS0FBSyxDQUFDLElBQUksUUFBUSxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7WUFDL0MsT0FBTyxFQUFFLENBQUM7U0FDYjtRQUVELElBQUksS0FBSyxHQUFHLFVBQVUsU0FBUyxDQUFDLElBQUksR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQztRQUNyRixLQUFLLElBQUksV0FBVyxDQUFDO1FBRXJCLFFBQVEsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUU7WUFDdkIsS0FBSyxJQUFJLEtBQUssT0FBTyxNQUFNLENBQUM7UUFDaEMsQ0FBQyxDQUFDLENBQUM7UUFFSCxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUU7WUFDL0IsS0FBSyxJQUFJLGdCQUFnQixPQUFPLE1BQU0sQ0FBQztRQUMzQyxDQUFDLENBQUMsQ0FBQztRQUVILE9BQU8sQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFDckIsS0FBSyxJQUFJLEtBQUssTUFBTSxJQUFJLENBQUM7UUFDN0IsQ0FBQyxDQUFDLENBQUM7UUFFSCxLQUFLLElBQUksR0FBRyxDQUFDO1FBRWIsTUFBQSxNQUFBLElBQUksQ0FBQyxPQUFPLEVBQUMsZ0JBQWdCLG1EQUFHLEtBQUssQ0FBQyxDQUFDO1FBQ3ZDLE9BQU8sS0FBSyxDQUFDO0lBQ2pCLENBQUM7SUFFSyxZQUFZOzs7WUFDZCxNQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7WUFFckMsSUFBSSxDQUFDLE1BQU0sRUFBRTtnQkFDVCxJQUFJLGlCQUFNLENBQUMsNkJBQTZCLENBQUMsQ0FBQztnQkFDMUMsT0FBTzthQUNWO1lBRUQsa0NBQWtDO1lBQ2xDLE1BQUEsTUFBQSxJQUFJLENBQUMsT0FBTyxFQUFDLGNBQWMsa0RBQUksQ0FBQztZQUVoQyxJQUFJLElBQUksQ0FBQyxlQUFlLEVBQUU7Z0JBQ3RCLElBQUk7b0JBQ0EsTUFBTSxNQUFNLEdBQUcsTUFBTSxJQUFJLENBQUMsZUFBZSxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQztvQkFDL0QsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUM7b0JBQy9CLElBQUksaUJBQU0sQ0FBQyxtQkFBbUIsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLFVBQVUsQ0FBQyxDQUFDO2lCQUNsRTtnQkFBQyxPQUFPLEtBQVUsRUFBRTtvQkFDakIsSUFBSSxpQkFBTSxDQUFDLGdCQUFnQixLQUFLLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztpQkFDL0M7YUFDSjtpQkFBTTtnQkFDSCxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQzthQUNsQzs7S0FDSjtJQUVELFdBQVc7UUFDUCxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ25CLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDbkIsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO1FBQ3RCLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNkLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUN2QixDQUFDO0lBRU8sTUFBTTtRQUNWLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDOUUsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO0lBQzNCLENBQUM7SUFFTyxPQUFPO1FBQ1gsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUM5RSxJQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7SUFDM0IsQ0FBQztJQUVPLFNBQVM7UUFDYixJQUFJLENBQUMsSUFBSSxHQUFHLENBQUMsQ0FBQztRQUNkLElBQUksQ0FBQyxTQUFTLEdBQUcsQ0FBQyxDQUFDO1FBQ25CLElBQUksQ0FBQyxTQUFTLEdBQUcsQ0FBQyxDQUFDO1FBQ25CLElBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQztJQUMzQixDQUFDO0lBRU8scUJBQXFCO1FBQ3pCLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLGVBQWUsRUFBRTtZQUMvQixJQUFJLGlCQUFNLENBQUMsc0NBQXNDLENBQUMsQ0FBQztZQUNuRCxPQUFPO1NBQ1Y7UUFFRCxNQUFNLGNBQWMsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3JELGNBQWMsQ0FBQyxLQUFLLENBQUMsT0FBTyxHQUFHOzs7Ozs7Ozs7Ozs7U0FZOUIsQ0FBQztRQUVGLE1BQU0sYUFBYSxHQUFHLElBQUksK0NBQXNCLENBQzVDLGNBQWMsRUFDZCxJQUFJLENBQUMsT0FBTyxDQUFDLGVBQWUsQ0FBQyxxQkFBcUIsRUFBRSxFQUNwRDtZQUNJLFdBQVcsRUFBRSxJQUFJO1lBQ2pCLG9CQUFvQixFQUFFLElBQUk7WUFDMUIsZ0JBQWdCLEVBQUUsQ0FBQyxRQUFRLEVBQUUsRUFBRTtnQkFDM0IsSUFBSSxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUMsQ0FBQztnQkFDNUIsY0FBYyxDQUFDLE1BQU0sRUFBRSxDQUFDO1lBQzVCLENBQUM7WUFDRCxPQUFPLEVBQUUsR0FBRyxFQUFFO2dCQUNWLGNBQWMsQ0FBQyxNQUFNLEVBQUUsQ0FBQztZQUM1QixDQUFDO1NBQ0osQ0FDSixDQUFDO1FBRUYsUUFBUSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsY0FBYyxDQUFDLENBQUM7UUFFMUMsNEJBQTRCO1FBQzVCLGNBQWMsQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRTtZQUMzQyxJQUFJLENBQUMsQ0FBQyxNQUFNLEtBQUssY0FBYyxFQUFFO2dCQUM3QixjQUFjLENBQUMsTUFBTSxFQUFFLENBQUM7YUFDM0I7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFYSxZQUFZLENBQUMsUUFBdUI7O1lBQzlDLElBQUk7Z0JBQ0EsSUFBSSxRQUFRLENBQUMsYUFBYSxFQUFFLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtvQkFDckMsNkJBQTZCO29CQUM3QixJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUU7d0JBQzNCLElBQUksaUJBQU0sQ0FBQyxtRUFBbUUsQ0FBQyxDQUFDO3dCQUNoRixPQUFPO3FCQUNWO29CQUVELE1BQU0sY0FBYyxHQUFHLElBQUksK0NBQXNCLENBQzdDLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUN4QixRQUFRLEVBQ1I7d0JBQ0ksUUFBUSxFQUFFLENBQU8sa0JBQWtCLEVBQUUsZUFBZSxFQUFFLEVBQUU7NEJBQ3BELE1BQU0sSUFBSSxDQUFDLG1CQUFtQixDQUFDLGtCQUFrQixDQUFDLENBQUM7d0JBQ3ZELENBQUMsQ0FBQTt3QkFDRCxRQUFRLEVBQUUsR0FBRyxFQUFFOzRCQUNYLHlDQUF5Qzt3QkFDN0MsQ0FBQztxQkFDSixDQUNKLENBQUM7b0JBRUYsY0FBYyxDQUFDLElBQUksRUFBRSxDQUFDO2lCQUN6QjtxQkFBTTtvQkFDSCxtREFBbUQ7b0JBQ25ELE1BQU0sSUFBSSxDQUFDLG1CQUFtQixDQUFDLFFBQVEsQ0FBQyxDQUFDO2lCQUM1QzthQUNKO1lBQUMsT0FBTyxLQUFLLEVBQUU7Z0JBQ1osT0FBTyxDQUFDLEtBQUssQ0FBQywwQkFBMEIsRUFBRSxLQUFLLENBQUMsQ0FBQztnQkFDakQsSUFBSSxpQkFBTSxDQUFDLDRCQUE0QixLQUFLLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQzthQUMzRDtRQUNMLENBQUM7S0FBQTtJQUVhLG1CQUFtQixDQUFDLFFBQXVCOztZQUNyRCxJQUFJO2dCQUNBLE1BQU0sRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEdBQUcsTUFBTSxJQUFJLENBQUMsT0FBTyxDQUFDLGVBQWdCLENBQUMsbUJBQW1CLENBQUMsUUFBUSxDQUFDLENBQUM7Z0JBRTNGLHVCQUF1QjtnQkFDdkIsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO2dCQUVuQixzQkFBc0I7Z0JBQ3RCLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUU7b0JBQ2pCLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsRUFBRSxJQUFJLENBQUMsQ0FBQztnQkFDdkMsQ0FBQyxDQUFDLENBQUM7Z0JBRUgsc0JBQXNCO2dCQUN0QixLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFO29CQUNqQixJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLEVBQUUsSUFBSSxDQUFDLENBQUM7Z0JBQ3ZDLENBQUMsQ0FBQyxDQUFDO2dCQUVILGlCQUFpQjtnQkFDakIsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDO2dCQUNkLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztnQkFFbkIsSUFBSSxpQkFBTSxDQUFDLGFBQWEsUUFBUSxDQUFDLFdBQVcsRUFBRSxDQUFDLElBQUksdUJBQXVCLENBQUMsQ0FBQzthQUMvRTtZQUFDLE9BQU8sS0FBSyxFQUFFO2dCQUNaLE9BQU8sQ0FBQyxLQUFLLENBQUMsaUNBQWlDLEVBQUUsS0FBSyxDQUFDLENBQUM7Z0JBQ3hELElBQUksaUJBQU0sQ0FBQyw2QkFBNkIsS0FBSyxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUM7YUFDNUQ7UUFDTCxDQUFDO0tBQUE7SUFFTyxxQkFBcUI7UUFDekIsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsZUFBZSxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUU7WUFDNUQsSUFBSSxpQkFBTSxDQUFDLHNDQUFzQyxDQUFDLENBQUM7WUFDbkQsT0FBTztTQUNWO1FBRUQsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksS0FBSyxDQUFDLEVBQUU7WUFDdkIsSUFBSSxpQkFBTSxDQUFDLGdEQUFnRCxDQUFDLENBQUM7WUFDN0QsT0FBTztTQUNWO1FBRUQsTUFBTSxTQUFTLEdBQUcsSUFBSSxxQ0FBaUIsQ0FDbkMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQ3hCO1lBQ0ksS0FBSyxFQUFFLElBQUksQ0FBQyxLQUFLO1lBQ2pCLEtBQUssRUFBRSxJQUFJLENBQUMsS0FBSztZQUNqQixRQUFRLEVBQUU7Z0JBQ04sQ0FBQyxFQUFFLElBQUksQ0FBQyxTQUFTO2dCQUNqQixDQUFDLEVBQUUsSUFBSSxDQUFDLFNBQVM7Z0JBQ2pCLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSTthQUNsQjtZQUNELFdBQVcsRUFBRSxJQUFJLENBQUMsY0FBYyxFQUFFO1lBQ2xDLE1BQU0sRUFBRSxDQUFPLFlBQVksRUFBRSxFQUFFO2dCQUMzQixJQUFJO29CQUNBLE1BQU0sUUFBUSxHQUFHLE1BQU0sSUFBSSxDQUFDLE9BQU8sQ0FBQyxlQUFnQixDQUFDLG9CQUFvQixDQUNyRSxJQUFJLENBQUMsS0FBSyxFQUNWLElBQUksQ0FBQyxLQUFLLEVBQ1Y7d0JBQ0ksQ0FBQyxFQUFFLElBQUksQ0FBQyxTQUFTO3dCQUNqQixDQUFDLEVBQUUsSUFBSSxDQUFDLFNBQVM7d0JBQ2pCLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSTtxQkFDbEIsRUFDRCxZQUFZLENBQUMsSUFBSSxFQUNqQixZQUFZLENBQUMsV0FBVyxFQUN4QixZQUFZLENBQUMsUUFBUSxFQUNyQixZQUFZLENBQUMsSUFBSSxDQUNwQixDQUFDO29CQUVGLElBQUksaUJBQU0sQ0FBQyxhQUFhLFFBQVEsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxJQUFJLHNCQUFzQixDQUFDLENBQUM7aUJBQzlFO2dCQUFDLE9BQU8sS0FBSyxFQUFFO29CQUNaLE9BQU8sQ0FBQyxLQUFLLENBQUMsMEJBQTBCLEVBQUUsS0FBSyxDQUFDLENBQUM7b0JBQ2pELElBQUksaUJBQU0sQ0FBQyw0QkFBNEIsS0FBSyxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUM7aUJBQzNEO1lBQ0wsQ0FBQyxDQUFBO1lBQ0QsUUFBUSxFQUFFLEdBQUcsRUFBRTtnQkFDWCxzQkFBc0I7WUFDMUIsQ0FBQztTQUNKLENBQ0osQ0FBQztRQUVGLFNBQVMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUNyQixDQUFDO0lBRUQsZ0JBQWdCLENBQUMsUUFBdUI7UUFDcEMsSUFBSSxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUNoQyxDQUFDO0lBRUQscUJBQXFCO1FBS2pCLE9BQU87WUFDSCxLQUFLLEVBQUUsSUFBSSxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQztZQUMxQixLQUFLLEVBQUUsSUFBSSxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQztZQUMxQixRQUFRLEVBQUU7Z0JBQ04sQ0FBQyxFQUFFLElBQUksQ0FBQyxTQUFTO2dCQUNqQixDQUFDLEVBQUUsSUFBSSxDQUFDLFNBQVM7Z0JBQ2pCLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSTthQUNsQjtTQUNKLENBQUM7SUFDTixDQUFDO0lBRUQsaURBQWlEO0lBQ2pELFFBQVE7UUFDSixPQUFPLElBQUksR0FBRyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUMvQixDQUFDO0lBRUQsUUFBUTtRQUNKLE9BQU8sSUFBSSxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQy9CLENBQUM7SUFFRCxVQUFVLENBQUMsTUFBYztRQUNyQixnQ0FBZ0M7UUFDaEMsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLEVBQUUsTUFBTSxFQUFFLEVBQUU7WUFDaEMsSUFBSSxJQUFJLENBQUMsZUFBZSxFQUFFLEtBQUssTUFBTSxJQUFJLElBQUksQ0FBQyxlQUFlLEVBQUUsS0FBSyxNQUFNLEVBQUU7Z0JBQ3hFLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO2FBQzdCO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFFSCxrQkFBa0I7UUFDbEIsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7UUFFMUIsbUJBQW1CO1FBQ25CLElBQUksQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBRWxDLDZCQUE2QjtRQUM3QixJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7UUFDZCxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDdkIsQ0FBQztJQUVELFVBQVUsQ0FBQyxNQUFjO1FBQ3JCLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQzFCLElBQUksQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ2xDLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNkLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUN2QixDQUFDO0lBRUQsU0FBUztRQUNMLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLEtBQUssQ0FBQyxFQUFFO1lBQ3ZCLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztZQUNqQixPQUFPO1NBQ1Y7UUFFRCxJQUFJLElBQUksR0FBRyxRQUFRLEVBQUUsSUFBSSxHQUFHLFFBQVEsRUFBRSxJQUFJLEdBQUcsQ0FBQyxRQUFRLEVBQUUsSUFBSSxHQUFHLENBQUMsUUFBUSxDQUFDO1FBRXpFLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFO1lBQ3RCLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUMvQixNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7WUFDbEMsSUFBSSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM3QixJQUFJLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzdCLElBQUksR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMxQyxJQUFJLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDL0MsQ0FBQyxDQUFDLENBQUM7UUFFSCxNQUFNLFlBQVksR0FBRyxJQUFJLEdBQUcsSUFBSSxDQUFDO1FBQ2pDLE1BQU0sYUFBYSxHQUFHLElBQUksR0FBRyxJQUFJLENBQUM7UUFDbEMsTUFBTSxPQUFPLEdBQUcsSUFBSSxHQUFHLFlBQVksR0FBRyxDQUFDLENBQUM7UUFDeEMsTUFBTSxPQUFPLEdBQUcsSUFBSSxHQUFHLGFBQWEsR0FBRyxDQUFDLENBQUM7UUFFekMscUNBQXFDO1FBQ3JDLE1BQU0sT0FBTyxHQUFHLEVBQUUsQ0FBQztRQUNuQixNQUFNLGNBQWMsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssR0FBRyxDQUFDLEdBQUcsT0FBTyxDQUFDO1FBQ3hELE1BQU0sZUFBZSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxHQUFHLENBQUMsR0FBRyxPQUFPLENBQUM7UUFDMUQsTUFBTSxNQUFNLEdBQUcsY0FBYyxHQUFHLFlBQVksQ0FBQztRQUM3QyxNQUFNLE1BQU0sR0FBRyxlQUFlLEdBQUcsYUFBYSxDQUFDO1FBQy9DLE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxJQUFJLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRS9ELG1DQUFtQztRQUNuQyxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDcEQsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssR0FBRyxDQUFDLEdBQUcsT0FBTyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUM7UUFDOUQsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sR0FBRyxDQUFDLEdBQUcsT0FBTyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUM7UUFFL0QsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO0lBQzNCLENBQUM7SUFFRCxZQUFZO1FBQ1IsTUFBTSxVQUFVLEdBQUc7WUFDZixPQUFPLEVBQUUsS0FBSztZQUNkLEtBQUssRUFBRSxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztnQkFDekQsRUFBRTtnQkFDRixJQUFJLEVBQUUsSUFBSSxDQUFDLE9BQU8sRUFBRTtnQkFDcEIsS0FBSyxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQUU7Z0JBQ3RCLFFBQVEsRUFBRSxJQUFJLENBQUMsV0FBVyxFQUFFO2dCQUM1QixHQUFHLEVBQUcsSUFBWSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUUsSUFBWSxDQUFDLFlBQVksRUFBRSxDQUFDLENBQUMsQ0FBQyxTQUFTO2FBQzdFLENBQUMsQ0FBQztZQUNILEtBQUssRUFBRSxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztnQkFDekQsRUFBRTtnQkFDRixZQUFZLEVBQUUsSUFBSSxDQUFDLGVBQWUsRUFBRTtnQkFDcEMsWUFBWSxFQUFFLElBQUksQ0FBQyxlQUFlLEVBQUU7Z0JBQ3BDLEtBQUssRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFO2dCQUN0QixJQUFJLEVBQUUsSUFBSSxDQUFDLE9BQU8sRUFBRTtnQkFDcEIsUUFBUSxFQUFFLElBQUksQ0FBQyxVQUFVLEVBQUU7Z0JBQzNCLFdBQVcsRUFBRSxJQUFJLENBQUMsY0FBYyxFQUFFO2FBQ3JDLENBQUMsQ0FBQztZQUNILFFBQVEsRUFBRTtnQkFDTixDQUFDLEVBQUUsSUFBSSxDQUFDLFNBQVM7Z0JBQ2pCLENBQUMsRUFBRSxJQUFJLENBQUMsU0FBUztnQkFDakIsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJO2FBQ2xCO1NBQ0osQ0FBQztRQUNGLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxVQUFVLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQy9DLENBQUM7SUFFRCxjQUFjLENBQUMsVUFBa0I7UUFDN0IsSUFBSTtZQUNBLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUM7WUFFcEMsa0JBQWtCO1lBQ2xCLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRTtnQkFDNUIsT0FBTyxDQUFDLElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDO2dCQUMzQyxPQUFPLEtBQUssQ0FBQzthQUNoQjtZQUVELHdCQUF3QjtZQUN4QixJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7WUFFbkIsZUFBZTtZQUNmLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsUUFBYSxFQUFFLEVBQUU7Z0JBQ2pDLElBQUk7b0JBQ0EsSUFBSSxJQUFxQixDQUFDO29CQUMxQixRQUFRLFFBQVEsQ0FBQyxJQUFJLEVBQUU7d0JBQ25CLEtBQUssMEJBQVEsQ0FBQyxNQUFNOzRCQUNoQixJQUFJLEdBQUcsaUNBQWUsQ0FBQyxZQUFZLENBQy9CLFFBQVEsQ0FBQyxLQUFLLEVBQ2QsUUFBUSxDQUFDLEdBQUcsRUFDWixRQUFRLENBQUMsUUFBUSxDQUNwQixDQUFDOzRCQUNGLE1BQU07d0JBQ1YsS0FBSywwQkFBUSxDQUFDLFFBQVE7NEJBQ2xCLElBQUksR0FBRyxpQ0FBZSxDQUFDLGNBQWMsQ0FDakMsUUFBUSxDQUFDLEtBQUssRUFDZCxRQUFRLENBQUMsUUFBUSxDQUNwQixDQUFDOzRCQUNGLE1BQU07d0JBQ1YsS0FBSywwQkFBUSxDQUFDLE9BQU87NEJBQ2pCLElBQUksR0FBRyxpQ0FBZSxDQUFDLGFBQWEsQ0FDaEMsUUFBUSxDQUFDLEtBQUssRUFDZCxRQUFRLENBQUMsUUFBUSxDQUNwQixDQUFDOzRCQUNGLE1BQU07d0JBQ1YsS0FBSywwQkFBUSxDQUFDLE1BQU07NEJBQ2hCLElBQUksR0FBRyxpQ0FBZSxDQUFDLFlBQVksQ0FDL0IsUUFBUSxDQUFDLEtBQUssRUFDZCxRQUFRLENBQUMsUUFBUSxDQUNwQixDQUFDOzRCQUNGLE1BQU07d0JBQ1Y7NEJBQ0ksT0FBTyxDQUFDLElBQUksQ0FBQyxzQkFBc0IsUUFBUSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7NEJBQ3BELE9BQU87cUJBQ2Q7b0JBQ0QsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsQ0FBQztpQkFDckM7Z0JBQUMsT0FBTyxLQUFLLEVBQUU7b0JBQ1osT0FBTyxDQUFDLElBQUksQ0FBQyx5QkFBeUIsUUFBUSxDQUFDLEVBQUUsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFDO2lCQUNoRTtZQUNMLENBQUMsQ0FBQyxDQUFDO1lBRUgsZUFBZTtZQUNmLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsUUFBYSxFQUFFLEVBQUU7Z0JBQ2pDLElBQUk7b0JBQ0EsSUFBSSxJQUFxQixDQUFDO29CQUMxQixJQUFJLFFBQVEsQ0FBQyxRQUFRLEVBQUU7d0JBQ25CLElBQUksR0FBRyxpQ0FBZSxDQUFDLGNBQWMsQ0FDakMsUUFBUSxDQUFDLFlBQVksRUFDckIsUUFBUSxDQUFDLFlBQVksRUFDckIsUUFBUSxDQUFDLEtBQUssRUFDZCxRQUFRLENBQUMsV0FBVyxDQUN2QixDQUFDO3FCQUNMO3lCQUFNO3dCQUNILElBQUksR0FBRyxpQ0FBZSxDQUFDLGNBQWMsQ0FDakMsUUFBUSxDQUFDLFlBQVksRUFDckIsUUFBUSxDQUFDLFlBQVksRUFDckIsUUFBUSxDQUFDLEtBQUssRUFDZCxRQUFRLENBQUMsV0FBVyxDQUN2QixDQUFDO3FCQUNMO29CQUNELElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDLENBQUM7aUJBQ3JDO2dCQUFDLE9BQU8sS0FBSyxFQUFFO29CQUNaLE9BQU8sQ0FBQyxJQUFJLENBQUMseUJBQXlCLFFBQVEsQ0FBQyxFQUFFLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQztpQkFDaEU7WUFDTCxDQUFDLENBQUMsQ0FBQztZQUVILG1CQUFtQjtZQUNuQixJQUFJLElBQUksQ0FBQyxRQUFRLEVBQUU7Z0JBQ2YsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQ3RDLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUN0QyxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxJQUFJLENBQUMsQ0FBQztnQkFDcEMsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO2FBQzFCO1lBRUQsWUFBWTtZQUNaLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztZQUNkLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUVuQixPQUFPLElBQUksQ0FBQztTQUNmO1FBQUMsT0FBTyxLQUFLLEVBQUU7WUFDWixPQUFPLENBQUMsSUFBSSxDQUFDLCtCQUErQixFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQ3JELE9BQU8sS0FBSyxDQUFDO1NBQ2hCO0lBQ0wsQ0FBQztJQUVELE9BQU87UUFDSCxJQUFJLENBQUMsR0FBRyxDQUFDLG1CQUFtQixDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBQzNFLElBQUksQ0FBQyxHQUFHLENBQUMsbUJBQW1CLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDM0UsSUFBSSxDQUFDLEdBQUcsQ0FBQyxtQkFBbUIsQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUN2RSxJQUFJLENBQUMsR0FBRyxDQUFDLG1CQUFtQixDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBQ25FLElBQUksQ0FBQyxHQUFHLENBQUMsbUJBQW1CLENBQUMsYUFBYSxFQUFFLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUUvRSxRQUFRLENBQUMsbUJBQW1CLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFFdkUsOENBQThDO1FBQzlDLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDbkIsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNuQixJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7UUFFdEIsSUFBSSxJQUFJLENBQUMsU0FBUyxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxFQUFFO1lBQzdDLElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7U0FDekQ7SUFDTCxDQUFDO0NBQ0o7QUEzOENELDhDQTI4Q0MiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2tpdGVsZXYvRG9jdW1lbnRzL2V4b2NvcnRleC1vYnNpZGlhbi1wbHVnaW4vc3JjL3ByZXNlbnRhdGlvbi9jb21wb25lbnRzL1Zpc3VhbFF1ZXJ5Q2FudmFzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFZpc3VhbFF1ZXJ5Tm9kZSwgTm9kZVR5cGUsIE5vZGVQb3NpdGlvbiB9IGZyb20gJy4uLy4uL2RvbWFpbi92aXN1YWwvVmlzdWFsUXVlcnlOb2RlJztcbmltcG9ydCB7IFZpc3VhbFF1ZXJ5RWRnZSwgRWRnZVR5cGUgfSBmcm9tICcuLi8uLi9kb21haW4vdmlzdWFsL1Zpc3VhbFF1ZXJ5RWRnZSc7XG5pbXBvcnQgeyBTUEFSUUxQcm9jZXNzb3IgfSBmcm9tICcuLi9wcm9jZXNzb3JzL1NQQVJRTFByb2Nlc3Nvcic7XG5pbXBvcnQgeyBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBRdWVyeVRlbXBsYXRlIH0gZnJvbSAnLi4vLi4vZG9tYWluL3Zpc3VhbC9RdWVyeVRlbXBsYXRlJztcbmltcG9ydCB7IFRlbXBsYXRlU2VsZWN0aW9uUGFuZWwgfSBmcm9tICcuL1RlbXBsYXRlU2VsZWN0aW9uUGFuZWwnO1xuaW1wb3J0IHsgVGVtcGxhdGVQYXJhbWV0ZXJNb2RhbCB9IGZyb20gJy4uL21vZGFscy9UZW1wbGF0ZVBhcmFtZXRlck1vZGFsJztcbmltcG9ydCB7IFNhdmVUZW1wbGF0ZU1vZGFsIH0gZnJvbSAnLi4vbW9kYWxzL1NhdmVUZW1wbGF0ZU1vZGFsJztcbmltcG9ydCB7IFF1ZXJ5VGVtcGxhdGVVc2VDYXNlIH0gZnJvbSAnLi4vLi4vYXBwbGljYXRpb24vdXNlLWNhc2VzL1F1ZXJ5VGVtcGxhdGVVc2VDYXNlJztcblxuZXhwb3J0IGludGVyZmFjZSBDYW52YXNPcHRpb25zIHtcbiAgICB3aWR0aD86IG51bWJlcjtcbiAgICBoZWlnaHQ/OiBudW1iZXI7XG4gICAgZ3JpZFNpemU/OiBudW1iZXI7XG4gICAgc2hvd0dyaWQ/OiBib29sZWFuO1xuICAgIHpvb21NaW4/OiBudW1iZXI7XG4gICAgem9vbU1heD86IG51bWJlcjtcbiAgICB6b29tU3RlcD86IG51bWJlcjtcbiAgICBvblF1ZXJ5Q2hhbmdlPzogKHNwYXJxbDogc3RyaW5nKSA9PiB2b2lkO1xuICAgIG9uRXhlY3V0ZT86IChzcGFycWw6IHN0cmluZykgPT4gdm9pZDtcbiAgICBlbmFibGVUZW1wbGF0ZXM/OiBib29sZWFuO1xuICAgIHRlbXBsYXRlVXNlQ2FzZT86IFF1ZXJ5VGVtcGxhdGVVc2VDYXNlO1xuICAgIGFwcEluc3RhbmNlPzogYW55OyAvLyBGb3IgbW9kYWwgY3JlYXRpb25cbiAgICAvLyBUZXN0LXNwZWNpZmljIGNhbGxiYWNrc1xuICAgIGFsbG93UGFuPzogYm9vbGVhbjtcbiAgICBtaW5ab29tPzogbnVtYmVyO1xuICAgIG1heFpvb20/OiBudW1iZXI7XG4gICAgb25Ob2RlU2VsZWN0PzogKG5vZGU6IFZpc3VhbFF1ZXJ5Tm9kZSkgPT4gdm9pZDtcbiAgICBvbkVkZ2VTZWxlY3Q/OiAoZWRnZTogVmlzdWFsUXVlcnlFZGdlKSA9PiB2b2lkO1xuICAgIG9uTm9kZUVkaXQ/OiAobm9kZTogVmlzdWFsUXVlcnlOb2RlKSA9PiB2b2lkO1xuICAgIG9uRWRnZUVkaXQ/OiAoZWRnZTogVmlzdWFsUXVlcnlFZGdlKSA9PiB2b2lkO1xuICAgIG9uUXVlcnlHZW5lcmF0ZWQ/OiAoc3BhcnFsOiBzdHJpbmcpID0+IHZvaWQ7XG4gICAgb25FeGVjdXRlUXVlcnk/OiAoKSA9PiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgVmlzdWFsUXVlcnlDYW52YXMge1xuICAgIHByaXZhdGUgY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudDtcbiAgICBwcml2YXRlIHN2ZzogU1ZHRWxlbWVudDtcbiAgICBwcml2YXRlIG5vZGVzR3JvdXA6IFNWR0dFbGVtZW50O1xuICAgIHByaXZhdGUgZWRnZXNHcm91cDogU1ZHR0VsZW1lbnQ7XG4gICAgcHJpdmF0ZSBncmlkR3JvdXA6IFNWR0dFbGVtZW50O1xuICAgIHByaXZhdGUgb3ZlcmxheUdyb3VwOiBTVkdHRWxlbWVudDtcbiAgICBcbiAgICBwcml2YXRlIG5vZGVzOiBNYXA8c3RyaW5nLCBWaXN1YWxRdWVyeU5vZGU+ID0gbmV3IE1hcCgpO1xuICAgIHByaXZhdGUgZWRnZXM6IE1hcDxzdHJpbmcsIFZpc3VhbFF1ZXJ5RWRnZT4gPSBuZXcgTWFwKCk7XG4gICAgcHJpdmF0ZSBzZWxlY3RlZE5vZGVzOiBTZXQ8c3RyaW5nPiA9IG5ldyBTZXQoKTtcbiAgICBwcml2YXRlIHNlbGVjdGVkRWRnZXM6IFNldDxzdHJpbmc+ID0gbmV3IFNldCgpO1xuICAgIFxuICAgIHByaXZhdGUgaXNEcmFnZ2luZyA9IGZhbHNlO1xuICAgIHByaXZhdGUgaXNQYW5uaW5nID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBpc0Nvbm5lY3RpbmcgPSBmYWxzZTtcbiAgICBwcml2YXRlIGRyYWdTdGFydFBvc2l0aW9uPzogTm9kZVBvc2l0aW9uO1xuICAgIHByaXZhdGUgY3VycmVudE1vdXNlUG9zaXRpb246IE5vZGVQb3NpdGlvbiA9IHsgeDogMCwgeTogMCB9O1xuICAgIHByaXZhdGUgY29ubmVjdGlvblNvdXJjZU5vZGU/OiBzdHJpbmc7XG4gICAgcHJpdmF0ZSB0ZW1wQ29ubmVjdGlvbkxpbmU/OiBTVkdMaW5lRWxlbWVudDtcbiAgICBcbiAgICBwcml2YXRlIHZpZXdwb3J0WCA9IDA7XG4gICAgcHJpdmF0ZSB2aWV3cG9ydFkgPSAwO1xuICAgIHByaXZhdGUgem9vbSA9IDE7XG4gICAgXG4gICAgcHJpdmF0ZSByZWFkb25seSBkZWZhdWx0T3B0aW9uczogUmVxdWlyZWQ8Q2FudmFzT3B0aW9ucz4gPSB7XG4gICAgICAgIHdpZHRoOiA4MDAsXG4gICAgICAgIGhlaWdodDogNjAwLFxuICAgICAgICBncmlkU2l6ZTogMjAsXG4gICAgICAgIHNob3dHcmlkOiB0cnVlLFxuICAgICAgICB6b29tTWluOiAwLjEsXG4gICAgICAgIHpvb21NYXg6IDUsXG4gICAgICAgIHpvb21TdGVwOiAwLjEsXG4gICAgICAgIG9uUXVlcnlDaGFuZ2U6ICgpID0+IHt9LFxuICAgICAgICBvbkV4ZWN1dGU6ICgpID0+IHt9LFxuICAgICAgICBlbmFibGVUZW1wbGF0ZXM6IHRydWUsXG4gICAgICAgIHRlbXBsYXRlVXNlQ2FzZTogdW5kZWZpbmVkIGFzIGFueSxcbiAgICAgICAgYXBwSW5zdGFuY2U6IHVuZGVmaW5lZCBhcyBhbnksXG4gICAgICAgIGFsbG93UGFuOiB0cnVlLFxuICAgICAgICBtaW5ab29tOiAwLjEsXG4gICAgICAgIG1heFpvb206IDUsXG4gICAgICAgIG9uTm9kZVNlbGVjdDogKCkgPT4ge30sXG4gICAgICAgIG9uRWRnZVNlbGVjdDogKCkgPT4ge30sXG4gICAgICAgIG9uTm9kZUVkaXQ6ICgpID0+IHt9LFxuICAgICAgICBvbkVkZ2VFZGl0OiAoKSA9PiB7fSxcbiAgICAgICAgb25RdWVyeUdlbmVyYXRlZDogKCkgPT4ge30sXG4gICAgICAgIG9uRXhlY3V0ZVF1ZXJ5OiAoKSA9PiB7fVxuICAgIH07XG4gICAgXG4gICAgcHJpdmF0ZSBvcHRpb25zOiBSZXF1aXJlZDxDYW52YXNPcHRpb25zPjtcbiAgICBwcml2YXRlIHNwYXJxbFByb2Nlc3Nvcj86IFNQQVJRTFByb2Nlc3NvcjtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHJlYWRvbmx5IHBhcmVudEVsZW1lbnQ6IEhUTUxFbGVtZW50LFxuICAgICAgICBvcHRpb25zT3JTcGFycWxQcm9jZXNzb3I/OiBDYW52YXNPcHRpb25zIHwgU1BBUlFMUHJvY2Vzc29yLFxuICAgICAgICBzcGFycWxQcm9jZXNzb3JPck9wdGlvbnM/OiBTUEFSUUxQcm9jZXNzb3IgfCBDYW52YXNPcHRpb25zXG4gICAgKSB7XG4gICAgICAgIC8vIEhhbmRsZSBtdWx0aXBsZSBjb25zdHJ1Y3RvciBzaWduYXR1cmVzIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5XG4gICAgICAgIGxldCBvcHRpb25zOiBDYW52YXNPcHRpb25zID0ge307XG4gICAgICAgIGxldCBzcGFycWxQcm9jZXNzb3I6IFNQQVJRTFByb2Nlc3NvciB8IHVuZGVmaW5lZDtcbiAgICAgICAgXG4gICAgICAgIGlmIChvcHRpb25zT3JTcGFycWxQcm9jZXNzb3IpIHtcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIGZpcnN0IHBhcmFtIGlzIFNQQVJRTFByb2Nlc3NvciAob2xkIHNpZ25hdHVyZSlcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygb3B0aW9uc09yU3BhcnFsUHJvY2Vzc29yID09PSAnb2JqZWN0JyAmJiAnZXhlY3V0ZVF1ZXJ5JyBpbiBvcHRpb25zT3JTcGFycWxQcm9jZXNzb3IpIHtcbiAgICAgICAgICAgICAgICBzcGFycWxQcm9jZXNzb3IgPSBvcHRpb25zT3JTcGFycWxQcm9jZXNzb3IgYXMgU1BBUlFMUHJvY2Vzc29yO1xuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSAoc3BhcnFsUHJvY2Vzc29yT3JPcHRpb25zIGFzIENhbnZhc09wdGlvbnMpIHx8IHt9O1xuICAgICAgICAgICAgfSBcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIGZpcnN0IHBhcmFtIGlzIG9wdGlvbnMgKG5ldyBzaWduYXR1cmU6IHBhcmVudEVsZW1lbnQsIG9wdGlvbnMsIHNwYXJxbFByb2Nlc3NvcilcbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBvcHRpb25zT3JTcGFycWxQcm9jZXNzb3IgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnNPclNwYXJxbFByb2Nlc3NvciBhcyBDYW52YXNPcHRpb25zO1xuICAgICAgICAgICAgICAgIGlmIChzcGFycWxQcm9jZXNzb3JPck9wdGlvbnMgJiYgJ2V4ZWN1dGVRdWVyeScgaW4gc3BhcnFsUHJvY2Vzc29yT3JPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgIHNwYXJxbFByb2Nlc3NvciA9IHNwYXJxbFByb2Nlc3Nvck9yT3B0aW9ucyBhcyBTUEFSUUxQcm9jZXNzb3I7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB0aGlzLm9wdGlvbnMgPSB7IC4uLnRoaXMuZGVmYXVsdE9wdGlvbnMsIC4uLm9wdGlvbnMgfTtcbiAgICAgICAgdGhpcy5zcGFycWxQcm9jZXNzb3IgPSBzcGFycWxQcm9jZXNzb3I7XG4gICAgICAgIHRoaXMuY3JlYXRlQ2FudmFzKCk7XG4gICAgICAgIHRoaXMuYXR0YWNoRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUNhbnZhcygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdGhpcy5jb250YWluZXIuY2xhc3NOYW1lID0gJ2V4b2NvcnRleC12aXN1YWwtcXVlcnktY2FudmFzJztcbiAgICAgICAgdGhpcy5jb250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAgICAgICAgIHdpZHRoOiAke3RoaXMub3B0aW9ucy53aWR0aH1weDtcbiAgICAgICAgICAgIGhlaWdodDogJHt0aGlzLm9wdGlvbnMuaGVpZ2h0fXB4O1xuICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLW0pO1xuICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcbiAgICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW47XG4gICAgICAgICAgICB1c2VyLXNlbGVjdDogbm9uZTtcbiAgICAgICAgYDtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHN2Z05TID0gJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJztcbiAgICAgICAgdGhpcy5zdmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoc3ZnTlMsICdzdmcnKSBhcyBTVkdFbGVtZW50O1xuICAgICAgICB0aGlzLnN2Zy5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgJzEwMCUnKTtcbiAgICAgICAgdGhpcy5zdmcuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCAnMTAwJScpO1xuICAgICAgICB0aGlzLnN2Zy5zdHlsZS5jc3NUZXh0ID0gJ2N1cnNvcjogZ3JhYjsnO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5ncmlkR3JvdXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoc3ZnTlMsICdnJykgYXMgU1ZHR0VsZW1lbnQ7XG4gICAgICAgIHRoaXMuZ3JpZEdyb3VwLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnZ3JpZC1ncm91cCcpO1xuICAgICAgICB0aGlzLnN2Zy5hcHBlbmRDaGlsZCh0aGlzLmdyaWRHcm91cCk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLmVkZ2VzR3JvdXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoc3ZnTlMsICdnJykgYXMgU1ZHR0VsZW1lbnQ7XG4gICAgICAgIHRoaXMuZWRnZXNHcm91cC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ2VkZ2VzLWdyb3VwJyk7XG4gICAgICAgIHRoaXMuc3ZnLmFwcGVuZENoaWxkKHRoaXMuZWRnZXNHcm91cCk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLm5vZGVzR3JvdXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoc3ZnTlMsICdnJykgYXMgU1ZHR0VsZW1lbnQ7XG4gICAgICAgIHRoaXMubm9kZXNHcm91cC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ25vZGVzLWdyb3VwJyk7XG4gICAgICAgIHRoaXMuc3ZnLmFwcGVuZENoaWxkKHRoaXMubm9kZXNHcm91cCk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLm92ZXJsYXlHcm91cCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhzdmdOUywgJ2cnKSBhcyBTVkdHRWxlbWVudDtcbiAgICAgICAgdGhpcy5vdmVybGF5R3JvdXAuc2V0QXR0cmlidXRlKCdjbGFzcycsICdvdmVybGF5LWdyb3VwJyk7XG4gICAgICAgIHRoaXMuc3ZnLmFwcGVuZENoaWxkKHRoaXMub3ZlcmxheUdyb3VwKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuc3ZnKTtcbiAgICAgICAgdGhpcy5jcmVhdGVDb250cm9scygpO1xuICAgICAgICB0aGlzLnBhcmVudEVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5jb250YWluZXIpO1xuICAgICAgICBcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5zaG93R3JpZCkge1xuICAgICAgICAgICAgdGhpcy5kcmF3R3JpZCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVDb250cm9scygpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY29udHJvbHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgY29udHJvbHMuY2xhc3NOYW1lID0gJ2NhbnZhcy10b29sYmFyJztcbiAgICAgICAgY29udHJvbHMuc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgICAgIHRvcDogMTBweDtcbiAgICAgICAgICAgIHJpZ2h0OiAxMHB4O1xuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgIGdhcDogOHB4O1xuICAgICAgICAgICAgcGFkZGluZzogOHB4O1xuICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1zZWNvbmRhcnkpO1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuICAgICAgICAgICAgYm94LXNoYWRvdzogMCAycHggOHB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcbiAgICAgICAgICAgIGZsZXgtd3JhcDogd3JhcDtcbiAgICAgICAgICAgIG1heC13aWR0aDogMzAwcHg7XG4gICAgICAgIGA7XG4gICAgICAgIFxuICAgICAgICAvLyBUZW1wbGF0ZSBjb250cm9scyAoaWYgZW5hYmxlZClcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5lbmFibGVUZW1wbGF0ZXMgJiYgdGhpcy5vcHRpb25zLnRlbXBsYXRlVXNlQ2FzZSkge1xuICAgICAgICAgICAgY29uc3QgdGVtcGxhdGVzQnRuID0gdGhpcy5jcmVhdGVDb250cm9sQnV0dG9uKCdUZW1wbGF0ZXMnLCAoKSA9PiB0aGlzLnNob3dUZW1wbGF0ZVNlbGVjdGlvbigpKTtcbiAgICAgICAgICAgIGNvbnN0IHNhdmVUZW1wbGF0ZUJ0biA9IHRoaXMuY3JlYXRlQ29udHJvbEJ1dHRvbignU2F2ZSBUZW1wbGF0ZScsICgpID0+IHRoaXMuc2hvd1NhdmVUZW1wbGF0ZU1vZGFsKCkpO1xuICAgICAgICAgICAgY29udHJvbHMuYXBwZW5kQ2hpbGQodGVtcGxhdGVzQnRuKTtcbiAgICAgICAgICAgIGNvbnRyb2xzLmFwcGVuZENoaWxkKHNhdmVUZW1wbGF0ZUJ0bik7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IHRlbXBsYXRlU2VwYXJhdG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICB0ZW1wbGF0ZVNlcGFyYXRvci5zdHlsZS5jc3NUZXh0ID0gJ3dpZHRoOiAxcHg7IGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTsgbWFyZ2luOiAwIDRweDsnO1xuICAgICAgICAgICAgY29udHJvbHMuYXBwZW5kQ2hpbGQodGVtcGxhdGVTZXBhcmF0b3IpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zdCBhZGRFbnRpdHlCdG4gPSB0aGlzLmNyZWF0ZUNvbnRyb2xCdXR0b24oJ0VudGl0eScsICgpID0+IHRoaXMuYWRkTm9kZShOb2RlVHlwZS5FTlRJVFkpKTtcbiAgICAgICAgY29uc3QgYWRkVmFyaWFibGVCdG4gPSB0aGlzLmNyZWF0ZUNvbnRyb2xCdXR0b24oJ1ZhcmlhYmxlJywgKCkgPT4gdGhpcy5hZGROb2RlKE5vZGVUeXBlLlZBUklBQkxFKSk7XG4gICAgICAgIGNvbnN0IGFkZExpdGVyYWxCdG4gPSB0aGlzLmNyZWF0ZUNvbnRyb2xCdXR0b24oJ0xpdGVyYWwnLCAoKSA9PiB0aGlzLmFkZE5vZGUoTm9kZVR5cGUuTElURVJBTCkpO1xuICAgICAgICBjb25zdCBhZGRGaWx0ZXJCdG4gPSB0aGlzLmNyZWF0ZUNvbnRyb2xCdXR0b24oJ0ZpbHRlcicsICgpID0+IHRoaXMuYWRkTm9kZShOb2RlVHlwZS5GSUxURVIpKTtcbiAgICAgICAgY29uc3QgZ2VuZXJhdGVCdG4gPSB0aGlzLmNyZWF0ZUNvbnRyb2xCdXR0b24oJ0dlbmVyYXRlJywgKCkgPT4gdGhpcy5nZW5lcmF0ZVNQQVJRTCgpKTtcbiAgICAgICAgY29uc3QgZXhlY3V0ZUJ0biA9IHRoaXMuY3JlYXRlQ29udHJvbEJ1dHRvbignRXhlY3V0ZScsICgpID0+IHRoaXMuZXhlY3V0ZVF1ZXJ5KCksIHRydWUpO1xuICAgICAgICBjb25zdCBjbGVhckJ0biA9IHRoaXMuY3JlYXRlQ29udHJvbEJ1dHRvbignQ2xlYXInLCAoKSA9PiB0aGlzLmNsZWFyQ2FudmFzKCkpO1xuICAgICAgICBcbiAgICAgICAgY29udHJvbHMuYXBwZW5kQ2hpbGQoYWRkRW50aXR5QnRuKTtcbiAgICAgICAgY29udHJvbHMuYXBwZW5kQ2hpbGQoYWRkVmFyaWFibGVCdG4pO1xuICAgICAgICBjb250cm9scy5hcHBlbmRDaGlsZChhZGRMaXRlcmFsQnRuKTtcbiAgICAgICAgY29udHJvbHMuYXBwZW5kQ2hpbGQoYWRkRmlsdGVyQnRuKTtcbiAgICAgICAgY29udHJvbHMuYXBwZW5kQ2hpbGQoZ2VuZXJhdGVCdG4pO1xuICAgICAgICBjb250cm9scy5hcHBlbmRDaGlsZChleGVjdXRlQnRuKTtcbiAgICAgICAgY29udHJvbHMuYXBwZW5kQ2hpbGQoY2xlYXJCdG4pO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQoY29udHJvbHMpO1xuICAgICAgICBcbiAgICAgICAgY29uc3Qgem9vbUNvbnRyb2xzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHpvb21Db250cm9scy5jbGFzc05hbWUgPSAnem9vbS1jb250cm9scyc7XG4gICAgICAgIHpvb21Db250cm9scy5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICAgICAgYm90dG9tOiAxMHB4O1xuICAgICAgICAgICAgcmlnaHQ6IDEwcHg7XG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgZ2FwOiA0cHg7XG4gICAgICAgICAgICBwYWRkaW5nOiA0cHg7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXNlY29uZGFyeSk7XG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG4gICAgICAgIGA7XG4gICAgICAgIFxuICAgICAgICBjb25zdCB6b29tSW5CdG4gPSB0aGlzLmNyZWF0ZVpvb21CdXR0b24oJysnLCAoKSA9PiB0aGlzLnpvb21JbigpKTtcbiAgICAgICAgY29uc3Qgem9vbU91dEJ0biA9IHRoaXMuY3JlYXRlWm9vbUJ1dHRvbignLScsICgpID0+IHRoaXMuem9vbU91dCgpKTtcbiAgICAgICAgY29uc3Qgem9vbVJlc2V0QnRuID0gdGhpcy5jcmVhdGVab29tQnV0dG9uKCfin7InLCAoKSA9PiB0aGlzLnJlc2V0Wm9vbSgpKTtcbiAgICAgICAgXG4gICAgICAgIHpvb21Db250cm9scy5hcHBlbmRDaGlsZCh6b29tT3V0QnRuKTtcbiAgICAgICAgem9vbUNvbnRyb2xzLmFwcGVuZENoaWxkKHpvb21SZXNldEJ0bik7XG4gICAgICAgIHpvb21Db250cm9scy5hcHBlbmRDaGlsZCh6b29tSW5CdG4pO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQoem9vbUNvbnRyb2xzKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUNvbnRyb2xCdXR0b24obGFiZWw6IHN0cmluZywgb25DbGljazogKCkgPT4gdm9pZCwgcHJpbWFyeSA9IGZhbHNlKTogSFRNTEJ1dHRvbkVsZW1lbnQge1xuICAgICAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICAgICAgYnV0dG9uLnRleHRDb250ZW50ID0gbGFiZWw7XG4gICAgICAgIGJ1dHRvbi5jbGFzc05hbWUgPSBwcmltYXJ5ID8gJ21vZC1jdGEnIDogJyc7XG4gICAgICAgIGJ1dHRvbi5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgcGFkZGluZzogNnB4IDEycHg7XG4gICAgICAgICAgICBib3JkZXI6IG5vbmU7XG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiAke3ByaW1hcnkgPyAndmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KScgOiAndmFyKC0taW50ZXJhY3RpdmUtbm9ybWFsKSd9O1xuICAgICAgICAgICAgY29sb3I6ICR7cHJpbWFyeSA/ICd2YXIoLS10ZXh0LW9uLWFjY2VudCknIDogJ3ZhcigtLXRleHQtbm9ybWFsKSd9O1xuICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICAgICAgZm9udC1zaXplOiAxMnB4O1xuICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDtcbiAgICAgICAgICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4xNXMgZWFzZTtcbiAgICAgICAgYDtcbiAgICAgICAgXG4gICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuICAgICAgICAgICAgYnV0dG9uLnN0eWxlLmJhY2tncm91bmQgPSBwcmltYXJ5ID8gJ3ZhcigtLWludGVyYWN0aXZlLWFjY2VudC1ob3ZlciknIDogJ3ZhcigtLWludGVyYWN0aXZlLWhvdmVyKSc7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG4gICAgICAgICAgICBidXR0b24uc3R5bGUuYmFja2dyb3VuZCA9IHByaW1hcnkgPyAndmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KScgOiAndmFyKC0taW50ZXJhY3RpdmUtbm9ybWFsKSc7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25DbGljayk7XG4gICAgICAgIHJldHVybiBidXR0b247XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVab29tQnV0dG9uKGxhYmVsOiBzdHJpbmcsIG9uQ2xpY2s6ICgpID0+IHZvaWQpOiBIVE1MQnV0dG9uRWxlbWVudCB7XG4gICAgICAgIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgICAgICBidXR0b24udGV4dENvbnRlbnQgPSBsYWJlbDtcbiAgICAgICAgYnV0dG9uLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICB3aWR0aDogMjRweDtcbiAgICAgICAgICAgIGhlaWdodDogMjRweDtcbiAgICAgICAgICAgIGJvcmRlcjogbm9uZTtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zKTtcbiAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWludGVyYWN0aXZlLW5vcm1hbCk7XG4gICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICAgICAgZm9udC1zaXplOiAxNHB4O1xuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4xNXMgZWFzZTtcbiAgICAgICAgYDtcbiAgICAgICAgXG4gICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuICAgICAgICAgICAgYnV0dG9uLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0taW50ZXJhY3RpdmUtaG92ZXIpJztcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcbiAgICAgICAgICAgIGJ1dHRvbi5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWludGVyYWN0aXZlLW5vcm1hbCknO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xpY2spO1xuICAgICAgICByZXR1cm4gYnV0dG9uO1xuICAgIH1cblxuICAgIHByaXZhdGUgZHJhd0dyaWQoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHN2Z05TID0gJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJztcbiAgICAgICAgdGhpcy5ncmlkR3JvdXAuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBwYXR0ZXJuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKHN2Z05TLCAncGF0dGVybicpIGFzIFNWR1BhdHRlcm5FbGVtZW50O1xuICAgICAgICBwYXR0ZXJuLnNldEF0dHJpYnV0ZSgnaWQnLCAnZ3JpZC1wYXR0ZXJuJyk7XG4gICAgICAgIHBhdHRlcm4uc2V0QXR0cmlidXRlKCd3aWR0aCcsIHRoaXMub3B0aW9ucy5ncmlkU2l6ZS50b1N0cmluZygpKTtcbiAgICAgICAgcGF0dGVybi5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsIHRoaXMub3B0aW9ucy5ncmlkU2l6ZS50b1N0cmluZygpKTtcbiAgICAgICAgcGF0dGVybi5zZXRBdHRyaWJ1dGUoJ3BhdHRlcm5Vbml0cycsICd1c2VyU3BhY2VPblVzZScpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbGluZTEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoc3ZnTlMsICdsaW5lJykgYXMgU1ZHTGluZUVsZW1lbnQ7XG4gICAgICAgIGxpbmUxLnNldEF0dHJpYnV0ZSgneDEnLCAnMCcpO1xuICAgICAgICBsaW5lMS5zZXRBdHRyaWJ1dGUoJ3kxJywgJzAnKTtcbiAgICAgICAgbGluZTEuc2V0QXR0cmlidXRlKCd4MicsIHRoaXMub3B0aW9ucy5ncmlkU2l6ZS50b1N0cmluZygpKTtcbiAgICAgICAgbGluZTEuc2V0QXR0cmlidXRlKCd5MicsICcwJyk7XG4gICAgICAgIGxpbmUxLnNldEF0dHJpYnV0ZSgnc3Ryb2tlJywgJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKScpO1xuICAgICAgICBsaW5lMS5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsICcwLjUnKTtcbiAgICAgICAgbGluZTEuc2V0QXR0cmlidXRlKCdvcGFjaXR5JywgJzAuMycpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbGluZTIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoc3ZnTlMsICdsaW5lJykgYXMgU1ZHTGluZUVsZW1lbnQ7XG4gICAgICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneDEnLCAnMCcpO1xuICAgICAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3kxJywgJzAnKTtcbiAgICAgICAgbGluZTIuc2V0QXR0cmlidXRlKCd4MicsICcwJyk7XG4gICAgICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneTInLCB0aGlzLm9wdGlvbnMuZ3JpZFNpemUudG9TdHJpbmcoKSk7XG4gICAgICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgnc3Ryb2tlJywgJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKScpO1xuICAgICAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsICcwLjUnKTtcbiAgICAgICAgbGluZTIuc2V0QXR0cmlidXRlKCdvcGFjaXR5JywgJzAuMycpO1xuICAgICAgICBcbiAgICAgICAgcGF0dGVybi5hcHBlbmRDaGlsZChsaW5lMSk7XG4gICAgICAgIHBhdHRlcm4uYXBwZW5kQ2hpbGQobGluZTIpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZGVmcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhzdmdOUywgJ2RlZnMnKSBhcyBTVkdEZWZzRWxlbWVudDtcbiAgICAgICAgZGVmcy5hcHBlbmRDaGlsZChwYXR0ZXJuKTtcbiAgICAgICAgdGhpcy5zdmcuaW5zZXJ0QmVmb3JlKGRlZnMsIHRoaXMuc3ZnLmZpcnN0Q2hpbGQpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgcmVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhzdmdOUywgJ3JlY3QnKSBhcyBTVkdSZWN0RWxlbWVudDtcbiAgICAgICAgcmVjdC5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgJzEwMCUnKTtcbiAgICAgICAgcmVjdC5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsICcxMDAlJyk7XG4gICAgICAgIHJlY3Quc2V0QXR0cmlidXRlKCdmaWxsJywgJ3VybCgjZ3JpZC1wYXR0ZXJuKScpO1xuICAgICAgICB0aGlzLmdyaWRHcm91cC5hcHBlbmRDaGlsZChyZWN0KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGF0dGFjaEV2ZW50TGlzdGVuZXJzKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnN2Zy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLmhhbmRsZU1vdXNlRG93bi5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5zdmcuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5oYW5kbGVNb3VzZU1vdmUuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuc3ZnLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLmhhbmRsZU1vdXNlVXAuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuc3ZnLmFkZEV2ZW50TGlzdGVuZXIoJ3doZWVsJywgdGhpcy5oYW5kbGVXaGVlbC5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5zdmcuYWRkRXZlbnRMaXN0ZW5lcignY29udGV4dG1lbnUnLCB0aGlzLmhhbmRsZUNvbnRleHRNZW51LmJpbmQodGhpcykpO1xuICAgICAgICBcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuaGFuZGxlS2V5RG93bi5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGhhbmRsZU1vdXNlRG93bihlOiBNb3VzZUV2ZW50KTogdm9pZCB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgY29uc3QgcG9pbnQgPSB0aGlzLmdldE1vdXNlUG9zaXRpb24oZSk7XG4gICAgICAgIHRoaXMuZHJhZ1N0YXJ0UG9zaXRpb24gPSBwb2ludDtcbiAgICAgICAgXG4gICAgICAgIGlmIChlLmJ1dHRvbiA9PT0gMSB8fCAoZS5idXR0b24gPT09IDAgJiYgZS5zaGlmdEtleSkpIHtcbiAgICAgICAgICAgIHRoaXMuaXNQYW5uaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuc3ZnLnN0eWxlLmN1cnNvciA9ICdncmFiYmluZyc7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGNsaWNrZWROb2RlID0gdGhpcy5nZXROb2RlQXQocG9pbnQpO1xuICAgICAgICBjb25zdCBjbGlja2VkRWRnZSA9IHRoaXMuZ2V0RWRnZUF0KHBvaW50KTtcbiAgICAgICAgXG4gICAgICAgIGlmIChlLmJ1dHRvbiA9PT0gMCkge1xuICAgICAgICAgICAgaWYgKGNsaWNrZWROb2RlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGUuY3RybEtleSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZU5vZGVTZWxlY3Rpb24oY2xpY2tlZE5vZGUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZS5hbHRLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFydENvbm5lY3Rpb24oY2xpY2tlZE5vZGUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5zZWxlY3RlZE5vZGVzLmhhcyhjbGlja2VkTm9kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0Tm9kZShjbGlja2VkTm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0RyYWdnaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGNsaWNrZWRFZGdlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhclNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0RWRnZShjbGlja2VkRWRnZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgaGFuZGxlTW91c2VNb3ZlKGU6IE1vdXNlRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgcG9pbnQgPSB0aGlzLmdldE1vdXNlUG9zaXRpb24oZSk7XG4gICAgICAgIHRoaXMuY3VycmVudE1vdXNlUG9zaXRpb24gPSBwb2ludDtcbiAgICAgICAgXG4gICAgICAgIGlmICh0aGlzLmlzUGFubmluZyAmJiB0aGlzLmRyYWdTdGFydFBvc2l0aW9uKSB7XG4gICAgICAgICAgICBjb25zdCBkeCA9IHBvaW50LnggLSB0aGlzLmRyYWdTdGFydFBvc2l0aW9uLng7XG4gICAgICAgICAgICBjb25zdCBkeSA9IHBvaW50LnkgLSB0aGlzLmRyYWdTdGFydFBvc2l0aW9uLnk7XG4gICAgICAgICAgICB0aGlzLnZpZXdwb3J0WCArPSBkeCAvIHRoaXMuem9vbTtcbiAgICAgICAgICAgIHRoaXMudmlld3BvcnRZICs9IGR5IC8gdGhpcy56b29tO1xuICAgICAgICAgICAgdGhpcy5kcmFnU3RhcnRQb3NpdGlvbiA9IHBvaW50O1xuICAgICAgICAgICAgdGhpcy51cGRhdGVUcmFuc2Zvcm0oKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmlzRHJhZ2dpbmcgJiYgdGhpcy5kcmFnU3RhcnRQb3NpdGlvbikge1xuICAgICAgICAgICAgY29uc3QgZHggPSAocG9pbnQueCAtIHRoaXMuZHJhZ1N0YXJ0UG9zaXRpb24ueCkgLyB0aGlzLnpvb207XG4gICAgICAgICAgICBjb25zdCBkeSA9IChwb2ludC55IC0gdGhpcy5kcmFnU3RhcnRQb3NpdGlvbi55KSAvIHRoaXMuem9vbTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE5vZGVzLmZvckVhY2gobm9kZUlkID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBub2RlID0gdGhpcy5ub2Rlcy5nZXQobm9kZUlkKTtcbiAgICAgICAgICAgICAgICBpZiAobm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwb3MgPSBub2RlLmdldFBvc2l0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUuc2V0UG9zaXRpb24oe1xuICAgICAgICAgICAgICAgICAgICAgICAgeDogcG9zLnggKyBkeCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IHBvcy55ICsgZHlcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRoaXMuZHJhZ1N0YXJ0UG9zaXRpb24gPSBwb2ludDtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5pc0Nvbm5lY3RpbmcgJiYgdGhpcy50ZW1wQ29ubmVjdGlvbkxpbmUpIHtcbiAgICAgICAgICAgIGNvbnN0IHN2Z1BvaW50ID0gdGhpcy5nZXRTVkdQb2ludChwb2ludCk7XG4gICAgICAgICAgICB0aGlzLnRlbXBDb25uZWN0aW9uTGluZS5zZXRBdHRyaWJ1dGUoJ3gyJywgc3ZnUG9pbnQueC50b1N0cmluZygpKTtcbiAgICAgICAgICAgIHRoaXMudGVtcENvbm5lY3Rpb25MaW5lLnNldEF0dHJpYnV0ZSgneTInLCBzdmdQb2ludC55LnRvU3RyaW5nKCkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoYW5kbGVNb3VzZVVwKGU6IE1vdXNlRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuaXNDb25uZWN0aW5nKSB7XG4gICAgICAgICAgICBjb25zdCBwb2ludCA9IHRoaXMuZ2V0TW91c2VQb3NpdGlvbihlKTtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldE5vZGUgPSB0aGlzLmdldE5vZGVBdChwb2ludCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICh0YXJnZXROb2RlICYmIHRhcmdldE5vZGUgIT09IHRoaXMuY29ubmVjdGlvblNvdXJjZU5vZGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUVkZ2UodGhpcy5jb25uZWN0aW9uU291cmNlTm9kZSEsIHRhcmdldE5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLmVuZENvbm5lY3Rpb24oKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdGhpcy5pc0RyYWdnaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaXNQYW5uaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZHJhZ1N0YXJ0UG9zaXRpb24gPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuc3ZnLnN0eWxlLmN1cnNvciA9ICdncmFiJztcbiAgICB9XG5cbiAgICBwcml2YXRlIGhhbmRsZVdoZWVsKGU6IFdoZWVsRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZGVsdGEgPSBlLmRlbHRhWSA+IDAgPyAtdGhpcy5vcHRpb25zLnpvb21TdGVwIDogdGhpcy5vcHRpb25zLnpvb21TdGVwO1xuICAgICAgICBjb25zdCBuZXdab29tID0gTWF0aC5tYXgodGhpcy5vcHRpb25zLnpvb21NaW4sIE1hdGgubWluKHRoaXMub3B0aW9ucy56b29tTWF4LCB0aGlzLnpvb20gKyBkZWx0YSkpO1xuICAgICAgICBcbiAgICAgICAgaWYgKG5ld1pvb20gIT09IHRoaXMuem9vbSkge1xuICAgICAgICAgICAgY29uc3QgcG9pbnQgPSB0aGlzLmdldE1vdXNlUG9zaXRpb24oZSk7XG4gICAgICAgICAgICBjb25zdCBzY2FsZUZhY3RvciA9IG5ld1pvb20gLyB0aGlzLnpvb207XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRoaXMudmlld3BvcnRYID0gcG9pbnQueCAtIChwb2ludC54IC0gdGhpcy52aWV3cG9ydFgpICogc2NhbGVGYWN0b3I7XG4gICAgICAgICAgICB0aGlzLnZpZXdwb3J0WSA9IHBvaW50LnkgLSAocG9pbnQueSAtIHRoaXMudmlld3BvcnRZKSAqIHNjYWxlRmFjdG9yO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLnpvb20gPSBuZXdab29tO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVUcmFuc2Zvcm0oKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgaGFuZGxlQ29udGV4dE1lbnUoZTogTW91c2VFdmVudCk6IHZvaWQge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGNvbnN0IHBvaW50ID0gdGhpcy5nZXRNb3VzZVBvc2l0aW9uKGUpO1xuICAgICAgICBjb25zdCBjbGlja2VkTm9kZSA9IHRoaXMuZ2V0Tm9kZUF0KHBvaW50KTtcbiAgICAgICAgY29uc3QgY2xpY2tlZEVkZ2UgPSB0aGlzLmdldEVkZ2VBdChwb2ludCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoY2xpY2tlZE5vZGUpIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd05vZGVDb250ZXh0TWVudShjbGlja2VkTm9kZSwgcG9pbnQpO1xuICAgICAgICB9IGVsc2UgaWYgKGNsaWNrZWRFZGdlKSB7XG4gICAgICAgICAgICB0aGlzLnNob3dFZGdlQ29udGV4dE1lbnUoY2xpY2tlZEVkZ2UsIHBvaW50KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgaGFuZGxlS2V5RG93bihlOiBLZXlib2FyZEV2ZW50KTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5jb250YWluZXIuY29udGFpbnMoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCkpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGlmIChlLmtleSA9PT0gJ0RlbGV0ZScgfHwgZS5rZXkgPT09ICdCYWNrc3BhY2UnKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLmRlbGV0ZVNlbGVjdGVkKCk7XG4gICAgICAgIH0gZWxzZSBpZiAoZS5rZXkgPT09ICdhJyAmJiBlLmN0cmxLZXkpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0QWxsKCk7XG4gICAgICAgIH0gZWxzZSBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgICAgICB0aGlzLmNsZWFyU2VsZWN0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGdldE1vdXNlUG9zaXRpb24oZTogTW91c2VFdmVudCk6IE5vZGVQb3NpdGlvbiB7XG4gICAgICAgIGNvbnN0IHJlY3QgPSB0aGlzLnN2Zy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHg6IGUuY2xpZW50WCAtIHJlY3QubGVmdCxcbiAgICAgICAgICAgIHk6IGUuY2xpZW50WSAtIHJlY3QudG9wXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRTVkdQb2ludChwb2ludDogTm9kZVBvc2l0aW9uKTogTm9kZVBvc2l0aW9uIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHg6IChwb2ludC54IC0gdGhpcy52aWV3cG9ydFgpIC8gdGhpcy56b29tLFxuICAgICAgICAgICAgeTogKHBvaW50LnkgLSB0aGlzLnZpZXdwb3J0WSkgLyB0aGlzLnpvb21cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldE5vZGVBdChwb2ludDogTm9kZVBvc2l0aW9uKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgICAgIGNvbnN0IHN2Z1BvaW50ID0gdGhpcy5nZXRTVkdQb2ludChwb2ludCk7XG4gICAgICAgIFxuICAgICAgICBmb3IgKGNvbnN0IFtpZCwgbm9kZV0gb2YgdGhpcy5ub2Rlcykge1xuICAgICAgICAgICAgaWYgKG5vZGUuY29udGFpbnNQb2ludChzdmdQb2ludC54LCBzdmdQb2ludC55KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRFZGdlQXQocG9pbnQ6IE5vZGVQb3NpdGlvbik6IHN0cmluZyB8IG51bGwge1xuICAgICAgICBjb25zdCBzdmdQb2ludCA9IHRoaXMuZ2V0U1ZHUG9pbnQocG9pbnQpO1xuICAgICAgICBjb25zdCB0aHJlc2hvbGQgPSA1O1xuICAgICAgICBcbiAgICAgICAgZm9yIChjb25zdCBbaWQsIGVkZ2VdIG9mIHRoaXMuZWRnZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHNvdXJjZSA9IHRoaXMubm9kZXMuZ2V0KGVkZ2UuZ2V0U291cmNlTm9kZUlkKCkpO1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0ID0gdGhpcy5ub2Rlcy5nZXQoZWRnZS5nZXRUYXJnZXROb2RlSWQoKSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChzb3VyY2UgJiYgdGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGFiZWxQb3MgPSBlZGdlLmdldExhYmVsUG9zaXRpb24oc291cmNlLCB0YXJnZXQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRpc3RhbmNlID0gTWF0aC5zcXJ0KFxuICAgICAgICAgICAgICAgICAgICBNYXRoLnBvdyhzdmdQb2ludC54IC0gbGFiZWxQb3MueCwgMikgK1xuICAgICAgICAgICAgICAgICAgICBNYXRoLnBvdyhzdmdQb2ludC55IC0gbGFiZWxQb3MueSwgMilcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChkaXN0YW5jZSA8IHRocmVzaG9sZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBwcml2YXRlIHN0YXJ0Q29ubmVjdGlvbihub2RlSWQ6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICB0aGlzLmlzQ29ubmVjdGluZyA9IHRydWU7XG4gICAgICAgIHRoaXMuY29ubmVjdGlvblNvdXJjZU5vZGUgPSBub2RlSWQ7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBub2RlID0gdGhpcy5ub2Rlcy5nZXQobm9kZUlkKTtcbiAgICAgICAgaWYgKCFub2RlKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICBjb25zdCBzdmdOUyA9ICdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zyc7XG4gICAgICAgIHRoaXMudGVtcENvbm5lY3Rpb25MaW5lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKHN2Z05TLCAnbGluZScpIGFzIFNWR0xpbmVFbGVtZW50O1xuICAgICAgICBcbiAgICAgICAgY29uc3Qgc291cmNlUG9pbnQgPSBub2RlLmdldENvbm5lY3Rpb25Qb2ludHMoKS5yaWdodDtcbiAgICAgICAgdGhpcy50ZW1wQ29ubmVjdGlvbkxpbmUuc2V0QXR0cmlidXRlKCd4MScsIHNvdXJjZVBvaW50LngudG9TdHJpbmcoKSk7XG4gICAgICAgIHRoaXMudGVtcENvbm5lY3Rpb25MaW5lLnNldEF0dHJpYnV0ZSgneTEnLCBzb3VyY2VQb2ludC55LnRvU3RyaW5nKCkpO1xuICAgICAgICB0aGlzLnRlbXBDb25uZWN0aW9uTGluZS5zZXRBdHRyaWJ1dGUoJ3gyJywgc291cmNlUG9pbnQueC50b1N0cmluZygpKTtcbiAgICAgICAgdGhpcy50ZW1wQ29ubmVjdGlvbkxpbmUuc2V0QXR0cmlidXRlKCd5MicsIHNvdXJjZVBvaW50LnkudG9TdHJpbmcoKSk7XG4gICAgICAgIHRoaXMudGVtcENvbm5lY3Rpb25MaW5lLnNldEF0dHJpYnV0ZSgnc3Ryb2tlJywgJ3ZhcigtLXRleHQtYWNjZW50KScpO1xuICAgICAgICB0aGlzLnRlbXBDb25uZWN0aW9uTGluZS5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsICcyJyk7XG4gICAgICAgIHRoaXMudGVtcENvbm5lY3Rpb25MaW5lLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWRhc2hhcnJheScsICc1LDUnKTtcbiAgICAgICAgdGhpcy50ZW1wQ29ubmVjdGlvbkxpbmUuc2V0QXR0cmlidXRlKCdvcGFjaXR5JywgJzAuNicpO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5vdmVybGF5R3JvdXAuYXBwZW5kQ2hpbGQodGhpcy50ZW1wQ29ubmVjdGlvbkxpbmUpO1xuICAgIH1cblxuICAgIHByaXZhdGUgZW5kQ29ubmVjdGlvbigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5pc0Nvbm5lY3RpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jb25uZWN0aW9uU291cmNlTm9kZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgXG4gICAgICAgIGlmICh0aGlzLnRlbXBDb25uZWN0aW9uTGluZSkge1xuICAgICAgICAgICAgdGhpcy50ZW1wQ29ubmVjdGlvbkxpbmUucmVtb3ZlKCk7XG4gICAgICAgICAgICB0aGlzLnRlbXBDb25uZWN0aW9uTGluZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlRWRnZShzb3VyY2VJZDogc3RyaW5nLCB0YXJnZXRJZDogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGVkZ2UgPSBWaXN1YWxRdWVyeUVkZ2UuY3JlYXRlUHJvcGVydHkoXG4gICAgICAgICAgICBzb3VyY2VJZCxcbiAgICAgICAgICAgIHRhcmdldElkLFxuICAgICAgICAgICAgJ3Byb3BlcnR5JyxcbiAgICAgICAgICAgIHVuZGVmaW5lZFxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5lZGdlcy5zZXQoZWRnZS5nZXRJZCgpLCBlZGdlKTtcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgdGhpcy51cGRhdGVRdWVyeSgpO1xuICAgIH1cblxuICAgIHByaXZhdGUgc2VsZWN0Tm9kZShub2RlSWQ6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICB0aGlzLnNlbGVjdGVkTm9kZXMuYWRkKG5vZGVJZCk7XG4gICAgICAgIGNvbnN0IG5vZGUgPSB0aGlzLm5vZGVzLmdldChub2RlSWQpO1xuICAgICAgICBpZiAobm9kZSkge1xuICAgICAgICAgICAgbm9kZS5zZXRTZWxlY3RlZCh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH1cblxuICAgIHByaXZhdGUgc2VsZWN0RWRnZShlZGdlSWQ6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICB0aGlzLnNlbGVjdGVkRWRnZXMuYWRkKGVkZ2VJZCk7XG4gICAgICAgIGNvbnN0IGVkZ2UgPSB0aGlzLmVkZ2VzLmdldChlZGdlSWQpO1xuICAgICAgICBpZiAoZWRnZSkge1xuICAgICAgICAgICAgZWRnZS5zZXRTZWxlY3RlZCh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH1cblxuICAgIHByaXZhdGUgdG9nZ2xlTm9kZVNlbGVjdGlvbihub2RlSWQ6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZE5vZGVzLmhhcyhub2RlSWQpKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkTm9kZXMuZGVsZXRlKG5vZGVJZCk7XG4gICAgICAgICAgICBjb25zdCBub2RlID0gdGhpcy5ub2Rlcy5nZXQobm9kZUlkKTtcbiAgICAgICAgICAgIGlmIChub2RlKSB7XG4gICAgICAgICAgICAgICAgbm9kZS5zZXRTZWxlY3RlZChmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdE5vZGUobm9kZUlkKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH1cblxuICAgIHByaXZhdGUgY2xlYXJTZWxlY3Rpb24oKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWROb2Rlcy5mb3JFYWNoKGlkID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5vZGUgPSB0aGlzLm5vZGVzLmdldChpZCk7XG4gICAgICAgICAgICBpZiAobm9kZSkgbm9kZS5zZXRTZWxlY3RlZChmYWxzZSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnNlbGVjdGVkRWRnZXMuZm9yRWFjaChpZCA9PiB7XG4gICAgICAgICAgICBjb25zdCBlZGdlID0gdGhpcy5lZGdlcy5nZXQoaWQpO1xuICAgICAgICAgICAgaWYgKGVkZ2UpIGVkZ2Uuc2V0U2VsZWN0ZWQoZmFsc2UpO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuc2VsZWN0ZWROb2Rlcy5jbGVhcigpO1xuICAgICAgICB0aGlzLnNlbGVjdGVkRWRnZXMuY2xlYXIoKTtcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNlbGVjdEFsbCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5ub2Rlcy5mb3JFYWNoKChub2RlLCBpZCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE5vZGVzLmFkZChpZCk7XG4gICAgICAgICAgICBub2RlLnNldFNlbGVjdGVkKHRydWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5lZGdlcy5mb3JFYWNoKChlZGdlLCBpZCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEVkZ2VzLmFkZChpZCk7XG4gICAgICAgICAgICBlZGdlLnNldFNlbGVjdGVkKHRydWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGRlbGV0ZVNlbGVjdGVkKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnNlbGVjdGVkRWRnZXMuZm9yRWFjaChpZCA9PiB7XG4gICAgICAgICAgICB0aGlzLmVkZ2VzLmRlbGV0ZShpZCk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5zZWxlY3RlZE5vZGVzLmZvckVhY2goaWQgPT4ge1xuICAgICAgICAgICAgdGhpcy5lZGdlcy5mb3JFYWNoKChlZGdlLCBlZGdlSWQpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZWRnZS5nZXRTb3VyY2VOb2RlSWQoKSA9PT0gaWQgfHwgZWRnZS5nZXRUYXJnZXROb2RlSWQoKSA9PT0gaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lZGdlcy5kZWxldGUoZWRnZUlkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMubm9kZXMuZGVsZXRlKGlkKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLmNsZWFyU2VsZWN0aW9uKCk7XG4gICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgIHRoaXMudXBkYXRlUXVlcnkoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNob3dOb2RlQ29udGV4dE1lbnUobm9kZUlkOiBzdHJpbmcsIHBvc2l0aW9uOiBOb2RlUG9zaXRpb24pOiB2b2lkIHtcbiAgICAgICAgY29uc3Qgbm9kZSA9IHRoaXMubm9kZXMuZ2V0KG5vZGVJZCk7XG4gICAgICAgIGlmICghbm9kZSkgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbWVudSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBtZW51LmNsYXNzTmFtZSA9ICdjb250ZXh0LW1lbnUnO1xuICAgICAgICBtZW51LnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgICAgICBsZWZ0OiAke3Bvc2l0aW9uLnh9cHg7XG4gICAgICAgICAgICB0b3A6ICR7cG9zaXRpb24ueX1weDtcbiAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtc2Vjb25kYXJ5KTtcbiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zKTtcbiAgICAgICAgICAgIHBhZGRpbmc6IDRweDtcbiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgMnB4IDhweCByZ2JhKDAsIDAsIDAsIDAuMTUpO1xuICAgICAgICAgICAgei1pbmRleDogMTAwMDtcbiAgICAgICAgYDtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGVkaXRPcHRpb24gPSB0aGlzLmNyZWF0ZU1lbnVPcHRpb24oJ0VkaXQgTGFiZWwnLCAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuZXdMYWJlbCA9IHByb21wdCgnRW50ZXIgbmV3IGxhYmVsOicsIG5vZGUuZ2V0TGFiZWwoKSk7XG4gICAgICAgICAgICBpZiAobmV3TGFiZWwpIHtcbiAgICAgICAgICAgICAgICBub2RlLnNldExhYmVsKG5ld0xhYmVsKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUXVlcnkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1lbnUucmVtb3ZlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZGVsZXRlT3B0aW9uID0gdGhpcy5jcmVhdGVNZW51T3B0aW9uKCdEZWxldGUnLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLm5vZGVzLmRlbGV0ZShub2RlSWQpO1xuICAgICAgICAgICAgdGhpcy5lZGdlcy5mb3JFYWNoKChlZGdlLCBpZCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChlZGdlLmdldFNvdXJjZU5vZGVJZCgpID09PSBub2RlSWQgfHwgZWRnZS5nZXRUYXJnZXROb2RlSWQoKSA9PT0gbm9kZUlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWRnZXMuZGVsZXRlKGlkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVF1ZXJ5KCk7XG4gICAgICAgICAgICBtZW51LnJlbW92ZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIG1lbnUuYXBwZW5kQ2hpbGQoZWRpdE9wdGlvbik7XG4gICAgICAgIG1lbnUuYXBwZW5kQ2hpbGQoZGVsZXRlT3B0aW9uKTtcbiAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQobWVudSk7XG4gICAgICAgIFxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gbWVudS5yZW1vdmUoKSwgeyBvbmNlOiB0cnVlIH0pO1xuICAgICAgICB9LCAxMCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzaG93RWRnZUNvbnRleHRNZW51KGVkZ2VJZDogc3RyaW5nLCBwb3NpdGlvbjogTm9kZVBvc2l0aW9uKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGVkZ2UgPSB0aGlzLmVkZ2VzLmdldChlZGdlSWQpO1xuICAgICAgICBpZiAoIWVkZ2UpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG1lbnUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgbWVudS5jbGFzc05hbWUgPSAnY29udGV4dC1tZW51JztcbiAgICAgICAgbWVudS5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICAgICAgbGVmdDogJHtwb3NpdGlvbi54fXB4O1xuICAgICAgICAgICAgdG9wOiAke3Bvc2l0aW9uLnl9cHg7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXNlY29uZGFyeSk7XG4gICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG4gICAgICAgICAgICBwYWRkaW5nOiA0cHg7XG4gICAgICAgICAgICBib3gtc2hhZG93OiAwIDJweCA4cHggcmdiYSgwLCAwLCAwLCAwLjE1KTtcbiAgICAgICAgICAgIHotaW5kZXg6IDEwMDA7XG4gICAgICAgIGA7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBlZGl0T3B0aW9uID0gdGhpcy5jcmVhdGVNZW51T3B0aW9uKCdFZGl0IFByb3BlcnR5JywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbmV3TGFiZWwgPSBwcm9tcHQoJ0VudGVyIHByb3BlcnR5IG5hbWU6JywgZWRnZS5nZXRMYWJlbCgpKTtcbiAgICAgICAgICAgIGlmIChuZXdMYWJlbCkge1xuICAgICAgICAgICAgICAgIGVkZ2Uuc2V0TGFiZWwobmV3TGFiZWwpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVRdWVyeSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbWVudS5yZW1vdmUoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCB0b2dnbGVPcHRpb25hbE9wdGlvbiA9IHRoaXMuY3JlYXRlTWVudU9wdGlvbihcbiAgICAgICAgICAgIGVkZ2UuaXNPcHRpb25hbCgpID8gJ01ha2UgUmVxdWlyZWQnIDogJ01ha2UgT3B0aW9uYWwnLFxuICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0VkZ2UgPSBlZGdlLmlzT3B0aW9uYWwoKVxuICAgICAgICAgICAgICAgICAgICA/IFZpc3VhbFF1ZXJ5RWRnZS5jcmVhdGVQcm9wZXJ0eShcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkZ2UuZ2V0U291cmNlTm9kZUlkKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGdlLmdldFRhcmdldE5vZGVJZCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRnZS5nZXRMYWJlbCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRnZS5nZXRQcm9wZXJ0eVVyaSgpXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgOiBWaXN1YWxRdWVyeUVkZ2UuY3JlYXRlT3B0aW9uYWwoXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGdlLmdldFNvdXJjZU5vZGVJZCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRnZS5nZXRUYXJnZXROb2RlSWQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkZ2UuZ2V0TGFiZWwoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkZ2UuZ2V0UHJvcGVydHlVcmkoKVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHRoaXMuZWRnZXMuZGVsZXRlKGVkZ2VJZCk7XG4gICAgICAgICAgICAgICAgdGhpcy5lZGdlcy5zZXQobmV3RWRnZS5nZXRJZCgpLCBuZXdFZGdlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUXVlcnkoKTtcbiAgICAgICAgICAgICAgICBtZW51LnJlbW92ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZGVsZXRlT3B0aW9uID0gdGhpcy5jcmVhdGVNZW51T3B0aW9uKCdEZWxldGUnLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmVkZ2VzLmRlbGV0ZShlZGdlSWQpO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUXVlcnkoKTtcbiAgICAgICAgICAgIG1lbnUucmVtb3ZlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgbWVudS5hcHBlbmRDaGlsZChlZGl0T3B0aW9uKTtcbiAgICAgICAgbWVudS5hcHBlbmRDaGlsZCh0b2dnbGVPcHRpb25hbE9wdGlvbik7XG4gICAgICAgIG1lbnUuYXBwZW5kQ2hpbGQoZGVsZXRlT3B0aW9uKTtcbiAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQobWVudSk7XG4gICAgICAgIFxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gbWVudS5yZW1vdmUoKSwgeyBvbmNlOiB0cnVlIH0pO1xuICAgICAgICB9LCAxMCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVNZW51T3B0aW9uKGxhYmVsOiBzdHJpbmcsIG9uQ2xpY2s6ICgpID0+IHZvaWQpOiBIVE1MRGl2RWxlbWVudCB7XG4gICAgICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBvcHRpb24udGV4dENvbnRlbnQgPSBsYWJlbDtcbiAgICAgICAgb3B0aW9uLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICBwYWRkaW5nOiA2cHggMTJweDtcbiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zKTtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTJweDtcbiAgICAgICAgICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4xNXMgZWFzZTtcbiAgICAgICAgYDtcbiAgICAgICAgXG4gICAgICAgIG9wdGlvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuICAgICAgICAgICAgb3B0aW9uLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIG9wdGlvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuICAgICAgICAgICAgb3B0aW9uLnN0eWxlLmJhY2tncm91bmQgPSAnJztcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBvcHRpb24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkNsaWNrKTtcbiAgICAgICAgcmV0dXJuIG9wdGlvbjtcbiAgICB9XG5cbiAgICBwcml2YXRlIHVwZGF0ZVRyYW5zZm9ybSgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgdHJhbnNmb3JtID0gYHRyYW5zbGF0ZSgke3RoaXMudmlld3BvcnRYfXB4LCAke3RoaXMudmlld3BvcnRZfXB4KSBzY2FsZSgke3RoaXMuem9vbX0pYDtcbiAgICAgICAgdGhpcy5ub2Rlc0dyb3VwLnN0eWxlLnRyYW5zZm9ybSA9IHRyYW5zZm9ybTtcbiAgICAgICAgdGhpcy5lZGdlc0dyb3VwLnN0eWxlLnRyYW5zZm9ybSA9IHRyYW5zZm9ybTtcbiAgICAgICAgdGhpcy5ncmlkR3JvdXAuc3R5bGUudHJhbnNmb3JtID0gdHJhbnNmb3JtO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVuZGVyKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnJlbmRlckVkZ2VzKCk7XG4gICAgICAgIHRoaXMucmVuZGVyTm9kZXMoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlbmRlck5vZGVzKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBzdmdOUyA9ICdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zyc7XG4gICAgICAgIHRoaXMubm9kZXNHcm91cC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgXG4gICAgICAgIHRoaXMubm9kZXMuZm9yRWFjaChub2RlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoc3ZnTlMsICdnJykgYXMgU1ZHR0VsZW1lbnQ7XG4gICAgICAgICAgICBnLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAncXVlcnktbm9kZScpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBwb3MgPSBub2RlLmdldFBvc2l0aW9uKCk7XG4gICAgICAgICAgICBjb25zdCBkaW1zID0gbm9kZS5nZXREaW1lbnNpb25zKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IHJlY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoc3ZnTlMsICdyZWN0JykgYXMgU1ZHUmVjdEVsZW1lbnQ7XG4gICAgICAgICAgICByZWN0LnNldEF0dHJpYnV0ZSgneCcsIHBvcy54LnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgcmVjdC5zZXRBdHRyaWJ1dGUoJ3knLCBwb3MueS50b1N0cmluZygpKTtcbiAgICAgICAgICAgIHJlY3Quc2V0QXR0cmlidXRlKCd3aWR0aCcsIGRpbXMud2lkdGgudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICByZWN0LnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgZGltcy5oZWlnaHQudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICByZWN0LnNldEF0dHJpYnV0ZSgncngnLCAnNCcpO1xuICAgICAgICAgICAgcmVjdC5zZXRBdHRyaWJ1dGUoJ3J5JywgJzQnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgY29sb3JzID0gdGhpcy5nZXROb2RlQ29sb3JzKG5vZGUuZ2V0VHlwZSgpKTtcbiAgICAgICAgICAgIHJlY3Quc2V0QXR0cmlidXRlKCdmaWxsJywgY29sb3JzLmZpbGwpO1xuICAgICAgICAgICAgcmVjdC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsIG5vZGUuaXNTZWxlY3RlZCgpID8gJ3ZhcigtLXRleHQtYWNjZW50KScgOiBjb2xvcnMuc3Ryb2tlKTtcbiAgICAgICAgICAgIHJlY3Quc2V0QXR0cmlidXRlKCdzdHJva2Utd2lkdGgnLCBub2RlLmlzU2VsZWN0ZWQoKSA/ICcyJyA6ICcxJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IHRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoc3ZnTlMsICd0ZXh0JykgYXMgU1ZHVGV4dEVsZW1lbnQ7XG4gICAgICAgICAgICB0ZXh0LnNldEF0dHJpYnV0ZSgneCcsIChwb3MueCArIGRpbXMud2lkdGggLyAyKS50b1N0cmluZygpKTtcbiAgICAgICAgICAgIHRleHQuc2V0QXR0cmlidXRlKCd5JywgKHBvcy55ICsgZGltcy5oZWlnaHQgLyAyICsgNCkudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICB0ZXh0LnNldEF0dHJpYnV0ZSgndGV4dC1hbmNob3InLCAnbWlkZGxlJyk7XG4gICAgICAgICAgICB0ZXh0LnNldEF0dHJpYnV0ZSgnZmlsbCcsIGNvbG9ycy50ZXh0KTtcbiAgICAgICAgICAgIHRleHQuc2V0QXR0cmlidXRlKCdmb250LXNpemUnLCAnMTInKTtcbiAgICAgICAgICAgIHRleHQuc2V0QXR0cmlidXRlKCdmb250LXdlaWdodCcsICc1MDAnKTtcbiAgICAgICAgICAgIHRleHQudGV4dENvbnRlbnQgPSBub2RlLmdldExhYmVsKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGcuYXBwZW5kQ2hpbGQocmVjdCk7XG4gICAgICAgICAgICBnLmFwcGVuZENoaWxkKHRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLm5vZGVzR3JvdXAuYXBwZW5kQ2hpbGQoZyk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVuZGVyRWRnZXMoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHN2Z05TID0gJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJztcbiAgICAgICAgdGhpcy5lZGdlc0dyb3VwLmlubmVySFRNTCA9ICcnO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5lZGdlcy5mb3JFYWNoKGVkZ2UgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc291cmNlID0gdGhpcy5ub2Rlcy5nZXQoZWRnZS5nZXRTb3VyY2VOb2RlSWQoKSk7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXQgPSB0aGlzLm5vZGVzLmdldChlZGdlLmdldFRhcmdldE5vZGVJZCgpKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKCFzb3VyY2UgfHwgIXRhcmdldCkgcmV0dXJuO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKHN2Z05TLCAnZycpIGFzIFNWR0dFbGVtZW50O1xuICAgICAgICAgICAgZy5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3F1ZXJ5LWVkZ2UnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgcGF0aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhzdmdOUywgJ3BhdGgnKSBhcyBTVkdQYXRoRWxlbWVudDtcbiAgICAgICAgICAgIHBhdGguc2V0QXR0cmlidXRlKCdkJywgZWRnZS5jYWxjdWxhdGVQYXRoKHNvdXJjZSwgdGFyZ2V0KSk7XG4gICAgICAgICAgICBwYXRoLnNldEF0dHJpYnV0ZSgnZmlsbCcsICdub25lJyk7XG4gICAgICAgICAgICBwYXRoLnNldEF0dHJpYnV0ZSgnc3Ryb2tlJywgZWRnZS5pc1NlbGVjdGVkKCkgPyAndmFyKC0tdGV4dC1hY2NlbnQpJyA6ICd2YXIoLS10ZXh0LW11dGVkKScpO1xuICAgICAgICAgICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsIGVkZ2UuaXNTZWxlY3RlZCgpID8gJzInIDogJzEnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGVkZ2UuaXNPcHRpb25hbCgpKSB7XG4gICAgICAgICAgICAgICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1kYXNoYXJyYXknLCAnNSw1Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IGxhYmVsUG9zID0gZWRnZS5nZXRMYWJlbFBvc2l0aW9uKHNvdXJjZSwgdGFyZ2V0KTtcbiAgICAgICAgICAgIGNvbnN0IGxhYmVsQmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoc3ZnTlMsICdyZWN0JykgYXMgU1ZHUmVjdEVsZW1lbnQ7XG4gICAgICAgICAgICBjb25zdCBsYWJlbFRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoc3ZnTlMsICd0ZXh0JykgYXMgU1ZHVGV4dEVsZW1lbnQ7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGxhYmVsVGV4dC5zZXRBdHRyaWJ1dGUoJ3gnLCBsYWJlbFBvcy54LnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgbGFiZWxUZXh0LnNldEF0dHJpYnV0ZSgneScsIGxhYmVsUG9zLnkudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICBsYWJlbFRleHQuc2V0QXR0cmlidXRlKCd0ZXh0LWFuY2hvcicsICdtaWRkbGUnKTtcbiAgICAgICAgICAgIGxhYmVsVGV4dC5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCAndmFyKC0tdGV4dC1ub3JtYWwpJyk7XG4gICAgICAgICAgICBsYWJlbFRleHQuc2V0QXR0cmlidXRlKCdmb250LXNpemUnLCAnMTAnKTtcbiAgICAgICAgICAgIGxhYmVsVGV4dC50ZXh0Q29udGVudCA9IGVkZ2UuZ2V0TGFiZWwoKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgYmJveCA9IHsgd2lkdGg6IGVkZ2UuZ2V0TGFiZWwoKS5sZW5ndGggKiA2ICsgOCwgaGVpZ2h0OiAxNiB9O1xuICAgICAgICAgICAgbGFiZWxCZy5zZXRBdHRyaWJ1dGUoJ3gnLCAobGFiZWxQb3MueCAtIGJib3gud2lkdGggLyAyKS50b1N0cmluZygpKTtcbiAgICAgICAgICAgIGxhYmVsQmcuc2V0QXR0cmlidXRlKCd5JywgKGxhYmVsUG9zLnkgLSBiYm94LmhlaWdodCAvIDIpLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgbGFiZWxCZy5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgYmJveC53aWR0aC50b1N0cmluZygpKTtcbiAgICAgICAgICAgIGxhYmVsQmcuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCBiYm94LmhlaWdodC50b1N0cmluZygpKTtcbiAgICAgICAgICAgIGxhYmVsQmcuc2V0QXR0cmlidXRlKCdmaWxsJywgJ3ZhcigtLWJhY2tncm91bmQtcHJpbWFyeSknKTtcbiAgICAgICAgICAgIGxhYmVsQmcuc2V0QXR0cmlidXRlKCdyeCcsICcyJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGcuYXBwZW5kQ2hpbGQocGF0aCk7XG4gICAgICAgICAgICBnLmFwcGVuZENoaWxkKGxhYmVsQmcpO1xuICAgICAgICAgICAgZy5hcHBlbmRDaGlsZChsYWJlbFRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLmVkZ2VzR3JvdXAuYXBwZW5kQ2hpbGQoZyk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0Tm9kZUNvbG9ycyh0eXBlOiBOb2RlVHlwZSk6IHsgZmlsbDogc3RyaW5nOyBzdHJva2U6IHN0cmluZzsgdGV4dDogc3RyaW5nIH0ge1xuICAgICAgICBjb25zdCBpc0RhcmsgPSBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5jb250YWlucygndGhlbWUtZGFyaycpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbGlnaHRDb2xvcnMgPSB7XG4gICAgICAgICAgICBbTm9kZVR5cGUuRU5USVRZXTogeyBmaWxsOiAnI2UzZjJmZCcsIHN0cm9rZTogJyMxOTc2ZDInLCB0ZXh0OiAnIzBkNDdhMScgfSxcbiAgICAgICAgICAgIFtOb2RlVHlwZS5WQVJJQUJMRV06IHsgZmlsbDogJyNmZmYzZTAnLCBzdHJva2U6ICcjZjU3YzAwJywgdGV4dDogJyNlNjUxMDAnIH0sXG4gICAgICAgICAgICBbTm9kZVR5cGUuTElURVJBTF06IHsgZmlsbDogJyNmM2U1ZjUnLCBzdHJva2U6ICcjN2IxZmEyJywgdGV4dDogJyM0YTE0OGMnIH0sXG4gICAgICAgICAgICBbTm9kZVR5cGUuRklMVEVSXTogeyBmaWxsOiAnI2U4ZjVlOCcsIHN0cm9rZTogJyMzODhlM2MnLCB0ZXh0OiAnIzFiNWUyMCcgfVxuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZGFya0NvbG9ycyA9IHtcbiAgICAgICAgICAgIFtOb2RlVHlwZS5FTlRJVFldOiB7IGZpbGw6ICdyZ2JhKDMzLCAxNTAsIDI0MywgMC4yKScsIHN0cm9rZTogJyMyMTk2ZjMnLCB0ZXh0OiAnIzkwY2FmOScgfSxcbiAgICAgICAgICAgIFtOb2RlVHlwZS5WQVJJQUJMRV06IHsgZmlsbDogJ3JnYmEoMjU1LCAxNTIsIDAsIDAuMiknLCBzdHJva2U6ICcjZmY5ODAwJywgdGV4dDogJyNmZmI3NGQnIH0sXG4gICAgICAgICAgICBbTm9kZVR5cGUuTElURVJBTF06IHsgZmlsbDogJ3JnYmEoMTU2LCAzOSwgMTc2LCAwLjIpJywgc3Ryb2tlOiAnIzljMjdiMCcsIHRleHQ6ICcjY2U5M2Q4JyB9LFxuICAgICAgICAgICAgW05vZGVUeXBlLkZJTFRFUl06IHsgZmlsbDogJ3JnYmEoNzYsIDE3NSwgODAsIDAuMiknLCBzdHJva2U6ICcjNGNhZjUwJywgdGV4dDogJyM4MWM3ODQnIH1cbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBpc0RhcmsgPyBkYXJrQ29sb3JzW3R5cGVdIDogbGlnaHRDb2xvcnNbdHlwZV07XG4gICAgfVxuXG4gICAgLy8gT3ZlcmxvYWRlZCBtZXRob2QgZm9yIGFkZGluZyBub2Rlc1xuICAgIGFkZE5vZGUobm9kZTogVmlzdWFsUXVlcnlOb2RlKTogdm9pZDtcbiAgICBhZGROb2RlKHR5cGU6IE5vZGVUeXBlKTogdm9pZDtcbiAgICBhZGROb2RlKG5vZGVPclR5cGU6IFZpc3VhbFF1ZXJ5Tm9kZSB8IE5vZGVUeXBlKTogdm9pZCB7XG4gICAgICAgIGlmICh0eXBlb2Ygbm9kZU9yVHlwZSA9PT0gJ29iamVjdCcgJiYgJ2dldElkJyBpbiBub2RlT3JUeXBlKSB7XG4gICAgICAgICAgICAvLyBEaXJlY3Qgbm9kZSBhZGRpdGlvbiBmb3IgdGVzdGluZy9wcm9ncmFtbWF0aWMgdXNlXG4gICAgICAgICAgICBjb25zdCBub2RlID0gbm9kZU9yVHlwZSBhcyBWaXN1YWxRdWVyeU5vZGU7XG4gICAgICAgICAgICB0aGlzLm5vZGVzLnNldChub2RlLmdldElkKCksIG5vZGUpO1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zLm9uTm9kZVNlbGVjdD8uKG5vZGUpO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUXVlcnkoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gSW50ZXJhY3RpdmUgbm9kZSBjcmVhdGlvblxuICAgICAgICBjb25zdCB0eXBlID0gbm9kZU9yVHlwZSBhcyBOb2RlVHlwZTtcbiAgICAgICAgY29uc3QgY2VudGVyWCA9ICh0aGlzLm9wdGlvbnMud2lkdGggLyAyIC0gdGhpcy52aWV3cG9ydFgpIC8gdGhpcy56b29tO1xuICAgICAgICBjb25zdCBjZW50ZXJZID0gKHRoaXMub3B0aW9ucy5oZWlnaHQgLyAyIC0gdGhpcy52aWV3cG9ydFkpIC8gdGhpcy56b29tO1xuICAgICAgICBcbiAgICAgICAgbGV0IG5vZGU6IFZpc3VhbFF1ZXJ5Tm9kZTtcbiAgICAgICAgXG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgY2FzZSBOb2RlVHlwZS5FTlRJVFk6XG4gICAgICAgICAgICAgICAgY29uc3QgZW50aXR5TmFtZSA9IHByb21wdCgnRW50ZXIgZW50aXR5IG5hbWU6Jyk7XG4gICAgICAgICAgICAgICAgaWYgKCFlbnRpdHlOYW1lKSByZXR1cm47XG4gICAgICAgICAgICAgICAgbm9kZSA9IFZpc3VhbFF1ZXJ5Tm9kZS5jcmVhdGVFbnRpdHkoZW50aXR5TmFtZSwgdW5kZWZpbmVkLCB7IHg6IGNlbnRlclgsIHk6IGNlbnRlclkgfSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIE5vZGVUeXBlLlZBUklBQkxFOlxuICAgICAgICAgICAgICAgIGNvbnN0IHZhck5hbWUgPSBwcm9tcHQoJ0VudGVyIHZhcmlhYmxlIG5hbWUgKHdpdGhvdXQgPyk6Jyk7XG4gICAgICAgICAgICAgICAgaWYgKCF2YXJOYW1lKSByZXR1cm47XG4gICAgICAgICAgICAgICAgbm9kZSA9IFZpc3VhbFF1ZXJ5Tm9kZS5jcmVhdGVWYXJpYWJsZSh2YXJOYW1lLCB7IHg6IGNlbnRlclgsIHk6IGNlbnRlclkgfSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIE5vZGVUeXBlLkxJVEVSQUw6XG4gICAgICAgICAgICAgICAgY29uc3QgbGl0ZXJhbFZhbHVlID0gcHJvbXB0KCdFbnRlciBsaXRlcmFsIHZhbHVlOicpO1xuICAgICAgICAgICAgICAgIGlmICghbGl0ZXJhbFZhbHVlKSByZXR1cm47XG4gICAgICAgICAgICAgICAgbm9kZSA9IFZpc3VhbFF1ZXJ5Tm9kZS5jcmVhdGVMaXRlcmFsKGxpdGVyYWxWYWx1ZSwgeyB4OiBjZW50ZXJYLCB5OiBjZW50ZXJZIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBOb2RlVHlwZS5GSUxURVI6XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsdGVyRXhwciA9IHByb21wdCgnRW50ZXIgZmlsdGVyIGV4cHJlc3Npb246Jyk7XG4gICAgICAgICAgICAgICAgaWYgKCFmaWx0ZXJFeHByKSByZXR1cm47XG4gICAgICAgICAgICAgICAgbm9kZSA9IFZpc3VhbFF1ZXJ5Tm9kZS5jcmVhdGVGaWx0ZXIoZmlsdGVyRXhwciwgeyB4OiBjZW50ZXJYLCB5OiBjZW50ZXJZIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHRoaXMubm9kZXMuc2V0KG5vZGUuZ2V0SWQoKSwgbm9kZSk7XG4gICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgIHRoaXMudXBkYXRlUXVlcnkoKTtcbiAgICB9XG5cbiAgICBhZGRFZGdlKGVkZ2U6IFZpc3VhbFF1ZXJ5RWRnZSk6IHZvaWQge1xuICAgICAgICAvLyBWYWxpZGF0ZSB0aGF0IGJvdGggc291cmNlIGFuZCB0YXJnZXQgbm9kZXMgZXhpc3RcbiAgICAgICAgY29uc3Qgc291cmNlRXhpc3RzID0gdGhpcy5ub2Rlcy5oYXMoZWRnZS5nZXRTb3VyY2VOb2RlSWQoKSk7XG4gICAgICAgIGNvbnN0IHRhcmdldEV4aXN0cyA9IHRoaXMubm9kZXMuaGFzKGVkZ2UuZ2V0VGFyZ2V0Tm9kZUlkKCkpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFzb3VyY2VFeGlzdHMgfHwgIXRhcmdldEV4aXN0cykge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdDYW5ub3QgYWRkIGVkZ2U6IHNvdXJjZSBvciB0YXJnZXQgbm9kZSBub3QgZm91bmQnKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdGhpcy5lZGdlcy5zZXQoZWRnZS5nZXRJZCgpLCBlZGdlKTtcbiAgICAgICAgdGhpcy5vcHRpb25zLm9uRWRnZVNlbGVjdD8uKGVkZ2UpO1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICB0aGlzLnVwZGF0ZVF1ZXJ5KCk7XG4gICAgfVxuXG4gICAgZ2V0U2VsZWN0ZWROb2RlcygpOiBzdHJpbmdbXSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuc2VsZWN0ZWROb2Rlcyk7XG4gICAgfVxuXG4gICAgZ2V0U2VsZWN0ZWRFZGdlcygpOiBzdHJpbmdbXSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuc2VsZWN0ZWRFZGdlcyk7XG4gICAgfVxuXG5cbiAgICBleHBvcnRUb1NWRygpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBzZXJpYWxpemVyID0gbmV3IFhNTFNlcmlhbGl6ZXIoKTtcbiAgICAgICAgcmV0dXJuIHNlcmlhbGl6ZXIuc2VyaWFsaXplVG9TdHJpbmcodGhpcy5zdmcpO1xuICAgIH1cblxuICAgIHByaXZhdGUgdXBkYXRlUXVlcnkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHNwYXJxbCA9IHRoaXMuZ2VuZXJhdGVTUEFSUUwoKTtcbiAgICAgICAgdGhpcy5vcHRpb25zLm9uUXVlcnlDaGFuZ2Uoc3BhcnFsKTtcbiAgICAgICAgaWYgKCh0aGlzLm9wdGlvbnMgYXMgYW55KS5vblF1ZXJ5R2VuZXJhdGVkKSB7XG4gICAgICAgICAgICAodGhpcy5vcHRpb25zIGFzIGFueSkub25RdWVyeUdlbmVyYXRlZChzcGFycWwpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2VuZXJhdGVTUEFSUUwoKTogc3RyaW5nIHtcbiAgICAgICAgaWYgKHRoaXMubm9kZXMuc2l6ZSA9PT0gMCkge1xuICAgICAgICAgICAgY29uc3QgcXVlcnkgPSAnU0VMRUNUICpcXG5XSEVSRSB7XFxuICA/cyA/cCA/byAuXFxufSc7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMub25RdWVyeUdlbmVyYXRlZD8uKHF1ZXJ5KTtcbiAgICAgICAgICAgIHJldHVybiBxdWVyeTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc3QgdmFyaWFibGVzID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gICAgICAgIGNvbnN0IHBhdHRlcm5zOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBjb25zdCBmaWx0ZXJzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBjb25zdCBvcHRpb25hbFBhdHRlcm5zOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5ub2Rlcy5mb3JFYWNoKG5vZGUgPT4ge1xuICAgICAgICAgICAgaWYgKG5vZGUuZ2V0VHlwZSgpID09PSBOb2RlVHlwZS5WQVJJQUJMRSkge1xuICAgICAgICAgICAgICAgIHZhcmlhYmxlcy5hZGQobm9kZS50b1NQQVJRTEVsZW1lbnQoKSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG5vZGUuZ2V0VHlwZSgpID09PSBOb2RlVHlwZS5GSUxURVIpIHtcbiAgICAgICAgICAgICAgICBmaWx0ZXJzLnB1c2goYEZJTFRFUiAoJHtub2RlLmdldExhYmVsKCl9KWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuZWRnZXMuZm9yRWFjaChlZGdlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNvdXJjZSA9IHRoaXMubm9kZXMuZ2V0KGVkZ2UuZ2V0U291cmNlTm9kZUlkKCkpO1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0ID0gdGhpcy5ub2Rlcy5nZXQoZWRnZS5nZXRUYXJnZXROb2RlSWQoKSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChzb3VyY2UgJiYgdGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGF0dGVybiA9IGAke3NvdXJjZS50b1NQQVJRTEVsZW1lbnQoKX0gJHtlZGdlLnRvU1BBUlFMUHJlZGljYXRlKCl9ICR7dGFyZ2V0LnRvU1BBUlFMRWxlbWVudCgpfWA7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKGVkZ2UuaXNPcHRpb25hbCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsUGF0dGVybnMucHVzaChwYXR0ZXJuKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwYXR0ZXJucy5wdXNoKHBhdHRlcm4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoc291cmNlLmdldFR5cGUoKSA9PT0gTm9kZVR5cGUuVkFSSUFCTEUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyaWFibGVzLmFkZChzb3VyY2UudG9TUEFSUUxFbGVtZW50KCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0LmdldFR5cGUoKSA9PT0gTm9kZVR5cGUuVkFSSUFCTEUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyaWFibGVzLmFkZCh0YXJnZXQudG9TUEFSUUxFbGVtZW50KCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBpZiAodmFyaWFibGVzLnNpemUgPT09IDAgJiYgcGF0dGVybnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGxldCBxdWVyeSA9IGBTRUxFQ1QgJHt2YXJpYWJsZXMuc2l6ZSA+IDAgPyBBcnJheS5mcm9tKHZhcmlhYmxlcykuam9pbignICcpIDogJyonfVxcbmA7XG4gICAgICAgIHF1ZXJ5ICs9ICdXSEVSRSB7XFxuJztcbiAgICAgICAgXG4gICAgICAgIHBhdHRlcm5zLmZvckVhY2gocGF0dGVybiA9PiB7XG4gICAgICAgICAgICBxdWVyeSArPSBgICAke3BhdHRlcm59IC5cXG5gO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIG9wdGlvbmFsUGF0dGVybnMuZm9yRWFjaChwYXR0ZXJuID0+IHtcbiAgICAgICAgICAgIHF1ZXJ5ICs9IGAgIE9QVElPTkFMIHsgJHtwYXR0ZXJufSB9XFxuYDtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBmaWx0ZXJzLmZvckVhY2goZmlsdGVyID0+IHtcbiAgICAgICAgICAgIHF1ZXJ5ICs9IGAgICR7ZmlsdGVyfVxcbmA7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgcXVlcnkgKz0gJ30nO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5vcHRpb25zLm9uUXVlcnlHZW5lcmF0ZWQ/LihxdWVyeSk7XG4gICAgICAgIHJldHVybiBxdWVyeTtcbiAgICB9XG5cbiAgICBhc3luYyBleGVjdXRlUXVlcnkoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IHNwYXJxbCA9IHRoaXMuZ2VuZXJhdGVTUEFSUUwoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghc3BhcnFsKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdQbGVhc2UgY3JlYXRlIGEgcXVlcnkgZmlyc3QnKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENhbGwgdGhlIGV4ZWN1dGUgcXVlcnkgY2FsbGJhY2tcbiAgICAgICAgdGhpcy5vcHRpb25zLm9uRXhlY3V0ZVF1ZXJ5Py4oKTtcbiAgICAgICAgXG4gICAgICAgIGlmICh0aGlzLnNwYXJxbFByb2Nlc3Nvcikge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnNwYXJxbFByb2Nlc3Nvci5leGVjdXRlUXVlcnkoc3BhcnFsKTtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMub25FeGVjdXRlKHNwYXJxbCk7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgUXVlcnkgZXhlY3V0ZWQ6ICR7cmVzdWx0LnJlc3VsdHMubGVuZ3RofSByZXN1bHRzYCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgUXVlcnkgZXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5vbkV4ZWN1dGUoc3BhcnFsKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNsZWFyQ2FudmFzKCk6IHZvaWQge1xuICAgICAgICB0aGlzLm5vZGVzLmNsZWFyKCk7XG4gICAgICAgIHRoaXMuZWRnZXMuY2xlYXIoKTtcbiAgICAgICAgdGhpcy5jbGVhclNlbGVjdGlvbigpO1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICB0aGlzLnVwZGF0ZVF1ZXJ5KCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB6b29tSW4oKTogdm9pZCB7XG4gICAgICAgIHRoaXMuem9vbSA9IE1hdGgubWluKHRoaXMub3B0aW9ucy56b29tTWF4LCB0aGlzLnpvb20gKyB0aGlzLm9wdGlvbnMuem9vbVN0ZXApO1xuICAgICAgICB0aGlzLnVwZGF0ZVRyYW5zZm9ybSgpO1xuICAgIH1cblxuICAgIHByaXZhdGUgem9vbU91dCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy56b29tID0gTWF0aC5tYXgodGhpcy5vcHRpb25zLnpvb21NaW4sIHRoaXMuem9vbSAtIHRoaXMub3B0aW9ucy56b29tU3RlcCk7XG4gICAgICAgIHRoaXMudXBkYXRlVHJhbnNmb3JtKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZXNldFpvb20oKTogdm9pZCB7XG4gICAgICAgIHRoaXMuem9vbSA9IDE7XG4gICAgICAgIHRoaXMudmlld3BvcnRYID0gMDtcbiAgICAgICAgdGhpcy52aWV3cG9ydFkgPSAwO1xuICAgICAgICB0aGlzLnVwZGF0ZVRyYW5zZm9ybSgpO1xuICAgIH1cblxuICAgIHByaXZhdGUgc2hvd1RlbXBsYXRlU2VsZWN0aW9uKCk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy50ZW1wbGF0ZVVzZUNhc2UpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ1RlbXBsYXRlIGZ1bmN0aW9uYWxpdHkgbm90IGF2YWlsYWJsZScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbW9kYWxDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgbW9kYWxDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICAgICAgICAgIHRvcDogMDtcbiAgICAgICAgICAgIGxlZnQ6IDA7XG4gICAgICAgICAgICByaWdodDogMDtcbiAgICAgICAgICAgIGJvdHRvbTogMDtcbiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC41KTtcbiAgICAgICAgICAgIHotaW5kZXg6IDEwMDAwO1xuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgICAgIHBhZGRpbmc6IDIwcHg7XG4gICAgICAgIGA7XG5cbiAgICAgICAgY29uc3QgdGVtcGxhdGVQYW5lbCA9IG5ldyBUZW1wbGF0ZVNlbGVjdGlvblBhbmVsKFxuICAgICAgICAgICAgbW9kYWxDb250YWluZXIsXG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMudGVtcGxhdGVVc2VDYXNlLmdldFRlbXBsYXRlUmVwb3NpdG9yeSgpLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHNob3dQcmV2aWV3OiB0cnVlLFxuICAgICAgICAgICAgICAgIGFsbG93Q3VzdG9tVGVtcGxhdGVzOiB0cnVlLFxuICAgICAgICAgICAgICAgIG9uVGVtcGxhdGVTZWxlY3Q6ICh0ZW1wbGF0ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRUZW1wbGF0ZSh0ZW1wbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIG1vZGFsQ29udGFpbmVyLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgb25DbG9zZTogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBtb2RhbENvbnRhaW5lci5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG5cbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChtb2RhbENvbnRhaW5lcik7XG5cbiAgICAgICAgLy8gQ2xvc2Ugb24gYmFja2dyb3VuZCBjbGlja1xuICAgICAgICBtb2RhbENvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgICBpZiAoZS50YXJnZXQgPT09IG1vZGFsQ29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgbW9kYWxDb250YWluZXIucmVtb3ZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgbG9hZFRlbXBsYXRlKHRlbXBsYXRlOiBRdWVyeVRlbXBsYXRlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAodGVtcGxhdGUuZ2V0UGFyYW1ldGVycygpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAvLyBTaG93IHBhcmFtZXRlciBpbnB1dCBtb2RhbFxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5vcHRpb25zLmFwcEluc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0Nhbm5vdCBjb25maWd1cmUgdGVtcGxhdGUgcGFyYW1ldGVycyAtIGFwcCBpbnN0YW5jZSBub3QgYXZhaWxhYmxlJyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zdCBwYXJhbWV0ZXJNb2RhbCA9IG5ldyBUZW1wbGF0ZVBhcmFtZXRlck1vZGFsKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMuYXBwSW5zdGFuY2UsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvblN1Ym1pdDogYXN5bmMgKGNvbmZpZ3VyZWRUZW1wbGF0ZSwgcGFyYW1ldGVyVmFsdWVzKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5pbnN0YW50aWF0ZVRlbXBsYXRlKGNvbmZpZ3VyZWRUZW1wbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgb25DYW5jZWw6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVc2VyIGNhbmNlbGxlZCBwYXJhbWV0ZXIgY29uZmlndXJhdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIHBhcmFtZXRlck1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gVGVtcGxhdGUgaGFzIG5vIHBhcmFtZXRlcnMsIGluc3RhbnRpYXRlIGRpcmVjdGx5XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5pbnN0YW50aWF0ZVRlbXBsYXRlKHRlbXBsYXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBsb2FkIHRlbXBsYXRlOicsIGVycm9yKTtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYEZhaWxlZCB0byBsb2FkIHRlbXBsYXRlOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGluc3RhbnRpYXRlVGVtcGxhdGUodGVtcGxhdGU6IFF1ZXJ5VGVtcGxhdGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHsgbm9kZXMsIGVkZ2VzIH0gPSBhd2FpdCB0aGlzLm9wdGlvbnMudGVtcGxhdGVVc2VDYXNlIS5pbnN0YW50aWF0ZVRlbXBsYXRlKHRlbXBsYXRlKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ2xlYXIgY3VycmVudCBjYW52YXNcbiAgICAgICAgICAgIHRoaXMuY2xlYXJDYW52YXMoKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQWRkIG5vZGVzIHRvIGNhbnZhc1xuICAgICAgICAgICAgbm9kZXMuZm9yRWFjaChub2RlID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGVzLnNldChub2RlLmdldElkKCksIG5vZGUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCBlZGdlcyB0byBjYW52YXNcbiAgICAgICAgICAgIGVkZ2VzLmZvckVhY2goZWRnZSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5lZGdlcy5zZXQoZWRnZS5nZXRJZCgpLCBlZGdlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBVcGRhdGUgZGlzcGxheVxuICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUXVlcnkoKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbmV3IE5vdGljZShgVGVtcGxhdGUgXCIke3RlbXBsYXRlLmdldE1ldGFkYXRhKCkubmFtZX1cIiBsb2FkZWQgc3VjY2Vzc2Z1bGx5YCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gaW5zdGFudGlhdGUgdGVtcGxhdGU6JywgZXJyb3IpO1xuICAgICAgICAgICAgbmV3IE5vdGljZShgRmFpbGVkIHRvIGFwcGx5IHRlbXBsYXRlOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHNob3dTYXZlVGVtcGxhdGVNb2RhbCgpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMudGVtcGxhdGVVc2VDYXNlIHx8ICF0aGlzLm9wdGlvbnMuYXBwSW5zdGFuY2UpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ1RlbXBsYXRlIGZ1bmN0aW9uYWxpdHkgbm90IGF2YWlsYWJsZScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMubm9kZXMuc2l6ZSA9PT0gMCkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnQ3JlYXRlIGEgcXVlcnkgZmlyc3QgYmVmb3JlIHNhdmluZyBhcyB0ZW1wbGF0ZScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc2F2ZU1vZGFsID0gbmV3IFNhdmVUZW1wbGF0ZU1vZGFsKFxuICAgICAgICAgICAgdGhpcy5vcHRpb25zLmFwcEluc3RhbmNlLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5vZGVzOiB0aGlzLm5vZGVzLFxuICAgICAgICAgICAgICAgIGVkZ2VzOiB0aGlzLmVkZ2VzLFxuICAgICAgICAgICAgICAgIHZpZXdwb3J0OiB7XG4gICAgICAgICAgICAgICAgICAgIHg6IHRoaXMudmlld3BvcnRYLFxuICAgICAgICAgICAgICAgICAgICB5OiB0aGlzLnZpZXdwb3J0WSxcbiAgICAgICAgICAgICAgICAgICAgem9vbTogdGhpcy56b29tXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzcGFycWxRdWVyeTogdGhpcy5nZW5lcmF0ZVNQQVJRTCgpLFxuICAgICAgICAgICAgICAgIG9uU2F2ZTogYXN5bmMgKHRlbXBsYXRlRGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGVtcGxhdGUgPSBhd2FpdCB0aGlzLm9wdGlvbnMudGVtcGxhdGVVc2VDYXNlIS5jcmVhdGVDdXN0b21UZW1wbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5vZGVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWRnZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4OiB0aGlzLnZpZXdwb3J0WCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeTogdGhpcy52aWV3cG9ydFksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpvb206IHRoaXMuem9vbVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVEYXRhLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVEYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlRGF0YS5jYXRlZ29yeSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZURhdGEudGFnc1xuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShgVGVtcGxhdGUgXCIke3RlbXBsYXRlLmdldE1ldGFkYXRhKCkubmFtZX1cIiBzYXZlZCBzdWNjZXNzZnVsbHlgKTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzYXZlIHRlbXBsYXRlOicsIGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYEZhaWxlZCB0byBzYXZlIHRlbXBsYXRlOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9uQ2FuY2VsOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFVzZXIgY2FuY2VsbGVkIHNhdmVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG5cbiAgICAgICAgc2F2ZU1vZGFsLm9wZW4oKTtcbiAgICB9XG5cbiAgICBsb2FkRnJvbVRlbXBsYXRlKHRlbXBsYXRlOiBRdWVyeVRlbXBsYXRlKTogdm9pZCB7XG4gICAgICAgIHRoaXMubG9hZFRlbXBsYXRlKHRlbXBsYXRlKTtcbiAgICB9XG5cbiAgICBnZXRDdXJyZW50Q2FudmFzU3RhdGUoKToge1xuICAgICAgICBub2RlczogTWFwPHN0cmluZywgVmlzdWFsUXVlcnlOb2RlPjtcbiAgICAgICAgZWRnZXM6IE1hcDxzdHJpbmcsIFZpc3VhbFF1ZXJ5RWRnZT47XG4gICAgICAgIHZpZXdwb3J0OiB7IHg6IG51bWJlcjsgeTogbnVtYmVyOyB6b29tOiBudW1iZXIgfTtcbiAgICB9IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG5vZGVzOiBuZXcgTWFwKHRoaXMubm9kZXMpLFxuICAgICAgICAgICAgZWRnZXM6IG5ldyBNYXAodGhpcy5lZGdlcyksXG4gICAgICAgICAgICB2aWV3cG9ydDoge1xuICAgICAgICAgICAgICAgIHg6IHRoaXMudmlld3BvcnRYLFxuICAgICAgICAgICAgICAgIHk6IHRoaXMudmlld3BvcnRZLFxuICAgICAgICAgICAgICAgIHpvb206IHRoaXMuem9vbVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8vIFB1YmxpYyBnZXR0ZXJzIGZvciB0ZXN0aW5nIGFuZCBleHRlcm5hbCBhY2Nlc3NcbiAgICBnZXROb2RlcygpOiBNYXA8c3RyaW5nLCBWaXN1YWxRdWVyeU5vZGU+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBNYXAodGhpcy5ub2Rlcyk7XG4gICAgfVxuXG4gICAgZ2V0RWRnZXMoKTogTWFwPHN0cmluZywgVmlzdWFsUXVlcnlFZGdlPiB7XG4gICAgICAgIHJldHVybiBuZXcgTWFwKHRoaXMuZWRnZXMpO1xuICAgIH1cblxuICAgIHJlbW92ZU5vZGUobm9kZUlkOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgLy8gUmVtb3ZlIGFzc29jaWF0ZWQgZWRnZXMgZmlyc3RcbiAgICAgICAgdGhpcy5lZGdlcy5mb3JFYWNoKChlZGdlLCBlZGdlSWQpID0+IHtcbiAgICAgICAgICAgIGlmIChlZGdlLmdldFNvdXJjZU5vZGVJZCgpID09PSBub2RlSWQgfHwgZWRnZS5nZXRUYXJnZXROb2RlSWQoKSA9PT0gbm9kZUlkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lZGdlcy5kZWxldGUoZWRnZUlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBSZW1vdmUgdGhlIG5vZGVcbiAgICAgICAgdGhpcy5ub2Rlcy5kZWxldGUobm9kZUlkKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFVwZGF0ZSBzZWxlY3Rpb25cbiAgICAgICAgdGhpcy5zZWxlY3RlZE5vZGVzLmRlbGV0ZShub2RlSWQpO1xuICAgICAgICBcbiAgICAgICAgLy8gUmUtcmVuZGVyIGFuZCB1cGRhdGUgcXVlcnlcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgdGhpcy51cGRhdGVRdWVyeSgpO1xuICAgIH1cblxuICAgIHJlbW92ZUVkZ2UoZWRnZUlkOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5lZGdlcy5kZWxldGUoZWRnZUlkKTtcbiAgICAgICAgdGhpcy5zZWxlY3RlZEVkZ2VzLmRlbGV0ZShlZGdlSWQpO1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICB0aGlzLnVwZGF0ZVF1ZXJ5KCk7XG4gICAgfVxuXG4gICAgem9vbVRvRml0KCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5ub2Rlcy5zaXplID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLnJlc2V0Wm9vbSgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IG1pblggPSBJbmZpbml0eSwgbWluWSA9IEluZmluaXR5LCBtYXhYID0gLUluZmluaXR5LCBtYXhZID0gLUluZmluaXR5O1xuICAgICAgICBcbiAgICAgICAgdGhpcy5ub2Rlcy5mb3JFYWNoKG5vZGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgcG9zID0gbm9kZS5nZXRQb3NpdGlvbigpO1xuICAgICAgICAgICAgY29uc3QgZGltcyA9IG5vZGUuZ2V0RGltZW5zaW9ucygpO1xuICAgICAgICAgICAgbWluWCA9IE1hdGgubWluKG1pblgsIHBvcy54KTtcbiAgICAgICAgICAgIG1pblkgPSBNYXRoLm1pbihtaW5ZLCBwb3MueSk7XG4gICAgICAgICAgICBtYXhYID0gTWF0aC5tYXgobWF4WCwgcG9zLnggKyBkaW1zLndpZHRoKTtcbiAgICAgICAgICAgIG1heFkgPSBNYXRoLm1heChtYXhZLCBwb3MueSArIGRpbXMuaGVpZ2h0KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgY29udGVudFdpZHRoID0gbWF4WCAtIG1pblg7XG4gICAgICAgIGNvbnN0IGNvbnRlbnRIZWlnaHQgPSBtYXhZIC0gbWluWTtcbiAgICAgICAgY29uc3QgY2VudGVyWCA9IG1pblggKyBjb250ZW50V2lkdGggLyAyO1xuICAgICAgICBjb25zdCBjZW50ZXJZID0gbWluWSArIGNvbnRlbnRIZWlnaHQgLyAyO1xuXG4gICAgICAgIC8vIENhbGN1bGF0ZSB6b29tIHRvIGZpdCB3aXRoIHBhZGRpbmdcbiAgICAgICAgY29uc3QgcGFkZGluZyA9IDUwO1xuICAgICAgICBjb25zdCBhdmFpbGFibGVXaWR0aCA9IHRoaXMub3B0aW9ucy53aWR0aCAtIDIgKiBwYWRkaW5nO1xuICAgICAgICBjb25zdCBhdmFpbGFibGVIZWlnaHQgPSB0aGlzLm9wdGlvbnMuaGVpZ2h0IC0gMiAqIHBhZGRpbmc7XG4gICAgICAgIGNvbnN0IHNjYWxlWCA9IGF2YWlsYWJsZVdpZHRoIC8gY29udGVudFdpZHRoO1xuICAgICAgICBjb25zdCBzY2FsZVkgPSBhdmFpbGFibGVIZWlnaHQgLyBjb250ZW50SGVpZ2h0O1xuICAgICAgICBjb25zdCBuZXdab29tID0gTWF0aC5taW4oc2NhbGVYLCBzY2FsZVksIHRoaXMub3B0aW9ucy56b29tTWF4KTtcblxuICAgICAgICAvLyBTZXQgbmV3IHpvb20gYW5kIGNlbnRlciB2aWV3cG9ydFxuICAgICAgICB0aGlzLnpvb20gPSBNYXRoLm1heCh0aGlzLm9wdGlvbnMuem9vbU1pbiwgbmV3Wm9vbSk7XG4gICAgICAgIHRoaXMudmlld3BvcnRYID0gdGhpcy5vcHRpb25zLndpZHRoIC8gMiAtIGNlbnRlclggKiB0aGlzLnpvb207XG4gICAgICAgIHRoaXMudmlld3BvcnRZID0gdGhpcy5vcHRpb25zLmhlaWdodCAvIDIgLSBjZW50ZXJZICogdGhpcy56b29tO1xuICAgICAgICBcbiAgICAgICAgdGhpcy51cGRhdGVUcmFuc2Zvcm0oKTtcbiAgICB9XG5cbiAgICBleHBvcnRUb0pTT04oKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgY2FudmFzRGF0YSA9IHtcbiAgICAgICAgICAgIHZlcnNpb246ICcxLjAnLFxuICAgICAgICAgICAgbm9kZXM6IEFycmF5LmZyb20odGhpcy5ub2Rlcy5lbnRyaWVzKCkpLm1hcCgoW2lkLCBub2RlXSkgPT4gKHtcbiAgICAgICAgICAgICAgICBpZCxcbiAgICAgICAgICAgICAgICB0eXBlOiBub2RlLmdldFR5cGUoKSxcbiAgICAgICAgICAgICAgICBsYWJlbDogbm9kZS5nZXRMYWJlbCgpLFxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBub2RlLmdldFBvc2l0aW9uKCksXG4gICAgICAgICAgICAgICAgdXJpOiAobm9kZSBhcyBhbnkpLmdldEVudGl0eVVyaSA/IChub2RlIGFzIGFueSkuZ2V0RW50aXR5VXJpKCkgOiB1bmRlZmluZWRcbiAgICAgICAgICAgIH0pKSxcbiAgICAgICAgICAgIGVkZ2VzOiBBcnJheS5mcm9tKHRoaXMuZWRnZXMuZW50cmllcygpKS5tYXAoKFtpZCwgZWRnZV0pID0+ICh7XG4gICAgICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICAgICAgc291cmNlTm9kZUlkOiBlZGdlLmdldFNvdXJjZU5vZGVJZCgpLFxuICAgICAgICAgICAgICAgIHRhcmdldE5vZGVJZDogZWRnZS5nZXRUYXJnZXROb2RlSWQoKSxcbiAgICAgICAgICAgICAgICBsYWJlbDogZWRnZS5nZXRMYWJlbCgpLFxuICAgICAgICAgICAgICAgIHR5cGU6IGVkZ2UuZ2V0VHlwZSgpLFxuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiBlZGdlLmlzT3B0aW9uYWwoKSxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eVVyaTogZWRnZS5nZXRQcm9wZXJ0eVVyaSgpXG4gICAgICAgICAgICB9KSksXG4gICAgICAgICAgICB2aWV3cG9ydDoge1xuICAgICAgICAgICAgICAgIHg6IHRoaXMudmlld3BvcnRYLFxuICAgICAgICAgICAgICAgIHk6IHRoaXMudmlld3BvcnRZLFxuICAgICAgICAgICAgICAgIHpvb206IHRoaXMuem9vbVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoY2FudmFzRGF0YSwgbnVsbCwgMik7XG4gICAgfVxuXG4gICAgaW1wb3J0RnJvbUpTT04oanNvblN0cmluZzogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShqc29uU3RyaW5nKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgZm9ybWF0XG4gICAgICAgICAgICBpZiAoIWRhdGEubm9kZXMgfHwgIWRhdGEuZWRnZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ludmFsaWQgY2FudmFzIGRhdGEgZm9ybWF0Jyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBDbGVhciBjdXJyZW50IGNvbnRlbnRcbiAgICAgICAgICAgIHRoaXMuY2xlYXJDYW52YXMoKTtcblxuICAgICAgICAgICAgLy8gSW1wb3J0IG5vZGVzXG4gICAgICAgICAgICBkYXRhLm5vZGVzLmZvckVhY2goKG5vZGVEYXRhOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgbm9kZTogVmlzdWFsUXVlcnlOb2RlO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKG5vZGVEYXRhLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTm9kZVR5cGUuRU5USVRZOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSBWaXN1YWxRdWVyeU5vZGUuY3JlYXRlRW50aXR5KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlRGF0YS5sYWJlbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZURhdGEudXJpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlRGF0YS5wb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE5vZGVUeXBlLlZBUklBQkxFOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSBWaXN1YWxRdWVyeU5vZGUuY3JlYXRlVmFyaWFibGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVEYXRhLmxhYmVsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlRGF0YS5wb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE5vZGVUeXBlLkxJVEVSQUw6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IFZpc3VhbFF1ZXJ5Tm9kZS5jcmVhdGVMaXRlcmFsKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlRGF0YS5sYWJlbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZURhdGEucG9zaXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBOb2RlVHlwZS5GSUxURVI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IFZpc3VhbFF1ZXJ5Tm9kZS5jcmVhdGVGaWx0ZXIoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVEYXRhLmxhYmVsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlRGF0YS5wb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgVW5rbm93biBub2RlIHR5cGU6ICR7bm9kZURhdGEudHlwZX1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub2Rlcy5zZXQobm9kZURhdGEuaWQsIG5vZGUpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgRmFpbGVkIHRvIGltcG9ydCBub2RlICR7bm9kZURhdGEuaWR9OmAsIGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gSW1wb3J0IGVkZ2VzXG4gICAgICAgICAgICBkYXRhLmVkZ2VzLmZvckVhY2goKGVkZ2VEYXRhOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgZWRnZTogVmlzdWFsUXVlcnlFZGdlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZWRnZURhdGEub3B0aW9uYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkZ2UgPSBWaXN1YWxRdWVyeUVkZ2UuY3JlYXRlT3B0aW9uYWwoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRnZURhdGEuc291cmNlTm9kZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkZ2VEYXRhLnRhcmdldE5vZGVJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGdlRGF0YS5sYWJlbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGdlRGF0YS5wcm9wZXJ0eVVyaVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkZ2UgPSBWaXN1YWxRdWVyeUVkZ2UuY3JlYXRlUHJvcGVydHkoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRnZURhdGEuc291cmNlTm9kZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkZ2VEYXRhLnRhcmdldE5vZGVJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGdlRGF0YS5sYWJlbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGdlRGF0YS5wcm9wZXJ0eVVyaVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVkZ2VzLnNldChlZGdlRGF0YS5pZCwgZWRnZSk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBGYWlsZWQgdG8gaW1wb3J0IGVkZ2UgJHtlZGdlRGF0YS5pZH06YCwgZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBSZXN0b3JlIHZpZXdwb3J0XG4gICAgICAgICAgICBpZiAoZGF0YS52aWV3cG9ydCkge1xuICAgICAgICAgICAgICAgIHRoaXMudmlld3BvcnRYID0gZGF0YS52aWV3cG9ydC54IHx8IDA7XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3cG9ydFkgPSBkYXRhLnZpZXdwb3J0LnkgfHwgMDtcbiAgICAgICAgICAgICAgICB0aGlzLnpvb20gPSBkYXRhLnZpZXdwb3J0Lnpvb20gfHwgMTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBSZS1yZW5kZXJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVF1ZXJ5KCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gaW1wb3J0IGNhbnZhcyBkYXRhOicsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3ZnLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuaGFuZGxlTW91c2VEb3duLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLnN2Zy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLmhhbmRsZU1vdXNlTW92ZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5zdmcucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMuaGFuZGxlTW91c2VVcC5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5zdmcucmVtb3ZlRXZlbnRMaXN0ZW5lcignd2hlZWwnLCB0aGlzLmhhbmRsZVdoZWVsLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLnN2Zy5yZW1vdmVFdmVudExpc3RlbmVyKCdjb250ZXh0bWVudScsIHRoaXMuaGFuZGxlQ29udGV4dE1lbnUuYmluZCh0aGlzKSk7XG4gICAgICAgIFxuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5oYW5kbGVLZXlEb3duLmJpbmQodGhpcykpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2xlYXIgYWxsIG5vZGVzIGFuZCBlZGdlcyB0byBlbnN1cmUgY2xlYW51cFxuICAgICAgICB0aGlzLm5vZGVzLmNsZWFyKCk7XG4gICAgICAgIHRoaXMuZWRnZXMuY2xlYXIoKTtcbiAgICAgICAgdGhpcy5jbGVhclNlbGVjdGlvbigpO1xuICAgICAgICBcbiAgICAgICAgaWYgKHRoaXMuY29udGFpbmVyICYmIHRoaXMuY29udGFpbmVyLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5jb250YWluZXIpO1xuICAgICAgICB9XG4gICAgfVxufSJdLCJ2ZXJzaW9uIjozfQ==