10bdd325cb13faf4ea95af48fdd657ee
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.RenderContextMother = exports.LayoutMother = void 0;
const ClassLayout_1 = require("../../src/domain/entities/ClassLayout");
const AssetId_1 = require("../../src/domain/value-objects/AssetId");
const ClassName_1 = require("../../src/domain/value-objects/ClassName");
/**
 * Mother Object pattern for creating test ClassLayout instances
 * Follows Test Data Builder pattern for flexible test setup
 */
class LayoutMother {
    constructor() {
        this.id = "00000000-0000-4000-8000-000000000001";
        this.targetClass = "TestClass";
        this.blocks = [];
        this.isEnabled = true;
        this.priority = 0;
    }
    static create() {
        return new LayoutMother();
    }
    static simple() {
        return LayoutMother.create()
            .withId("00000000-0000-4000-8000-000000000002")
            .withTargetClass("SimpleClass")
            .withPropertiesBlock()
            .build();
    }
    static complex() {
        return LayoutMother.create()
            .withId("00000000-0000-4000-8000-000000000003")
            .withTargetClass("ComplexClass")
            .withPropertiesBlock()
            .withBacklinksBlock()
            .withChildrenEffortsBlock()
            .withCustomBlock()
            .withPriority(10)
            .build();
    }
    static empty() {
        return LayoutMother.create()
            .withId("00000000-0000-4000-8000-000000000004")
            .withTargetClass("EmptyClass")
            .build();
    }
    static disabled() {
        return LayoutMother.create()
            .withId("00000000-0000-4000-8000-000000000005")
            .withTargetClass("DisabledClass")
            .disabled()
            .build();
    }
    static withCollapsibleBlocks() {
        return LayoutMother.create()
            .withId("00000000-0000-4000-8000-000000000006")
            .withTargetClass("CollapsibleClass")
            .withCollapsibleBlock("collapsible-1", "properties", "Collapsible Properties")
            .withCollapsibleBlock("collapsible-2", "backlinks", "Collapsible Backlinks", true)
            .build();
    }
    // Builder methods
    withId(id) {
        this.id = id;
        return this;
    }
    withTargetClass(targetClass) {
        this.targetClass = targetClass;
        return this;
    }
    withPriority(priority) {
        this.priority = priority;
        return this;
    }
    enabled() {
        this.isEnabled = true;
        return this;
    }
    disabled() {
        this.isEnabled = false;
        return this;
    }
    withBlock(block) {
        this.blocks.push(block);
        return this;
    }
    withPropertiesBlock(id = "properties-block", title = "Properties") {
        return this.withBlock({
            id,
            type: "properties",
            title,
            order: this.blocks.length,
            config: { type: "properties" },
            isVisible: true,
        });
    }
    withBacklinksBlock(id = "backlinks-block", title = "Backlinks") {
        return this.withBlock({
            id,
            type: "backlinks",
            title,
            order: this.blocks.length,
            config: { type: "backlinks" },
            isVisible: true,
        });
    }
    withChildrenEffortsBlock(id = "children-efforts-block", title = "Children Efforts") {
        return this.withBlock({
            id,
            type: "children-efforts",
            title,
            order: this.blocks.length,
            config: { type: "children-efforts" },
            isVisible: true,
        });
    }
    withQueryBlock(id = "query-block", title = "Query Results", query = "SELECT * WHERE { ?s ?p ?o }") {
        return this.withBlock({
            id,
            type: "query",
            title,
            order: this.blocks.length,
            config: { type: "query", query },
            isVisible: true,
        });
    }
    withCustomBlock(id = "custom-block", title = "Custom Block") {
        return this.withBlock({
            id,
            type: "custom",
            title,
            order: this.blocks.length,
            config: { type: "custom", templatePath: "templates/custom.md" },
            isVisible: true,
        });
    }
    withButtonsBlock(id = "buttons-block", title = "Actions") {
        return this.withBlock({
            id,
            type: "buttons",
            title,
            order: this.blocks.length,
            config: {
                type: "buttons",
                buttons: [
                    { id: "btn-1", label: "Action 1", commandType: "test-command" },
                ],
            },
            isVisible: true,
        });
    }
    withHiddenBlock(id = "hidden-block", type = "properties") {
        return this.withBlock({
            id,
            type,
            title: "Hidden Block",
            order: this.blocks.length,
            config: { type },
            isVisible: false,
        });
    }
    withCollapsibleBlock(id, type, title, isCollapsed = false) {
        return this.withBlock({
            id,
            type,
            title,
            order: this.blocks.length,
            config: { type },
            isVisible: true,
            isCollapsible: true,
            isCollapsed,
        });
    }
    build() {
        const assetIdResult = AssetId_1.AssetId.create(this.id);
        const classNameResult = ClassName_1.ClassName.create(this.targetClass);
        if (assetIdResult.isFailure) {
            throw new Error(`Invalid asset ID: ${assetIdResult.error}`);
        }
        if (classNameResult.isFailure) {
            throw new Error(`Invalid class name: ${classNameResult.error}`);
        }
        const layoutResult = ClassLayout_1.ClassLayout.create({
            id: assetIdResult.getValue(),
            targetClass: classNameResult.getValue(),
            blocks: this.blocks,
            isEnabled: this.isEnabled,
            priority: this.priority,
        });
        if (layoutResult.isFailure) {
            throw new Error(`Failed to create layout: ${layoutResult.error}`);
        }
        return layoutResult.getValue();
    }
}
exports.LayoutMother = LayoutMother;
/**
 * Mother Object for creating test RenderContext instances
 */
class RenderContextMother {
    constructor() {
        this.containerId = "test-container";
        this.assetPath = "/test/path.md";
        this.metadata = {};
        this.frontmatter = {};
    }
    static create() {
        return new RenderContextMother();
    }
    static simple() {
        return RenderContextMother.create().build();
    }
    static withFrontmatter(frontmatter) {
        return RenderContextMother.create().withFrontmatter(frontmatter).build();
    }
    static forAsset(assetPath) {
        return RenderContextMother.create().withAssetPath(assetPath).build();
    }
    withContainerId(containerId) {
        this.containerId = containerId;
        return this;
    }
    withAssetPath(assetPath) {
        this.assetPath = assetPath;
        return this;
    }
    withMetadata(metadata) {
        this.metadata = metadata;
        return this;
    }
    withFrontmatter(frontmatter) {
        this.frontmatter = frontmatter;
        return this;
    }
    build() {
        return {
            containerId: this.containerId,
            assetPath: this.assetPath,
            metadata: { ...this.metadata, frontmatter: this.frontmatter },
            frontmatter: this.frontmatter,
        };
    }
}
exports.RenderContextMother = RenderContextMother;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2tpdGVsZXYvRG9jdW1lbnRzL2V4b2NvcnRleC1vYnNpZGlhbi1wbHVnaW4vdGVzdHMvX19idWlsZGVyc19fL0xheW91dE1vdGhlci50cyIsIm1hcHBpbmdzIjoiOzs7QUFBQSx1RUFHK0M7QUFFL0Msb0VBQWlFO0FBQ2pFLHdFQUFxRTtBQUdyRTs7O0dBR0c7QUFDSCxNQUFhLFlBQVk7SUFBekI7UUFDVSxPQUFFLEdBQVcsc0NBQXNDLENBQUM7UUFDcEQsZ0JBQVcsR0FBVyxXQUFXLENBQUM7UUFDbEMsV0FBTSxHQUF3QixFQUFFLENBQUM7UUFDakMsY0FBUyxHQUFZLElBQUksQ0FBQztRQUMxQixhQUFRLEdBQVcsQ0FBQyxDQUFDO0lBOE8vQixDQUFDO0lBNU9DLE1BQU0sQ0FBQyxNQUFNO1FBQ1gsT0FBTyxJQUFJLFlBQVksRUFBRSxDQUFDO0lBQzVCLENBQUM7SUFFRCxNQUFNLENBQUMsTUFBTTtRQUNYLE9BQU8sWUFBWSxDQUFDLE1BQU0sRUFBRTthQUN6QixNQUFNLENBQUMsc0NBQXNDLENBQUM7YUFDOUMsZUFBZSxDQUFDLGFBQWEsQ0FBQzthQUM5QixtQkFBbUIsRUFBRTthQUNyQixLQUFLLEVBQUUsQ0FBQztJQUNiLENBQUM7SUFFRCxNQUFNLENBQUMsT0FBTztRQUNaLE9BQU8sWUFBWSxDQUFDLE1BQU0sRUFBRTthQUN6QixNQUFNLENBQUMsc0NBQXNDLENBQUM7YUFDOUMsZUFBZSxDQUFDLGNBQWMsQ0FBQzthQUMvQixtQkFBbUIsRUFBRTthQUNyQixrQkFBa0IsRUFBRTthQUNwQix3QkFBd0IsRUFBRTthQUMxQixlQUFlLEVBQUU7YUFDakIsWUFBWSxDQUFDLEVBQUUsQ0FBQzthQUNoQixLQUFLLEVBQUUsQ0FBQztJQUNiLENBQUM7SUFFRCxNQUFNLENBQUMsS0FBSztRQUNWLE9BQU8sWUFBWSxDQUFDLE1BQU0sRUFBRTthQUN6QixNQUFNLENBQUMsc0NBQXNDLENBQUM7YUFDOUMsZUFBZSxDQUFDLFlBQVksQ0FBQzthQUM3QixLQUFLLEVBQUUsQ0FBQztJ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SUFDZCxDQUFDO0lBRUQsWUFBWSxDQUFDLFFBQTZCO1FBQ3hDLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO1FBQ3pCLE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVELGVBQWUsQ0FBQyxXQUFnQztRQUM5QyxJQUFJLENBQUMsV0FBVyxHQUFHLFdBQVcsQ0FBQztRQUMvQixPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7SUFFRCxLQUFLO1FBQ0gsT0FBTztZQUNMLFdBQVcsRUFBRSxJQUFJLENBQUMsV0FBVztZQUM3QixTQUFTLEVBQUUsSUFBSSxDQUFDLFNBQVM7WUFDekIsUUFBUSxFQUFFLEVBQUUsR0FBRyxJQUFJLENBQUMsUUFBUSxFQUFFLFdBQVcsRUFBRSxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQzdELFdBQVcsRUFBRSxJQUFJLENBQUMsV0FBVztTQUM5QixDQUFDO0lBQ0osQ0FBQztDQUNGO0FBbERELGtEQWtEQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMva2l0ZWxldi9Eb2N1bWVudHMvZXhvY29ydGV4LW9ic2lkaWFuLXBsdWdpbi90ZXN0cy9fX2J1aWxkZXJzX18vTGF5b3V0TW90aGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIENsYXNzTGF5b3V0LFxuICBMYXlvdXRCbG9ja0NvbmZpZyxcbn0gZnJvbSBcIi4uLy4uL3NyYy9kb21haW4vZW50aXRpZXMvQ2xhc3NMYXlvdXRcIjtcbmltcG9ydCB7IExheW91dEJsb2NrLCBCbG9ja1R5cGUgfSBmcm9tIFwiLi4vLi4vc3JjL2RvbWFpbi9lbnRpdGllcy9MYXlvdXRCbG9ja1wiO1xuaW1wb3J0IHsgQXNzZXRJZCB9IGZyb20gXCIuLi8uLi9zcmMvZG9tYWluL3ZhbHVlLW9iamVjdHMvQXNzZXRJZFwiO1xuaW1wb3J0IHsgQ2xhc3NOYW1lIH0gZnJvbSBcIi4uLy4uL3NyYy9kb21haW4vdmFsdWUtb2JqZWN0cy9DbGFzc05hbWVcIjtcbmltcG9ydCB7IFJlc3VsdCB9IGZyb20gXCIuLi8uLi9zcmMvZG9tYWluL2NvcmUvUmVzdWx0XCI7XG5cbi8qKlxuICogTW90aGVyIE9iamVjdCBwYXR0ZXJuIGZvciBjcmVhdGluZyB0ZXN0IENsYXNzTGF5b3V0IGluc3RhbmNlc1xuICogRm9sbG93cyBUZXN0IERhdGEgQnVpbGRlciBwYXR0ZXJuIGZvciBmbGV4aWJsZSB0ZXN0IHNldHVwXG4gKi9cbmV4cG9ydCBjbGFzcyBMYXlvdXRNb3RoZXIge1xuICBwcml2YXRlIGlkOiBzdHJpbmcgPSBcIjAwMDAwMDAwLTAwMDAtNDAwMC04MDAwLTAwMDAwMDAwMDAwMVwiO1xuICBwcml2YXRlIHRhcmdldENsYXNzOiBzdHJpbmcgPSBcIlRlc3RDbGFzc1wiO1xuICBwcml2YXRlIGJsb2NrczogTGF5b3V0QmxvY2tDb25maWdbXSA9IFtdO1xuICBwcml2YXRlIGlzRW5hYmxlZDogYm9vbGVhbiA9IHRydWU7XG4gIHByaXZhdGUgcHJpb3JpdHk6IG51bWJlciA9IDA7XG5cbiAgc3RhdGljIGNyZWF0ZSgpOiBMYXlvdXRNb3RoZXIge1xuICAgIHJldHVybiBuZXcgTGF5b3V0TW90aGVyKCk7XG4gIH1cblxuICBzdGF0aWMgc2ltcGxlKCk6IENsYXNzTGF5b3V0IHtcbiAgICByZXR1cm4gTGF5b3V0TW90aGVyLmNyZWF0ZSgpXG4gICAgICAud2l0aElkKFwiMDAwMDAwMDAtMDAwMC00MDAwLTgwMDAtMDAwMDAwMDAwMDAyXCIpXG4gICAgICAud2l0aFRhcmdldENsYXNzKFwiU2ltcGxlQ2xhc3NcIilcbiAgICAgIC53aXRoUHJvcGVydGllc0Jsb2NrKClcbiAgICAgIC5idWlsZCgpO1xuICB9XG5cbiAgc3RhdGljIGNvbXBsZXgoKTogQ2xhc3NMYXlvdXQge1xuICAgIHJldHVybiBMYXlvdXRNb3RoZXIuY3JlYXRlKClcbiAgICAgIC53aXRoSWQoXCIwMDAwMDAwMC0wMDAwLTQwMDAtODAwMC0wMDAwMDAwMDAwMDNcIilcbiAgICAgIC53aXRoVGFyZ2V0Q2xhc3MoXCJDb21wbGV4Q2xhc3NcIilcbiAgICAgIC53aXRoUHJvcGVydGllc0Jsb2NrKClcbiAgICAgIC53aXRoQmFja2xpbmtzQmxvY2soKVxuICAgICAgLndpdGhDaGlsZHJlbkVmZm9ydHNCbG9jaygpXG4gICAgICAud2l0aEN1c3RvbUJsb2NrKClcbiAgICAgIC53aXRoUHJpb3JpdHkoMTApXG4gICAgICAuYnVpbGQoKTtcbiAgfVxuXG4gIHN0YXRpYyBlbXB0eSgpOiBDbGFzc0xheW91dCB7XG4gICAgcmV0dXJuIExheW91dE1vdGhlci5jcmVhdGUoKVxuICAgICAgLndpdGhJZChcIjAwMDAwMDAwLTAwMDAtNDAwMC04MDAwLTAwMDAwMDAwMDAwNFwiKVxuICAgICAgLndpdGhUYXJnZXRDbGFzcyhcIkVtcHR5Q2xhc3NcIilcbiAgICAgIC5idWlsZCgpO1xuICB9XG5cbiAgc3RhdGljIGRpc2FibGVkKCk6IENsYXNzTGF5b3V0IHtcbiAgICByZXR1cm4gTGF5b3V0TW90aGVyLmNyZWF0ZSgpXG4gICAgICAud2l0aElkKFwiMDAwMDAwMDAtMDAwMC00MDAwLTgwMDAtMDAwMDAwMDAwMDA1XCIpXG4gICAgICAud2l0aFRhcmdldENsYXNzKFwiRGlzYWJsZWRDbGFzc1wiKVxuICAgICAgLmRpc2FibGVkKClcbiAgICAgIC5idWlsZCgpO1xuICB9XG5cbiAgc3RhdGljIHdpdGhDb2xsYXBzaWJsZUJsb2NrcygpOiBDbGFzc0xheW91dCB7XG4gICAgcmV0dXJuIExheW91dE1vdGhlci5jcmVhdGUoKVxuICAgICAgLndpdGhJZChcIjAwMDAwMDAwLTAwMDAtNDAwMC04MDAwLTAwMDAwMDAwMDAwNlwiKVxuICAgICAgLndpdGhUYXJnZXRDbGFzcyhcIkNvbGxhcHNpYmxlQ2xhc3NcIilcbiAgICAgIC53aXRoQ29sbGFwc2libGVCbG9jayhcbiAgICAgICAgXCJjb2xsYXBzaWJsZS0xXCIsXG4gICAgICAgIFwicHJvcGVydGllc1wiLFxuICAgICAgICBcIkNvbGxhcHNpYmxlIFByb3BlcnRpZXNcIixcbiAgICAgIClcbiAgICAgIC53aXRoQ29sbGFwc2libGVCbG9jayhcbiAgICAgICAgXCJjb2xsYXBzaWJsZS0yXCIsXG4gICAgICAgIFwiYmFja2xpbmtzXCIsXG4gICAgICAgIFwiQ29sbGFwc2libGUgQmFja2xpbmtzXCIsXG4gICAgICAgIHRydWUsXG4gICAgICApXG4gICAgICAuYnVpbGQoKTtcbiAgfVxuXG4gIC8vIEJ1aWxkZXIgbWV0aG9kc1xuICB3aXRoSWQoaWQ6IHN0cmluZyk6IHRoaXMge1xuICAgIHRoaXMuaWQgPSBpZDtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHdpdGhUYXJnZXRDbGFzcyh0YXJnZXRDbGFzczogc3RyaW5nKTogdGhpcyB7XG4gICAgdGhpcy50YXJnZXRDbGFzcyA9IHRhcmdldENsYXNzO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgd2l0aFByaW9yaXR5KHByaW9yaXR5OiBudW1iZXIpOiB0aGlzIHtcbiAgICB0aGlzLnByaW9yaXR5ID0gcHJpb3JpdHk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBlbmFibGVkKCk6IHRoaXMge1xuICAgIHRoaXMuaXNFbmFibGVkID0gdHJ1ZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGRpc2FibGVkKCk6IHRoaXMge1xuICAgIHRoaXMuaXNFbmFibGVkID0gZmFsc2U7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICB3aXRoQmxvY2soYmxvY2s6IExheW91dEJsb2NrQ29uZmlnKTogdGhpcyB7XG4gICAgdGhpcy5ibG9ja3MucHVzaChibG9jayk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICB3aXRoUHJvcGVydGllc0Jsb2NrKFxuICAgIGlkOiBzdHJpbmcgPSBcInByb3BlcnRpZXMtYmxvY2tcIixcbiAgICB0aXRsZTogc3RyaW5nID0gXCJQcm9wZXJ0aWVzXCIsXG4gICk6IHRoaXMge1xuICAgIHJldHVybiB0aGlzLndpdGhCbG9jayh7XG4gICAgICBpZCxcbiAgICAgIHR5cGU6IFwicHJvcGVydGllc1wiLFxuICAgICAgdGl0bGUsXG4gICAgICBvcmRlcjogdGhpcy5ibG9ja3MubGVuZ3RoLFxuICAgICAgY29uZmlnOiB7IHR5cGU6IFwicHJvcGVydGllc1wiIH0sXG4gICAgICBpc1Zpc2libGU6IHRydWUsXG4gICAgfSk7XG4gIH1cblxuICB3aXRoQmFja2xpbmtzQmxvY2soXG4gICAgaWQ6IHN0cmluZyA9IFwiYmFja2xpbmtzLWJsb2NrXCIsXG4gICAgdGl0bGU6IHN0cmluZyA9IFwiQmFja2xpbmtzXCIsXG4gICk6IHRoaXMge1xuICAgIHJldHVybiB0aGlzLndpdGhCbG9jayh7XG4gICAgICBpZCxcbiAgICAgIHR5cGU6IFwiYmFja2xpbmtzXCIsXG4gICAgICB0aXRsZSxcbiAgICAgIG9yZGVyOiB0aGlzLmJsb2Nrcy5sZW5ndGgsXG4gICAgICBjb25maWc6IHsgdHlwZTogXCJiYWNrbGlua3NcIiB9LFxuICAgICAgaXNWaXNpYmxlOiB0cnVlLFxuICAgIH0pO1xuICB9XG5cbiAgd2l0aENoaWxkcmVuRWZmb3J0c0Jsb2NrKFxuICAgIGlkOiBzdHJpbmcgPSBcImNoaWxkcmVuLWVmZm9ydHMtYmxvY2tcIixcbiAgICB0aXRsZTogc3RyaW5nID0gXCJDaGlsZHJlbiBFZmZvcnRzXCIsXG4gICk6IHRoaXMge1xuICAgIHJldHVybiB0aGlzLndpdGhCbG9jayh7XG4gICAgICBpZCxcbiAgICAgIHR5cGU6IFwiY2hpbGRyZW4tZWZmb3J0c1wiLFxuICAgICAgdGl0bGUsXG4gICAgICBvcmRlcjogdGhpcy5ibG9ja3MubGVuZ3RoLFxuICAgICAgY29uZmlnOiB7IHR5cGU6IFwiY2hpbGRyZW4tZWZmb3J0c1wiIH0sXG4gICAgICBpc1Zpc2libGU6IHRydWUsXG4gICAgfSk7XG4gIH1cblxuICB3aXRoUXVlcnlCbG9jayhcbiAgICBpZDogc3RyaW5nID0gXCJxdWVyeS1ibG9ja1wiLFxuICAgIHRpdGxlOiBzdHJpbmcgPSBcIlF1ZXJ5IFJlc3VsdHNcIixcbiAgICBxdWVyeTogc3RyaW5nID0gXCJTRUxFQ1QgKiBXSEVSRSB7ID9zID9wID9vIH1cIixcbiAgKTogdGhpcyB7XG4gICAgcmV0dXJuIHRoaXMud2l0aEJsb2NrKHtcbiAgICAgIGlkLFxuICAgICAgdHlwZTogXCJxdWVyeVwiLFxuICAgICAgdGl0bGUsXG4gICAgICBvcmRlcjogdGhpcy5ibG9ja3MubGVuZ3RoLFxuICAgICAgY29uZmlnOiB7IHR5cGU6IFwicXVlcnlcIiwgcXVlcnkgfSxcbiAgICAgIGlzVmlzaWJsZTogdHJ1ZSxcbiAgICB9KTtcbiAgfVxuXG4gIHdpdGhDdXN0b21CbG9jayhcbiAgICBpZDogc3RyaW5nID0gXCJjdXN0b20tYmxvY2tcIixcbiAgICB0aXRsZTogc3RyaW5nID0gXCJDdXN0b20gQmxvY2tcIixcbiAgKTogdGhpcyB7XG4gICAgcmV0dXJuIHRoaXMud2l0aEJsb2NrKHtcbiAgICAgIGlkLFxuICAgICAgdHlwZTogXCJjdXN0b21cIixcbiAgICAgIHRpdGxlLFxuICAgICAgb3JkZXI6IHRoaXMuYmxvY2tzLmxlbmd0aCxcbiAgICAgIGNvbmZpZzogeyB0eXBlOiBcImN1c3RvbVwiLCB0ZW1wbGF0ZVBhdGg6IFwidGVtcGxhdGVzL2N1c3RvbS5tZFwiIH0sXG4gICAgICBpc1Zpc2libGU6IHRydWUsXG4gICAgfSk7XG4gIH1cblxuICB3aXRoQnV0dG9uc0Jsb2NrKFxuICAgIGlkOiBzdHJpbmcgPSBcImJ1dHRvbnMtYmxvY2tcIixcbiAgICB0aXRsZTogc3RyaW5nID0gXCJBY3Rpb25zXCIsXG4gICk6IHRoaXMge1xuICAgIHJldHVybiB0aGlzLndpdGhCbG9jayh7XG4gICAgICBpZCxcbiAgICAgIHR5cGU6IFwiYnV0dG9uc1wiLFxuICAgICAgdGl0bGUsXG4gICAgICBvcmRlcjogdGhpcy5ibG9ja3MubGVuZ3RoLFxuICAgICAgY29uZmlnOiB7XG4gICAgICAgIHR5cGU6IFwiYnV0dG9uc1wiLFxuICAgICAgICBidXR0b25zOiBbXG4gICAgICAgICAgeyBpZDogXCJidG4tMVwiLCBsYWJlbDogXCJBY3Rpb24gMVwiLCBjb21tYW5kVHlwZTogXCJ0ZXN0LWNvbW1hbmRcIiB9LFxuICAgICAgICBdLFxuICAgICAgfSxcbiAgICAgIGlzVmlzaWJsZTogdHJ1ZSxcbiAgICB9KTtcbiAgfVxuXG4gIHdpdGhIaWRkZW5CbG9jayhcbiAgICBpZDogc3RyaW5nID0gXCJoaWRkZW4tYmxvY2tcIixcbiAgICB0eXBlOiBCbG9ja1R5cGUgPSBcInByb3BlcnRpZXNcIixcbiAgKTogdGhpcyB7XG4gICAgcmV0dXJuIHRoaXMud2l0aEJsb2NrKHtcbiAgICAgIGlkLFxuICAgICAgdHlwZSxcbiAgICAgIHRpdGxlOiBcIkhpZGRlbiBCbG9ja1wiLFxuICAgICAgb3JkZXI6IHRoaXMuYmxvY2tzLmxlbmd0aCxcbiAgICAgIGNvbmZpZzogeyB0eXBlIH0sXG4gICAgICBpc1Zpc2libGU6IGZhbHNlLFxuICAgIH0pO1xuICB9XG5cbiAgd2l0aENvbGxhcHNpYmxlQmxvY2soXG4gICAgaWQ6IHN0cmluZyxcbiAgICB0eXBlOiBCbG9ja1R5cGUsXG4gICAgdGl0bGU6IHN0cmluZyxcbiAgICBpc0NvbGxhcHNlZDogYm9vbGVhbiA9IGZhbHNlLFxuICApOiB0aGlzIHtcbiAgICByZXR1cm4gdGhpcy53aXRoQmxvY2soe1xuICAgICAgaWQsXG4gICAgICB0eXBlLFxuICAgICAgdGl0bGUsXG4gICAgICBvcmRlcjogdGhpcy5ibG9ja3MubGVuZ3RoLFxuICAgICAgY29uZmlnOiB7IHR5cGUgfSxcbiAgICAgIGlzVmlzaWJsZTogdHJ1ZSxcbiAgICAgIGlzQ29sbGFwc2libGU6IHRydWUsXG4gICAgICBpc0NvbGxhcHNlZCxcbiAgICB9KTtcbiAgfVxuXG4gIGJ1aWxkKCk6IENsYXNzTGF5b3V0IHtcbiAgICBjb25zdCBhc3NldElkUmVzdWx0ID0gQXNzZXRJZC5jcmVhdGUodGhpcy5pZCk7XG4gICAgY29uc3QgY2xhc3NOYW1lUmVzdWx0ID0gQ2xhc3NOYW1lLmNyZWF0ZSh0aGlzLnRhcmdldENsYXNzKTtcblxuICAgIGlmIChhc3NldElkUmVzdWx0LmlzRmFpbHVyZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIGFzc2V0IElEOiAke2Fzc2V0SWRSZXN1bHQuZXJyb3J9YCk7XG4gICAgfVxuXG4gICAgaWYgKGNsYXNzTmFtZVJlc3VsdC5pc0ZhaWx1cmUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBjbGFzcyBuYW1lOiAke2NsYXNzTmFtZVJlc3VsdC5lcnJvcn1gKTtcbiAgICB9XG5cbiAgICBjb25zdCBsYXlvdXRSZXN1bHQgPSBDbGFzc0xheW91dC5jcmVhdGUoe1xuICAgICAgaWQ6IGFzc2V0SWRSZXN1bHQuZ2V0VmFsdWUoKSxcbiAgICAgIHRhcmdldENsYXNzOiBjbGFzc05hbWVSZXN1bHQuZ2V0VmFsdWUoKSxcbiAgICAgIGJsb2NrczogdGhpcy5ibG9ja3MsXG4gICAgICBpc0VuYWJsZWQ6IHRoaXMuaXNFbmFibGVkLFxuICAgICAgcHJpb3JpdHk6IHRoaXMucHJpb3JpdHksXG4gICAgfSk7XG5cbiAgICBpZiAobGF5b3V0UmVzdWx0LmlzRmFpbHVyZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gY3JlYXRlIGxheW91dDogJHtsYXlvdXRSZXN1bHQuZXJyb3J9YCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGxheW91dFJlc3VsdC5nZXRWYWx1ZSgpO1xuICB9XG59XG5cbi8qKlxuICogTW90aGVyIE9iamVjdCBmb3IgY3JlYXRpbmcgdGVzdCBSZW5kZXJDb250ZXh0IGluc3RhbmNlc1xuICovXG5leHBvcnQgY2xhc3MgUmVuZGVyQ29udGV4dE1vdGhlciB7XG4gIHByaXZhdGUgY29udGFpbmVySWQ6IHN0cmluZyA9IFwidGVzdC1jb250YWluZXJcIjtcbiAgcHJpdmF0ZSBhc3NldFBhdGg6IHN0cmluZyA9IFwiL3Rlc3QvcGF0aC5tZFwiO1xuICBwcml2YXRlIG1ldGFkYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge307XG4gIHByaXZhdGUgZnJvbnRtYXR0ZXI6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcblxuICBzdGF0aWMgY3JlYXRlKCk6IFJlbmRlckNvbnRleHRNb3RoZXIge1xuICAgIHJldHVybiBuZXcgUmVuZGVyQ29udGV4dE1vdGhlcigpO1xuICB9XG5cbiAgc3RhdGljIHNpbXBsZSgpOiBhbnkge1xuICAgIHJldHVybiBSZW5kZXJDb250ZXh0TW90aGVyLmNyZWF0ZSgpLmJ1aWxkKCk7XG4gIH1cblxuICBzdGF0aWMgd2l0aEZyb250bWF0dGVyKGZyb250bWF0dGVyOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogYW55IHtcbiAgICByZXR1cm4gUmVuZGVyQ29udGV4dE1vdGhlci5jcmVhdGUoKS53aXRoRnJvbnRtYXR0ZXIoZnJvbnRtYXR0ZXIpLmJ1aWxkKCk7XG4gIH1cblxuICBzdGF0aWMgZm9yQXNzZXQoYXNzZXRQYXRoOiBzdHJpbmcpOiBhbnkge1xuICAgIHJldHVybiBSZW5kZXJDb250ZXh0TW90aGVyLmNyZWF0ZSgpLndpdGhBc3NldFBhdGgoYXNzZXRQYXRoKS5idWlsZCgpO1xuICB9XG5cbiAgd2l0aENvbnRhaW5lcklkKGNvbnRhaW5lcklkOiBzdHJpbmcpOiB0aGlzIHtcbiAgICB0aGlzLmNvbnRhaW5lcklkID0gY29udGFpbmVySWQ7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICB3aXRoQXNzZXRQYXRoKGFzc2V0UGF0aDogc3RyaW5nKTogdGhpcyB7XG4gICAgdGhpcy5hc3NldFBhdGggPSBhc3NldFBhdGg7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICB3aXRoTWV0YWRhdGEobWV0YWRhdGE6IFJlY29yZDxzdHJpbmcsIGFueT4pOiB0aGlzIHtcbiAgICB0aGlzLm1ldGFkYXRhID0gbWV0YWRhdGE7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICB3aXRoRnJvbnRtYXR0ZXIoZnJvbnRtYXR0ZXI6IFJlY29yZDxzdHJpbmcsIGFueT4pOiB0aGlzIHtcbiAgICB0aGlzLmZyb250bWF0dGVyID0gZnJvbnRtYXR0ZXI7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBidWlsZCgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgY29udGFpbmVySWQ6IHRoaXMuY29udGFpbmVySWQsXG4gICAgICBhc3NldFBhdGg6IHRoaXMuYXNzZXRQYXRoLFxuICAgICAgbWV0YWRhdGE6IHsgLi4udGhpcy5tZXRhZGF0YSwgZnJvbnRtYXR0ZXI6IHRoaXMuZnJvbnRtYXR0ZXIgfSxcbiAgICAgIGZyb250bWF0dGVyOiB0aGlzLmZyb250bWF0dGVyLFxuICAgIH07XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==