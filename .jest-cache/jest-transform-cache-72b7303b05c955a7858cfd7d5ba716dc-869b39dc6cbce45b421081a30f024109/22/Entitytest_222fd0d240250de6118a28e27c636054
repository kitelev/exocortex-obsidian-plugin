ff8f9e9911fd8795706b7111ef0ed17a
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Entity_1 = require("../../../../src/domain/core/Entity");
/**
 * Test implementation of Entity for testing purposes
 */
class TestEntity extends Entity_1.Entity {
    constructor(props, id) {
        super(props);
        this._id = id || 'test-id-' + Math.random().toString(36).substr(2, 9);
    }
    getName() {
        return this.props.name;
    }
    getValue() {
        return this.props.value;
    }
    updateName(name) {
        this.props.name = name;
    }
    getId() {
        return this._id;
    }
    // Expose protected methods for testing
    testAddDomainEvent(event) {
        this.addDomainEvent(event);
    }
    testGetDomainEvents() {
        return this.getDomainEvents();
    }
    testClearDomainEvents() {
        this.clearDomainEvents();
    }
}
describe('Entity', () => {
    describe('Construction', () => {
        it('should create entity with props', () => {
            // Given
            const props = { name: 'Test Entity', value: 42 };
            // When
            const entity = new TestEntity(props);
            // Then
            expect(entity.getName()).toBe('Test Entity');
            expect(entity.getValue()).toBe(42);
            expect(entity.getId()).toBeDefined();
        });
        it('should create entity with custom id', () => {
            // Given
            const props = { name: 'Test Entity', value: 42 };
            const id = 'custom-id-123';
            // When
            const entity = new TestEntity(props, id);
            // Then
            expect(entity.getId()).toBe(id);
        });
        it('should initialize empty domain events array', () => {
            // Given
            const entity = new TestEntity({ name: 'Test', value: 1 });
            // When
            const events = entity.domainEvents;
            // Then
            expect(events).toEqual([]);
            expect(Array.isArray(events)).toBe(true);
        });
    });
    describe('equals', () => {
        it('should return true for entities with same id', () => {
            // Given
            const id = 'same-id';
            const entity1 = new TestEntity({ name: 'Entity 1', value: 1 }, id);
            const entity2 = new TestEntity({ name: 'Entity 2', value: 2 }, id);
            // When
            const result = entity1.equals(entity2);
            // Then
            expect(result).toBe(true);
        });
        it('should return false for entities with different ids', () => {
            // Given
            const entity1 = new TestEntity({ name: 'Entity 1', value: 1 }, 'id-1');
            const entity2 = new TestEntity({ name: 'Entity 2', value: 2 }, 'id-2');
            // When
            const result = entity1.equals(entity2);
            // Then
            expect(result).toBe(false);
        });
        it('should return false when comparing with null', () => {
            // Given
            const entity = new TestEntity({ name: 'Test', value: 1 });
            // When
            const result = entity.equals(null);
            // Then
            expect(result).toBe(false);
        });
        it('should return false when comparing with undefined', () => {
            // Given
            const entity = new TestEntity({ name: 'Test', value: 1 });
            // When
            const result = entity.equals(undefined);
            // Then
            expect(result).toBe(false);
        });
        it('should return true when comparing entity with itself', () => {
            // Given
            const entity = new TestEntity({ name: 'Test', value: 1 });
            // When
            const result = entity.equals(entity);
            // Then
            expect(result).toBe(true);
        });
        it('should return false when comparing with non-entity object', () => {
            // Given
            const entity = new TestEntity({ name: 'Test', value: 1 });
            const nonEntity = { _id: entity.getId() };
            // When
            const result = entity.equals(nonEntity);
            // Then
            expect(result).toBe(false);
        });
        it('should handle string and number ids correctly', () => {
            // Given
            const stringIdEntity = new TestEntity({ name: 'Test', value: 1 }, 'string-id');
            const numberIdEntity = new TestEntity({ name: 'Test', value: 1 }, 123);
            const sameStringIdEntity = new TestEntity({ name: 'Test', value: 1 }, 'string-id');
            const sameNumberIdEntity = new TestEntity({ name: 'Test', value: 1 }, 123);
            // When & Then
            expect(stringIdEntity.equals(sameStringIdEntity)).toBe(true);
            expect(numberIdEntity.equals(sameNumberIdEntity)).toBe(true);
            expect(stringIdEntity.equals(numberIdEntity)).toBe(false);
        });
    });
    describe('Domain Events', () => {
        let entity;
        beforeEach(() => {
            entity = new TestEntity({ name: 'Test Entity', value: 42 });
        });
        it('should add domain event', () => {
            // Given
            const event = { type: 'TestEvent', data: { test: true } };
            // When
            entity.testAddDomainEvent(event);
            // Then
            expect(entity.domainEvents).toContain(event);
            expect(entity.domainEvents.length).toBe(1);
        });
        it('should add multiple domain events', () => {
            // Given
            const event1 = { type: 'Event1', data: { value: 1 } };
            const event2 = { type: 'Event2', data: { value: 2 } };
            const event3 = { type: 'Event3', data: { value: 3 } };
            // When
            entity.testAddDomainEvent(event1);
            entity.testAddDomainEvent(event2);
            entity.testAddDomainEvent(event3);
            // Then
            expect(entity.domainEvents).toEqual([event1, event2, event3]);
            expect(entity.domainEvents.length).toBe(3);
        });
        it('should get domain events via protected method', () => {
            // Given
            const event = { type: 'TestEvent' };
            entity.testAddDomainEvent(event);
            // When
            const events = entity.testGetDomainEvents();
            // Then
            expect(events).toContain(event);
            expect(events).toBe(entity.domainEvents);
        });
        it('should clear events via public method', () => {
            // Given
            entity.testAddDomainEvent({ type: 'Event1' });
            entity.testAddDomainEvent({ type: 'Event2' });
            expect(entity.domainEvents.length).toBe(2);
            // When
            entity.clearEvents();
            // Then
            expect(entity.domainEvents).toEqual([]);
            expect(entity.domainEvents.length).toBe(0);
        });
        it('should clear events via protected method', () => {
            // Given
            entity.testAddDomainEvent({ type: 'Event1' });
            entity.testAddDomainEvent({ type: 'Event2' });
            expect(entity.domainEvents.length).toBe(2);
            // When
            entity.testClearDomainEvents();
            // Then
            expect(entity.domainEvents).toEqual([]);
            expect(entity.domainEvents.length).toBe(0);
        });
        it('should handle null and undefined events', () => {
            // Given & When
            entity.testAddDomainEvent(null);
            entity.testAddDomainEvent(undefined);
            // Then
            expect(entity.domainEvents).toEqual([null, undefined]);
            expect(entity.domainEvents.length).toBe(2);
        });
        it('should preserve event references', () => {
            // Given
            const event = { type: 'TestEvent', mutable: true };
            entity.testAddDomainEvent(event);
            // When
            event.mutable = false;
            // Then
            expect(entity.domainEvents[0]).toBe(event);
            expect(entity.domainEvents[0].mutable).toBe(false);
        });
        it('should maintain event order', () => {
            // Given
            const events = [];
            for (let i = 0; i < 10; i++) {
                events.push({ type: `Event${i}`, order: i });
            }
            // When
            events.forEach(event => entity.testAddDomainEvent(event));
            // Then
            entity.domainEvents.forEach((event, index) => {
                expect(event.order).toBe(index);
            });
        });
    });
    describe('Entity Properties', () => {
        it('should protect props from external modification', () => {
            // Given
            const entity = new TestEntity({ name: 'Original', value: 100 });
            // When - try to modify props directly (should not be possible)
            // props is protected, so this is more of a design verification
            // Then
            expect(entity.getName()).toBe('Original');
            expect(entity.getValue()).toBe(100);
        });
        it('should allow controlled prop updates via methods', () => {
            // Given
            const entity = new TestEntity({ name: 'Original', value: 100 });
            // When
            entity.updateName('Updated');
            // Then
            expect(entity.getName()).toBe('Updated');
            expect(entity.getValue()).toBe(100); // Other props unchanged
        });
        it('should maintain prop integrity', () => {
            // Given
            const props = { name: 'Test', value: 42 };
            const entity = new TestEntity(props);
            // When - modify original props object
            props.name = 'Modified';
            props.value = 999;
            // Then - entity should be affected since it shares reference
            expect(entity.getName()).toBe('Modified');
            expect(entity.getValue()).toBe(999);
        });
    });
    describe('Entity Lifecycle', () => {
        it('should maintain id throughout lifecycle', () => {
            // Given
            const entity = new TestEntity({ name: 'Test', value: 1 }, 'persistent-id');
            const originalId = entity.getId();
            // When - perform various operations
            entity.updateName('Updated');
            entity.testAddDomainEvent({ type: 'Event' });
            entity.clearEvents();
            // Then
            expect(entity.getId()).toBe(originalId);
        });
        it('should allow event management throughout lifecycle', () => {
            // Given
            const entity = new TestEntity({ name: 'Test', value: 1 });
            // When - simulate lifecycle operations
            entity.testAddDomainEvent({ type: 'Created' });
            expect(entity.domainEvents.length).toBe(1);
            entity.updateName('Updated');
            entity.testAddDomainEvent({ type: 'Updated' });
            expect(entity.domainEvents.length).toBe(2);
            entity.clearEvents();
            expect(entity.domainEvents.length).toBe(0);
            entity.testAddDomainEvent({ type: 'Final' });
            expect(entity.domainEvents.length).toBe(1);
            // Then - all operations should work correctly
            expect(entity.getName()).toBe('Updated');
            expect(entity.domainEvents[0].type).toBe('Final');
        });
    });
    describe('Edge Cases', () => {
        it('should handle empty props object', () => {
            // Given
            const props = {};
            // When
            const entity = new TestEntity(props);
            // Then
            expect(entity.getName()).toBeUndefined();
            expect(entity.getValue()).toBeUndefined();
            expect(entity.getId()).toBeDefined();
        });
        it('should handle props with special characters', () => {
            // Given
            const props = { name: 'Entity with "quotes" and \nnewlines', value: -42.5 };
            // When
            const entity = new TestEntity(props);
            // Then
            expect(entity.getName()).toBe('Entity with "quotes" and \nnewlines');
            expect(entity.getValue()).toBe(-42.5);
        });
        it('should handle very large domain event arrays', () => {
            // Given
            const entity = new TestEntity({ name: 'Test', value: 1 });
            const eventCount = 1000;
            // When
            for (let i = 0; i < eventCount; i++) {
                entity.testAddDomainEvent({ type: `Event${i}`, index: i });
            }
            // Then
            expect(entity.domainEvents.length).toBe(eventCount);
            expect(entity.domainEvents[0].index).toBe(0);
            expect(entity.domainEvents[eventCount - 1].index).toBe(eventCount - 1);
            // Clear should work with large arrays
            entity.clearEvents();
            expect(entity.domainEvents.length).toBe(0);
        });
        it('should handle complex event objects', () => {
            // Given
            const entity = new TestEntity({ name: 'Test', value: 1 });
            const complexEvent = {
                type: 'ComplexEvent',
                timestamp: new Date(),
                payload: {
                    nested: {
                        data: [1, 2, 3],
                        metadata: { version: '1.0', tags: ['test', 'complex'] }
                    }
                },
                callback: () => 'test function'
            };
            // When
            entity.testAddDomainEvent(complexEvent);
            // Then
            const retrievedEvent = entity.domainEvents[0];
            expect(retrievedEvent.type).toBe('ComplexEvent');
            expect(retrievedEvent.payload.nested.data).toEqual([1, 2, 3]);
            expect(retrievedEvent.callback()).toBe('test function');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2tpdGVsZXYvRG9jdW1lbnRzL2V4b2NvcnRleC1vYnNpZGlhbi1wbHVnaW4vdGVzdHMvdW5pdC9kb21haW4vY29yZS9FbnRpdHkudGVzdC50cyIsIm1hcHBpbmdzIjoiOztBQUFBLCtEQUE0RDtBQUU1RDs7R0FFRztBQUNILE1BQU0sVUFBVyxTQUFRLGVBQXVDO0lBQzlELFlBQVksS0FBc0MsRUFBRSxFQUFvQjtRQUN0RSxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDYixJQUFJLENBQUMsR0FBRyxHQUFHLEVBQUUsSUFBSSxVQUFVLEdBQUcsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ3hFLENBQUM7SUFFRCxPQUFPO1FBQ0wsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQztJQUN6QixDQUFDO0lBRUQsUUFBUTtRQUNOLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUM7SUFDMUIsQ0FBQztJQUVELFVBQVUsQ0FBQyxJQUFZO1FBQ3JCLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztJQUN6QixDQUFDO0lBRUQsS0FBSztRQUNILE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQztJQUNsQixDQUFDO0lBRUQsdUNBQXVDO0lBQ2hDLGtCQUFrQixDQUFDLEtBQVU7UUFDbEMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUM3QixDQUFDO0lBRU0sbUJBQW1CO1FBQ3hCLE9BQU8sSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO0lBQ2hDLENBQUM7SUFFTSxxQkFBcUI7UUFDMUIsSUFBSSxDQUFDLGlCQUFpQixFQUFFLENBQUM7SUFDM0IsQ0FBQztDQUNGO0FBRUQsUUFBUSxDQUFDLFFBQVEsRUFBRSxHQUFHLEVBQUU7SUFDdEIsUUFBUSxDQUFDLGNBQWMsRUFBRSxHQUFHLEVBQUU7UUFDNUIsRUFB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RSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzlELE1BQU0sQ0FBQyxjQUFjLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUM7UUFDMUQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9raXRlbGV2L0RvY3VtZW50cy9leG9jb3J0ZXgtb2JzaWRpYW4tcGx1Z2luL3Rlc3RzL3VuaXQvZG9tYWluL2NvcmUvRW50aXR5LnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRW50aXR5IH0gZnJvbSAnLi4vLi4vLi4vLi4vc3JjL2RvbWFpbi9jb3JlL0VudGl0eSc7XG5cbi8qKlxuICogVGVzdCBpbXBsZW1lbnRhdGlvbiBvZiBFbnRpdHkgZm9yIHRlc3RpbmcgcHVycG9zZXNcbiAqL1xuY2xhc3MgVGVzdEVudGl0eSBleHRlbmRzIEVudGl0eTx7IG5hbWU6IHN0cmluZzsgdmFsdWU6IG51bWJlciB9PiB7XG4gIGNvbnN0cnVjdG9yKHByb3BzOiB7IG5hbWU6IHN0cmluZzsgdmFsdWU6IG51bWJlciB9LCBpZD86IHN0cmluZyB8IG51bWJlcikge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLl9pZCA9IGlkIHx8ICd0ZXN0LWlkLScgKyBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSk7XG4gIH1cblxuICBnZXROYW1lKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMucHJvcHMubmFtZTtcbiAgfVxuXG4gIGdldFZhbHVlKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMucHJvcHMudmFsdWU7XG4gIH1cblxuICB1cGRhdGVOYW1lKG5hbWU6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMucHJvcHMubmFtZSA9IG5hbWU7XG4gIH1cblxuICBnZXRJZCgpOiBzdHJpbmcgfCBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9pZDtcbiAgfVxuXG4gIC8vIEV4cG9zZSBwcm90ZWN0ZWQgbWV0aG9kcyBmb3IgdGVzdGluZ1xuICBwdWJsaWMgdGVzdEFkZERvbWFpbkV2ZW50KGV2ZW50OiBhbnkpOiB2b2lkIHtcbiAgICB0aGlzLmFkZERvbWFpbkV2ZW50KGV2ZW50KTtcbiAgfVxuXG4gIHB1YmxpYyB0ZXN0R2V0RG9tYWluRXZlbnRzKCk6IGFueVtdIHtcbiAgICByZXR1cm4gdGhpcy5nZXREb21haW5FdmVudHMoKTtcbiAgfVxuXG4gIHB1YmxpYyB0ZXN0Q2xlYXJEb21haW5FdmVudHMoKTogdm9pZCB7XG4gICAgdGhpcy5jbGVhckRvbWFpbkV2ZW50cygpO1xuICB9XG59XG5cbmRlc2NyaWJlKCdFbnRpdHknLCAoKSA9PiB7XG4gIGRlc2NyaWJlKCdDb25zdHJ1Y3Rpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgZW50aXR5IHdpdGggcHJvcHMnLCAoKSA9PiB7XG4gICAgICAvLyBHaXZlblxuICAgICAgY29uc3QgcHJvcHMgPSB7IG5hbWU6ICdUZXN0IEVudGl0eScsIHZhbHVlOiA0MiB9O1xuXG4gICAgICAvLyBXaGVuXG4gICAgICBjb25zdCBlbnRpdHkgPSBuZXcgVGVzdEVudGl0eShwcm9wcyk7XG5cbiAgICAgIC8vIFRoZW5cbiAgICAgIGV4cGVjdChlbnRpdHkuZ2V0TmFtZSgpKS50b0JlKCdUZXN0IEVudGl0eScpO1xuICAgICAgZXhwZWN0KGVudGl0eS5nZXRWYWx1ZSgpKS50b0JlKDQyKTtcbiAgICAgIGV4cGVjdChlbnRpdHkuZ2V0SWQoKSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY3JlYXRlIGVudGl0eSB3aXRoIGN1c3RvbSBpZCcsICgpID0+IHtcbiAgICAgIC8vIEdpdmVuXG4gICAgICBjb25zdCBwcm9wcyA9IHsgbmFtZTogJ1Rlc3QgRW50aXR5JywgdmFsdWU6IDQyIH07XG4gICAgICBjb25zdCBpZCA9ICdjdXN0b20taWQtMTIzJztcblxuICAgICAgLy8gV2hlblxuICAgICAgY29uc3QgZW50aXR5ID0gbmV3IFRlc3RFbnRpdHkocHJvcHMsIGlkKTtcblxuICAgICAgLy8gVGhlblxuICAgICAgZXhwZWN0KGVudGl0eS5nZXRJZCgpKS50b0JlKGlkKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaW5pdGlhbGl6ZSBlbXB0eSBkb21haW4gZXZlbnRzIGFycmF5JywgKCkgPT4ge1xuICAgICAgLy8gR2l2ZW5cbiAgICAgIGNvbnN0IGVudGl0eSA9IG5ldyBUZXN0RW50aXR5KHsgbmFtZTogJ1Rlc3QnLCB2YWx1ZTogMSB9KTtcblxuICAgICAgLy8gV2hlblxuICAgICAgY29uc3QgZXZlbnRzID0gZW50aXR5LmRvbWFpbkV2ZW50cztcblxuICAgICAgLy8gVGhlblxuICAgICAgZXhwZWN0KGV2ZW50cykudG9FcXVhbChbXSk7XG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShldmVudHMpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZXF1YWxzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIHRydWUgZm9yIGVudGl0aWVzIHdpdGggc2FtZSBpZCcsICgpID0+IHtcbiAgICAgIC8vIEdpdmVuXG4gICAgICBjb25zdCBpZCA9ICdzYW1lLWlkJztcbiAgICAgIGNvbnN0IGVudGl0eTEgPSBuZXcgVGVzdEVudGl0eSh7IG5hbWU6ICdFbnRpdHkgMScsIHZhbHVlOiAxIH0sIGlkKTtcbiAgICAgIGNvbnN0IGVudGl0eTIgPSBuZXcgVGVzdEVudGl0eSh7IG5hbWU6ICdFbnRpdHkgMicsIHZhbHVlOiAyIH0sIGlkKTtcblxuICAgICAgLy8gV2hlblxuICAgICAgY29uc3QgcmVzdWx0ID0gZW50aXR5MS5lcXVhbHMoZW50aXR5Mik7XG5cbiAgICAgIC8vIFRoZW5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBmYWxzZSBmb3IgZW50aXRpZXMgd2l0aCBkaWZmZXJlbnQgaWRzJywgKCkgPT4ge1xuICAgICAgLy8gR2l2ZW5cbiAgICAgIGNvbnN0IGVudGl0eTEgPSBuZXcgVGVzdEVudGl0eSh7IG5hbWU6ICdFbnRpdHkgMScsIHZhbHVlOiAxIH0sICdpZC0xJyk7XG4gICAgICBjb25zdCBlbnRpdHkyID0gbmV3IFRlc3RFbnRpdHkoeyBuYW1lOiAnRW50aXR5IDInLCB2YWx1ZTogMiB9LCAnaWQtMicpO1xuXG4gICAgICAvLyBXaGVuXG4gICAgICBjb25zdCByZXN1bHQgPSBlbnRpdHkxLmVxdWFscyhlbnRpdHkyKTtcblxuICAgICAgLy8gVGhlblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBmYWxzZSB3aGVuIGNvbXBhcmluZyB3aXRoIG51bGwnLCAoKSA9PiB7XG4gICAgICAvLyBHaXZlblxuICAgICAgY29uc3QgZW50aXR5ID0gbmV3IFRlc3RFbnRpdHkoeyBuYW1lOiAnVGVzdCcsIHZhbHVlOiAxIH0pO1xuXG4gICAgICAvLyBXaGVuXG4gICAgICBjb25zdCByZXN1bHQgPSBlbnRpdHkuZXF1YWxzKG51bGwgYXMgYW55KTtcblxuICAgICAgLy8gVGhlblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBmYWxzZSB3aGVuIGNvbXBhcmluZyB3aXRoIHVuZGVmaW5lZCcsICgpID0+IHtcbiAgICAgIC8vIEdpdmVuXG4gICAgICBjb25zdCBlbnRpdHkgPSBuZXcgVGVzdEVudGl0eSh7IG5hbWU6ICdUZXN0JywgdmFsdWU6IDEgfSk7XG5cbiAgICAgIC8vIFdoZW5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGVudGl0eS5lcXVhbHModW5kZWZpbmVkIGFzIGFueSk7XG5cbiAgICAgIC8vIFRoZW5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gdHJ1ZSB3aGVuIGNvbXBhcmluZyBlbnRpdHkgd2l0aCBpdHNlbGYnLCAoKSA9PiB7XG4gICAgICAvLyBHaXZlblxuICAgICAgY29uc3QgZW50aXR5ID0gbmV3IFRlc3RFbnRpdHkoeyBuYW1lOiAnVGVzdCcsIHZhbHVlOiAxIH0pO1xuXG4gICAgICAvLyBXaGVuXG4gICAgICBjb25zdCByZXN1bHQgPSBlbnRpdHkuZXF1YWxzKGVudGl0eSk7XG5cbiAgICAgIC8vIFRoZW5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBmYWxzZSB3aGVuIGNvbXBhcmluZyB3aXRoIG5vbi1lbnRpdHkgb2JqZWN0JywgKCkgPT4ge1xuICAgICAgLy8gR2l2ZW5cbiAgICAgIGNvbnN0IGVudGl0eSA9IG5ldyBUZXN0RW50aXR5KHsgbmFtZTogJ1Rlc3QnLCB2YWx1ZTogMSB9KTtcbiAgICAgIGNvbnN0IG5vbkVudGl0eSA9IHsgX2lkOiBlbnRpdHkuZ2V0SWQoKSB9IGFzIGFueTtcblxuICAgICAgLy8gV2hlblxuICAgICAgY29uc3QgcmVzdWx0ID0gZW50aXR5LmVxdWFscyhub25FbnRpdHkpO1xuXG4gICAgICAvLyBUaGVuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHN0cmluZyBhbmQgbnVtYmVyIGlkcyBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICAvLyBHaXZlblxuICAgICAgY29uc3Qgc3RyaW5nSWRFbnRpdHkgPSBuZXcgVGVzdEVudGl0eSh7IG5hbWU6ICdUZXN0JywgdmFsdWU6IDEgfSwgJ3N0cmluZy1pZCcpO1xuICAgICAgY29uc3QgbnVtYmVySWRFbnRpdHkgPSBuZXcgVGVzdEVudGl0eSh7IG5hbWU6ICdUZXN0JywgdmFsdWU6IDEgfSwgMTIzKTtcbiAgICAgIGNvbnN0IHNhbWVTdHJpbmdJZEVudGl0eSA9IG5ldyBUZXN0RW50aXR5KHsgbmFtZTogJ1Rlc3QnLCB2YWx1ZTogMSB9LCAnc3RyaW5nLWlkJyk7XG4gICAgICBjb25zdCBzYW1lTnVtYmVySWRFbnRpdHkgPSBuZXcgVGVzdEVudGl0eSh7IG5hbWU6ICdUZXN0JywgdmFsdWU6IDEgfSwgMTIzKTtcblxuICAgICAgLy8gV2hlbiAmIFRoZW5cbiAgICAgIGV4cGVjdChzdHJpbmdJZEVudGl0eS5lcXVhbHMoc2FtZVN0cmluZ0lkRW50aXR5KSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChudW1iZXJJZEVudGl0eS5lcXVhbHMoc2FtZU51bWJlcklkRW50aXR5KSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChzdHJpbmdJZEVudGl0eS5lcXVhbHMobnVtYmVySWRFbnRpdHkpKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0RvbWFpbiBFdmVudHMnLCAoKSA9PiB7XG4gICAgbGV0IGVudGl0eTogVGVzdEVudGl0eTtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgZW50aXR5ID0gbmV3IFRlc3RFbnRpdHkoeyBuYW1lOiAnVGVzdCBFbnRpdHknLCB2YWx1ZTogNDIgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFkZCBkb21haW4gZXZlbnQnLCAoKSA9PiB7XG4gICAgICAvLyBHaXZlblxuICAgICAgY29uc3QgZXZlbnQgPSB7IHR5cGU6ICdUZXN0RXZlbnQnLCBkYXRhOiB7IHRlc3Q6IHRydWUgfSB9O1xuXG4gICAgICAvLyBXaGVuXG4gICAgICBlbnRpdHkudGVzdEFkZERvbWFpbkV2ZW50KGV2ZW50KTtcblxuICAgICAgLy8gVGhlblxuICAgICAgZXhwZWN0KGVudGl0eS5kb21haW5FdmVudHMpLnRvQ29udGFpbihldmVudCk7XG4gICAgICBleHBlY3QoZW50aXR5LmRvbWFpbkV2ZW50cy5sZW5ndGgpLnRvQmUoMSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFkZCBtdWx0aXBsZSBkb21haW4gZXZlbnRzJywgKCkgPT4ge1xuICAgICAgLy8gR2l2ZW5cbiAgICAgIGNvbnN0IGV2ZW50MSA9IHsgdHlwZTogJ0V2ZW50MScsIGRhdGE6IHsgdmFsdWU6IDEgfSB9O1xuICAgICAgY29uc3QgZXZlbnQyID0geyB0eXBlOiAnRXZlbnQyJywgZGF0YTogeyB2YWx1ZTogMiB9IH07XG4gICAgICBjb25zdCBldmVudDMgPSB7IHR5cGU6ICdFdmVudDMnLCBkYXRhOiB7IHZhbHVlOiAzIH0gfTtcblxuICAgICAgLy8gV2hlblxuICAgICAgZW50aXR5LnRlc3RBZGREb21haW5FdmVudChldmVudDEpO1xuICAgICAgZW50aXR5LnRlc3RBZGREb21haW5FdmVudChldmVudDIpO1xuICAgICAgZW50aXR5LnRlc3RBZGREb21haW5FdmVudChldmVudDMpO1xuXG4gICAgICAvLyBUaGVuXG4gICAgICBleHBlY3QoZW50aXR5LmRvbWFpbkV2ZW50cykudG9FcXVhbChbZXZlbnQxLCBldmVudDIsIGV2ZW50M10pO1xuICAgICAgZXhwZWN0KGVudGl0eS5kb21haW5FdmVudHMubGVuZ3RoKS50b0JlKDMpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBnZXQgZG9tYWluIGV2ZW50cyB2aWEgcHJvdGVjdGVkIG1ldGhvZCcsICgpID0+IHtcbiAgICAgIC8vIEdpdmVuXG4gICAgICBjb25zdCBldmVudCA9IHsgdHlwZTogJ1Rlc3RFdmVudCcgfTtcbiAgICAgIGVudGl0eS50ZXN0QWRkRG9tYWluRXZlbnQoZXZlbnQpO1xuXG4gICAgICAvLyBXaGVuXG4gICAgICBjb25zdCBldmVudHMgPSBlbnRpdHkudGVzdEdldERvbWFpbkV2ZW50cygpO1xuXG4gICAgICAvLyBUaGVuXG4gICAgICBleHBlY3QoZXZlbnRzKS50b0NvbnRhaW4oZXZlbnQpO1xuICAgICAgZXhwZWN0KGV2ZW50cykudG9CZShlbnRpdHkuZG9tYWluRXZlbnRzKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2xlYXIgZXZlbnRzIHZpYSBwdWJsaWMgbWV0aG9kJywgKCkgPT4ge1xuICAgICAgLy8gR2l2ZW5cbiAgICAgIGVudGl0eS50ZXN0QWRkRG9tYWluRXZlbnQoeyB0eXBlOiAnRXZlbnQxJyB9KTtcbiAgICAgIGVudGl0eS50ZXN0QWRkRG9tYWluRXZlbnQoeyB0eXBlOiAnRXZlbnQyJyB9KTtcbiAgICAgIGV4cGVjdChlbnRpdHkuZG9tYWluRXZlbnRzLmxlbmd0aCkudG9CZSgyKTtcblxuICAgICAgLy8gV2hlblxuICAgICAgZW50aXR5LmNsZWFyRXZlbnRzKCk7XG5cbiAgICAgIC8vIFRoZW5cbiAgICAgIGV4cGVjdChlbnRpdHkuZG9tYWluRXZlbnRzKS50b0VxdWFsKFtdKTtcbiAgICAgIGV4cGVjdChlbnRpdHkuZG9tYWluRXZlbnRzLmxlbmd0aCkudG9CZSgwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2xlYXIgZXZlbnRzIHZpYSBwcm90ZWN0ZWQgbWV0aG9kJywgKCkgPT4ge1xuICAgICAgLy8gR2l2ZW5cbiAgICAgIGVudGl0eS50ZXN0QWRkRG9tYWluRXZlbnQoeyB0eXBlOiAnRXZlbnQxJyB9KTtcbiAgICAgIGVudGl0eS50ZXN0QWRkRG9tYWluRXZlbnQoeyB0eXBlOiAnRXZlbnQyJyB9KTtcbiAgICAgIGV4cGVjdChlbnRpdHkuZG9tYWluRXZlbnRzLmxlbmd0aCkudG9CZSgyKTtcblxuICAgICAgLy8gV2hlblxuICAgICAgZW50aXR5LnRlc3RDbGVhckRvbWFpbkV2ZW50cygpO1xuXG4gICAgICAvLyBUaGVuXG4gICAgICBleHBlY3QoZW50aXR5LmRvbWFpbkV2ZW50cykudG9FcXVhbChbXSk7XG4gICAgICBleHBlY3QoZW50aXR5LmRvbWFpbkV2ZW50cy5sZW5ndGgpLnRvQmUoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBudWxsIGFuZCB1bmRlZmluZWQgZXZlbnRzJywgKCkgPT4ge1xuICAgICAgLy8gR2l2ZW4gJiBXaGVuXG4gICAgICBlbnRpdHkudGVzdEFkZERvbWFpbkV2ZW50KG51bGwpO1xuICAgICAgZW50aXR5LnRlc3RBZGREb21haW5FdmVudCh1bmRlZmluZWQpO1xuXG4gICAgICAvLyBUaGVuXG4gICAgICBleHBlY3QoZW50aXR5LmRvbWFpbkV2ZW50cykudG9FcXVhbChbbnVsbCwgdW5kZWZpbmVkXSk7XG4gICAgICBleHBlY3QoZW50aXR5LmRvbWFpbkV2ZW50cy5sZW5ndGgpLnRvQmUoMik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByZXNlcnZlIGV2ZW50IHJlZmVyZW5jZXMnLCAoKSA9PiB7XG4gICAgICAvLyBHaXZlblxuICAgICAgY29uc3QgZXZlbnQgPSB7IHR5cGU6ICdUZXN0RXZlbnQnLCBtdXRhYmxlOiB0cnVlIH07XG4gICAgICBlbnRpdHkudGVzdEFkZERvbWFpbkV2ZW50KGV2ZW50KTtcblxuICAgICAgLy8gV2hlblxuICAgICAgZXZlbnQubXV0YWJsZSA9IGZhbHNlO1xuXG4gICAgICAvLyBUaGVuXG4gICAgICBleHBlY3QoZW50aXR5LmRvbWFpbkV2ZW50c1swXSkudG9CZShldmVudCk7XG4gICAgICBleHBlY3QoZW50aXR5LmRvbWFpbkV2ZW50c1swXS5tdXRhYmxlKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbWFpbnRhaW4gZXZlbnQgb3JkZXInLCAoKSA9PiB7XG4gICAgICAvLyBHaXZlblxuICAgICAgY29uc3QgZXZlbnRzID0gW107XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgICAgZXZlbnRzLnB1c2goeyB0eXBlOiBgRXZlbnQke2l9YCwgb3JkZXI6IGkgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFdoZW5cbiAgICAgIGV2ZW50cy5mb3JFYWNoKGV2ZW50ID0+IGVudGl0eS50ZXN0QWRkRG9tYWluRXZlbnQoZXZlbnQpKTtcblxuICAgICAgLy8gVGhlblxuICAgICAgZW50aXR5LmRvbWFpbkV2ZW50cy5mb3JFYWNoKChldmVudCwgaW5kZXgpID0+IHtcbiAgICAgICAgZXhwZWN0KGV2ZW50Lm9yZGVyKS50b0JlKGluZGV4KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRW50aXR5IFByb3BlcnRpZXMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBwcm90ZWN0IHByb3BzIGZyb20gZXh0ZXJuYWwgbW9kaWZpY2F0aW9uJywgKCkgPT4ge1xuICAgICAgLy8gR2l2ZW5cbiAgICAgIGNvbnN0IGVudGl0eSA9IG5ldyBUZXN0RW50aXR5KHsgbmFtZTogJ09yaWdpbmFsJywgdmFsdWU6IDEwMCB9KTtcbiAgICAgIFxuICAgICAgLy8gV2hlbiAtIHRyeSB0byBtb2RpZnkgcHJvcHMgZGlyZWN0bHkgKHNob3VsZCBub3QgYmUgcG9zc2libGUpXG4gICAgICAvLyBwcm9wcyBpcyBwcm90ZWN0ZWQsIHNvIHRoaXMgaXMgbW9yZSBvZiBhIGRlc2lnbiB2ZXJpZmljYXRpb25cblxuICAgICAgLy8gVGhlblxuICAgICAgZXhwZWN0KGVudGl0eS5nZXROYW1lKCkpLnRvQmUoJ09yaWdpbmFsJyk7XG4gICAgICBleHBlY3QoZW50aXR5LmdldFZhbHVlKCkpLnRvQmUoMTAwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYWxsb3cgY29udHJvbGxlZCBwcm9wIHVwZGF0ZXMgdmlhIG1ldGhvZHMnLCAoKSA9PiB7XG4gICAgICAvLyBHaXZlblxuICAgICAgY29uc3QgZW50aXR5ID0gbmV3IFRlc3RFbnRpdHkoeyBuYW1lOiAnT3JpZ2luYWwnLCB2YWx1ZTogMTAwIH0pO1xuXG4gICAgICAvLyBXaGVuXG4gICAgICBlbnRpdHkudXBkYXRlTmFtZSgnVXBkYXRlZCcpO1xuXG4gICAgICAvLyBUaGVuXG4gICAgICBleHBlY3QoZW50aXR5LmdldE5hbWUoKSkudG9CZSgnVXBkYXRlZCcpO1xuICAgICAgZXhwZWN0KGVudGl0eS5nZXRWYWx1ZSgpKS50b0JlKDEwMCk7IC8vIE90aGVyIHByb3BzIHVuY2hhbmdlZFxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBtYWludGFpbiBwcm9wIGludGVncml0eScsICgpID0+IHtcbiAgICAgIC8vIEdpdmVuXG4gICAgICBjb25zdCBwcm9wcyA9IHsgbmFtZTogJ1Rlc3QnLCB2YWx1ZTogNDIgfTtcbiAgICAgIGNvbnN0IGVudGl0eSA9IG5ldyBUZXN0RW50aXR5KHByb3BzKTtcblxuICAgICAgLy8gV2hlbiAtIG1vZGlmeSBvcmlnaW5hbCBwcm9wcyBvYmplY3RcbiAgICAgIHByb3BzLm5hbWUgPSAnTW9kaWZpZWQnO1xuICAgICAgcHJvcHMudmFsdWUgPSA5OTk7XG5cbiAgICAgIC8vIFRoZW4gLSBlbnRpdHkgc2hvdWxkIGJlIGFmZmVjdGVkIHNpbmNlIGl0IHNoYXJlcyByZWZlcmVuY2VcbiAgICAgIGV4cGVjdChlbnRpdHkuZ2V0TmFtZSgpKS50b0JlKCdNb2RpZmllZCcpO1xuICAgICAgZXhwZWN0KGVudGl0eS5nZXRWYWx1ZSgpKS50b0JlKDk5OSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdFbnRpdHkgTGlmZWN5Y2xlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgbWFpbnRhaW4gaWQgdGhyb3VnaG91dCBsaWZlY3ljbGUnLCAoKSA9PiB7XG4gICAgICAvLyBHaXZlblxuICAgICAgY29uc3QgZW50aXR5ID0gbmV3IFRlc3RFbnRpdHkoeyBuYW1lOiAnVGVzdCcsIHZhbHVlOiAxIH0sICdwZXJzaXN0ZW50LWlkJyk7XG4gICAgICBjb25zdCBvcmlnaW5hbElkID0gZW50aXR5LmdldElkKCk7XG5cbiAgICAgIC8vIFdoZW4gLSBwZXJmb3JtIHZhcmlvdXMgb3BlcmF0aW9uc1xuICAgICAgZW50aXR5LnVwZGF0ZU5hbWUoJ1VwZGF0ZWQnKTtcbiAgICAgIGVudGl0eS50ZXN0QWRkRG9tYWluRXZlbnQoeyB0eXBlOiAnRXZlbnQnIH0pO1xuICAgICAgZW50aXR5LmNsZWFyRXZlbnRzKCk7XG5cbiAgICAgIC8vIFRoZW5cbiAgICAgIGV4cGVjdChlbnRpdHkuZ2V0SWQoKSkudG9CZShvcmlnaW5hbElkKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYWxsb3cgZXZlbnQgbWFuYWdlbWVudCB0aHJvdWdob3V0IGxpZmVjeWNsZScsICgpID0+IHtcbiAgICAgIC8vIEdpdmVuXG4gICAgICBjb25zdCBlbnRpdHkgPSBuZXcgVGVzdEVudGl0eSh7IG5hbWU6ICdUZXN0JywgdmFsdWU6IDEgfSk7XG5cbiAgICAgIC8vIFdoZW4gLSBzaW11bGF0ZSBsaWZlY3ljbGUgb3BlcmF0aW9uc1xuICAgICAgZW50aXR5LnRlc3RBZGREb21haW5FdmVudCh7IHR5cGU6ICdDcmVhdGVkJyB9KTtcbiAgICAgIGV4cGVjdChlbnRpdHkuZG9tYWluRXZlbnRzLmxlbmd0aCkudG9CZSgxKTtcblxuICAgICAgZW50aXR5LnVwZGF0ZU5hbWUoJ1VwZGF0ZWQnKTtcbiAgICAgIGVudGl0eS50ZXN0QWRkRG9tYWluRXZlbnQoeyB0eXBlOiAnVXBkYXRlZCcgfSk7XG4gICAgICBleHBlY3QoZW50aXR5LmRvbWFpbkV2ZW50cy5sZW5ndGgpLnRvQmUoMik7XG5cbiAgICAgIGVudGl0eS5jbGVhckV2ZW50cygpO1xuICAgICAgZXhwZWN0KGVudGl0eS5kb21haW5FdmVudHMubGVuZ3RoKS50b0JlKDApO1xuXG4gICAgICBlbnRpdHkudGVzdEFkZERvbWFpbkV2ZW50KHsgdHlwZTogJ0ZpbmFsJyB9KTtcbiAgICAgIGV4cGVjdChlbnRpdHkuZG9tYWluRXZlbnRzLmxlbmd0aCkudG9CZSgxKTtcblxuICAgICAgLy8gVGhlbiAtIGFsbCBvcGVyYXRpb25zIHNob3VsZCB3b3JrIGNvcnJlY3RseVxuICAgICAgZXhwZWN0KGVudGl0eS5nZXROYW1lKCkpLnRvQmUoJ1VwZGF0ZWQnKTtcbiAgICAgIGV4cGVjdChlbnRpdHkuZG9tYWluRXZlbnRzWzBdLnR5cGUpLnRvQmUoJ0ZpbmFsJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdFZGdlIENhc2VzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IHByb3BzIG9iamVjdCcsICgpID0+IHtcbiAgICAgIC8vIEdpdmVuXG4gICAgICBjb25zdCBwcm9wcyA9IHt9IGFzIGFueTtcblxuICAgICAgLy8gV2hlblxuICAgICAgY29uc3QgZW50aXR5ID0gbmV3IFRlc3RFbnRpdHkocHJvcHMpO1xuXG4gICAgICAvLyBUaGVuXG4gICAgICBleHBlY3QoZW50aXR5LmdldE5hbWUoKSkudG9CZVVuZGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGVudGl0eS5nZXRWYWx1ZSgpKS50b0JlVW5kZWZpbmVkKCk7XG4gICAgICBleHBlY3QoZW50aXR5LmdldElkKCkpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBwcm9wcyB3aXRoIHNwZWNpYWwgY2hhcmFjdGVycycsICgpID0+IHtcbiAgICAgIC8vIEdpdmVuXG4gICAgICBjb25zdCBwcm9wcyA9IHsgbmFtZTogJ0VudGl0eSB3aXRoIFwicXVvdGVzXCIgYW5kIFxcbm5ld2xpbmVzJywgdmFsdWU6IC00Mi41IH07XG5cbiAgICAgIC8vIFdoZW5cbiAgICAgIGNvbnN0IGVudGl0eSA9IG5ldyBUZXN0RW50aXR5KHByb3BzKTtcblxuICAgICAgLy8gVGhlblxuICAgICAgZXhwZWN0KGVudGl0eS5nZXROYW1lKCkpLnRvQmUoJ0VudGl0eSB3aXRoIFwicXVvdGVzXCIgYW5kIFxcbm5ld2xpbmVzJyk7XG4gICAgICBleHBlY3QoZW50aXR5LmdldFZhbHVlKCkpLnRvQmUoLTQyLjUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgdmVyeSBsYXJnZSBkb21haW4gZXZlbnQgYXJyYXlzJywgKCkgPT4ge1xuICAgICAgLy8gR2l2ZW5cbiAgICAgIGNvbnN0IGVudGl0eSA9IG5ldyBUZXN0RW50aXR5KHsgbmFtZTogJ1Rlc3QnLCB2YWx1ZTogMSB9KTtcbiAgICAgIGNvbnN0IGV2ZW50Q291bnQgPSAxMDAwO1xuXG4gICAgICAvLyBXaGVuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGV2ZW50Q291bnQ7IGkrKykge1xuICAgICAgICBlbnRpdHkudGVzdEFkZERvbWFpbkV2ZW50KHsgdHlwZTogYEV2ZW50JHtpfWAsIGluZGV4OiBpIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBUaGVuXG4gICAgICBleHBlY3QoZW50aXR5LmRvbWFpbkV2ZW50cy5sZW5ndGgpLnRvQmUoZXZlbnRDb3VudCk7XG4gICAgICBleHBlY3QoZW50aXR5LmRvbWFpbkV2ZW50c1swXS5pbmRleCkudG9CZSgwKTtcbiAgICAgIGV4cGVjdChlbnRpdHkuZG9tYWluRXZlbnRzW2V2ZW50Q291bnQgLSAxXS5pbmRleCkudG9CZShldmVudENvdW50IC0gMSk7XG5cbiAgICAgIC8vIENsZWFyIHNob3VsZCB3b3JrIHdpdGggbGFyZ2UgYXJyYXlzXG4gICAgICBlbnRpdHkuY2xlYXJFdmVudHMoKTtcbiAgICAgIGV4cGVjdChlbnRpdHkuZG9tYWluRXZlbnRzLmxlbmd0aCkudG9CZSgwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbXBsZXggZXZlbnQgb2JqZWN0cycsICgpID0+IHtcbiAgICAgIC8vIEdpdmVuXG4gICAgICBjb25zdCBlbnRpdHkgPSBuZXcgVGVzdEVudGl0eSh7IG5hbWU6ICdUZXN0JywgdmFsdWU6IDEgfSk7XG4gICAgICBjb25zdCBjb21wbGV4RXZlbnQgPSB7XG4gICAgICAgIHR5cGU6ICdDb21wbGV4RXZlbnQnLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgIHBheWxvYWQ6IHtcbiAgICAgICAgICBuZXN0ZWQ6IHtcbiAgICAgICAgICAgIGRhdGE6IFsxLCAyLCAzXSxcbiAgICAgICAgICAgIG1ldGFkYXRhOiB7IHZlcnNpb246ICcxLjAnLCB0YWdzOiBbJ3Rlc3QnLCAnY29tcGxleCddIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGNhbGxiYWNrOiAoKSA9PiAndGVzdCBmdW5jdGlvbidcbiAgICAgIH07XG5cbiAgICAgIC8vIFdoZW5cbiAgICAgIGVudGl0eS50ZXN0QWRkRG9tYWluRXZlbnQoY29tcGxleEV2ZW50KTtcblxuICAgICAgLy8gVGhlblxuICAgICAgY29uc3QgcmV0cmlldmVkRXZlbnQgPSBlbnRpdHkuZG9tYWluRXZlbnRzWzBdO1xuICAgICAgZXhwZWN0KHJldHJpZXZlZEV2ZW50LnR5cGUpLnRvQmUoJ0NvbXBsZXhFdmVudCcpO1xuICAgICAgZXhwZWN0KHJldHJpZXZlZEV2ZW50LnBheWxvYWQubmVzdGVkLmRhdGEpLnRvRXF1YWwoWzEsIDIsIDNdKTtcbiAgICAgIGV4cGVjdChyZXRyaWV2ZWRFdmVudC5jYWxsYmFjaygpKS50b0JlKCd0ZXN0IGZ1bmN0aW9uJyk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sInZlcnNpb24iOjN9