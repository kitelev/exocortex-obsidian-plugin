3684c26991fc55b89937faa0797d9c97
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.TaskStatus = exports.TaskStatusType = void 0;
const Result_1 = require("../core/Result");
var TaskStatusType;
(function (TaskStatusType) {
    TaskStatusType["TODO"] = "todo";
    TaskStatusType["IN_PROGRESS"] = "in-progress";
    TaskStatusType["WAITING"] = "waiting";
    TaskStatusType["DONE"] = "done";
    TaskStatusType["CANCELLED"] = "cancelled";
})(TaskStatusType = exports.TaskStatusType || (exports.TaskStatusType = {}));
/**
 * Value object representing task status
 * Immutable and self-validating with state transition rules
 */
class TaskStatus {
    constructor(status) {
        this.status = status;
    }
    static create(value) {
        if (!value) {
            return Result_1.Result.fail('TaskStatus cannot be empty');
        }
        const normalizedValue = typeof value === 'string' ? value.toLowerCase().replace('_', '-') : value;
        if (!Object.values(TaskStatusType).includes(normalizedValue)) {
            return Result_1.Result.fail('TaskStatus must be one of: todo, in-progress, waiting, done, cancelled');
        }
        return Result_1.Result.ok(new TaskStatus(normalizedValue));
    }
    static todo() {
        return new TaskStatus(TaskStatusType.TODO);
    }
    static inProgress() {
        return new TaskStatus(TaskStatusType.IN_PROGRESS);
    }
    static waiting() {
        return new TaskStatus(TaskStatusType.WAITING);
    }
    static done() {
        return new TaskStatus(TaskStatusType.DONE);
    }
    static cancelled() {
        return new TaskStatus(TaskStatusType.CANCELLED);
    }
    getStatus() {
        return this.status;
    }
    toString() {
        return this.status;
    }
    equals(other) {
        return this.status === other.status;
    }
    /**
     * Checks if transition to another status is valid
     */
    canTransitionTo(newStatus) {
        const validTransitions = {
            [TaskStatusType.TODO]: [TaskStatusType.IN_PROGRESS, TaskStatusType.WAITING, TaskStatusType.DONE, TaskStatusType.CANCELLED],
            [TaskStatusType.IN_PROGRESS]: [TaskStatusType.TODO, TaskStatusType.WAITING, TaskStatusType.DONE, TaskStatusType.CANCELLED],
            [TaskStatusType.WAITING]: [TaskStatusType.TODO, TaskStatusType.IN_PROGRESS, TaskStatusType.DONE, TaskStatusType.CANCELLED],
            [TaskStatusType.DONE]: [TaskStatusType.TODO],
            [TaskStatusType.CANCELLED]: [TaskStatusType.TODO] // Can reactivate cancelled tasks
        };
        return validTransitions[this.status].includes(newStatus.status);
    }
    /**
     * Returns if the task is in an active state (not done or cancelled)
     */
    isActive() {
        return this.status === TaskStatusType.TODO ||
            this.status === TaskStatusType.IN_PROGRESS ||
            this.status === TaskStatusType.WAITING;
    }
    /**
     * Returns if the task is completed
     */
    isCompleted() {
        return this.status === TaskStatusType.DONE;
    }
    /**
     * Returns if the task is cancelled
     */
    isCancelled() {
        return this.status === TaskStatusType.CANCELLED;
    }
    /**
     * Returns if the task is in progress
     */
    isInProgress() {
        return this.status === TaskStatusType.IN_PROGRESS;
    }
    /**
     * Returns markdown checkbox representation
     */
    toMarkdownCheckbox() {
        switch (this.status) {
            case TaskStatusType.TODO: return '- [ ]';
            case TaskStatusType.IN_PROGRESS: return '- [/]';
            case TaskStatusType.WAITING: return '- [-]';
            case TaskStatusType.DONE: return '- [x]';
            case TaskStatusType.CANCELLED: return '- [~]';
        }
    }
    /**
     * Creates TaskStatus from markdown checkbox
     */
    static fromMarkdownCheckbox(checkbox) {
        const trimmed = checkbox.trim();
        if (trimmed === '- [ ]')
            return Result_1.Result.ok(TaskStatus.todo());
        if (trimmed === '- [/]')
            return Result_1.Result.ok(TaskStatus.inProgress());
        if (trimmed === '- [-]')
            return Result_1.Result.ok(TaskStatus.waiting());
        if (trimmed === '- [x]' || trimmed === '- [X]')
            return Result_1.Result.ok(TaskStatus.done());
        if (trimmed === '- [~]')
            return Result_1.Result.ok(TaskStatus.cancelled());
        return Result_1.Result.fail('Invalid markdown checkbox format');
    }
}
exports.TaskStatus = TaskStatus;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2tpdGVsZXYvRG9jdW1lbnRzL2V4b2NvcnRleC1vYnNpZGlhbi1wbHVnaW4vc3JjL2RvbWFpbi92YWx1ZS1vYmplY3RzL1Rhc2tTdGF0dXMudHMiLCJtYXBwaW5ncyI6Ijs7O0FBQUEsMkNBQXdDO0FBRXhDLElBQVksY0FNWDtBQU5ELFdBQVksY0FBYztJQUN4QiwrQkFBYSxDQUFBO0lBQ2IsNkNBQTJCLENBQUE7SUFDM0IscUNBQW1CLENBQUE7SUFDbkIsK0JBQWEsQ0FBQTtJQUNiLHlDQUF1QixDQUFBO0FBQ3pCLENBQUMsRUFOVyxjQUFjLEdBQWQsc0JBQWMsS0FBZCxzQkFBYyxRQU16QjtBQUVEOzs7R0FHRztBQUNILE1BQWEsVUFBVTtJQUdyQixZQUFvQixNQUFzQjtRQUN4QyxJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztJQUN2QixDQUFDO0lBRUQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxLQUE4QjtRQUMxQyxJQUFJLENBQUMsS0FBSyxFQUFFO1lBQ1YsT0FBTyxlQUFNLENBQUMsSUFBSSxDQUFhLDRCQUE0QixDQUFDLENBQUM7U0FDOUQ7UUFFRCxNQUFNLGVBQWUsR0FBRyxPQUFPLEtBQUssS0FBSyxRQUFRLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxXQUFXLEVBQUUsQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUM7UUFFbEcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsUUFBUSxDQUFDLGVBQWlDLENBQUMsRUFBRTtZQUM5RSxPQUFPLGVBQU0sQ0FBQyxJQUFJLENBQWEsd0VBQXdFLENBQUMsQ0FBQztTQUMxRztRQUVELE9BQU8sZUFBTSxDQUFDLEVBQUUsQ0FBYSxJQUFJLFVBQVUsQ0FBQyxlQUFpQyxDQUFDLENBQUMsQ0FBQztJQUNsRixDQUFDO0lBRUQsTUFBTSxDQUFDLElBQUk7UUFDVCxPQUFPLElBQUksVUFBVSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENB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QztZQUM1QyxLQUFLLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxPQUFPLE9BQU8sQ0FBQztZQUN6QyxLQUFLLGNBQWMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxPQUFPLE9BQU8sQ0FBQztTQUMvQztJQUNILENBQUM7SUFFRDs7T0FFRztJQUNILE1BQU0sQ0FBQyxvQkFBb0IsQ0FBQyxRQUFnQjtRQUMxQyxNQUFNLE9BQU8sR0FBRyxRQUFRLENBQUMsSUFBSSxFQUFFLENBQUM7UUFFaEMsSUFBSSxPQUFPLEtBQUssT0FBTztZQUFFLE9BQU8sZUFBTSxDQUFDLEVBQUUsQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQztRQUM3RCxJQUFJLE9BQU8sS0FBSyxPQUFPO1lBQUUsT0FBTyxlQUFNLENBQUMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUFDO1FBQ25FLElBQUksT0FBTyxLQUFLLE9BQU87WUFBRSxPQUFPLGVBQU0sQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUM7UUFDaEUsSUFBSSxPQUFPLEtBQUssT0FBTyxJQUFJLE9BQU8sS0FBSyxPQUFPO1lBQUUsT0FBTyxlQUFNLENBQUMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO1FBQ3BGLElBQUksT0FBTyxLQUFLLE9BQU87WUFBRSxPQUFPLGVBQU0sQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLFNBQVMsRUFBRSxDQUFDLENBQUM7UUFFbEUsT0FBTyxlQUFNLENBQUMsSUFBSSxDQUFhLGtDQUFrQyxDQUFDLENBQUM7SUFDckUsQ0FBQztDQUNGO0FBN0hELGdDQTZIQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMva2l0ZWxldi9Eb2N1bWVudHMvZXhvY29ydGV4LW9ic2lkaWFuLXBsdWdpbi9zcmMvZG9tYWluL3ZhbHVlLW9iamVjdHMvVGFza1N0YXR1cy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSZXN1bHQgfSBmcm9tICcuLi9jb3JlL1Jlc3VsdCc7XG5cbmV4cG9ydCBlbnVtIFRhc2tTdGF0dXNUeXBlIHtcbiAgVE9ETyA9ICd0b2RvJyxcbiAgSU5fUFJPR1JFU1MgPSAnaW4tcHJvZ3Jlc3MnLFxuICBXQUlUSU5HID0gJ3dhaXRpbmcnLFxuICBET05FID0gJ2RvbmUnLFxuICBDQU5DRUxMRUQgPSAnY2FuY2VsbGVkJ1xufVxuXG4vKipcbiAqIFZhbHVlIG9iamVjdCByZXByZXNlbnRpbmcgdGFzayBzdGF0dXNcbiAqIEltbXV0YWJsZSBhbmQgc2VsZi12YWxpZGF0aW5nIHdpdGggc3RhdGUgdHJhbnNpdGlvbiBydWxlc1xuICovXG5leHBvcnQgY2xhc3MgVGFza1N0YXR1cyB7XG4gIHByaXZhdGUgcmVhZG9ubHkgc3RhdHVzOiBUYXNrU3RhdHVzVHlwZTtcblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKHN0YXR1czogVGFza1N0YXR1c1R5cGUpIHtcbiAgICB0aGlzLnN0YXR1cyA9IHN0YXR1cztcbiAgfVxuXG4gIHN0YXRpYyBjcmVhdGUodmFsdWU6IHN0cmluZyB8IFRhc2tTdGF0dXNUeXBlKTogUmVzdWx0PFRhc2tTdGF0dXM+IHtcbiAgICBpZiAoIXZhbHVlKSB7XG4gICAgICByZXR1cm4gUmVzdWx0LmZhaWw8VGFza1N0YXR1cz4oJ1Rhc2tTdGF0dXMgY2Fubm90IGJlIGVtcHR5Jyk7XG4gICAgfVxuXG4gICAgY29uc3Qgbm9ybWFsaXplZFZhbHVlID0gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyA/IHZhbHVlLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgnXycsICctJykgOiB2YWx1ZTtcbiAgICBcbiAgICBpZiAoIU9iamVjdC52YWx1ZXMoVGFza1N0YXR1c1R5cGUpLmluY2x1ZGVzKG5vcm1hbGl6ZWRWYWx1ZSBhcyBUYXNrU3RhdHVzVHlwZSkpIHtcbiAgICAgIHJldHVybiBSZXN1bHQuZmFpbDxUYXNrU3RhdHVzPignVGFza1N0YXR1cyBtdXN0IGJlIG9uZSBvZjogdG9kbywgaW4tcHJvZ3Jlc3MsIHdhaXRpbmcsIGRvbmUsIGNhbmNlbGxlZCcpO1xuICAgIH1cblxuICAgIHJldHVybiBSZXN1bHQub2s8VGFza1N0YXR1cz4obmV3IFRhc2tTdGF0dXMobm9ybWFsaXplZFZhbHVlIGFzIFRhc2tTdGF0dXNUeXBlKSk7XG4gIH1cblxuICBzdGF0aWMgdG9kbygpOiBUYXNrU3RhdHVzIHtcbiAgICByZXR1cm4gbmV3IFRhc2tTdGF0dXMoVGFza1N0YXR1c1R5cGUuVE9ETyk7XG4gIH1cblxuICBzdGF0aWMgaW5Qcm9ncmVzcygpOiBUYXNrU3RhdHVzIHtcbiAgICByZXR1cm4gbmV3IFRhc2tTdGF0dXMoVGFza1N0YXR1c1R5cGUuSU5fUFJPR1JFU1MpO1xuICB9XG5cbiAgc3RhdGljIHdhaXRpbmcoKTogVGFza1N0YXR1cyB7XG4gICAgcmV0dXJuIG5ldyBUYXNrU3RhdHVzKFRhc2tTdGF0dXNUeXBlLldBSVRJTkcpO1xuICB9XG5cbiAgc3RhdGljIGRvbmUoKTogVGFza1N0YXR1cyB7XG4gICAgcmV0dXJuIG5ldyBUYXNrU3RhdHVzKFRhc2tTdGF0dXNUeXBlLkRPTkUpO1xuICB9XG5cbiAgc3RhdGljIGNhbmNlbGxlZCgpOiBUYXNrU3RhdHVzIHtcbiAgICByZXR1cm4gbmV3IFRhc2tTdGF0dXMoVGFza1N0YXR1c1R5cGUuQ0FOQ0VMTEVEKTtcbiAgfVxuXG4gIGdldFN0YXR1cygpOiBUYXNrU3RhdHVzVHlwZSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdHVzO1xuICB9XG5cbiAgdG9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0dXM7XG4gIH1cblxuICBlcXVhbHMob3RoZXI6IFRhc2tTdGF0dXMpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0dXMgPT09IG90aGVyLnN0YXR1cztcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVja3MgaWYgdHJhbnNpdGlvbiB0byBhbm90aGVyIHN0YXR1cyBpcyB2YWxpZFxuICAgKi9cbiAgY2FuVHJhbnNpdGlvblRvKG5ld1N0YXR1czogVGFza1N0YXR1cyk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHZhbGlkVHJhbnNpdGlvbnM6IFJlY29yZDxUYXNrU3RhdHVzVHlwZSwgVGFza1N0YXR1c1R5cGVbXT4gPSB7XG4gICAgICBbVGFza1N0YXR1c1R5cGUuVE9ET106IFtUYXNrU3RhdHVzVHlwZS5JTl9QUk9HUkVTUywgVGFza1N0YXR1c1R5cGUuV0FJVElORywgVGFza1N0YXR1c1R5cGUuRE9ORSwgVGFza1N0YXR1c1R5cGUuQ0FOQ0VMTEVEXSxcbiAgICAgIFtUYXNrU3RhdHVzVHlwZS5JTl9QUk9HUkVTU106IFtUYXNrU3RhdHVzVHlwZS5UT0RPLCBUYXNrU3RhdHVzVHlwZS5XQUlUSU5HLCBUYXNrU3RhdHVzVHlwZS5ET05FLCBUYXNrU3RhdHVzVHlwZS5DQU5DRUxMRURdLFxuICAgICAgW1Rhc2tTdGF0dXNUeXBlLldBSVRJTkddOiBbVGFza1N0YXR1c1R5cGUuVE9ETywgVGFza1N0YXR1c1R5cGUuSU5fUFJPR1JFU1MsIFRhc2tTdGF0dXNUeXBlLkRPTkUsIFRhc2tTdGF0dXNUeXBlLkNBTkNFTExFRF0sXG4gICAgICBbVGFza1N0YXR1c1R5cGUuRE9ORV06IFtUYXNrU3RhdHVzVHlwZS5UT0RPXSwgLy8gQ2FuIHJlb3BlbiBjb21wbGV0ZWQgdGFza3NcbiAgICAgIFtUYXNrU3RhdHVzVHlwZS5DQU5DRUxMRURdOiBbVGFza1N0YXR1c1R5cGUuVE9ET10gLy8gQ2FuIHJlYWN0aXZhdGUgY2FuY2VsbGVkIHRhc2tzXG4gICAgfTtcblxuICAgIHJldHVybiB2YWxpZFRyYW5zaXRpb25zW3RoaXMuc3RhdHVzXS5pbmNsdWRlcyhuZXdTdGF0dXMuc3RhdHVzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGlmIHRoZSB0YXNrIGlzIGluIGFuIGFjdGl2ZSBzdGF0ZSAobm90IGRvbmUgb3IgY2FuY2VsbGVkKVxuICAgKi9cbiAgaXNBY3RpdmUoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdHVzID09PSBUYXNrU3RhdHVzVHlwZS5UT0RPIHx8IFxuICAgICAgICAgICB0aGlzLnN0YXR1cyA9PT0gVGFza1N0YXR1c1R5cGUuSU5fUFJPR1JFU1MgfHwgXG4gICAgICAgICAgIHRoaXMuc3RhdHVzID09PSBUYXNrU3RhdHVzVHlwZS5XQUlUSU5HO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgaWYgdGhlIHRhc2sgaXMgY29tcGxldGVkXG4gICAqL1xuICBpc0NvbXBsZXRlZCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0dXMgPT09IFRhc2tTdGF0dXNUeXBlLkRPTkU7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBpZiB0aGUgdGFzayBpcyBjYW5jZWxsZWRcbiAgICovXG4gIGlzQ2FuY2VsbGVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnN0YXR1cyA9PT0gVGFza1N0YXR1c1R5cGUuQ0FOQ0VMTEVEO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgaWYgdGhlIHRhc2sgaXMgaW4gcHJvZ3Jlc3NcbiAgICovXG4gIGlzSW5Qcm9ncmVzcygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0dXMgPT09IFRhc2tTdGF0dXNUeXBlLklOX1BST0dSRVNTO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgbWFya2Rvd24gY2hlY2tib3ggcmVwcmVzZW50YXRpb25cbiAgICovXG4gIHRvTWFya2Rvd25DaGVja2JveCgpOiBzdHJpbmcge1xuICAgIHN3aXRjaCAodGhpcy5zdGF0dXMpIHtcbiAgICAgIGNhc2UgVGFza1N0YXR1c1R5cGUuVE9ETzogcmV0dXJuICctIFsgXSc7XG4gICAgICBjYXNlIFRhc2tTdGF0dXNUeXBlLklOX1BST0dSRVNTOiByZXR1cm4gJy0gWy9dJztcbiAgICAgIGNhc2UgVGFza1N0YXR1c1R5cGUuV0FJVElORzogcmV0dXJuICctIFstXSc7XG4gICAgICBjYXNlIFRhc2tTdGF0dXNUeXBlLkRPTkU6IHJldHVybiAnLSBbeF0nO1xuICAgICAgY2FzZSBUYXNrU3RhdHVzVHlwZS5DQU5DRUxMRUQ6IHJldHVybiAnLSBbfl0nO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIFRhc2tTdGF0dXMgZnJvbSBtYXJrZG93biBjaGVja2JveFxuICAgKi9cbiAgc3RhdGljIGZyb21NYXJrZG93bkNoZWNrYm94KGNoZWNrYm94OiBzdHJpbmcpOiBSZXN1bHQ8VGFza1N0YXR1cz4ge1xuICAgIGNvbnN0IHRyaW1tZWQgPSBjaGVja2JveC50cmltKCk7XG4gICAgXG4gICAgaWYgKHRyaW1tZWQgPT09ICctIFsgXScpIHJldHVybiBSZXN1bHQub2soVGFza1N0YXR1cy50b2RvKCkpO1xuICAgIGlmICh0cmltbWVkID09PSAnLSBbL10nKSByZXR1cm4gUmVzdWx0Lm9rKFRhc2tTdGF0dXMuaW5Qcm9ncmVzcygpKTtcbiAgICBpZiAodHJpbW1lZCA9PT0gJy0gWy1dJykgcmV0dXJuIFJlc3VsdC5vayhUYXNrU3RhdHVzLndhaXRpbmcoKSk7XG4gICAgaWYgKHRyaW1tZWQgPT09ICctIFt4XScgfHwgdHJpbW1lZCA9PT0gJy0gW1hdJykgcmV0dXJuIFJlc3VsdC5vayhUYXNrU3RhdHVzLmRvbmUoKSk7XG4gICAgaWYgKHRyaW1tZWQgPT09ICctIFt+XScpIHJldHVybiBSZXN1bHQub2soVGFza1N0YXR1cy5jYW5jZWxsZWQoKSk7XG4gICAgXG4gICAgcmV0dXJuIFJlc3VsdC5mYWlsPFRhc2tTdGF0dXM+KCdJbnZhbGlkIG1hcmtkb3duIGNoZWNrYm94IGZvcm1hdCcpO1xuICB9XG59Il0sInZlcnNpb24iOjN9