db34a2e806f6ef5edb75022fc6d054bb
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Task_1 = require("../../../../src/domain/entities/Task");
const TaskId_1 = require("../../../../src/domain/value-objects/TaskId");
const Priority_1 = require("../../../../src/domain/value-objects/Priority");
const TaskStatus_1 = require("../../../../src/domain/value-objects/TaskStatus");
const AssetId_1 = require("../../../../src/domain/value-objects/AssetId");
describe('Task', () => {
    describe('create', () => {
        it('should create a task with valid parameters', () => {
            const result = Task_1.Task.create({
                title: 'Test Task',
                description: 'A test task',
                priority: Priority_1.Priority.high()
            });
            expect(result.isSuccess).toBe(true);
            const task = result.getValue();
            expect(task.getTitle()).toBe('Test Task');
            expect(task.getDescription()).toBe('A test task');
            expect(task.getPriority().toString()).toBe('high');
            expect(task.getStatus().toString()).toBe('todo');
        });
        it('should create task with default values', () => {
            const result = Task_1.Task.create({
                title: 'Minimal Task'
            });
            expect(result.isSuccess).toBe(true);
            const task = result.getValue();
            expect(task.getTitle()).toBe('Minimal Task');
            expect(task.getPriority().toString()).toBe('medium');
            expect(task.getStatus().toString()).toBe('todo');
            expect(task.getTags()).toEqual([]);
        });
        it('should reject empty title', () => {
            const result = Task_1.Task.create({
                title: ''
            });
            expect(result.isFailure).toBe(true);
            expect(result.error).toBe('Task title cannot be empty');
        });
        it('should reject title that is too long', () => {
            const longTitle = 'a'.repeat(201);
            const result = Task_1.Task.create({
                title: longTitle
            });
            expect(result.isFailure).toBe(true);
            expect(result.error).toBe('Task title cannot exceed 200 characters');
        });
        it('should reject negative estimated hours', () => {
            const result = Task_1.Task.create({
                title: 'Test Task',
                estimatedHours: -1
            });
            expect(result.isFailure).toBe(true);
            expect(result.error).toBe('Estimated hours cannot be negative');
        });
        it('should trim title', () => {
            const result = Task_1.Task.create({
                title: '  Test Task  '
            });
            expect(result.isSuccess).toBe(true);
            expect(result.getValue().getTitle()).toBe('Test Task');
        });
    });
    describe('business methods', () => {
        let task;
        beforeEach(() => {
            task = Task_1.Task.create({
                title: 'Test Task',
                description: 'A test task'
            }).getValue();
        });
        describe('updateTitle', () => {
            it('should update title successfully', () => {
                const result = task.updateTitle('Updated Title');
                expect(result.isSuccess).toBe(true);
                expect(task.getTitle()).toBe('Updated Title');
            });
            it('should reject empty title', () => {
                const result = task.updateTitle('');
                expect(result.isFailure).toBe(true);
                expect(result.error).toBe('Task title cannot be empty');
            });
        });
        describe('updateStatus', () => {
            it('should update status with valid transition', () => {
                const result = task.updateStatus(TaskStatus_1.TaskStatus.inProgress());
                expect(result.isSuccess).toBe(true);
                expect(task.getStatus().toString()).toBe('in-progress');
            });
            it('should set completion date when task is completed', () => {
                const beforeCompletion = new Date();
                const result = task.updateStatus(TaskStatus_1.TaskStatus.done());
                expect(result.isSuccess).toBe(true);
                expect(task.getStatus().isCompleted()).toBe(true);
                expect(task.getCompletedAt()).toBeDefined();
                expect(task.getCompletedAt().getTime()).toBeGreaterThanOrEqual(beforeCompletion.getTime());
            });
            it('should clear completion date when task is reopened', () => {
                task.updateStatus(TaskStatus_1.TaskStatus.done());
                expect(task.getCompletedAt()).toBeDefined();
                task.updateStatus(TaskStatus_1.TaskStatus.todo());
                expect(task.getCompletedAt()).toBeUndefined();
            });
        });
        describe('project assignment', () => {
            it('should assign task to project', () => {
                const projectId = AssetId_1.AssetId.generate();
                task.assignToProject(projectId);
                expect(task.getProjectId()).toBeDefined();
                expect(task.getProjectId().equals(projectId)).toBe(true);
            });
            it('should remove task from project', () => {
                const projectId = AssetId_1.AssetId.generate();
                task.assignToProject(projectId);
                task.removeFromProject();
                expect(task.getProjectId()).toBeUndefined();
            });
        });
        describe('tag management', () => {
            it('should add tags', () => {
                task.addTag('urgent');
                task.addTag('backend');
                expect(task.getTags()).toContain('urgent');
                expect(task.getTags()).toContain('backend');
            });
            it('should normalize tag case', () => {
                task.addTag('URGENT');
                expect(task.getTags()).toContain('urgent');
                expect(task.hasTag('urgent')).toBe(true);
            });
            it('should not add duplicate tags', () => {
                task.addTag('urgent');
                task.addTag('urgent');
                expect(task.getTags().filter(tag => tag === 'urgent')).toHaveLength(1);
            });
            it('should remove tags', () => {
                task.addTag('urgent');
                task.removeTag('urgent');
                expect(task.getTags()).not.toContain('urgent');
            });
        });
    });
    describe('query methods', () => {
        it('should identify overdue tasks', () => {
            const pastDate = new Date();
            pastDate.setDate(pastDate.getDate() - 1);
            const task = Task_1.Task.create({
                title: 'Overdue Task',
                dueDate: pastDate
            }).getValue();
            expect(task.isOverdue()).toBe(true);
        });
        it('should identify tasks due today', () => {
            const today = new Date();
            const task = Task_1.Task.create({
                title: 'Due Today',
                dueDate: today
            }).getValue();
            expect(task.isDueToday()).toBe(true);
        });
        it('should identify high priority tasks', () => {
            const highPriorityTask = Task_1.Task.create({
                title: 'High Priority',
                priority: Priority_1.Priority.high()
            }).getValue();
            const mediumPriorityTask = Task_1.Task.create({
                title: 'Medium Priority',
                priority: Priority_1.Priority.medium()
            }).getValue();
            expect(highPriorityTask.isHighPriority()).toBe(true);
            expect(mediumPriorityTask.isHighPriority()).toBe(false);
        });
    });
    describe('frontmatter serialization', () => {
        it('should serialize to frontmatter', () => {
            const projectId = AssetId_1.AssetId.generate();
            const task = Task_1.Task.create({
                title: 'Test Task',
                description: 'A test task',
                priority: Priority_1.Priority.high(),
                projectId: projectId,
                estimatedHours: 4,
                tags: ['urgent', 'backend']
            }).getValue();
            const frontmatter = task.toFrontmatter();
            expect(frontmatter['exo__Task_title']).toBe('Test Task');
            expect(frontmatter['exo__Task_description']).toBe('A test task');
            expect(frontmatter['exo__Task_priority']).toBe('high');
            expect(frontmatter['exo__Task_status']).toBe('todo');
            expect(frontmatter['exo__Effort_parent']).toBe(`[[${projectId.toString()}]]`);
            expect(frontmatter['exo__Task_estimatedHours']).toBe(4);
            expect(frontmatter['exo__Task_tags']).toEqual(['urgent', 'backend']);
        });
        it('should deserialize from frontmatter', () => {
            const projectId = AssetId_1.AssetId.generate();
            const frontmatter = {
                'exo__Task_uid': TaskId_1.TaskId.generate().toString(),
                'exo__Task_title': 'Test Task',
                'exo__Task_description': 'A test task',
                'exo__Task_priority': 'high',
                'exo__Task_status': 'in-progress',
                'exo__Effort_parent': `[[${projectId.toString()}]]`,
                'exo__Task_estimatedHours': 4,
                'exo__Task_tags': ['urgent', 'backend']
            };
            const task = Task_1.Task.fromFrontmatter(frontmatter, 'test-task.md');
            expect(task).not.toBeNull();
            expect(task.getTitle()).toBe('Test Task');
            expect(task.getDescription()).toBe('A test task');
            expect(task.getPriority().toString()).toBe('high');
            expect(task.getStatus().toString()).toBe('in-progress');
            expect(task.getProjectId().toString()).toBe(projectId.toString());
            expect(task.getEstimatedHours()).toBe(4);
            expect(task.getTags()).toEqual(['urgent', 'backend']);
        });
    });
    describe('markdown generation', () => {
        it('should generate markdown content', () => {
            const task = Task_1.Task.create({
                title: 'Test Task',
                description: 'A test task',
                priority: Priority_1.Priority.high(),
                tags: ['urgent']
            }).getValue();
            const markdown = task.toMarkdown();
            expect(markdown).toContain('# Test Task');
            expect(markdown).toContain('A test task');
            expect(markdown).toContain('**Priority**: high');
            expect(markdown).toContain('**Status**: todo');
            expect(markdown).toContain('#urgent');
            expect(markdown).toContain('- [ ]'); // Todo checkbox
        });
    });
    describe('equals', () => {
        it('should return true for tasks with same ID', () => {
            const taskId = TaskId_1.TaskId.generate();
            const task1 = Task_1.Task.create({ title: 'Task 1' }).getValue();
            const task2 = Task_1.Task.create({ title: 'Task 2' }).getValue();
            // Set same ID for both tasks
            task1.props.id = taskId;
            task2.props.id = taskId;
            expect(task1.equals(task2)).toBe(true);
        });
        it('should return false for tasks with different IDs', () => {
            const task1 = Task_1.Task.create({ title: 'Task 1' }).getValue();
            const task2 = Task_1.Task.create({ title: 'Task 2' }).getValue();
            expect(task1.equals(task2)).toBe(false);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2tpdGVsZXYvRG9jdW1lbnRzL2V4b2NvcnRleC1vYnNpZGlhbi1wbHVnaW4vdGVzdHMvdW5pdC9kb21haW4vZW50aXRpZXMvVGFzay50ZXN0LnRzIiwibWFwcGluZ3MiOiI7O0FBQUEsK0RBQTREO0FBQzVELHdFQUFxRTtBQUNyRSw0RUFBeUU7QUFDekUsZ0ZBQTZFO0FBQzdFLDBFQUF1RTtBQUV2RSxRQUFRLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRTtJQUNwQixRQUFRLENBQUMsUUFBUSxFQUFFLEdBQUcsRUFBRTtRQUN0QixFQUFFLENBQUMsNENBQTRDLEVBQUUsR0FBRyxFQUFFO1lBQ3BELE1BQU0sTUFBTSxHQUFHLFdBQUksQ0FBQyxNQUFNLENBQUM7Z0JBQ3pCLEtBQUssRUFBRSxXQUFXO2dCQUNsQixXQUFXLEVBQUUsYUFBYTtnQkFDMUIsUUFBUSxFQUFFLG1CQUFRLENBQUMsSUFBSSxFQUFFO2FBQzFCLENBQUMsQ0FBQztZQUVILE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3BDLE1BQU0sSUFBSSxHQUFHLE1BQU0sQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUMvQixNQUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQzFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7WUFDbEQsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUNuRCxNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ25ELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHdDQUF3QyxFQUFF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LFdBQUksQ0FBQyxNQUFNLENBQUMsRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFFLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUMxRCxNQUFNLEtBQUssR0FBRyxXQUFJLENBQUMsTUFBTSxDQUFDLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRSxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUM7WUFFMUQsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDMUMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9raXRlbGV2L0RvY3VtZW50cy9leG9jb3J0ZXgtb2JzaWRpYW4tcGx1Z2luL3Rlc3RzL3VuaXQvZG9tYWluL2VudGl0aWVzL1Rhc2sudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUYXNrIH0gZnJvbSAnLi4vLi4vLi4vLi4vc3JjL2RvbWFpbi9lbnRpdGllcy9UYXNrJztcbmltcG9ydCB7IFRhc2tJZCB9IGZyb20gJy4uLy4uLy4uLy4uL3NyYy9kb21haW4vdmFsdWUtb2JqZWN0cy9UYXNrSWQnO1xuaW1wb3J0IHsgUHJpb3JpdHkgfSBmcm9tICcuLi8uLi8uLi8uLi9zcmMvZG9tYWluL3ZhbHVlLW9iamVjdHMvUHJpb3JpdHknO1xuaW1wb3J0IHsgVGFza1N0YXR1cyB9IGZyb20gJy4uLy4uLy4uLy4uL3NyYy9kb21haW4vdmFsdWUtb2JqZWN0cy9UYXNrU3RhdHVzJztcbmltcG9ydCB7IEFzc2V0SWQgfSBmcm9tICcuLi8uLi8uLi8uLi9zcmMvZG9tYWluL3ZhbHVlLW9iamVjdHMvQXNzZXRJZCc7XG5cbmRlc2NyaWJlKCdUYXNrJywgKCkgPT4ge1xuICBkZXNjcmliZSgnY3JlYXRlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY3JlYXRlIGEgdGFzayB3aXRoIHZhbGlkIHBhcmFtZXRlcnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBUYXNrLmNyZWF0ZSh7XG4gICAgICAgIHRpdGxlOiAnVGVzdCBUYXNrJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdBIHRlc3QgdGFzaycsXG4gICAgICAgIHByaW9yaXR5OiBQcmlvcml0eS5oaWdoKClcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmlzU3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGNvbnN0IHRhc2sgPSByZXN1bHQuZ2V0VmFsdWUoKTtcbiAgICAgIGV4cGVjdCh0YXNrLmdldFRpdGxlKCkpLnRvQmUoJ1Rlc3QgVGFzaycpO1xuICAgICAgZXhwZWN0KHRhc2suZ2V0RGVzY3JpcHRpb24oKSkudG9CZSgnQSB0ZXN0IHRhc2snKTtcbiAgICAgIGV4cGVjdCh0YXNrLmdldFByaW9yaXR5KCkudG9TdHJpbmcoKSkudG9CZSgnaGlnaCcpO1xuICAgICAgZXhwZWN0KHRhc2suZ2V0U3RhdHVzKCkudG9TdHJpbmcoKSkudG9CZSgndG9kbycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgdGFzayB3aXRoIGRlZmF1bHQgdmFsdWVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gVGFzay5jcmVhdGUoe1xuICAgICAgICB0aXRsZTogJ01pbmltYWwgVGFzaydcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmlzU3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGNvbnN0IHRhc2sgPSByZXN1bHQuZ2V0VmFsdWUoKTtcbiAgICAgIGV4cGVjdCh0YXNrLmdldFRpdGxlKCkpLnRvQmUoJ01pbmltYWwgVGFzaycpO1xuICAgICAgZXhwZWN0KHRhc2suZ2V0UHJpb3JpdHkoKS50b1N0cmluZygpKS50b0JlKCdtZWRpdW0nKTtcbiAgICAgIGV4cGVjdCh0YXNrLmdldFN0YXR1cygpLnRvU3RyaW5nKCkpLnRvQmUoJ3RvZG8nKTtcbiAgICAgIGV4cGVjdCh0YXNrLmdldFRhZ3MoKSkudG9FcXVhbChbXSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCBlbXB0eSB0aXRsZScsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IFRhc2suY3JlYXRlKHtcbiAgICAgICAgdGl0bGU6ICcnXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5pc0ZhaWx1cmUpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yKS50b0JlKCdUYXNrIHRpdGxlIGNhbm5vdCBiZSBlbXB0eScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgdGl0bGUgdGhhdCBpcyB0b28gbG9uZycsICgpID0+IHtcbiAgICAgIGNvbnN0IGxvbmdUaXRsZSA9ICdhJy5yZXBlYXQoMjAxKTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IFRhc2suY3JlYXRlKHtcbiAgICAgICAgdGl0bGU6IGxvbmdUaXRsZVxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuaXNGYWlsdXJlKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcikudG9CZSgnVGFzayB0aXRsZSBjYW5ub3QgZXhjZWVkIDIwMCBjaGFyYWN0ZXJzJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCBuZWdhdGl2ZSBlc3RpbWF0ZWQgaG91cnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBUYXNrLmNyZWF0ZSh7XG4gICAgICAgIHRpdGxlOiAnVGVzdCBUYXNrJyxcbiAgICAgICAgZXN0aW1hdGVkSG91cnM6IC0xXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5pc0ZhaWx1cmUpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yKS50b0JlKCdFc3RpbWF0ZWQgaG91cnMgY2Fubm90IGJlIG5lZ2F0aXZlJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRyaW0gdGl0bGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBUYXNrLmNyZWF0ZSh7XG4gICAgICAgIHRpdGxlOiAnICBUZXN0IFRhc2sgICdcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmlzU3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZ2V0VmFsdWUoKS5nZXRUaXRsZSgpKS50b0JlKCdUZXN0IFRhc2snKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2J1c2luZXNzIG1ldGhvZHMnLCAoKSA9PiB7XG4gICAgbGV0IHRhc2s6IFRhc2s7XG5cbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgIHRhc2sgPSBUYXNrLmNyZWF0ZSh7XG4gICAgICAgIHRpdGxlOiAnVGVzdCBUYXNrJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdBIHRlc3QgdGFzaydcbiAgICAgIH0pLmdldFZhbHVlKCk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgndXBkYXRlVGl0bGUnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIHVwZGF0ZSB0aXRsZSBzdWNjZXNzZnVsbHknLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHRhc2sudXBkYXRlVGl0bGUoJ1VwZGF0ZWQgVGl0bGUnKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LmlzU3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KHRhc2suZ2V0VGl0bGUoKSkudG9CZSgnVXBkYXRlZCBUaXRsZScpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgcmVqZWN0IGVtcHR5IHRpdGxlJywgKCkgPT4ge1xuICAgICAgICBjb25zdCByZXN1bHQgPSB0YXNrLnVwZGF0ZVRpdGxlKCcnKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LmlzRmFpbHVyZSkudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcikudG9CZSgnVGFzayB0aXRsZSBjYW5ub3QgYmUgZW1wdHknKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ3VwZGF0ZVN0YXR1cycsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgdXBkYXRlIHN0YXR1cyB3aXRoIHZhbGlkIHRyYW5zaXRpb24nLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHRhc2sudXBkYXRlU3RhdHVzKFRhc2tTdGF0dXMuaW5Qcm9ncmVzcygpKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LmlzU3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KHRhc2suZ2V0U3RhdHVzKCkudG9TdHJpbmcoKSkudG9CZSgnaW4tcHJvZ3Jlc3MnKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHNldCBjb21wbGV0aW9uIGRhdGUgd2hlbiB0YXNrIGlzIGNvbXBsZXRlZCcsICgpID0+IHtcbiAgICAgICAgY29uc3QgYmVmb3JlQ29tcGxldGlvbiA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHRhc2sudXBkYXRlU3RhdHVzKFRhc2tTdGF0dXMuZG9uZSgpKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LmlzU3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KHRhc2suZ2V0U3RhdHVzKCkuaXNDb21wbGV0ZWQoKSkudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KHRhc2suZ2V0Q29tcGxldGVkQXQoKSkudG9CZURlZmluZWQoKTtcbiAgICAgICAgZXhwZWN0KHRhc2suZ2V0Q29tcGxldGVkQXQoKSEuZ2V0VGltZSgpKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKGJlZm9yZUNvbXBsZXRpb24uZ2V0VGltZSgpKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGNsZWFyIGNvbXBsZXRpb24gZGF0ZSB3aGVuIHRhc2sgaXMgcmVvcGVuZWQnLCAoKSA9PiB7XG4gICAgICAgIHRhc2sudXBkYXRlU3RhdHVzKFRhc2tTdGF0dXMuZG9uZSgpKTtcbiAgICAgICAgZXhwZWN0KHRhc2suZ2V0Q29tcGxldGVkQXQoKSkudG9CZURlZmluZWQoKTtcblxuICAgICAgICB0YXNrLnVwZGF0ZVN0YXR1cyhUYXNrU3RhdHVzLnRvZG8oKSk7XG4gICAgICAgIGV4cGVjdCh0YXNrLmdldENvbXBsZXRlZEF0KCkpLnRvQmVVbmRlZmluZWQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ3Byb2plY3QgYXNzaWdubWVudCcsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgYXNzaWduIHRhc2sgdG8gcHJvamVjdCcsICgpID0+IHtcbiAgICAgICAgY29uc3QgcHJvamVjdElkID0gQXNzZXRJZC5nZW5lcmF0ZSgpO1xuICAgICAgICBcbiAgICAgICAgdGFzay5hc3NpZ25Ub1Byb2plY3QocHJvamVjdElkKTtcblxuICAgICAgICBleHBlY3QodGFzay5nZXRQcm9qZWN0SWQoKSkudG9CZURlZmluZWQoKTtcbiAgICAgICAgZXhwZWN0KHRhc2suZ2V0UHJvamVjdElkKCkhLmVxdWFscyhwcm9qZWN0SWQpKS50b0JlKHRydWUpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgcmVtb3ZlIHRhc2sgZnJvbSBwcm9qZWN0JywgKCkgPT4ge1xuICAgICAgICBjb25zdCBwcm9qZWN0SWQgPSBBc3NldElkLmdlbmVyYXRlKCk7XG4gICAgICAgIHRhc2suYXNzaWduVG9Qcm9qZWN0KHByb2plY3RJZCk7XG5cbiAgICAgICAgdGFzay5yZW1vdmVGcm9tUHJvamVjdCgpO1xuXG4gICAgICAgIGV4cGVjdCh0YXNrLmdldFByb2plY3RJZCgpKS50b0JlVW5kZWZpbmVkKCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCd0YWcgbWFuYWdlbWVudCcsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgYWRkIHRhZ3MnLCAoKSA9PiB7XG4gICAgICAgIHRhc2suYWRkVGFnKCd1cmdlbnQnKTtcbiAgICAgICAgdGFzay5hZGRUYWcoJ2JhY2tlbmQnKTtcblxuICAgICAgICBleHBlY3QodGFzay5nZXRUYWdzKCkpLnRvQ29udGFpbigndXJnZW50Jyk7XG4gICAgICAgIGV4cGVjdCh0YXNrLmdldFRhZ3MoKSkudG9Db250YWluKCdiYWNrZW5kJyk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBub3JtYWxpemUgdGFnIGNhc2UnLCAoKSA9PiB7XG4gICAgICAgIHRhc2suYWRkVGFnKCdVUkdFTlQnKTtcblxuICAgICAgICBleHBlY3QodGFzay5nZXRUYWdzKCkpLnRvQ29udGFpbigndXJnZW50Jyk7XG4gICAgICAgIGV4cGVjdCh0YXNrLmhhc1RhZygndXJnZW50JykpLnRvQmUodHJ1ZSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBub3QgYWRkIGR1cGxpY2F0ZSB0YWdzJywgKCkgPT4ge1xuICAgICAgICB0YXNrLmFkZFRhZygndXJnZW50Jyk7XG4gICAgICAgIHRhc2suYWRkVGFnKCd1cmdlbnQnKTtcblxuICAgICAgICBleHBlY3QodGFzay5nZXRUYWdzKCkuZmlsdGVyKHRhZyA9PiB0YWcgPT09ICd1cmdlbnQnKSkudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgcmVtb3ZlIHRhZ3MnLCAoKSA9PiB7XG4gICAgICAgIHRhc2suYWRkVGFnKCd1cmdlbnQnKTtcbiAgICAgICAgdGFzay5yZW1vdmVUYWcoJ3VyZ2VudCcpO1xuXG4gICAgICAgIGV4cGVjdCh0YXNrLmdldFRhZ3MoKSkubm90LnRvQ29udGFpbigndXJnZW50Jyk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3F1ZXJ5IG1ldGhvZHMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBpZGVudGlmeSBvdmVyZHVlIHRhc2tzJywgKCkgPT4ge1xuICAgICAgY29uc3QgcGFzdERhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgcGFzdERhdGUuc2V0RGF0ZShwYXN0RGF0ZS5nZXREYXRlKCkgLSAxKTtcblxuICAgICAgY29uc3QgdGFzayA9IFRhc2suY3JlYXRlKHtcbiAgICAgICAgdGl0bGU6ICdPdmVyZHVlIFRhc2snLFxuICAgICAgICBkdWVEYXRlOiBwYXN0RGF0ZVxuICAgICAgfSkuZ2V0VmFsdWUoKTtcblxuICAgICAgZXhwZWN0KHRhc2suaXNPdmVyZHVlKCkpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGlkZW50aWZ5IHRhc2tzIGR1ZSB0b2RheScsICgpID0+IHtcbiAgICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKTtcblxuICAgICAgY29uc3QgdGFzayA9IFRhc2suY3JlYXRlKHtcbiAgICAgICAgdGl0bGU6ICdEdWUgVG9kYXknLFxuICAgICAgICBkdWVEYXRlOiB0b2RheVxuICAgICAgfSkuZ2V0VmFsdWUoKTtcblxuICAgICAgZXhwZWN0KHRhc2suaXNEdWVUb2RheSgpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBpZGVudGlmeSBoaWdoIHByaW9yaXR5IHRhc2tzJywgKCkgPT4ge1xuICAgICAgY29uc3QgaGlnaFByaW9yaXR5VGFzayA9IFRhc2suY3JlYXRlKHtcbiAgICAgICAgdGl0bGU6ICdIaWdoIFByaW9yaXR5JyxcbiAgICAgICAgcHJpb3JpdHk6IFByaW9yaXR5LmhpZ2goKVxuICAgICAgfSkuZ2V0VmFsdWUoKTtcblxuICAgICAgY29uc3QgbWVkaXVtUHJpb3JpdHlUYXNrID0gVGFzay5jcmVhdGUoe1xuICAgICAgICB0aXRsZTogJ01lZGl1bSBQcmlvcml0eScsXG4gICAgICAgIHByaW9yaXR5OiBQcmlvcml0eS5tZWRpdW0oKVxuICAgICAgfSkuZ2V0VmFsdWUoKTtcblxuICAgICAgZXhwZWN0KGhpZ2hQcmlvcml0eVRhc2suaXNIaWdoUHJpb3JpdHkoKSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChtZWRpdW1Qcmlvcml0eVRhc2suaXNIaWdoUHJpb3JpdHkoKSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmcm9udG1hdHRlciBzZXJpYWxpemF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgc2VyaWFsaXplIHRvIGZyb250bWF0dGVyJywgKCkgPT4ge1xuICAgICAgY29uc3QgcHJvamVjdElkID0gQXNzZXRJZC5nZW5lcmF0ZSgpO1xuICAgICAgY29uc3QgdGFzayA9IFRhc2suY3JlYXRlKHtcbiAgICAgICAgdGl0bGU6ICdUZXN0IFRhc2snLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0EgdGVzdCB0YXNrJyxcbiAgICAgICAgcHJpb3JpdHk6IFByaW9yaXR5LmhpZ2goKSxcbiAgICAgICAgcHJvamVjdElkOiBwcm9qZWN0SWQsXG4gICAgICAgIGVzdGltYXRlZEhvdXJzOiA0LFxuICAgICAgICB0YWdzOiBbJ3VyZ2VudCcsICdiYWNrZW5kJ11cbiAgICAgIH0pLmdldFZhbHVlKCk7XG5cbiAgICAgIGNvbnN0IGZyb250bWF0dGVyID0gdGFzay50b0Zyb250bWF0dGVyKCk7XG5cbiAgICAgIGV4cGVjdChmcm9udG1hdHRlclsnZXhvX19UYXNrX3RpdGxlJ10pLnRvQmUoJ1Rlc3QgVGFzaycpO1xuICAgICAgZXhwZWN0KGZyb250bWF0dGVyWydleG9fX1Rhc2tfZGVzY3JpcHRpb24nXSkudG9CZSgnQSB0ZXN0IHRhc2snKTtcbiAgICAgIGV4cGVjdChmcm9udG1hdHRlclsnZXhvX19UYXNrX3ByaW9yaXR5J10pLnRvQmUoJ2hpZ2gnKTtcbiAgICAgIGV4cGVjdChmcm9udG1hdHRlclsnZXhvX19UYXNrX3N0YXR1cyddKS50b0JlKCd0b2RvJyk7XG4gICAgICBleHBlY3QoZnJvbnRtYXR0ZXJbJ2V4b19fRWZmb3J0X3BhcmVudCddKS50b0JlKGBbWyR7cHJvamVjdElkLnRvU3RyaW5nKCl9XV1gKTtcbiAgICAgIGV4cGVjdChmcm9udG1hdHRlclsnZXhvX19UYXNrX2VzdGltYXRlZEhvdXJzJ10pLnRvQmUoNCk7XG4gICAgICBleHBlY3QoZnJvbnRtYXR0ZXJbJ2V4b19fVGFza190YWdzJ10pLnRvRXF1YWwoWyd1cmdlbnQnLCAnYmFja2VuZCddKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGVzZXJpYWxpemUgZnJvbSBmcm9udG1hdHRlcicsICgpID0+IHtcbiAgICAgIGNvbnN0IHByb2plY3RJZCA9IEFzc2V0SWQuZ2VuZXJhdGUoKTtcbiAgICAgIGNvbnN0IGZyb250bWF0dGVyID0ge1xuICAgICAgICAnZXhvX19UYXNrX3VpZCc6IFRhc2tJZC5nZW5lcmF0ZSgpLnRvU3RyaW5nKCksXG4gICAgICAgICdleG9fX1Rhc2tfdGl0bGUnOiAnVGVzdCBUYXNrJyxcbiAgICAgICAgJ2V4b19fVGFza19kZXNjcmlwdGlvbic6ICdBIHRlc3QgdGFzaycsXG4gICAgICAgICdleG9fX1Rhc2tfcHJpb3JpdHknOiAnaGlnaCcsXG4gICAgICAgICdleG9fX1Rhc2tfc3RhdHVzJzogJ2luLXByb2dyZXNzJyxcbiAgICAgICAgJ2V4b19fRWZmb3J0X3BhcmVudCc6IGBbWyR7cHJvamVjdElkLnRvU3RyaW5nKCl9XV1gLFxuICAgICAgICAnZXhvX19UYXNrX2VzdGltYXRlZEhvdXJzJzogNCxcbiAgICAgICAgJ2V4b19fVGFza190YWdzJzogWyd1cmdlbnQnLCAnYmFja2VuZCddXG4gICAgICB9O1xuXG4gICAgICBjb25zdCB0YXNrID0gVGFzay5mcm9tRnJvbnRtYXR0ZXIoZnJvbnRtYXR0ZXIsICd0ZXN0LXRhc2subWQnKTtcblxuICAgICAgZXhwZWN0KHRhc2spLm5vdC50b0JlTnVsbCgpO1xuICAgICAgZXhwZWN0KHRhc2shLmdldFRpdGxlKCkpLnRvQmUoJ1Rlc3QgVGFzaycpO1xuICAgICAgZXhwZWN0KHRhc2shLmdldERlc2NyaXB0aW9uKCkpLnRvQmUoJ0EgdGVzdCB0YXNrJyk7XG4gICAgICBleHBlY3QodGFzayEuZ2V0UHJpb3JpdHkoKS50b1N0cmluZygpKS50b0JlKCdoaWdoJyk7XG4gICAgICBleHBlY3QodGFzayEuZ2V0U3RhdHVzKCkudG9TdHJpbmcoKSkudG9CZSgnaW4tcHJvZ3Jlc3MnKTtcbiAgICAgIGV4cGVjdCh0YXNrIS5nZXRQcm9qZWN0SWQoKSEudG9TdHJpbmcoKSkudG9CZShwcm9qZWN0SWQudG9TdHJpbmcoKSk7XG4gICAgICBleHBlY3QodGFzayEuZ2V0RXN0aW1hdGVkSG91cnMoKSkudG9CZSg0KTtcbiAgICAgIGV4cGVjdCh0YXNrIS5nZXRUYWdzKCkpLnRvRXF1YWwoWyd1cmdlbnQnLCAnYmFja2VuZCddKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ21hcmtkb3duIGdlbmVyYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBnZW5lcmF0ZSBtYXJrZG93biBjb250ZW50JywgKCkgPT4ge1xuICAgICAgY29uc3QgdGFzayA9IFRhc2suY3JlYXRlKHtcbiAgICAgICAgdGl0bGU6ICdUZXN0IFRhc2snLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0EgdGVzdCB0YXNrJyxcbiAgICAgICAgcHJpb3JpdHk6IFByaW9yaXR5LmhpZ2goKSxcbiAgICAgICAgdGFnczogWyd1cmdlbnQnXVxuICAgICAgfSkuZ2V0VmFsdWUoKTtcblxuICAgICAgY29uc3QgbWFya2Rvd24gPSB0YXNrLnRvTWFya2Rvd24oKTtcblxuICAgICAgZXhwZWN0KG1hcmtkb3duKS50b0NvbnRhaW4oJyMgVGVzdCBUYXNrJyk7XG4gICAgICBleHBlY3QobWFya2Rvd24pLnRvQ29udGFpbignQSB0ZXN0IHRhc2snKTtcbiAgICAgIGV4cGVjdChtYXJrZG93bikudG9Db250YWluKCcqKlByaW9yaXR5Kio6IGhpZ2gnKTtcbiAgICAgIGV4cGVjdChtYXJrZG93bikudG9Db250YWluKCcqKlN0YXR1cyoqOiB0b2RvJyk7XG4gICAgICBleHBlY3QobWFya2Rvd24pLnRvQ29udGFpbignI3VyZ2VudCcpO1xuICAgICAgZXhwZWN0KG1hcmtkb3duKS50b0NvbnRhaW4oJy0gWyBdJyk7IC8vIFRvZG8gY2hlY2tib3hcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2VxdWFscycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiB0cnVlIGZvciB0YXNrcyB3aXRoIHNhbWUgSUQnLCAoKSA9PiB7XG4gICAgICBjb25zdCB0YXNrSWQgPSBUYXNrSWQuZ2VuZXJhdGUoKTtcbiAgICAgIGNvbnN0IHRhc2sxID0gVGFzay5jcmVhdGUoeyB0aXRsZTogJ1Rhc2sgMScgfSkuZ2V0VmFsdWUoKTtcbiAgICAgIGNvbnN0IHRhc2syID0gVGFzay5jcmVhdGUoeyB0aXRsZTogJ1Rhc2sgMicgfSkuZ2V0VmFsdWUoKTtcbiAgICAgIFxuICAgICAgLy8gU2V0IHNhbWUgSUQgZm9yIGJvdGggdGFza3NcbiAgICAgICh0YXNrMSBhcyBhbnkpLnByb3BzLmlkID0gdGFza0lkO1xuICAgICAgKHRhc2syIGFzIGFueSkucHJvcHMuaWQgPSB0YXNrSWQ7XG5cbiAgICAgIGV4cGVjdCh0YXNrMS5lcXVhbHModGFzazIpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZmFsc2UgZm9yIHRhc2tzIHdpdGggZGlmZmVyZW50IElEcycsICgpID0+IHtcbiAgICAgIGNvbnN0IHRhc2sxID0gVGFzay5jcmVhdGUoeyB0aXRsZTogJ1Rhc2sgMScgfSkuZ2V0VmFsdWUoKTtcbiAgICAgIGNvbnN0IHRhc2syID0gVGFzay5jcmVhdGUoeyB0aXRsZTogJ1Rhc2sgMicgfSkuZ2V0VmFsdWUoKTtcblxuICAgICAgZXhwZWN0KHRhc2sxLmVxdWFscyh0YXNrMikpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==