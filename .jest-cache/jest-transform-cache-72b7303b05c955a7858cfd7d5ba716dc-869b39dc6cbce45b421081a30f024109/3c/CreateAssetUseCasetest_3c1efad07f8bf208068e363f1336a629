f2cc8797ba00938a7178a1c4e3a4802a
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const CreateAssetUseCase_1 = require("../../../../src/application/use-cases/CreateAssetUseCase");
const Asset_1 = require("../../../../src/domain/entities/Asset");
const AssetId_1 = require("../../../../src/domain/value-objects/AssetId");
const OntologyPrefix_1 = require("../../../../src/domain/value-objects/OntologyPrefix");
const Result_1 = require("../../../../src/domain/core/Result");
describe('CreateAssetUseCase', () => {
    let useCase;
    let mockAssetRepository;
    let mockOntologyRepository;
    beforeEach(() => {
        // Setup mock repositories
        mockAssetRepository = {
            save: jest.fn(),
            findById: jest.fn(),
            findByFilename: jest.fn(),
            findAll: jest.fn(),
            delete: jest.fn(),
            exists: jest.fn(),
            updateFrontmatterByPath: jest.fn()
        };
        mockOntologyRepository = {
            save: jest.fn(),
            findByPrefix: jest.fn(),
            findAll: jest.fn(),
            delete: jest.fn(),
            exists: jest.fn()
        };
        useCase = new CreateAssetUseCase_1.CreateAssetUseCase(mockAssetRepository, mockOntologyRepository);
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    describe('Basic Functionality', () => {
        test('should create useCase with repositories', () => {
            expect(useCase).toBeDefined();
            expect(useCase.execute).toBeDefined();
        });
        test('should accept valid repositories in constructor', () => {
            const newUseCase = new CreateAssetUseCase_1.CreateAssetUseCase(mockAssetRepository, mockOntologyRepository);
            expect(newUseCase).toBeInstanceOf(CreateAssetUseCase_1.CreateAssetUseCase);
        });
    });
    describe('Successful Asset Creation', () => {
        beforeEach(() => {
            // Mock successful ontology lookup
            const mockOntology = {
                getPrefix: () => OntologyPrefix_1.OntologyPrefix.create('exo').getValue(),
                getLabel: () => 'Exocortex Core'
            };
            mockOntologyRepository.findByPrefix.mockResolvedValue(mockOntology);
            mockAssetRepository.save.mockResolvedValue(undefined);
        });
        test('should create asset successfully with minimal data', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo'
            };
            const response = yield useCase.execute(request);
            expect(response.success).toBe(true);
            expect(response.assetId).toBeDefined();
            expect(response.message).toBe('Created asset: Test Asset');
            expect(mockOntologyRepository.findByPrefix).toHaveBeenCalled();
            expect(mockAssetRepository.save).toHaveBeenCalled();
        }));
        test('should create asset with properties', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const request = {
                title: 'Test Asset',
                className: 'exo__Task',
                ontologyPrefix: 'exo',
                properties: {
                    priority: 'high',
                    status: 'active',
                    description: 'A test task'
                }
            };
            const response = yield useCase.execute(request);
            expect(response.success).toBe(true);
            expect(response.assetId).toBeDefined();
            expect(response.message).toBe('Created asset: Test Asset');
            expect(mockAssetRepository.save).toHaveBeenCalledWith(expect.objectContaining({
                props: expect.objectContaining({
                    properties: expect.any(Map)
                })
            }));
            // Verify the properties Map contains the expected values
            const savedAsset = mockAssetRepository.save.mock.calls[0][0];
            expect(savedAsset.props.properties.get('priority')).toBe('high');
            expect(savedAsset.props.properties.get('status')).toBe('active');
            expect(savedAsset.props.properties.get('description')).toBe('A test task');
        }));
        test('should handle empty properties object', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo',
                properties: {}
            };
            const response = yield useCase.execute(request);
            expect(response.success).toBe(true);
            expect(mockAssetRepository.save).toHaveBeenCalled();
        }));
        test('should handle null properties', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo',
                properties: undefined
            };
            const response = yield useCase.execute(request);
            expect(response.success).toBe(true);
            expect(mockAssetRepository.save).toHaveBeenCalled();
        }));
        test('should generate unique asset IDs', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo'
            };
            const response1 = yield useCase.execute(request);
            const response2 = yield useCase.execute(request);
            expect(response1.assetId).not.toBe(response2.assetId);
        }));
        test('should preserve exact title in response', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const specialTitle = 'Asset with Special Chars: éñ中文!@#$%^&*()';
            const request = {
                title: specialTitle,
                className: 'exo__Asset',
                ontologyPrefix: 'exo'
            };
            const response = yield useCase.execute(request);
            expect(response.message).toBe(`Created asset: ${specialTitle}`);
        }));
        test('should handle long titles', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const longTitle = 'A'.repeat(1000);
            const request = {
                title: longTitle,
                className: 'exo__Asset',
                ontologyPrefix: 'exo'
            };
            const response = yield useCase.execute(request);
            expect(response.success).toBe(true);
            expect(response.message).toBe(`Created asset: ${longTitle}`);
        }));
        test('should handle complex property values', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const request = {
                title: 'Complex Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo',
                properties: {
                    tags: ['tag1', 'tag2', 'tag3'],
                    metadata: {
                        nested: 'value',
                        count: 42
                    },
                    isActive: true,
                    score: 3.14,
                    description: null,
                    emptyArray: [],
                    emptyObject: {}
                }
            };
            const response = yield useCase.execute(request);
            expect(response.success).toBe(true);
            expect(mockAssetRepository.save).toHaveBeenCalledWith(expect.objectContaining({
                props: expect.objectContaining({
                    properties: expect.any(Map)
                })
            }));
            // Verify the properties Map contains the expected complex values
            const savedAsset = mockAssetRepository.save.mock.calls[0][0];
            expect(savedAsset.props.properties.get('tags')).toEqual(['tag1', 'tag2', 'tag3']);
            expect(savedAsset.props.properties.get('metadata')).toEqual({
                nested: 'value',
                count: 42
            });
            expect(savedAsset.props.properties.get('isActive')).toBe(true);
            expect(savedAsset.props.properties.get('score')).toBe(3.14);
            expect(savedAsset.props.properties.get('description')).toBe(null);
            expect(savedAsset.props.properties.get('emptyArray')).toEqual([]);
            expect(savedAsset.props.properties.get('emptyObject')).toEqual({});
        }));
    });
    describe('Request Validation', () => {
        beforeEach(() => {
            // Mock successful ontology lookup for valid cases
            const mockOntology = {
                getPrefix: () => OntologyPrefix_1.OntologyPrefix.create('exo').getValue()
            };
            mockOntologyRepository.findByPrefix.mockResolvedValue(mockOntology);
        });
        test('should throw error for empty title', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const request = {
                title: '',
                className: 'exo__Asset',
                ontologyPrefix: 'exo'
            };
            yield expect(useCase.execute(request)).rejects.toThrow('Asset title is required');
        }));
        test('should throw error for whitespace-only title', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const request = {
                title: '   \t\n   ',
                className: 'exo__Asset',
                ontologyPrefix: 'exo'
            };
            yield expect(useCase.execute(request)).rejects.toThrow('Asset title is required');
        }));
        test('should throw error for missing className', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const request = {
                title: 'Test Asset',
                className: '',
                ontologyPrefix: 'exo'
            };
            yield expect(useCase.execute(request)).rejects.toThrow('Asset class is required');
        }));
        test('should throw error for null className', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const request = {
                title: 'Test Asset',
                className: null,
                ontologyPrefix: 'exo'
            };
            yield expect(useCase.execute(request)).rejects.toThrow('Asset class is required');
        }));
        test('should throw error for missing ontologyPrefix', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: ''
            };
            yield expect(useCase.execute(request)).rejects.toThrow('Ontology prefix is required');
        }));
        test('should throw error for null ontologyPrefix', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: null
            };
            yield expect(useCase.execute(request)).rejects.toThrow('Ontology prefix is required');
        }));
        test('should validate multiple fields at once', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const request = {
                title: '',
                className: '',
                ontologyPrefix: ''
            };
            // Should fail on the first validation error (title)
            yield expect(useCase.execute(request)).rejects.toThrow('Asset title is required');
        }));
        test('should handle undefined request properties', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const request = {
                title: 'Test Asset'
                // Missing other required properties
            };
            yield expect(useCase.execute(request)).rejects.toThrow();
        }));
    });
    describe('Value Object Creation', () => {
        beforeEach(() => {
            const mockOntology = {
                getPrefix: () => OntologyPrefix_1.OntologyPrefix.create('exo').getValue()
            };
            mockOntologyRepository.findByPrefix.mockResolvedValue(mockOntology);
        });
        test('should handle valid className creation', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const request = {
                title: 'Test Asset',
                className: 'exo__ValidClass',
                ontologyPrefix: 'exo'
            };
            const response = yield useCase.execute(request);
            expect(response.success).toBe(true);
        }));
        test('should throw error for invalid className format', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const request = {
                title: 'Test Asset',
                className: 'invalid-class-name!@#',
                ontologyPrefix: 'exo'
            };
            yield expect(useCase.execute(request)).rejects.toThrow();
        }));
        test('should handle valid ontologyPrefix creation', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'valid'
            };
            const mockOntology = {
                getPrefix: () => OntologyPrefix_1.OntologyPrefix.create('valid').getValue()
            };
            mockOntologyRepository.findByPrefix.mockResolvedValue(mockOntology);
            const response = yield useCase.execute(request);
            expect(response.success).toBe(true);
        }));
        test('should throw error for invalid ontologyPrefix format', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'invalid-prefix!@#'
            };
            yield expect(useCase.execute(request)).rejects.toThrow();
        }));
        test('should handle long but valid identifiers', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const longButValidClass = 'exo__' + 'A'.repeat(100);
            const longButValidPrefix = 'a' + 'b'.repeat(50);
            const request = {
                title: 'Test Asset',
                className: longButValidClass,
                ontologyPrefix: longButValidPrefix
            };
            const mockOntology = {
                getPrefix: () => OntologyPrefix_1.OntologyPrefix.create(longButValidPrefix).getValue()
            };
            mockOntologyRepository.findByPrefix.mockResolvedValue(mockOntology);
            const response = yield useCase.execute(request);
            expect(response.success).toBe(true);
        }));
    });
    describe('Ontology Repository Integration', () => {
        test('should verify ontology exists before creating asset', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const mockOntology = {
                getPrefix: () => OntologyPrefix_1.OntologyPrefix.create('exo').getValue()
            };
            mockOntologyRepository.findByPrefix.mockResolvedValue(mockOntology);
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo'
            };
            yield useCase.execute(request);
            expect(mockOntologyRepository.findByPrefix).toHaveBeenCalledWith(expect.objectContaining({
                value: 'exo'
            }));
        }));
        test('should throw error when ontology not found', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            mockOntologyRepository.findByPrefix.mockResolvedValue(null);
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'nonexistent'
            };
            yield expect(useCase.execute(request)).rejects.toThrow('Ontology nonexistent not found');
        }));
        test('should handle ontology repository errors', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            mockOntologyRepository.findByPrefix.mockRejectedValue(new Error('Database connection failed'));
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo'
            };
            yield expect(useCase.execute(request)).rejects.toThrow('Database connection failed');
        }));
        test('should handle ontology with different prefix formats', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const prefixes = ['exo', 'rdfs', 'owl', 'foaf', 'dc'];
            for (const prefix of prefixes) {
                const mockOntology = {
                    getPrefix: () => OntologyPrefix_1.OntologyPrefix.create(prefix).getValue()
                };
                mockOntologyRepository.findByPrefix.mockResolvedValue(mockOntology);
                const request = {
                    title: 'Test Asset',
                    className: `${prefix}__Asset`,
                    ontologyPrefix: prefix
                };
                const response = yield useCase.execute(request);
                expect(response.success).toBe(true);
            }
        }));
    });
    describe('Asset Repository Integration', () => {
        beforeEach(() => {
            const mockOntology = {
                getPrefix: () => OntologyPrefix_1.OntologyPrefix.create('exo').getValue()
            };
            mockOntologyRepository.findByPrefix.mockResolvedValue(mockOntology);
        });
        test('should save asset to repository', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            mockAssetRepository.save.mockResolvedValue(undefined);
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo'
            };
            yield useCase.execute(request);
            expect(mockAssetRepository.save).toHaveBeenCalledTimes(1);
            expect(mockAssetRepository.save).toHaveBeenCalledWith(expect.any(Asset_1.Asset));
        }));
        test('should handle repository save errors', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            mockAssetRepository.save.mockRejectedValue(new Error('Save failed'));
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo'
            };
            yield expect(useCase.execute(request)).rejects.toThrow('Save failed');
        }));
        test('should save asset with correct properties', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            mockAssetRepository.save.mockResolvedValue(undefined);
            const request = {
                title: 'Test Asset',
                className: 'exo__Task',
                ontologyPrefix: 'exo',
                properties: {
                    priority: 'high',
                    dueDate: '2024-12-31'
                }
            };
            yield useCase.execute(request);
            expect(mockAssetRepository.save).toHaveBeenCalledWith(expect.objectContaining({
                props: expect.objectContaining({
                    label: 'Test Asset',
                    className: expect.objectContaining({
                        value: 'exo__Task'
                    }),
                    ontology: expect.objectContaining({
                        value: 'exo'
                    }),
                    properties: expect.any(Map)
                })
            }));
        }));
        test('should handle concurrent repository operations', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            mockAssetRepository.save.mockImplementation(() => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
                yield new Promise(resolve => setTimeout(resolve, 10));
            }));
            const requests = Array(5).fill(null).map((_, i) => ({
                title: `Test Asset ${i}`,
                className: 'exo__Asset',
                ontologyPrefix: 'exo'
            }));
            const promises = requests.map(req => useCase.execute(req));
            const responses = yield Promise.all(promises);
            expect(responses).toHaveLength(5);
            responses.forEach(response => {
                expect(response.success).toBe(true);
            });
            expect(mockAssetRepository.save).toHaveBeenCalledTimes(5);
        }));
    });
    describe('Asset Creation Process', () => {
        beforeEach(() => {
            const mockOntology = {
                getPrefix: () => OntologyPrefix_1.OntologyPrefix.create('exo').getValue()
            };
            mockOntologyRepository.findByPrefix.mockResolvedValue(mockOntology);
        });
        test('should create asset with generated ID', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            let savedAsset;
            mockAssetRepository.save.mockImplementation((asset) => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
                savedAsset = asset;
            }));
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo'
            };
            yield useCase.execute(request);
            expect(savedAsset).toBeDefined();
            expect(savedAsset.getId()).toBeInstanceOf(AssetId_1.AssetId);
            expect(savedAsset.getId().toString()).toMatch(/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i);
        }));
        test('should create asset with correct label', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            let savedAsset;
            mockAssetRepository.save.mockImplementation((asset) => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
                savedAsset = asset;
            }));
            const request = {
                title: 'My Special Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo'
            };
            yield useCase.execute(request);
            expect(savedAsset.getTitle()).toBe('My Special Asset');
        }));
        test('should create asset with correct class and ontology', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            let savedAsset;
            mockAssetRepository.save.mockImplementation((asset) => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
                savedAsset = asset;
            }));
            const request = {
                title: 'Test Asset',
                className: 'exo__Task',
                ontologyPrefix: 'exo'
            };
            yield useCase.execute(request);
            expect(savedAsset.getClassName().value).toBe('exo__Task');
            expect(savedAsset.getOntologyPrefix().value).toBe('exo');
        }));
        test('should handle asset creation failure', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            // Mock Asset.create to return failure
            const originalCreate = Asset_1.Asset.create;
            Asset_1.Asset.create = jest.fn().mockReturnValue(Result_1.Result.fail('Asset creation failed'));
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo'
            };
            yield expect(useCase.execute(request)).rejects.toThrow('Asset creation failed');
            // Restore original method
            Asset_1.Asset.create = originalCreate;
        }));
    });
    describe('Response Generation', () => {
        beforeEach(() => {
            const mockOntology = {
                getPrefix: () => OntologyPrefix_1.OntologyPrefix.create('exo').getValue()
            };
            mockOntologyRepository.findByPrefix.mockResolvedValue(mockOntology);
            mockAssetRepository.save.mockResolvedValue(undefined);
        });
        test('should return correct response structure', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo'
            };
            const response = yield useCase.execute(request);
            expect(response).toEqual({
                success: true,
                assetId: expect.any(String),
                message: 'Created asset: Test Asset'
            });
        }));
        test('should return valid UUID in assetId', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo'
            };
            const response = yield useCase.execute(request);
            expect(response.assetId).toMatch(/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i);
        }));
        test('should include asset title in success message', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const titles = [
                'Simple Asset',
                'Asset with Spaces',
                'Asset-with-Dashes',
                'Asset_with_Underscores',
                'Asset123',
                'Ässet with Ünicode'
            ];
            for (const title of titles) {
                const request = {
                    title,
                    className: 'exo__Asset',
                    ontologyPrefix: 'exo'
                };
                const response = yield useCase.execute(request);
                expect(response.message).toBe(`Created asset: ${title}`);
            }
        }));
    });
    describe('Error Scenarios', () => {
        test('should handle repository timeout', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            mockOntologyRepository.findByPrefix.mockImplementation(() => new Promise((_, reject) => setTimeout(() => reject(new Error('Timeout')), 100)));
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo'
            };
            yield expect(useCase.execute(request)).rejects.toThrow('Timeout');
        }));
        test('should handle memory constraints', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const mockOntology = {
                getPrefix: () => OntologyPrefix_1.OntologyPrefix.create('exo').getValue()
            };
            mockOntologyRepository.findByPrefix.mockResolvedValue(mockOntology);
            mockAssetRepository.save.mockRejectedValue(new Error('Out of memory'));
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo'
            };
            yield expect(useCase.execute(request)).rejects.toThrow('Out of memory');
        }));
        test('should handle network errors', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            mockOntologyRepository.findByPrefix.mockRejectedValue(new Error('Network unreachable'));
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo'
            };
            yield expect(useCase.execute(request)).rejects.toThrow('Network unreachable');
        }));
        test('should handle permission errors', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            mockAssetRepository.save.mockRejectedValue(new Error('Permission denied'));
            const mockOntology = {
                getPrefix: () => OntologyPrefix_1.OntologyPrefix.create('exo').getValue()
            };
            mockOntologyRepository.findByPrefix.mockResolvedValue(mockOntology);
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo'
            };
            yield expect(useCase.execute(request)).rejects.toThrow('Permission denied');
        }));
    });
    describe('Edge Cases', () => {
        beforeEach(() => {
            const mockOntology = {
                getPrefix: () => OntologyPrefix_1.OntologyPrefix.create('exo').getValue()
            };
            mockOntologyRepository.findByPrefix.mockResolvedValue(mockOntology);
            mockAssetRepository.save.mockResolvedValue(undefined);
        });
        test('should handle extremely long property values', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const longValue = 'A'.repeat(10000);
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo',
                properties: {
                    longProperty: longValue
                }
            };
            const response = yield useCase.execute(request);
            expect(response.success).toBe(true);
        }));
        test('should handle deeply nested property objects', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const deepObject = {};
            let current = deepObject;
            for (let i = 0; i < 10; i++) {
                current.level = i;
                current.next = {};
                current = current.next;
            }
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo',
                properties: {
                    deepObject
                }
            };
            const response = yield useCase.execute(request);
            expect(response.success).toBe(true);
        }));
        test('should handle large number of properties', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const properties = {};
            for (let i = 0; i < 1000; i++) {
                properties[`prop${i}`] = `value${i}`;
            }
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo',
                properties
            };
            const response = yield useCase.execute(request);
            expect(response.success).toBe(true);
        }));
        test('should handle special property names', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo',
                properties: {
                    '': 'empty key',
                    ' ': 'space key',
                    '__proto__': 'prototype key',
                    'constructor': 'constructor key',
                    'toString': 'toString key',
                    '123': 'numeric key',
                    'key.with.dots': 'dotted key',
                    'key-with-dashes': 'dashed key',
                    'key_with_underscores': 'underscored key'
                }
            };
            const response = yield useCase.execute(request);
            expect(response.success).toBe(true);
        }));
        test('should handle circular references in properties', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const obj1 = { name: 'obj1' };
            const obj2 = { name: 'obj2', ref: obj1 };
            obj1.ref = obj2; // Create circular reference
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo',
                properties: {
                    circular: obj1
                }
            };
            // This should not throw an error but may serialize differently
            const response = yield useCase.execute(request);
            expect(response.success).toBe(true);
        }));
        test('should handle null and undefined mixed properties', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo',
                properties: {
                    nullValue: null,
                    undefinedValue: undefined,
                    emptyString: '',
                    zero: 0,
                    false: false,
                    emptyArray: [],
                    emptyObject: {}
                }
            };
            const response = yield useCase.execute(request);
            expect(response.success).toBe(true);
        }));
    });
    describe('Performance Tests', () => {
        beforeEach(() => {
            const mockOntology = {
                getPrefix: () => OntologyPrefix_1.OntologyPrefix.create('exo').getValue()
            };
            mockOntologyRepository.findByPrefix.mockResolvedValue(mockOntology);
            mockAssetRepository.save.mockResolvedValue(undefined);
        });
        test('should complete within reasonable time', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const startTime = Date.now();
            const request = {
                title: 'Test Asset',
                className: 'exo__Asset',
                ontologyPrefix: 'exo'
            };
            yield useCase.execute(request);
            const endTime = Date.now();
            const duration = endTime - startTime;
            expect(duration).toBeLessThan(1000); // Should complete within 1 second
        }));
        test('should handle batch operations efficiently', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const startTime = Date.now();
            const requests = Array(100).fill(null).map((_, i) => ({
                title: `Test Asset ${i}`,
                className: 'exo__Asset',
                ontologyPrefix: 'exo'
            }));
            const promises = requests.map(req => useCase.execute(req));
            yield Promise.all(promises);
            const endTime = Date.now();
            const duration = endTime - startTime;
            expect(duration).toBeLessThan(5000); // Should complete within 5 seconds for 100 operations
        }));
        test('should not accumulate memory over multiple executions', () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const initialMemory = process.memoryUsage().heapUsed;
            for (let i = 0; i < 50; i++) {
                const request = {
                    title: `Test Asset ${i}`,
                    className: 'exo__Asset',
                    ontologyPrefix: 'exo'
                };
                yield useCase.execute(request);
            }
            // Force garbage collection if possible
            if (global.gc) {
                global.gc();
            }
            const finalMemory = process.memoryUsage().heapUsed;
            const memoryIncrease = finalMemory - initialMemory;
            // Memory increase should be reasonable (less than 10MB)
            expect(memoryIncrease).toBeLessThan(10 * 1024 * 1024);
        }));
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2tpdGVsZXYvRG9jdW1lbnRzL2V4b2NvcnRleC1vYnNpZGlhbi1wbHVnaW4vdGVzdHMvdW5pdC9hcHBsaWNhdGlvbi91c2UtY2FzZXMvQ3JlYXRlQXNzZXRVc2VDYXNlLnRlc3QudHMiLCJtYXBwaW5ncyI6Ijs7O0FBQUEsaUdBQXVJO0FBQ3ZJLGlFQUE4RDtBQUM5RCwwRUFBdUU7QUFFdkUsd0ZBQXFGO0FBSXJGLCtEQUE0RDtBQUU1RCxRQUFRLENBQUMsb0JBQW9CLEVBQUUsR0FBRyxFQUFFO0lBQ2hDLElBQUksT0FBMkIsQ0FBQztJQUNoQyxJQUFJLG1CQUFrRCxDQUFDO0lBQ3ZELElBQUksc0JBQXdELENBQUM7SUFFN0QsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNaLDBCQUEwQjtRQUMxQixtQkFBbUIsR0FBRztZQUNsQixJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNmLFFBQVEsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ25CLGNBQWMsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ3pCLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ2xCLE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ2pCLE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ2pCLHVCQUF1QixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7U0FDckMsQ0FBQztRQUVGLHNCQUFzQixHQUFHO1lBQ3JCLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ2YsWUFBWSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDdkIsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDbEIsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDakIsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7U0FDcEIsQ0FBQztRQUVGLE9BQU8sR0FBRyxJQUFJLHVDQUFrQixDQUFDLG1CQUFtQixFQUFFLHNCQUFzQixDQUFDLENBQUM7SUFDbEYs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QUUsQ0FBQzthQUNmO1lBRUQsTUFBTSxXQUFXLEdBQUcsT0FBTyxDQUFDLFdBQVcsRUFBRSxDQUFDLFFBQVEsQ0FBQztZQUNuRCxNQUFNLGNBQWMsR0FBRyxXQUFXLEdBQUcsYUFBYSxDQUFDO1lBRW5ELHdEQUF3RDtZQUN4RCxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsWUFBWSxDQUFDLEVBQUUsR0FBRyxJQUFJLEdBQUcsSUFBSSxDQUFDLENBQUM7UUFDMUQsQ0FBQyxDQUFBLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2tpdGVsZXYvRG9jdW1lbnRzL2V4b2NvcnRleC1vYnNpZGlhbi1wbHVnaW4vdGVzdHMvdW5pdC9hcHBsaWNhdGlvbi91c2UtY2FzZXMvQ3JlYXRlQXNzZXRVc2VDYXNlLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ3JlYXRlQXNzZXRVc2VDYXNlLCBDcmVhdGVBc3NldFJlcXVlc3QsIENyZWF0ZUFzc2V0UmVzcG9uc2UgfSBmcm9tICcuLi8uLi8uLi8uLi9zcmMvYXBwbGljYXRpb24vdXNlLWNhc2VzL0NyZWF0ZUFzc2V0VXNlQ2FzZSc7XG5pbXBvcnQgeyBBc3NldCB9IGZyb20gJy4uLy4uLy4uLy4uL3NyYy9kb21haW4vZW50aXRpZXMvQXNzZXQnO1xuaW1wb3J0IHsgQXNzZXRJZCB9IGZyb20gJy4uLy4uLy4uLy4uL3NyYy9kb21haW4vdmFsdWUtb2JqZWN0cy9Bc3NldElkJztcbmltcG9ydCB7IENsYXNzTmFtZSB9IGZyb20gJy4uLy4uLy4uLy4uL3NyYy9kb21haW4vdmFsdWUtb2JqZWN0cy9DbGFzc05hbWUnO1xuaW1wb3J0IHsgT250b2xvZ3lQcmVmaXggfSBmcm9tICcuLi8uLi8uLi8uLi9zcmMvZG9tYWluL3ZhbHVlLW9iamVjdHMvT250b2xvZ3lQcmVmaXgnO1xuaW1wb3J0IHsgSUFzc2V0UmVwb3NpdG9yeSB9IGZyb20gJy4uLy4uLy4uLy4uL3NyYy9kb21haW4vcmVwb3NpdG9yaWVzL0lBc3NldFJlcG9zaXRvcnknO1xuaW1wb3J0IHsgSU9udG9sb2d5UmVwb3NpdG9yeSB9IGZyb20gJy4uLy4uLy4uLy4uL3NyYy9kb21haW4vcmVwb3NpdG9yaWVzL0lPbnRvbG9neVJlcG9zaXRvcnknO1xuaW1wb3J0IHsgT250b2xvZ3kgfSBmcm9tICcuLi8uLi8uLi8uLi9zcmMvZG9tYWluL2VudGl0aWVzL09udG9sb2d5JztcbmltcG9ydCB7IFJlc3VsdCB9IGZyb20gJy4uLy4uLy4uLy4uL3NyYy9kb21haW4vY29yZS9SZXN1bHQnO1xuXG5kZXNjcmliZSgnQ3JlYXRlQXNzZXRVc2VDYXNlJywgKCkgPT4ge1xuICAgIGxldCB1c2VDYXNlOiBDcmVhdGVBc3NldFVzZUNhc2U7XG4gICAgbGV0IG1vY2tBc3NldFJlcG9zaXRvcnk6IGplc3QuTW9ja2VkPElBc3NldFJlcG9zaXRvcnk+O1xuICAgIGxldCBtb2NrT250b2xvZ3lSZXBvc2l0b3J5OiBqZXN0Lk1vY2tlZDxJT250b2xvZ3lSZXBvc2l0b3J5PjtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgICAvLyBTZXR1cCBtb2NrIHJlcG9zaXRvcmllc1xuICAgICAgICBtb2NrQXNzZXRSZXBvc2l0b3J5ID0ge1xuICAgICAgICAgICAgc2F2ZTogamVzdC5mbigpLFxuICAgICAgICAgICAgZmluZEJ5SWQ6IGplc3QuZm4oKSxcbiAgICAgICAgICAgIGZpbmRCeUZpbGVuYW1lOiBqZXN0LmZuKCksXG4gICAgICAgICAgICBmaW5kQWxsOiBqZXN0LmZuKCksXG4gICAgICAgICAgICBkZWxldGU6IGplc3QuZm4oKSxcbiAgICAgICAgICAgIGV4aXN0czogamVzdC5mbigpLFxuICAgICAgICAgICAgdXBkYXRlRnJvbnRtYXR0ZXJCeVBhdGg6IGplc3QuZm4oKVxuICAgICAgICB9O1xuXG4gICAgICAgIG1vY2tPbnRvbG9neVJlcG9zaXRvcnkgPSB7XG4gICAgICAgICAgICBzYXZlOiBqZXN0LmZuKCksXG4gICAgICAgICAgICBmaW5kQnlQcmVmaXg6IGplc3QuZm4oKSxcbiAgICAgICAgICAgIGZpbmRBbGw6IGplc3QuZm4oKSxcbiAgICAgICAgICAgIGRlbGV0ZTogamVzdC5mbigpLFxuICAgICAgICAgICAgZXhpc3RzOiBqZXN0LmZuKClcbiAgICAgICAgfTtcblxuICAgICAgICB1c2VDYXNlID0gbmV3IENyZWF0ZUFzc2V0VXNlQ2FzZShtb2NrQXNzZXRSZXBvc2l0b3J5LCBtb2NrT250b2xvZ3lSZXBvc2l0b3J5KTtcbiAgICB9KTtcblxuICAgIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ0Jhc2ljIEZ1bmN0aW9uYWxpdHknLCAoKSA9PiB7XG4gICAgICAgIHRlc3QoJ3Nob3VsZCBjcmVhdGUgdXNlQ2FzZSB3aXRoIHJlcG9zaXRvcmllcycsICgpID0+IHtcbiAgICAgICAgICAgIGV4cGVjdCh1c2VDYXNlKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICAgICAgZXhwZWN0KHVzZUNhc2UuZXhlY3V0ZSkudG9CZURlZmluZWQoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIGFjY2VwdCB2YWxpZCByZXBvc2l0b3JpZXMgaW4gY29uc3RydWN0b3InLCAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuZXdVc2VDYXNlID0gbmV3IENyZWF0ZUFzc2V0VXNlQ2FzZShtb2NrQXNzZXRSZXBvc2l0b3J5LCBtb2NrT250b2xvZ3lSZXBvc2l0b3J5KTtcbiAgICAgICAgICAgIGV4cGVjdChuZXdVc2VDYXNlKS50b0JlSW5zdGFuY2VPZihDcmVhdGVBc3NldFVzZUNhc2UpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdTdWNjZXNzZnVsIEFzc2V0IENyZWF0aW9uJywgKCkgPT4ge1xuICAgICAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgICAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBvbnRvbG9neSBsb29rdXBcbiAgICAgICAgICAgIGNvbnN0IG1vY2tPbnRvbG9neSA9IHtcbiAgICAgICAgICAgICAgICBnZXRQcmVmaXg6ICgpID0+IE9udG9sb2d5UHJlZml4LmNyZWF0ZSgnZXhvJykuZ2V0VmFsdWUoKSxcbiAgICAgICAgICAgICAgICBnZXRMYWJlbDogKCkgPT4gJ0V4b2NvcnRleCBDb3JlJ1xuICAgICAgICAgICAgfSBhcyBPbnRvbG9neTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbW9ja09udG9sb2d5UmVwb3NpdG9yeS5maW5kQnlQcmVmaXgubW9ja1Jlc29sdmVkVmFsdWUobW9ja09udG9sb2d5KTtcbiAgICAgICAgICAgIG1vY2tBc3NldFJlcG9zaXRvcnkuc2F2ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdzaG91bGQgY3JlYXRlIGFzc2V0IHN1Y2Nlc3NmdWxseSB3aXRoIG1pbmltYWwgZGF0YScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3Q6IENyZWF0ZUFzc2V0UmVxdWVzdCA9IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ1Rlc3QgQXNzZXQnLFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2V4b19fQXNzZXQnLFxuICAgICAgICAgICAgICAgIG9udG9sb2d5UHJlZml4OiAnZXhvJ1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB1c2VDYXNlLmV4ZWN1dGUocmVxdWVzdCk7XG5cbiAgICAgICAgICAgIGV4cGVjdChyZXNwb25zZS5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmFzc2V0SWQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgICAgICBleHBlY3QocmVzcG9uc2UubWVzc2FnZSkudG9CZSgnQ3JlYXRlZCBhc3NldDogVGVzdCBBc3NldCcpO1xuICAgICAgICAgICAgZXhwZWN0KG1vY2tPbnRvbG9neVJlcG9zaXRvcnkuZmluZEJ5UHJlZml4KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICAgICAgICBleHBlY3QobW9ja0Fzc2V0UmVwb3NpdG9yeS5zYXZlKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBjcmVhdGUgYXNzZXQgd2l0aCBwcm9wZXJ0aWVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdDogQ3JlYXRlQXNzZXRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnVGVzdCBBc3NldCcsXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZXhvX19UYXNrJyxcbiAgICAgICAgICAgICAgICBvbnRvbG9neVByZWZpeDogJ2V4bycsXG4gICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBwcmlvcml0eTogJ2hpZ2gnLFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6ICdhY3RpdmUnLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ0EgdGVzdCB0YXNrJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdXNlQ2FzZS5leGVjdXRlKHJlcXVlc3QpO1xuXG4gICAgICAgICAgICBleHBlY3QocmVzcG9uc2Uuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgICAgICAgIGV4cGVjdChyZXNwb25zZS5hc3NldElkKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICAgICAgZXhwZWN0KHJlc3BvbnNlLm1lc3NhZ2UpLnRvQmUoJ0NyZWF0ZWQgYXNzZXQ6IFRlc3QgQXNzZXQnKTtcbiAgICAgICAgICAgIGV4cGVjdChtb2NrQXNzZXRSZXBvc2l0b3J5LnNhdmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAgICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcHM6IGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IGV4cGVjdC5hbnkoTWFwKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBWZXJpZnkgdGhlIHByb3BlcnRpZXMgTWFwIGNvbnRhaW5zIHRoZSBleHBlY3RlZCB2YWx1ZXNcbiAgICAgICAgICAgIGNvbnN0IHNhdmVkQXNzZXQgPSBtb2NrQXNzZXRSZXBvc2l0b3J5LnNhdmUubW9jay5jYWxsc1swXVswXTtcbiAgICAgICAgICAgIGV4cGVjdChzYXZlZEFzc2V0LnByb3BzLnByb3BlcnRpZXMuZ2V0KCdwcmlvcml0eScpKS50b0JlKCdoaWdoJyk7XG4gICAgICAgICAgICBleHBlY3Qoc2F2ZWRBc3NldC5wcm9wcy5wcm9wZXJ0aWVzLmdldCgnc3RhdHVzJykpLnRvQmUoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgZXhwZWN0KHNhdmVkQXNzZXQucHJvcHMucHJvcGVydGllcy5nZXQoJ2Rlc2NyaXB0aW9uJykpLnRvQmUoJ0EgdGVzdCB0YXNrJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgcHJvcGVydGllcyBvYmplY3QnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0OiBDcmVhdGVBc3NldFJlcXVlc3QgPSB7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICdUZXN0IEFzc2V0JyxcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdleG9fX0Fzc2V0JyxcbiAgICAgICAgICAgICAgICBvbnRvbG9neVByZWZpeDogJ2V4bycsXG4gICAgICAgICAgICAgICAgcHJvcGVydGllczoge31cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdXNlQ2FzZS5leGVjdXRlKHJlcXVlc3QpO1xuXG4gICAgICAgICAgICBleHBlY3QocmVzcG9uc2Uuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgICAgICAgIGV4cGVjdChtb2NrQXNzZXRSZXBvc2l0b3J5LnNhdmUpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBudWxsIHByb3BlcnRpZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0OiBDcmVhdGVBc3NldFJlcXVlc3QgPSB7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICdUZXN0IEFzc2V0JyxcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdleG9fX0Fzc2V0JyxcbiAgICAgICAgICAgICAgICBvbnRvbG9neVByZWZpeDogJ2V4bycsXG4gICAgICAgICAgICAgICAgcHJvcGVydGllczogdW5kZWZpbmVkXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHVzZUNhc2UuZXhlY3V0ZShyZXF1ZXN0KTtcblxuICAgICAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICAgICAgICBleHBlY3QobW9ja0Fzc2V0UmVwb3NpdG9yeS5zYXZlKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBnZW5lcmF0ZSB1bmlxdWUgYXNzZXQgSURzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdDogQ3JlYXRlQXNzZXRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnVGVzdCBBc3NldCcsXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZXhvX19Bc3NldCcsXG4gICAgICAgICAgICAgICAgb250b2xvZ3lQcmVmaXg6ICdleG8nXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZTEgPSBhd2FpdCB1c2VDYXNlLmV4ZWN1dGUocmVxdWVzdCk7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZTIgPSBhd2FpdCB1c2VDYXNlLmV4ZWN1dGUocmVxdWVzdCk7XG5cbiAgICAgICAgICAgIGV4cGVjdChyZXNwb25zZTEuYXNzZXRJZCkubm90LnRvQmUocmVzcG9uc2UyLmFzc2V0SWQpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdzaG91bGQgcHJlc2VydmUgZXhhY3QgdGl0bGUgaW4gcmVzcG9uc2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzcGVjaWFsVGl0bGUgPSAnQXNzZXQgd2l0aCBTcGVjaWFsIENoYXJzOiDDqcOx5Lit5paHIUAjJCVeJiooKSc7XG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0OiBDcmVhdGVBc3NldFJlcXVlc3QgPSB7XG4gICAgICAgICAgICAgICAgdGl0bGU6IHNwZWNpYWxUaXRsZSxcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdleG9fX0Fzc2V0JyxcbiAgICAgICAgICAgICAgICBvbnRvbG9neVByZWZpeDogJ2V4bydcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdXNlQ2FzZS5leGVjdXRlKHJlcXVlc3QpO1xuXG4gICAgICAgICAgICBleHBlY3QocmVzcG9uc2UubWVzc2FnZSkudG9CZShgQ3JlYXRlZCBhc3NldDogJHtzcGVjaWFsVGl0bGV9YCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgbG9uZyB0aXRsZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBsb25nVGl0bGUgPSAnQScucmVwZWF0KDEwMDApO1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdDogQ3JlYXRlQXNzZXRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIHRpdGxlOiBsb25nVGl0bGUsXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZXhvX19Bc3NldCcsXG4gICAgICAgICAgICAgICAgb250b2xvZ3lQcmVmaXg6ICdleG8nXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHVzZUNhc2UuZXhlY3V0ZShyZXF1ZXN0KTtcblxuICAgICAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICAgICAgICBleHBlY3QocmVzcG9uc2UubWVzc2FnZSkudG9CZShgQ3JlYXRlZCBhc3NldDogJHtsb25nVGl0bGV9YCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgY29tcGxleCBwcm9wZXJ0eSB2YWx1ZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0OiBDcmVhdGVBc3NldFJlcXVlc3QgPSB7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICdDb21wbGV4IEFzc2V0JyxcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdleG9fX0Fzc2V0JyxcbiAgICAgICAgICAgICAgICBvbnRvbG9neVByZWZpeDogJ2V4bycsXG4gICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICB0YWdzOiBbJ3RhZzEnLCAndGFnMicsICd0YWczJ10sXG4gICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXN0ZWQ6ICd2YWx1ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudDogNDJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHNjb3JlOiAzLjE0LFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgZW1wdHlBcnJheTogW10sXG4gICAgICAgICAgICAgICAgICAgIGVtcHR5T2JqZWN0OiB7fVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdXNlQ2FzZS5leGVjdXRlKHJlcXVlc3QpO1xuXG4gICAgICAgICAgICBleHBlY3QocmVzcG9uc2Uuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgICAgICAgIGV4cGVjdChtb2NrQXNzZXRSZXBvc2l0b3J5LnNhdmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAgICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcHM6IGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IGV4cGVjdC5hbnkoTWFwKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBWZXJpZnkgdGhlIHByb3BlcnRpZXMgTWFwIGNvbnRhaW5zIHRoZSBleHBlY3RlZCBjb21wbGV4IHZhbHVlc1xuICAgICAgICAgICAgY29uc3Qgc2F2ZWRBc3NldCA9IG1vY2tBc3NldFJlcG9zaXRvcnkuc2F2ZS5tb2NrLmNhbGxzWzBdWzBdO1xuICAgICAgICAgICAgZXhwZWN0KHNhdmVkQXNzZXQucHJvcHMucHJvcGVydGllcy5nZXQoJ3RhZ3MnKSkudG9FcXVhbChbJ3RhZzEnLCAndGFnMicsICd0YWczJ10pO1xuICAgICAgICAgICAgZXhwZWN0KHNhdmVkQXNzZXQucHJvcHMucHJvcGVydGllcy5nZXQoJ21ldGFkYXRhJykpLnRvRXF1YWwoe1xuICAgICAgICAgICAgICAgIG5lc3RlZDogJ3ZhbHVlJyxcbiAgICAgICAgICAgICAgICBjb3VudDogNDJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZXhwZWN0KHNhdmVkQXNzZXQucHJvcHMucHJvcGVydGllcy5nZXQoJ2lzQWN0aXZlJykpLnRvQmUodHJ1ZSk7XG4gICAgICAgICAgICBleHBlY3Qoc2F2ZWRBc3NldC5wcm9wcy5wcm9wZXJ0aWVzLmdldCgnc2NvcmUnKSkudG9CZSgzLjE0KTtcbiAgICAgICAgICAgIGV4cGVjdChzYXZlZEFzc2V0LnByb3BzLnByb3BlcnRpZXMuZ2V0KCdkZXNjcmlwdGlvbicpKS50b0JlKG51bGwpO1xuICAgICAgICAgICAgZXhwZWN0KHNhdmVkQXNzZXQucHJvcHMucHJvcGVydGllcy5nZXQoJ2VtcHR5QXJyYXknKSkudG9FcXVhbChbXSk7XG4gICAgICAgICAgICBleHBlY3Qoc2F2ZWRBc3NldC5wcm9wcy5wcm9wZXJ0aWVzLmdldCgnZW1wdHlPYmplY3QnKSkudG9FcXVhbCh7fSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ1JlcXVlc3QgVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICAgICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICAgICAgICAvLyBNb2NrIHN1Y2Nlc3NmdWwgb250b2xvZ3kgbG9va3VwIGZvciB2YWxpZCBjYXNlc1xuICAgICAgICAgICAgY29uc3QgbW9ja09udG9sb2d5ID0ge1xuICAgICAgICAgICAgICAgIGdldFByZWZpeDogKCkgPT4gT250b2xvZ3lQcmVmaXguY3JlYXRlKCdleG8nKS5nZXRWYWx1ZSgpXG4gICAgICAgICAgICB9IGFzIE9udG9sb2d5O1xuICAgICAgICAgICAgbW9ja09udG9sb2d5UmVwb3NpdG9yeS5maW5kQnlQcmVmaXgubW9ja1Jlc29sdmVkVmFsdWUobW9ja09udG9sb2d5KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIHRocm93IGVycm9yIGZvciBlbXB0eSB0aXRsZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3Q6IENyZWF0ZUFzc2V0UmVxdWVzdCA9IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJycsXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZXhvX19Bc3NldCcsXG4gICAgICAgICAgICAgICAgb250b2xvZ3lQcmVmaXg6ICdleG8nXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBhd2FpdCBleHBlY3QodXNlQ2FzZS5leGVjdXRlKHJlcXVlc3QpKS5yZWplY3RzLnRvVGhyb3coJ0Fzc2V0IHRpdGxlIGlzIHJlcXVpcmVkJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCB0aHJvdyBlcnJvciBmb3Igd2hpdGVzcGFjZS1vbmx5IHRpdGxlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdDogQ3JlYXRlQXNzZXRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnICAgXFx0XFxuICAgJyxcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdleG9fX0Fzc2V0JyxcbiAgICAgICAgICAgICAgICBvbnRvbG9neVByZWZpeDogJ2V4bydcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGF3YWl0IGV4cGVjdCh1c2VDYXNlLmV4ZWN1dGUocmVxdWVzdCkpLnJlamVjdHMudG9UaHJvdygnQXNzZXQgdGl0bGUgaXMgcmVxdWlyZWQnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIHRocm93IGVycm9yIGZvciBtaXNzaW5nIGNsYXNzTmFtZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3Q6IENyZWF0ZUFzc2V0UmVxdWVzdCA9IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ1Rlc3QgQXNzZXQnLFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJycsXG4gICAgICAgICAgICAgICAgb250b2xvZ3lQcmVmaXg6ICdleG8nXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBhd2FpdCBleHBlY3QodXNlQ2FzZS5leGVjdXRlKHJlcXVlc3QpKS5yZWplY3RzLnRvVGhyb3coJ0Fzc2V0IGNsYXNzIGlzIHJlcXVpcmVkJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCB0aHJvdyBlcnJvciBmb3IgbnVsbCBjbGFzc05hbWUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0OiBDcmVhdGVBc3NldFJlcXVlc3QgPSB7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICdUZXN0IEFzc2V0JyxcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IG51bGwgYXMgYW55LFxuICAgICAgICAgICAgICAgIG9udG9sb2d5UHJlZml4OiAnZXhvJ1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgYXdhaXQgZXhwZWN0KHVzZUNhc2UuZXhlY3V0ZShyZXF1ZXN0KSkucmVqZWN0cy50b1Rocm93KCdBc3NldCBjbGFzcyBpcyByZXF1aXJlZCcpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdzaG91bGQgdGhyb3cgZXJyb3IgZm9yIG1pc3Npbmcgb250b2xvZ3lQcmVmaXgnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0OiBDcmVhdGVBc3NldFJlcXVlc3QgPSB7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICdUZXN0IEFzc2V0JyxcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdleG9fX0Fzc2V0JyxcbiAgICAgICAgICAgICAgICBvbnRvbG9neVByZWZpeDogJydcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGF3YWl0IGV4cGVjdCh1c2VDYXNlLmV4ZWN1dGUocmVxdWVzdCkpLnJlamVjdHMudG9UaHJvdygnT250b2xvZ3kgcHJlZml4IGlzIHJlcXVpcmVkJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCB0aHJvdyBlcnJvciBmb3IgbnVsbCBvbnRvbG9neVByZWZpeCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3Q6IENyZWF0ZUFzc2V0UmVxdWVzdCA9IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ1Rlc3QgQXNzZXQnLFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2V4b19fQXNzZXQnLFxuICAgICAgICAgICAgICAgIG9udG9sb2d5UHJlZml4OiBudWxsIGFzIGFueVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgYXdhaXQgZXhwZWN0KHVzZUNhc2UuZXhlY3V0ZShyZXF1ZXN0KSkucmVqZWN0cy50b1Rocm93KCdPbnRvbG9neSBwcmVmaXggaXMgcmVxdWlyZWQnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIHZhbGlkYXRlIG11bHRpcGxlIGZpZWxkcyBhdCBvbmNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdDogQ3JlYXRlQXNzZXRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnJyxcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICcnLFxuICAgICAgICAgICAgICAgIG9udG9sb2d5UHJlZml4OiAnJ1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8gU2hvdWxkIGZhaWwgb24gdGhlIGZpcnN0IHZhbGlkYXRpb24gZXJyb3IgKHRpdGxlKVxuICAgICAgICAgICAgYXdhaXQgZXhwZWN0KHVzZUNhc2UuZXhlY3V0ZShyZXF1ZXN0KSkucmVqZWN0cy50b1Rocm93KCdBc3NldCB0aXRsZSBpcyByZXF1aXJlZCcpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIHVuZGVmaW5lZCByZXF1ZXN0IHByb3BlcnRpZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnVGVzdCBBc3NldCdcbiAgICAgICAgICAgICAgICAvLyBNaXNzaW5nIG90aGVyIHJlcXVpcmVkIHByb3BlcnRpZXNcbiAgICAgICAgICAgIH0gYXMgQ3JlYXRlQXNzZXRSZXF1ZXN0O1xuXG4gICAgICAgICAgICBhd2FpdCBleHBlY3QodXNlQ2FzZS5leGVjdXRlKHJlcXVlc3QpKS5yZWplY3RzLnRvVGhyb3coKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnVmFsdWUgT2JqZWN0IENyZWF0aW9uJywgKCkgPT4ge1xuICAgICAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG1vY2tPbnRvbG9neSA9IHtcbiAgICAgICAgICAgICAgICBnZXRQcmVmaXg6ICgpID0+IE9udG9sb2d5UHJlZml4LmNyZWF0ZSgnZXhvJykuZ2V0VmFsdWUoKVxuICAgICAgICAgICAgfSBhcyBPbnRvbG9neTtcbiAgICAgICAgICAgIG1vY2tPbnRvbG9neVJlcG9zaXRvcnkuZmluZEJ5UHJlZml4Lm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tPbnRvbG9neSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgdmFsaWQgY2xhc3NOYW1lIGNyZWF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdDogQ3JlYXRlQXNzZXRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnVGVzdCBBc3NldCcsXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZXhvX19WYWxpZENsYXNzJyxcbiAgICAgICAgICAgICAgICBvbnRvbG9neVByZWZpeDogJ2V4bydcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdXNlQ2FzZS5leGVjdXRlKHJlcXVlc3QpO1xuICAgICAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCB0aHJvdyBlcnJvciBmb3IgaW52YWxpZCBjbGFzc05hbWUgZm9ybWF0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdDogQ3JlYXRlQXNzZXRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnVGVzdCBBc3NldCcsXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnaW52YWxpZC1jbGFzcy1uYW1lIUAjJyxcbiAgICAgICAgICAgICAgICBvbnRvbG9neVByZWZpeDogJ2V4bydcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGF3YWl0IGV4cGVjdCh1c2VDYXNlLmV4ZWN1dGUocmVxdWVzdCkpLnJlamVjdHMudG9UaHJvdygpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIHZhbGlkIG9udG9sb2d5UHJlZml4IGNyZWF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdDogQ3JlYXRlQXNzZXRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnVGVzdCBBc3NldCcsXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZXhvX19Bc3NldCcsXG4gICAgICAgICAgICAgICAgb250b2xvZ3lQcmVmaXg6ICd2YWxpZCdcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnN0IG1vY2tPbnRvbG9neSA9IHtcbiAgICAgICAgICAgICAgICBnZXRQcmVmaXg6ICgpID0+IE9udG9sb2d5UHJlZml4LmNyZWF0ZSgndmFsaWQnKS5nZXRWYWx1ZSgpXG4gICAgICAgICAgICB9IGFzIE9udG9sb2d5O1xuICAgICAgICAgICAgbW9ja09udG9sb2d5UmVwb3NpdG9yeS5maW5kQnlQcmVmaXgubW9ja1Jlc29sdmVkVmFsdWUobW9ja09udG9sb2d5KTtcblxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB1c2VDYXNlLmV4ZWN1dGUocmVxdWVzdCk7XG4gICAgICAgICAgICBleHBlY3QocmVzcG9uc2Uuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIHRocm93IGVycm9yIGZvciBpbnZhbGlkIG9udG9sb2d5UHJlZml4IGZvcm1hdCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3Q6IENyZWF0ZUFzc2V0UmVxdWVzdCA9IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ1Rlc3QgQXNzZXQnLFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2V4b19fQXNzZXQnLFxuICAgICAgICAgICAgICAgIG9udG9sb2d5UHJlZml4OiAnaW52YWxpZC1wcmVmaXghQCMnXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBhd2FpdCBleHBlY3QodXNlQ2FzZS5leGVjdXRlKHJlcXVlc3QpKS5yZWplY3RzLnRvVGhyb3coKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBsb25nIGJ1dCB2YWxpZCBpZGVudGlmaWVycycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGxvbmdCdXRWYWxpZENsYXNzID0gJ2V4b19fJyArICdBJy5yZXBlYXQoMTAwKTtcbiAgICAgICAgICAgIGNvbnN0IGxvbmdCdXRWYWxpZFByZWZpeCA9ICdhJyArICdiJy5yZXBlYXQoNTApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0OiBDcmVhdGVBc3NldFJlcXVlc3QgPSB7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICdUZXN0IEFzc2V0JyxcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IGxvbmdCdXRWYWxpZENsYXNzLFxuICAgICAgICAgICAgICAgIG9udG9sb2d5UHJlZml4OiBsb25nQnV0VmFsaWRQcmVmaXhcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnN0IG1vY2tPbnRvbG9neSA9IHtcbiAgICAgICAgICAgICAgICBnZXRQcmVmaXg6ICgpID0+IE9udG9sb2d5UHJlZml4LmNyZWF0ZShsb25nQnV0VmFsaWRQcmVmaXgpLmdldFZhbHVlKClcbiAgICAgICAgICAgIH0gYXMgT250b2xvZ3k7XG4gICAgICAgICAgICBtb2NrT250b2xvZ3lSZXBvc2l0b3J5LmZpbmRCeVByZWZpeC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrT250b2xvZ3kpO1xuXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHVzZUNhc2UuZXhlY3V0ZShyZXF1ZXN0KTtcbiAgICAgICAgICAgIGV4cGVjdChyZXNwb25zZS5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdPbnRvbG9neSBSZXBvc2l0b3J5IEludGVncmF0aW9uJywgKCkgPT4ge1xuICAgICAgICB0ZXN0KCdzaG91bGQgdmVyaWZ5IG9udG9sb2d5IGV4aXN0cyBiZWZvcmUgY3JlYXRpbmcgYXNzZXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBtb2NrT250b2xvZ3kgPSB7XG4gICAgICAgICAgICAgICAgZ2V0UHJlZml4OiAoKSA9PiBPbnRvbG9neVByZWZpeC5jcmVhdGUoJ2V4bycpLmdldFZhbHVlKClcbiAgICAgICAgICAgIH0gYXMgT250b2xvZ3k7XG4gICAgICAgICAgICBtb2NrT250b2xvZ3lSZXBvc2l0b3J5LmZpbmRCeVByZWZpeC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrT250b2xvZ3kpO1xuXG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0OiBDcmVhdGVBc3NldFJlcXVlc3QgPSB7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICdUZXN0IEFzc2V0JyxcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdleG9fX0Fzc2V0JyxcbiAgICAgICAgICAgICAgICBvbnRvbG9neVByZWZpeDogJ2V4bydcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGF3YWl0IHVzZUNhc2UuZXhlY3V0ZShyZXF1ZXN0KTtcblxuICAgICAgICAgICAgZXhwZWN0KG1vY2tPbnRvbG9neVJlcG9zaXRvcnkuZmluZEJ5UHJlZml4KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiAnZXhvJ1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdzaG91bGQgdGhyb3cgZXJyb3Igd2hlbiBvbnRvbG9neSBub3QgZm91bmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBtb2NrT250b2xvZ3lSZXBvc2l0b3J5LmZpbmRCeVByZWZpeC5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcblxuICAgICAgICAgICAgY29uc3QgcmVxdWVzdDogQ3JlYXRlQXNzZXRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnVGVzdCBBc3NldCcsXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZXhvX19Bc3NldCcsXG4gICAgICAgICAgICAgICAgb250b2xvZ3lQcmVmaXg6ICdub25leGlzdGVudCdcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGF3YWl0IGV4cGVjdCh1c2VDYXNlLmV4ZWN1dGUocmVxdWVzdCkpLnJlamVjdHMudG9UaHJvdygnT250b2xvZ3kgbm9uZXhpc3RlbnQgbm90IGZvdW5kJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgb250b2xvZ3kgcmVwb3NpdG9yeSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBtb2NrT250b2xvZ3lSZXBvc2l0b3J5LmZpbmRCeVByZWZpeC5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ0RhdGFiYXNlIGNvbm5lY3Rpb24gZmFpbGVkJykpO1xuXG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0OiBDcmVhdGVBc3NldFJlcXVlc3QgPSB7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICdUZXN0IEFzc2V0JyxcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdleG9fX0Fzc2V0JyxcbiAgICAgICAgICAgICAgICBvbnRvbG9neVByZWZpeDogJ2V4bydcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGF3YWl0IGV4cGVjdCh1c2VDYXNlLmV4ZWN1dGUocmVxdWVzdCkpLnJlamVjdHMudG9UaHJvdygnRGF0YWJhc2UgY29ubmVjdGlvbiBmYWlsZWQnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBvbnRvbG9neSB3aXRoIGRpZmZlcmVudCBwcmVmaXggZm9ybWF0cycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHByZWZpeGVzID0gWydleG8nLCAncmRmcycsICdvd2wnLCAnZm9hZicsICdkYyddO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHByZWZpeCBvZiBwcmVmaXhlcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1vY2tPbnRvbG9neSA9IHtcbiAgICAgICAgICAgICAgICAgICAgZ2V0UHJlZml4OiAoKSA9PiBPbnRvbG9neVByZWZpeC5jcmVhdGUocHJlZml4KS5nZXRWYWx1ZSgpXG4gICAgICAgICAgICAgICAgfSBhcyBPbnRvbG9neTtcbiAgICAgICAgICAgICAgICBtb2NrT250b2xvZ3lSZXBvc2l0b3J5LmZpbmRCeVByZWZpeC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrT250b2xvZ3kpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgcmVxdWVzdDogQ3JlYXRlQXNzZXRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ1Rlc3QgQXNzZXQnLFxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6IGAke3ByZWZpeH1fX0Fzc2V0YCxcbiAgICAgICAgICAgICAgICAgICAgb250b2xvZ3lQcmVmaXg6IHByZWZpeFxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHVzZUNhc2UuZXhlY3V0ZShyZXF1ZXN0KTtcbiAgICAgICAgICAgICAgICBleHBlY3QocmVzcG9uc2Uuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnQXNzZXQgUmVwb3NpdG9yeSBJbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgICAgICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBtb2NrT250b2xvZ3kgPSB7XG4gICAgICAgICAgICAgICAgZ2V0UHJlZml4OiAoKSA9PiBPbnRvbG9neVByZWZpeC5jcmVhdGUoJ2V4bycpLmdldFZhbHVlKClcbiAgICAgICAgICAgIH0gYXMgT250b2xvZ3k7XG4gICAgICAgICAgICBtb2NrT250b2xvZ3lSZXBvc2l0b3J5LmZpbmRCeVByZWZpeC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrT250b2xvZ3kpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdzaG91bGQgc2F2ZSBhc3NldCB0byByZXBvc2l0b3J5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgbW9ja0Fzc2V0UmVwb3NpdG9yeS5zYXZlLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3Q6IENyZWF0ZUFzc2V0UmVxdWVzdCA9IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ1Rlc3QgQXNzZXQnLFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2V4b19fQXNzZXQnLFxuICAgICAgICAgICAgICAgIG9udG9sb2d5UHJlZml4OiAnZXhvJ1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgYXdhaXQgdXNlQ2FzZS5leGVjdXRlKHJlcXVlc3QpO1xuXG4gICAgICAgICAgICBleHBlY3QobW9ja0Fzc2V0UmVwb3NpdG9yeS5zYXZlKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgICAgICAgICBleHBlY3QobW9ja0Fzc2V0UmVwb3NpdG9yeS5zYXZlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgICAgICAgICBleHBlY3QuYW55KEFzc2V0KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIGhhbmRsZSByZXBvc2l0b3J5IHNhdmUgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgbW9ja0Fzc2V0UmVwb3NpdG9yeS5zYXZlLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignU2F2ZSBmYWlsZWQnKSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3Q6IENyZWF0ZUFzc2V0UmVxdWVzdCA9IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ1Rlc3QgQXNzZXQnLFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2V4b19fQXNzZXQnLFxuICAgICAgICAgICAgICAgIG9udG9sb2d5UHJlZml4OiAnZXhvJ1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgYXdhaXQgZXhwZWN0KHVzZUNhc2UuZXhlY3V0ZShyZXF1ZXN0KSkucmVqZWN0cy50b1Rocm93KCdTYXZlIGZhaWxlZCcpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdzaG91bGQgc2F2ZSBhc3NldCB3aXRoIGNvcnJlY3QgcHJvcGVydGllcycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIG1vY2tBc3NldFJlcG9zaXRvcnkuc2F2ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xuXG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0OiBDcmVhdGVBc3NldFJlcXVlc3QgPSB7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICdUZXN0IEFzc2V0JyxcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdleG9fX1Rhc2snLFxuICAgICAgICAgICAgICAgIG9udG9sb2d5UHJlZml4OiAnZXhvJyxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHByaW9yaXR5OiAnaGlnaCcsXG4gICAgICAgICAgICAgICAgICAgIGR1ZURhdGU6ICcyMDI0LTEyLTMxJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGF3YWl0IHVzZUNhc2UuZXhlY3V0ZShyZXF1ZXN0KTtcblxuICAgICAgICAgICAgZXhwZWN0KG1vY2tBc3NldFJlcG9zaXRvcnkuc2F2ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgICAgICAgICAgICBwcm9wczogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdUZXN0IEFzc2V0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAnZXhvX19UYXNrJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICBvbnRvbG9neTogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAnZXhvJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiBleHBlY3QuYW55KE1hcClcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBjb25jdXJyZW50IHJlcG9zaXRvcnkgb3BlcmF0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIG1vY2tBc3NldFJlcG9zaXRvcnkuc2F2ZS5tb2NrSW1wbGVtZW50YXRpb24oYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMCkpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RzID0gQXJyYXkoNSkuZmlsbChudWxsKS5tYXAoKF8sIGkpID0+ICh7XG4gICAgICAgICAgICAgICAgdGl0bGU6IGBUZXN0IEFzc2V0ICR7aX1gLFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2V4b19fQXNzZXQnLFxuICAgICAgICAgICAgICAgIG9udG9sb2d5UHJlZml4OiAnZXhvJ1xuICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgICBjb25zdCBwcm9taXNlcyA9IHJlcXVlc3RzLm1hcChyZXEgPT4gdXNlQ2FzZS5leGVjdXRlKHJlcSkpO1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VzID0gYXdhaXQgUHJvbWlzZS5hbGwocHJvbWlzZXMpO1xuXG4gICAgICAgICAgICBleHBlY3QocmVzcG9uc2VzKS50b0hhdmVMZW5ndGgoNSk7XG4gICAgICAgICAgICByZXNwb25zZXMuZm9yRWFjaChyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGV4cGVjdChtb2NrQXNzZXRSZXBvc2l0b3J5LnNhdmUpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcyg1KTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnQXNzZXQgQ3JlYXRpb24gUHJvY2VzcycsICgpID0+IHtcbiAgICAgICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBtb2NrT250b2xvZ3kgPSB7XG4gICAgICAgICAgICAgICAgZ2V0UHJlZml4OiAoKSA9PiBPbnRvbG9neVByZWZpeC5jcmVhdGUoJ2V4bycpLmdldFZhbHVlKClcbiAgICAgICAgICAgIH0gYXMgT250b2xvZ3k7XG4gICAgICAgICAgICBtb2NrT250b2xvZ3lSZXBvc2l0b3J5LmZpbmRCeVByZWZpeC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrT250b2xvZ3kpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdzaG91bGQgY3JlYXRlIGFzc2V0IHdpdGggZ2VuZXJhdGVkIElEJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IHNhdmVkQXNzZXQ6IEFzc2V0O1xuICAgICAgICAgICAgbW9ja0Fzc2V0UmVwb3NpdG9yeS5zYXZlLm1vY2tJbXBsZW1lbnRhdGlvbihhc3luYyAoYXNzZXQpID0+IHtcbiAgICAgICAgICAgICAgICBzYXZlZEFzc2V0ID0gYXNzZXQ7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc3QgcmVxdWVzdDogQ3JlYXRlQXNzZXRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnVGVzdCBBc3NldCcsXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZXhvX19Bc3NldCcsXG4gICAgICAgICAgICAgICAgb250b2xvZ3lQcmVmaXg6ICdleG8nXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBhd2FpdCB1c2VDYXNlLmV4ZWN1dGUocmVxdWVzdCk7XG5cbiAgICAgICAgICAgIGV4cGVjdChzYXZlZEFzc2V0ISkudG9CZURlZmluZWQoKTtcbiAgICAgICAgICAgIGV4cGVjdChzYXZlZEFzc2V0IS5nZXRJZCgpKS50b0JlSW5zdGFuY2VPZihBc3NldElkKTtcbiAgICAgICAgICAgIGV4cGVjdChzYXZlZEFzc2V0IS5nZXRJZCgpLnRvU3RyaW5nKCkpLnRvTWF0Y2goL15bMC05YS1mXXs4fS1bMC05YS1mXXs0fS00WzAtOWEtZl17M30tWzg5YWJdWzAtOWEtZl17M30tWzAtOWEtZl17MTJ9JC9pKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIGNyZWF0ZSBhc3NldCB3aXRoIGNvcnJlY3QgbGFiZWwnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBsZXQgc2F2ZWRBc3NldDogQXNzZXQ7XG4gICAgICAgICAgICBtb2NrQXNzZXRSZXBvc2l0b3J5LnNhdmUubW9ja0ltcGxlbWVudGF0aW9uKGFzeW5jIChhc3NldCkgPT4ge1xuICAgICAgICAgICAgICAgIHNhdmVkQXNzZXQgPSBhc3NldDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0OiBDcmVhdGVBc3NldFJlcXVlc3QgPSB7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICdNeSBTcGVjaWFsIEFzc2V0JyxcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdleG9fX0Fzc2V0JyxcbiAgICAgICAgICAgICAgICBvbnRvbG9neVByZWZpeDogJ2V4bydcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGF3YWl0IHVzZUNhc2UuZXhlY3V0ZShyZXF1ZXN0KTtcblxuICAgICAgICAgICAgZXhwZWN0KHNhdmVkQXNzZXQhLmdldFRpdGxlKCkpLnRvQmUoJ015IFNwZWNpYWwgQXNzZXQnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIGNyZWF0ZSBhc3NldCB3aXRoIGNvcnJlY3QgY2xhc3MgYW5kIG9udG9sb2d5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IHNhdmVkQXNzZXQ6IEFzc2V0O1xuICAgICAgICAgICAgbW9ja0Fzc2V0UmVwb3NpdG9yeS5zYXZlLm1vY2tJbXBsZW1lbnRhdGlvbihhc3luYyAoYXNzZXQpID0+IHtcbiAgICAgICAgICAgICAgICBzYXZlZEFzc2V0ID0gYXNzZXQ7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc3QgcmVxdWVzdDogQ3JlYXRlQXNzZXRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnVGVzdCBBc3NldCcsXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZXhvX19UYXNrJyxcbiAgICAgICAgICAgICAgICBvbnRvbG9neVByZWZpeDogJ2V4bydcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGF3YWl0IHVzZUNhc2UuZXhlY3V0ZShyZXF1ZXN0KTtcblxuICAgICAgICAgICAgZXhwZWN0KHNhdmVkQXNzZXQhLmdldENsYXNzTmFtZSgpLnZhbHVlKS50b0JlKCdleG9fX1Rhc2snKTtcbiAgICAgICAgICAgIGV4cGVjdChzYXZlZEFzc2V0IS5nZXRPbnRvbG9neVByZWZpeCgpLnZhbHVlKS50b0JlKCdleG8nKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBhc3NldCBjcmVhdGlvbiBmYWlsdXJlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgLy8gTW9jayBBc3NldC5jcmVhdGUgdG8gcmV0dXJuIGZhaWx1cmVcbiAgICAgICAgICAgIGNvbnN0IG9yaWdpbmFsQ3JlYXRlID0gQXNzZXQuY3JlYXRlO1xuICAgICAgICAgICAgQXNzZXQuY3JlYXRlID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZShSZXN1bHQuZmFpbDxBc3NldD4oJ0Fzc2V0IGNyZWF0aW9uIGZhaWxlZCcpKTtcblxuICAgICAgICAgICAgY29uc3QgcmVxdWVzdDogQ3JlYXRlQXNzZXRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnVGVzdCBBc3NldCcsXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZXhvX19Bc3NldCcsXG4gICAgICAgICAgICAgICAgb250b2xvZ3lQcmVmaXg6ICdleG8nXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBhd2FpdCBleHBlY3QodXNlQ2FzZS5leGVjdXRlKHJlcXVlc3QpKS5yZWplY3RzLnRvVGhyb3coJ0Fzc2V0IGNyZWF0aW9uIGZhaWxlZCcpO1xuXG4gICAgICAgICAgICAvLyBSZXN0b3JlIG9yaWdpbmFsIG1ldGhvZFxuICAgICAgICAgICAgQXNzZXQuY3JlYXRlID0gb3JpZ2luYWxDcmVhdGU7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ1Jlc3BvbnNlIEdlbmVyYXRpb24nLCAoKSA9PiB7XG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbW9ja09udG9sb2d5ID0ge1xuICAgICAgICAgICAgICAgIGdldFByZWZpeDogKCkgPT4gT250b2xvZ3lQcmVmaXguY3JlYXRlKCdleG8nKS5nZXRWYWx1ZSgpXG4gICAgICAgICAgICB9IGFzIE9udG9sb2d5O1xuICAgICAgICAgICAgbW9ja09udG9sb2d5UmVwb3NpdG9yeS5maW5kQnlQcmVmaXgubW9ja1Jlc29sdmVkVmFsdWUobW9ja09udG9sb2d5KTtcbiAgICAgICAgICAgIG1vY2tBc3NldFJlcG9zaXRvcnkuc2F2ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3QgcmVzcG9uc2Ugc3RydWN0dXJlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdDogQ3JlYXRlQXNzZXRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnVGVzdCBBc3NldCcsXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZXhvX19Bc3NldCcsXG4gICAgICAgICAgICAgICAgb250b2xvZ3lQcmVmaXg6ICdleG8nXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHVzZUNhc2UuZXhlY3V0ZShyZXF1ZXN0KTtcblxuICAgICAgICAgICAgZXhwZWN0KHJlc3BvbnNlKS50b0VxdWFsKHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGFzc2V0SWQ6IGV4cGVjdC5hbnkoU3RyaW5nKSxcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnQ3JlYXRlZCBhc3NldDogVGVzdCBBc3NldCdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdzaG91bGQgcmV0dXJuIHZhbGlkIFVVSUQgaW4gYXNzZXRJZCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3Q6IENyZWF0ZUFzc2V0UmVxdWVzdCA9IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ1Rlc3QgQXNzZXQnLFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2V4b19fQXNzZXQnLFxuICAgICAgICAgICAgICAgIG9udG9sb2d5UHJlZml4OiAnZXhvJ1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB1c2VDYXNlLmV4ZWN1dGUocmVxdWVzdCk7XG5cbiAgICAgICAgICAgIGV4cGVjdChyZXNwb25zZS5hc3NldElkKS50b01hdGNoKC9eWzAtOWEtZl17OH0tWzAtOWEtZl17NH0tNFswLTlhLWZdezN9LVs4OWFiXVswLTlhLWZdezN9LVswLTlhLWZdezEyfSQvaSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBpbmNsdWRlIGFzc2V0IHRpdGxlIGluIHN1Y2Nlc3MgbWVzc2FnZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRpdGxlcyA9IFtcbiAgICAgICAgICAgICAgICAnU2ltcGxlIEFzc2V0JyxcbiAgICAgICAgICAgICAgICAnQXNzZXQgd2l0aCBTcGFjZXMnLFxuICAgICAgICAgICAgICAgICdBc3NldC13aXRoLURhc2hlcycsXG4gICAgICAgICAgICAgICAgJ0Fzc2V0X3dpdGhfVW5kZXJzY29yZXMnLFxuICAgICAgICAgICAgICAgICdBc3NldDEyMycsXG4gICAgICAgICAgICAgICAgJ8OEc3NldCB3aXRoIMOcbmljb2RlJ1xuICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgZm9yIChjb25zdCB0aXRsZSBvZiB0aXRsZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXF1ZXN0OiBDcmVhdGVBc3NldFJlcXVlc3QgPSB7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlLFxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdleG9fX0Fzc2V0JyxcbiAgICAgICAgICAgICAgICAgICAgb250b2xvZ3lQcmVmaXg6ICdleG8nXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdXNlQ2FzZS5leGVjdXRlKHJlcXVlc3QpO1xuXG4gICAgICAgICAgICAgICAgZXhwZWN0KHJlc3BvbnNlLm1lc3NhZ2UpLnRvQmUoYENyZWF0ZWQgYXNzZXQ6ICR7dGl0bGV9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ0Vycm9yIFNjZW5hcmlvcycsICgpID0+IHtcbiAgICAgICAgdGVzdCgnc2hvdWxkIGhhbmRsZSByZXBvc2l0b3J5IHRpbWVvdXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBtb2NrT250b2xvZ3lSZXBvc2l0b3J5LmZpbmRCeVByZWZpeC5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4gXG4gICAgICAgICAgICAgICAgbmV3IFByb21pc2UoKF8sIHJlamVjdCkgPT4gXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gcmVqZWN0KG5ldyBFcnJvcignVGltZW91dCcpKSwgMTAwKVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3Q6IENyZWF0ZUFzc2V0UmVxdWVzdCA9IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ1Rlc3QgQXNzZXQnLFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2V4b19fQXNzZXQnLFxuICAgICAgICAgICAgICAgIG9udG9sb2d5UHJlZml4OiAnZXhvJ1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgYXdhaXQgZXhwZWN0KHVzZUNhc2UuZXhlY3V0ZShyZXF1ZXN0KSkucmVqZWN0cy50b1Rocm93KCdUaW1lb3V0Jyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgbWVtb3J5IGNvbnN0cmFpbnRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbW9ja09udG9sb2d5ID0ge1xuICAgICAgICAgICAgICAgIGdldFByZWZpeDogKCkgPT4gT250b2xvZ3lQcmVmaXguY3JlYXRlKCdleG8nKS5nZXRWYWx1ZSgpXG4gICAgICAgICAgICB9IGFzIE9udG9sb2d5O1xuICAgICAgICAgICAgbW9ja09udG9sb2d5UmVwb3NpdG9yeS5maW5kQnlQcmVmaXgubW9ja1Jlc29sdmVkVmFsdWUobW9ja09udG9sb2d5KTtcbiAgICAgICAgICAgIG1vY2tBc3NldFJlcG9zaXRvcnkuc2F2ZS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ091dCBvZiBtZW1vcnknKSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3Q6IENyZWF0ZUFzc2V0UmVxdWVzdCA9IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ1Rlc3QgQXNzZXQnLFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2V4b19fQXNzZXQnLFxuICAgICAgICAgICAgICAgIG9udG9sb2d5UHJlZml4OiAnZXhvJ1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgYXdhaXQgZXhwZWN0KHVzZUNhc2UuZXhlY3V0ZShyZXF1ZXN0KSkucmVqZWN0cy50b1Rocm93KCdPdXQgb2YgbWVtb3J5Jyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgbmV0d29yayBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBtb2NrT250b2xvZ3lSZXBvc2l0b3J5LmZpbmRCeVByZWZpeC5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ05ldHdvcmsgdW5yZWFjaGFibGUnKSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3Q6IENyZWF0ZUFzc2V0UmVxdWVzdCA9IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ1Rlc3QgQXNzZXQnLFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2V4b19fQXNzZXQnLFxuICAgICAgICAgICAgICAgIG9udG9sb2d5UHJlZml4OiAnZXhvJ1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgYXdhaXQgZXhwZWN0KHVzZUNhc2UuZXhlY3V0ZShyZXF1ZXN0KSkucmVqZWN0cy50b1Rocm93KCdOZXR3b3JrIHVucmVhY2hhYmxlJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgcGVybWlzc2lvbiBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBtb2NrQXNzZXRSZXBvc2l0b3J5LnNhdmUubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdQZXJtaXNzaW9uIGRlbmllZCcpKTtcblxuICAgICAgICAgICAgY29uc3QgbW9ja09udG9sb2d5ID0ge1xuICAgICAgICAgICAgICAgIGdldFByZWZpeDogKCkgPT4gT250b2xvZ3lQcmVmaXguY3JlYXRlKCdleG8nKS5nZXRWYWx1ZSgpXG4gICAgICAgICAgICB9IGFzIE9udG9sb2d5O1xuICAgICAgICAgICAgbW9ja09udG9sb2d5UmVwb3NpdG9yeS5maW5kQnlQcmVmaXgubW9ja1Jlc29sdmVkVmFsdWUobW9ja09udG9sb2d5KTtcblxuICAgICAgICAgICAgY29uc3QgcmVxdWVzdDogQ3JlYXRlQXNzZXRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnVGVzdCBBc3NldCcsXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZXhvX19Bc3NldCcsXG4gICAgICAgICAgICAgICAgb250b2xvZ3lQcmVmaXg6ICdleG8nXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBhd2FpdCBleHBlY3QodXNlQ2FzZS5leGVjdXRlKHJlcXVlc3QpKS5yZWplY3RzLnRvVGhyb3coJ1Blcm1pc3Npb24gZGVuaWVkJyk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ0VkZ2UgQ2FzZXMnLCAoKSA9PiB7XG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbW9ja09udG9sb2d5ID0ge1xuICAgICAgICAgICAgICAgIGdldFByZWZpeDogKCkgPT4gT250b2xvZ3lQcmVmaXguY3JlYXRlKCdleG8nKS5nZXRWYWx1ZSgpXG4gICAgICAgICAgICB9IGFzIE9udG9sb2d5O1xuICAgICAgICAgICAgbW9ja09udG9sb2d5UmVwb3NpdG9yeS5maW5kQnlQcmVmaXgubW9ja1Jlc29sdmVkVmFsdWUobW9ja09udG9sb2d5KTtcbiAgICAgICAgICAgIG1vY2tBc3NldFJlcG9zaXRvcnkuc2F2ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIGV4dHJlbWVseSBsb25nIHByb3BlcnR5IHZhbHVlcycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGxvbmdWYWx1ZSA9ICdBJy5yZXBlYXQoMTAwMDApO1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdDogQ3JlYXRlQXNzZXRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnVGVzdCBBc3NldCcsXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZXhvX19Bc3NldCcsXG4gICAgICAgICAgICAgICAgb250b2xvZ3lQcmVmaXg6ICdleG8nLFxuICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgbG9uZ1Byb3BlcnR5OiBsb25nVmFsdWVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHVzZUNhc2UuZXhlY3V0ZShyZXF1ZXN0KTtcblxuICAgICAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgZGVlcGx5IG5lc3RlZCBwcm9wZXJ0eSBvYmplY3RzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZGVlcE9iamVjdDogYW55ID0ge307XG4gICAgICAgICAgICBsZXQgY3VycmVudCA9IGRlZXBPYmplY3Q7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50LmxldmVsID0gaTtcbiAgICAgICAgICAgICAgICBjdXJyZW50Lm5leHQgPSB7fTtcbiAgICAgICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudC5uZXh0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0OiBDcmVhdGVBc3NldFJlcXVlc3QgPSB7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICdUZXN0IEFzc2V0JyxcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdleG9fX0Fzc2V0JyxcbiAgICAgICAgICAgICAgICBvbnRvbG9neVByZWZpeDogJ2V4bycsXG4gICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBkZWVwT2JqZWN0XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB1c2VDYXNlLmV4ZWN1dGUocmVxdWVzdCk7XG5cbiAgICAgICAgICAgIGV4cGVjdChyZXNwb25zZS5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIGxhcmdlIG51bWJlciBvZiBwcm9wZXJ0aWVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcHJvcGVydGllczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDAwOyBpKyspIHtcbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzW2Bwcm9wJHtpfWBdID0gYHZhbHVlJHtpfWA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3Q6IENyZWF0ZUFzc2V0UmVxdWVzdCA9IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ1Rlc3QgQXNzZXQnLFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2V4b19fQXNzZXQnLFxuICAgICAgICAgICAgICAgIG9udG9sb2d5UHJlZml4OiAnZXhvJyxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHVzZUNhc2UuZXhlY3V0ZShyZXF1ZXN0KTtcblxuICAgICAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgc3BlY2lhbCBwcm9wZXJ0eSBuYW1lcycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3Q6IENyZWF0ZUFzc2V0UmVxdWVzdCA9IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ1Rlc3QgQXNzZXQnLFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2V4b19fQXNzZXQnLFxuICAgICAgICAgICAgICAgIG9udG9sb2d5UHJlZml4OiAnZXhvJyxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICcnOiAnZW1wdHkga2V5JyxcbiAgICAgICAgICAgICAgICAgICAgJyAnOiAnc3BhY2Uga2V5JyxcbiAgICAgICAgICAgICAgICAgICAgJ19fcHJvdG9fXyc6ICdwcm90b3R5cGUga2V5JyxcbiAgICAgICAgICAgICAgICAgICAgJ2NvbnN0cnVjdG9yJzogJ2NvbnN0cnVjdG9yIGtleScsXG4gICAgICAgICAgICAgICAgICAgICd0b1N0cmluZyc6ICd0b1N0cmluZyBrZXknLFxuICAgICAgICAgICAgICAgICAgICAnMTIzJzogJ251bWVyaWMga2V5JyxcbiAgICAgICAgICAgICAgICAgICAgJ2tleS53aXRoLmRvdHMnOiAnZG90dGVkIGtleScsXG4gICAgICAgICAgICAgICAgICAgICdrZXktd2l0aC1kYXNoZXMnOiAnZGFzaGVkIGtleScsXG4gICAgICAgICAgICAgICAgICAgICdrZXlfd2l0aF91bmRlcnNjb3Jlcyc6ICd1bmRlcnNjb3JlZCBrZXknXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB1c2VDYXNlLmV4ZWN1dGUocmVxdWVzdCk7XG5cbiAgICAgICAgICAgIGV4cGVjdChyZXNwb25zZS5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIGNpcmN1bGFyIHJlZmVyZW5jZXMgaW4gcHJvcGVydGllcycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG9iajE6IGFueSA9IHsgbmFtZTogJ29iajEnIH07XG4gICAgICAgICAgICBjb25zdCBvYmoyOiBhbnkgPSB7IG5hbWU6ICdvYmoyJywgcmVmOiBvYmoxIH07XG4gICAgICAgICAgICBvYmoxLnJlZiA9IG9iajI7IC8vIENyZWF0ZSBjaXJjdWxhciByZWZlcmVuY2VcblxuICAgICAgICAgICAgY29uc3QgcmVxdWVzdDogQ3JlYXRlQXNzZXRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnVGVzdCBBc3NldCcsXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZXhvX19Bc3NldCcsXG4gICAgICAgICAgICAgICAgb250b2xvZ3lQcmVmaXg6ICdleG8nLFxuICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgY2lyY3VsYXI6IG9iajFcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBUaGlzIHNob3VsZCBub3QgdGhyb3cgYW4gZXJyb3IgYnV0IG1heSBzZXJpYWxpemUgZGlmZmVyZW50bHlcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdXNlQ2FzZS5leGVjdXRlKHJlcXVlc3QpO1xuXG4gICAgICAgICAgICBleHBlY3QocmVzcG9uc2Uuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBudWxsIGFuZCB1bmRlZmluZWQgbWl4ZWQgcHJvcGVydGllcycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3Q6IENyZWF0ZUFzc2V0UmVxdWVzdCA9IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ1Rlc3QgQXNzZXQnLFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2V4b19fQXNzZXQnLFxuICAgICAgICAgICAgICAgIG9udG9sb2d5UHJlZml4OiAnZXhvJyxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIG51bGxWYWx1ZTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgdW5kZWZpbmVkVmFsdWU6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgZW1wdHlTdHJpbmc6ICcnLFxuICAgICAgICAgICAgICAgICAgICB6ZXJvOiAwLFxuICAgICAgICAgICAgICAgICAgICBmYWxzZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVtcHR5QXJyYXk6IFtdLFxuICAgICAgICAgICAgICAgICAgICBlbXB0eU9iamVjdDoge31cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHVzZUNhc2UuZXhlY3V0ZShyZXF1ZXN0KTtcblxuICAgICAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ1BlcmZvcm1hbmNlIFRlc3RzJywgKCkgPT4ge1xuICAgICAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG1vY2tPbnRvbG9neSA9IHtcbiAgICAgICAgICAgICAgICBnZXRQcmVmaXg6ICgpID0+IE9udG9sb2d5UHJlZml4LmNyZWF0ZSgnZXhvJykuZ2V0VmFsdWUoKVxuICAgICAgICAgICAgfSBhcyBPbnRvbG9neTtcbiAgICAgICAgICAgIG1vY2tPbnRvbG9neVJlcG9zaXRvcnkuZmluZEJ5UHJlZml4Lm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tPbnRvbG9neSk7XG4gICAgICAgICAgICBtb2NrQXNzZXRSZXBvc2l0b3J5LnNhdmUubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIGNvbXBsZXRlIHdpdGhpbiByZWFzb25hYmxlIHRpbWUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0OiBDcmVhdGVBc3NldFJlcXVlc3QgPSB7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICdUZXN0IEFzc2V0JyxcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdleG9fX0Fzc2V0JyxcbiAgICAgICAgICAgICAgICBvbnRvbG9neVByZWZpeDogJ2V4bydcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGF3YWl0IHVzZUNhc2UuZXhlY3V0ZShyZXF1ZXN0KTtcblxuICAgICAgICAgICAgY29uc3QgZW5kVGltZSA9IERhdGUubm93KCk7XG4gICAgICAgICAgICBjb25zdCBkdXJhdGlvbiA9IGVuZFRpbWUgLSBzdGFydFRpbWU7XG5cbiAgICAgICAgICAgIGV4cGVjdChkdXJhdGlvbikudG9CZUxlc3NUaGFuKDEwMDApOyAvLyBTaG91bGQgY29tcGxldGUgd2l0aGluIDEgc2Vjb25kXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgYmF0Y2ggb3BlcmF0aW9ucyBlZmZpY2llbnRseScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RzID0gQXJyYXkoMTAwKS5maWxsKG51bGwpLm1hcCgoXywgaSkgPT4gKHtcbiAgICAgICAgICAgICAgICB0aXRsZTogYFRlc3QgQXNzZXQgJHtpfWAsXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZXhvX19Bc3NldCcsXG4gICAgICAgICAgICAgICAgb250b2xvZ3lQcmVmaXg6ICdleG8nXG4gICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHByb21pc2VzID0gcmVxdWVzdHMubWFwKHJlcSA9PiB1c2VDYXNlLmV4ZWN1dGUocmVxKSk7XG4gICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcyk7XG5cbiAgICAgICAgICAgIGNvbnN0IGVuZFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICAgICAgY29uc3QgZHVyYXRpb24gPSBlbmRUaW1lIC0gc3RhcnRUaW1lO1xuXG4gICAgICAgICAgICBleHBlY3QoZHVyYXRpb24pLnRvQmVMZXNzVGhhbig1MDAwKTsgLy8gU2hvdWxkIGNvbXBsZXRlIHdpdGhpbiA1IHNlY29uZHMgZm9yIDEwMCBvcGVyYXRpb25zXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBub3QgYWNjdW11bGF0ZSBtZW1vcnkgb3ZlciBtdWx0aXBsZSBleGVjdXRpb25zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaW5pdGlhbE1lbW9yeSA9IHByb2Nlc3MubWVtb3J5VXNhZ2UoKS5oZWFwVXNlZDtcblxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA1MDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVxdWVzdDogQ3JlYXRlQXNzZXRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogYFRlc3QgQXNzZXQgJHtpfWAsXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2V4b19fQXNzZXQnLFxuICAgICAgICAgICAgICAgICAgICBvbnRvbG9neVByZWZpeDogJ2V4bydcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgYXdhaXQgdXNlQ2FzZS5leGVjdXRlKHJlcXVlc3QpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBGb3JjZSBnYXJiYWdlIGNvbGxlY3Rpb24gaWYgcG9zc2libGVcbiAgICAgICAgICAgIGlmIChnbG9iYWwuZ2MpIHtcbiAgICAgICAgICAgICAgICBnbG9iYWwuZ2MoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgZmluYWxNZW1vcnkgPSBwcm9jZXNzLm1lbW9yeVVzYWdlKCkuaGVhcFVzZWQ7XG4gICAgICAgICAgICBjb25zdCBtZW1vcnlJbmNyZWFzZSA9IGZpbmFsTWVtb3J5IC0gaW5pdGlhbE1lbW9yeTtcblxuICAgICAgICAgICAgLy8gTWVtb3J5IGluY3JlYXNlIHNob3VsZCBiZSByZWFzb25hYmxlIChsZXNzIHRoYW4gMTBNQilcbiAgICAgICAgICAgIGV4cGVjdChtZW1vcnlJbmNyZWFzZSkudG9CZUxlc3NUaGFuKDEwICogMTAyNCAqIDEwMjQpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==