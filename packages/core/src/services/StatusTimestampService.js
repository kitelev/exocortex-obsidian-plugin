import { FrontmatterService } from "./FrontmatterService";
import { DateFormatter } from "../utilities/DateFormatter";
export class StatusTimestampService {
    constructor(vault) {
        this.vault = vault;
        this.frontmatterService = new FrontmatterService();
    }
    async addStartTimestamp(taskFile) {
        const content = await this.vault.read(taskFile);
        const timestamp = DateFormatter.toLocalTimestamp(new Date());
        const updated = this.frontmatterService.updateProperty(content, "ems__Effort_startTimestamp", timestamp);
        await this.vault.modify(taskFile, updated);
    }
    async addEndTimestamp(taskFile, date) {
        const content = await this.vault.read(taskFile);
        const targetDate = date || new Date();
        const timestamp = DateFormatter.toLocalTimestamp(targetDate);
        const updated = this.frontmatterService.updateProperty(content, "ems__Effort_endTimestamp", timestamp);
        await this.vault.modify(taskFile, updated);
    }
    async addResolutionTimestamp(taskFile) {
        const content = await this.vault.read(taskFile);
        const timestamp = DateFormatter.toLocalTimestamp(new Date());
        const updated = this.frontmatterService.updateProperty(content, "ems__Effort_resolutionTimestamp", timestamp);
        await this.vault.modify(taskFile, updated);
    }
    async addEndAndResolutionTimestamps(taskFile, date) {
        const content = await this.vault.read(taskFile);
        const targetDate = date || new Date();
        const timestamp = DateFormatter.toLocalTimestamp(targetDate);
        let updated = this.frontmatterService.updateProperty(content, "ems__Effort_endTimestamp", timestamp);
        updated = this.frontmatterService.updateProperty(updated, "ems__Effort_resolutionTimestamp", timestamp);
        await this.vault.modify(taskFile, updated);
    }
    async removeStartTimestamp(taskFile) {
        const content = await this.vault.read(taskFile);
        const updated = this.frontmatterService.removeProperty(content, "ems__Effort_startTimestamp");
        await this.vault.modify(taskFile, updated);
    }
    async removeEndTimestamp(taskFile) {
        const content = await this.vault.read(taskFile);
        const updated = this.frontmatterService.removeProperty(content, "ems__Effort_endTimestamp");
        await this.vault.modify(taskFile, updated);
    }
    async removeResolutionTimestamp(taskFile) {
        const content = await this.vault.read(taskFile);
        const updated = this.frontmatterService.removeProperty(content, "ems__Effort_resolutionTimestamp");
        await this.vault.modify(taskFile, updated);
    }
    async removeEndAndResolutionTimestamps(taskFile) {
        const content = await this.vault.read(taskFile);
        let updated = this.frontmatterService.removeProperty(content, "ems__Effort_endTimestamp");
        updated = this.frontmatterService.removeProperty(updated, "ems__Effort_resolutionTimestamp");
        await this.vault.modify(taskFile, updated);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU3RhdHVzVGltZXN0YW1wU2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIlN0YXR1c1RpbWVzdGFtcFNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDMUQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBRTNELE1BQU0sT0FBTyxzQkFBc0I7SUFHakMsWUFBb0IsS0FBWTtRQUFaLFVBQUssR0FBTCxLQUFLLENBQU87UUFDOUIsSUFBSSxDQUFDLGtCQUFrQixHQUFHLElBQUksa0JBQWtCLEVBQUUsQ0FBQztJQUNyRCxDQUFDO0lBRUQsS0FBSyxDQUFDLGlCQUFpQixDQUFDLFFBQWU7UUFDckMsTUFBTSxPQUFPLEdBQUcsTUFBTSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUNoRCxNQUFNLFNBQVMsR0FBRyxhQUFhLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxJQUFJLEVBQUUsQ0FBQyxDQUFDO1FBRTdELE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxjQUFjLENBQ3BELE9BQU8sRUFDUCw0QkFBNEIsRUFDNUIsU0FBUyxDQUNWLENBQUM7UUFFRixNQUFNLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUM3QyxDQUFDO0lBRUQsS0FBSyxDQUFDLGVBQWUsQ0FBQyxRQUFlLEVBQUUsSUFBVztRQUNoRCxNQUFNLE9BQU8sR0FBRyxNQUFNLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ2hELE1BQU0sVUFBVSxHQUFHLElBQUksSUFBSSxJQUFJLElBQUksRUFBRSxDQUFDO1FBQ3RDLE1BQU0sU0FBUyxHQUFHLGFBQWEsQ0FBQyxnQkFBZ0IsQ0FBQyxVQUFVLENBQUMsQ0FBQztR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cEQsTUFBTSxPQUFPLEdBQUcsTUFBTSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUNoRCxJQUFJLE9BQU8sR0FBRyxJQUFJLENBQUMsa0JBQWtCLENBQUMsY0FBYyxDQUNsRCxPQUFPLEVBQ1AsMEJBQTBCLENBQzNCLENBQUM7UUFDRixPQUFPLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixDQUFDLGNBQWMsQ0FDOUMsT0FBTyxFQUNQLGlDQUFpQyxDQUNsQyxDQUFDO1FBQ0YsTUFBTSxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxRQUFRLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDN0MsQ0FBQztDQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVEZpbGUsIFZhdWx0IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBGcm9udG1hdHRlclNlcnZpY2UgfSBmcm9tIFwiLi9Gcm9udG1hdHRlclNlcnZpY2VcIjtcbmltcG9ydCB7IERhdGVGb3JtYXR0ZXIgfSBmcm9tIFwiLi4vdXRpbGl0aWVzL0RhdGVGb3JtYXR0ZXJcIjtcblxuZXhwb3J0IGNsYXNzIFN0YXR1c1RpbWVzdGFtcFNlcnZpY2Uge1xuICBwcml2YXRlIGZyb250bWF0dGVyU2VydmljZTogRnJvbnRtYXR0ZXJTZXJ2aWNlO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgdmF1bHQ6IFZhdWx0KSB7XG4gICAgdGhpcy5mcm9udG1hdHRlclNlcnZpY2UgPSBuZXcgRnJvbnRtYXR0ZXJTZXJ2aWNlKCk7XG4gIH1cblxuICBhc3luYyBhZGRTdGFydFRpbWVzdGFtcCh0YXNrRmlsZTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy52YXVsdC5yZWFkKHRhc2tGaWxlKTtcbiAgICBjb25zdCB0aW1lc3RhbXAgPSBEYXRlRm9ybWF0dGVyLnRvTG9jYWxUaW1lc3RhbXAobmV3IERhdGUoKSk7XG5cbiAgICBjb25zdCB1cGRhdGVkID0gdGhpcy5mcm9udG1hdHRlclNlcnZpY2UudXBkYXRlUHJvcGVydHkoXG4gICAgICBjb250ZW50LFxuICAgICAgXCJlbXNfX0VmZm9ydF9zdGFydFRpbWVzdGFtcFwiLFxuICAgICAgdGltZXN0YW1wLFxuICAgICk7XG5cbiAgICBhd2FpdCB0aGlzLnZhdWx0Lm1vZGlmeSh0YXNrRmlsZSwgdXBkYXRlZCk7XG4gIH1cblxuICBhc3luYyBhZGRFbmRUaW1lc3RhbXAodGFza0ZpbGU6IFRGaWxlLCBkYXRlPzogRGF0ZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLnZhdWx0LnJlYWQodGFza0ZpbGUpO1xuICAgIGNvbnN0IHRhcmdldERhdGUgPSBkYXRlIHx8IG5ldyBEYXRlKCk7XG4gICAgY29uc3QgdGltZXN0YW1wID0gRGF0ZUZvcm1hdHRlci50b0xvY2FsVGltZXN0YW1wKHRhcmdldERhdGUpO1xuXG4gICAgY29uc3QgdXBkYXRlZCA9IHRoaXMuZnJvbnRtYXR0ZXJTZXJ2aWNlLnVwZGF0ZVByb3BlcnR5KFxuICAgICAgY29udGVudCxcbiAgICAgIFwiZW1zX19FZmZvcnRfZW5kVGltZXN0YW1wXCIsXG4gICAgICB0aW1lc3RhbXAsXG4gICAgKTtcblxuICAgIGF3YWl0IHRoaXMudmF1bHQubW9kaWZ5KHRhc2tGaWxlLCB1cGRhdGVkKTtcbiAgfVxuXG4gIGFzeW5jIGFkZFJlc29sdXRpb25UaW1lc3RhbXAodGFza0ZpbGU6IFRGaWxlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMudmF1bHQucmVhZCh0YXNrRmlsZSk7XG4gICAgY29uc3QgdGltZXN0YW1wID0gRGF0ZUZvcm1hdHRlci50b0xvY2FsVGltZXN0YW1wKG5ldyBEYXRlKCkpO1xuXG4gICAgY29uc3QgdXBkYXRlZCA9IHRoaXMuZnJvbnRtYXR0ZXJTZXJ2aWNlLnVwZGF0ZVByb3BlcnR5KFxuICAgICAgY29udGVudCxcbiAgICAgIFwiZW1zX19FZmZvcnRfcmVzb2x1dGlvblRpbWVzdGFtcFwiLFxuICAgICAgdGltZXN0YW1wLFxuICAgICk7XG5cbiAgICBhd2FpdCB0aGlzLnZhdWx0Lm1vZGlmeSh0YXNrRmlsZSwgdXBkYXRlZCk7XG4gIH1cblxuICBhc3luYyBhZGRFbmRBbmRSZXNvbHV0aW9uVGltZXN0YW1wcyhcbiAgICB0YXNrRmlsZTogVEZpbGUsXG4gICAgZGF0ZT86IERhdGUsXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLnZhdWx0LnJlYWQodGFza0ZpbGUpO1xuICAgIGNvbnN0IHRhcmdldERhdGUgPSBkYXRlIHx8IG5ldyBEYXRlKCk7XG4gICAgY29uc3QgdGltZXN0YW1wID0gRGF0ZUZvcm1hdHRlci50b0xvY2FsVGltZXN0YW1wKHRhcmdldERhdGUpO1xuXG4gICAgbGV0IHVwZGF0ZWQgPSB0aGlzLmZyb250bWF0dGVyU2VydmljZS51cGRhdGVQcm9wZXJ0eShcbiAgICAgIGNvbnRlbnQsXG4gICAgICBcImVtc19fRWZmb3J0X2VuZFRpbWVzdGFtcFwiLFxuICAgICAgdGltZXN0YW1wLFxuICAgICk7XG4gICAgdXBkYXRlZCA9IHRoaXMuZnJvbnRtYXR0ZXJTZXJ2aWNlLnVwZGF0ZVByb3BlcnR5KFxuICAgICAgdXBkYXRlZCxcbiAgICAgIFwiZW1zX19FZmZvcnRfcmVzb2x1dGlvblRpbWVzdGFtcFwiLFxuICAgICAgdGltZXN0YW1wLFxuICAgICk7XG5cbiAgICBhd2FpdCB0aGlzLnZhdWx0Lm1vZGlmeSh0YXNrRmlsZSwgdXBkYXRlZCk7XG4gIH1cblxuICBhc3luYyByZW1vdmVTdGFydFRpbWVzdGFtcCh0YXNrRmlsZTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy52YXVsdC5yZWFkKHRhc2tGaWxlKTtcbiAgICBjb25zdCB1cGRhdGVkID0gdGhpcy5mcm9udG1hdHRlclNlcnZpY2UucmVtb3ZlUHJvcGVydHkoXG4gICAgICBjb250ZW50LFxuICAgICAgXCJlbXNfX0VmZm9ydF9zdGFydFRpbWVzdGFtcFwiLFxuICAgICk7XG4gICAgYXdhaXQgdGhpcy52YXVsdC5tb2RpZnkodGFza0ZpbGUsIHVwZGF0ZWQpO1xuICB9XG5cbiAgYXN5bmMgcmVtb3ZlRW5kVGltZXN0YW1wKHRhc2tGaWxlOiBURmlsZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLnZhdWx0LnJlYWQodGFza0ZpbGUpO1xuICAgIGNvbnN0IHVwZGF0ZWQgPSB0aGlzLmZyb250bWF0dGVyU2VydmljZS5yZW1vdmVQcm9wZXJ0eShcbiAgICAgIGNvbnRlbnQsXG4gICAgICBcImVtc19fRWZmb3J0X2VuZFRpbWVzdGFtcFwiLFxuICAgICk7XG4gICAgYXdhaXQgdGhpcy52YXVsdC5tb2RpZnkodGFza0ZpbGUsIHVwZGF0ZWQpO1xuICB9XG5cbiAgYXN5bmMgcmVtb3ZlUmVzb2x1dGlvblRpbWVzdGFtcCh0YXNrRmlsZTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy52YXVsdC5yZWFkKHRhc2tGaWxlKTtcbiAgICBjb25zdCB1cGRhdGVkID0gdGhpcy5mcm9udG1hdHRlclNlcnZpY2UucmVtb3ZlUHJvcGVydHkoXG4gICAgICBjb250ZW50LFxuICAgICAgXCJlbXNfX0VmZm9ydF9yZXNvbHV0aW9uVGltZXN0YW1wXCIsXG4gICAgKTtcbiAgICBhd2FpdCB0aGlzLnZhdWx0Lm1vZGlmeSh0YXNrRmlsZSwgdXBkYXRlZCk7XG4gIH1cblxuICBhc3luYyByZW1vdmVFbmRBbmRSZXNvbHV0aW9uVGltZXN0YW1wcyh0YXNrRmlsZTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy52YXVsdC5yZWFkKHRhc2tGaWxlKTtcbiAgICBsZXQgdXBkYXRlZCA9IHRoaXMuZnJvbnRtYXR0ZXJTZXJ2aWNlLnJlbW92ZVByb3BlcnR5KFxuICAgICAgY29udGVudCxcbiAgICAgIFwiZW1zX19FZmZvcnRfZW5kVGltZXN0YW1wXCIsXG4gICAgKTtcbiAgICB1cGRhdGVkID0gdGhpcy5mcm9udG1hdHRlclNlcnZpY2UucmVtb3ZlUHJvcGVydHkoXG4gICAgICB1cGRhdGVkLFxuICAgICAgXCJlbXNfX0VmZm9ydF9yZXNvbHV0aW9uVGltZXN0YW1wXCIsXG4gICAgKTtcbiAgICBhd2FpdCB0aGlzLnZhdWx0Lm1vZGlmeSh0YXNrRmlsZSwgdXBkYXRlZCk7XG4gIH1cbn1cbiJdfQ==