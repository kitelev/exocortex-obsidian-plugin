#!/usr/bin/env node
// exocortex-cli v0.1.0
// CLI tool for Exocortex knowledge management system - SPARQL queries, task management, and more
// License: MIT

"use strict";var KS=Object.create;var Pa=Object.defineProperty;var YS=Object.getOwnPropertyDescriptor;var QS=Object.getOwnPropertyNames;var JS=Object.getPrototypeOf,XS=Object.prototype.hasOwnProperty;var o=(r,e)=>Pa(r,"name",{value:e,configurable:!0});var ZS=(r,e)=>()=>(r&&(e=r(r=0)),e);var y=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),ew=(r,e)=>{for(var t in e)Pa(r,t,{get:e[t],enumerable:!0})},z1=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of QS(e))!XS.call(r,i)&&i!==t&&Pa(r,i,{get:()=>e[i],enumerable:!(n=YS(e,i))||n.enumerable});return r};var Qe=(r,e,t)=>(t=r!=null?KS(JS(r)):{},z1(e||!r||!r.__esModule?Pa(t,"default",{value:r,enumerable:!0}):t,r)),cf=r=>z1(Pa({},"__esModule",{value:!0}),r);var uf=y(()=>{var K1;(function(r){(function(e){var t=typeof globalThis=="object"?globalThis:typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:c(),n=i(r);typeof t.Reflect<"u"&&(n=i(t.Reflect,n)),e(n,t),typeof t.Reflect>"u"&&(t.Reflect=r);function i(u,f){return function(l,h){Object.defineProperty(u,l,{configurable:!0,writable:!0,value:h}),f&&f(l,h)}}o(i,"makeExporter");function s(){try{return Function("return this;")()}catch{}}o(s,"functionThis");function a(){try{return(0,eval)("(function() { return this; })()")}catch{}}o(a,"indirectEvalThis");function c(){return s()||a()}o(c,"sloppyModeThis")})(function(e,t){var n=Object.prototype.hasOwnProperty,i=typeof Symbol=="function",s=i&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",a=i&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",c=typeof Object.create=="function",u={__proto__:[]}instanceof Array,f=!c&&!u,l={create:c?function(){return me(Object.create(null))}:u?function(){return me({__proto__:null})}:function(){return me({})},has:f?function(_,v){return n.call(_,v)}:function(_,v){return v in _},get:f?function(_,v){return n.call(_,v)?_[v]:void 0}:function(_,v){return _[v]}},h=Object.getPrototypeOf(Function),p=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:oe(),g=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:De(),w=typeof WeakMap=="function"?WeakMap:Oe(),S=i?Symbol.for("@reflect-metadata:registry"):void 0,x=ie(),P=se(x);function F(_,v,b,C){if(j(b)){if(!ve(_))throw new TypeError;if(!Se(v))throw new TypeError;return Ze(_,v)}else{if(!ve(_))throw new TypeError;if(!W(v))throw new TypeError;if(!W(C)&&!j(C)&&!le(C))throw new TypeError;return le(C)&&(C=void 0),b=ue(b),Ge(_,v,b,C)}}o(F,"decorate"),e("decorate",F);function L(_,v){function b(C,V){if(!W(C))throw new TypeError;if(!j(V)&&!xe(V))throw new TypeError;G(_,v,C,V)}return o(b,"decorator"),b}o(L,"metadata"),e("metadata",L);function $(_,v,b,C){if(!W(b))throw new TypeError;return j(C)||(C=ue(C)),G(_,v,b,C)}o($,"defineMetadata"),e("defineMetadata",$);function K(_,v,b){if(!W(v))throw new TypeError;return j(b)||(b=ue(b)),ze(_,v,b)}o(K,"hasMetadata"),e("hasMetadata",K);function Fe(_,v,b){if(!W(v))throw new TypeError;return j(b)||(b=ue(b)),Ne(_,v,b)}o(Fe,"hasOwnMetadata"),e("hasOwnMetadata",Fe);function Xe(_,v,b){if(!W(v))throw new TypeError;return j(b)||(b=ue(b)),ke(_,v,b)}o(Xe,"getMetadata"),e("getMetadata",Xe);function at(_,v,b){if(!W(v))throw new TypeError;return j(b)||(b=ue(b)),Pe(_,v,b)}o(at,"getOwnMetadata"),e("getOwnMetadata",at);function B(_,v){if(!W(_))throw new TypeError;return j(v)||(v=ue(v)),D(_,v)}o(B,"getMetadataKeys"),e("getMetadataKeys",B);function ce(_,v){if(!W(_))throw new TypeError;return j(v)||(v=ue(v)),je(_,v)}o(ce,"getOwnMetadataKeys"),e("getOwnMetadataKeys",ce);function Ce(_,v,b){if(!W(v))throw new TypeError;if(j(b)||(b=ue(b)),!W(v))throw new TypeError;j(b)||(b=ue(b));var C=Y(v,b,!1);return j(C)?!1:C.OrdinaryDeleteMetadata(_,v,b)}o(Ce,"deleteMetadata"),e("deleteMetadata",Ce);function Ze(_,v){for(var b=_.length-1;b>=0;--b){var C=_[b],V=C(v);if(!j(V)&&!le(V)){if(!Se(V))throw new TypeError;v=V}}return v}o(Ze,"DecorateConstructor");function Ge(_,v,b,C){for(var V=_.length-1;V>=0;--V){var ge=_[V],$e=ge(v,b,C);if(!j($e)&&!le($e)){if(!W($e))throw new TypeError;C=$e}}return C}o(Ge,"DecorateProperty");function ze(_,v,b){var C=Ne(_,v,b);if(C)return!0;var V=Q(v);return le(V)?!1:ze(_,V,b)}o(ze,"OrdinaryHasMetadata");function Ne(_,v,b){var C=Y(v,b,!1);return j(C)?!1:_e(C.OrdinaryHasOwnMetadata(_,v,b))}o(Ne,"OrdinaryHasOwnMetadata");function ke(_,v,b){var C=Ne(_,v,b);if(C)return Pe(_,v,b);var V=Q(v);if(!le(V))return ke(_,V,b)}o(ke,"OrdinaryGetMetadata");function Pe(_,v,b){var C=Y(v,b,!1);if(!j(C))return C.OrdinaryGetOwnMetadata(_,v,b)}o(Pe,"OrdinaryGetOwnMetadata");function G(_,v,b,C){var V=Y(b,C,!0);V.OrdinaryDefineOwnMetadata(_,v,b,C)}o(G,"OrdinaryDefineOwnMetadata");function D(_,v){var b=je(_,v),C=Q(_);if(C===null)return b;var V=D(C,v);if(V.length<=0)return b;if(b.length<=0)return V;for(var ge=new g,$e=[],ye=0,N=b;ye<N.length;ye++){var k=N[ye],M=ge.has(k);M||(ge.add(k),$e.push(k))}for(var q=0,de=V;q<de.length;q++){var k=de[q],M=ge.has(k);M||(ge.add(k),$e.push(k))}return $e}o(D,"OrdinaryMetadataKeys");function je(_,v){var b=Y(_,v,!1);return b?b.OrdinaryOwnMetadataKeys(_,v):[]}o(je,"OrdinaryOwnMetadataKeys");function Be(_){if(_===null)return 1;switch(typeof _){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return _===null?1:6;default:return 6}}o(Be,"Type");function j(_){return _===void 0}o(j,"IsUndefined");function le(_){return _===null}o(le,"IsNull");function be(_){return typeof _=="symbol"}o(be,"IsSymbol");function W(_){return typeof _=="object"?_!==null:typeof _=="function"}o(W,"IsObject");function Ee(_,v){switch(Be(_)){case 0:return _;case 1:return _;case 2:return _;case 3:return _;case 4:return _;case 5:return _}var b=v===3?"string":v===5?"number":"default",C=te(_,s);if(C!==void 0){var V=C.call(_,b);if(W(V))throw new TypeError;return V}return Te(_,b==="default"?"number":b)}o(Ee,"ToPrimitive");function Te(_,v){if(v==="string"){var b=_.toString;if(fe(b)){var C=b.call(_);if(!W(C))return C}var V=_.valueOf;if(fe(V)){var C=V.call(_);if(!W(C))return C}}else{var V=_.valueOf;if(fe(V)){var C=V.call(_);if(!W(C))return C}var ge=_.toString;if(fe(ge)){var C=ge.call(_);if(!W(C))return C}}throw new TypeError}o(Te,"OrdinaryToPrimitive");function _e(_){return!!_}o(_e,"ToBoolean");function Ae(_){return""+_}o(Ae,"ToString");function ue(_){var v=Ee(_,3);return be(v)?v:Ae(v)}o(ue,"ToPropertyKey");function ve(_){return Array.isArray?Array.isArray(_):_ instanceof Object?_ instanceof Array:Object.prototype.toString.call(_)==="[object Array]"}o(ve,"IsArray");function fe(_){return typeof _=="function"}o(fe,"IsCallable");function Se(_){return typeof _=="function"}o(Se,"IsConstructor");function xe(_){switch(Be(_)){case 3:return!0;case 4:return!0;default:return!1}}o(xe,"IsPropertyKey");function J(_,v){return _===v||_!==_&&v!==v}o(J,"SameValueZero");function te(_,v){var b=_[v];if(b!=null){if(!fe(b))throw new TypeError;return b}}o(te,"GetMethod");function re(_){var v=te(_,a);if(!fe(v))throw new TypeError;var b=v.call(_);if(!W(b))throw new TypeError;return b}o(re,"GetIterator");function X(_){return _.value}o(X,"IteratorValue");function Z(_){var v=_.next();return v.done?!1:v}o(Z,"IteratorStep");function ee(_){var v=_.return;v&&v.call(_)}o(ee,"IteratorClose");function Q(_){var v=Object.getPrototypeOf(_);if(typeof _!="function"||_===h||v!==h)return v;var b=_.prototype,C=b&&Object.getPrototypeOf(b);if(C==null||C===Object.prototype)return v;var V=C.constructor;return typeof V!="function"||V===_?v:V}o(Q,"OrdinaryGetPrototypeOf");function ne(){var _;!j(S)&&typeof t.Reflect<"u"&&!(S in t.Reflect)&&typeof t.Reflect.defineMetadata=="function"&&(_=ae(t.Reflect));var v,b,C,V=new w,ge={registerProvider:$e,getProvider:N,setProvider:M};return ge;function $e(q){if(!Object.isExtensible(ge))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case _===q:break;case j(v):v=q;break;case v===q:break;case j(b):b=q;break;case b===q:break;default:C===void 0&&(C=new g),C.add(q);break}}function ye(q,de){if(!j(v)){if(v.isProviderFor(q,de))return v;if(!j(b)){if(b.isProviderFor(q,de))return v;if(!j(C))for(var Me=re(C);;){var Le=Z(Me);if(!Le)return;var xt=X(Le);if(xt.isProviderFor(q,de))return ee(Me),xt}}}if(!j(_)&&_.isProviderFor(q,de))return _}function N(q,de){var Me=V.get(q),Le;return j(Me)||(Le=Me.get(de)),j(Le)&&(Le=ye(q,de),j(Le)||(j(Me)&&(Me=new p,V.set(q,Me)),Me.set(de,Le))),Le}function k(q){if(j(q))throw new TypeError;return v===q||b===q||!j(C)&&C.has(q)}function M(q,de,Me){if(!k(Me))throw new Error("Metadata provider not registered.");var Le=N(q,de);if(Le!==Me){if(!j(Le))return!1;var xt=V.get(q);j(xt)&&(xt=new p,V.set(q,xt)),xt.set(de,Me)}return!0}}o(ne,"CreateMetadataRegistry");function ie(){var _;return!j(S)&&W(t.Reflect)&&Object.isExtensible(t.Reflect)&&(_=t.Reflect[S]),j(_)&&(_=ne()),!j(S)&&W(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,S,{enumerable:!1,configurable:!1,writable:!1,value:_}),_}o(ie,"GetOrCreateMetadataRegistry");function se(_){var v=new w,b={isProviderFor:o(function(k,M){var q=v.get(k);return j(q)?!1:q.has(M)},"isProviderFor"),OrdinaryDefineOwnMetadata:$e,OrdinaryHasOwnMetadata:V,OrdinaryGetOwnMetadata:ge,OrdinaryOwnMetadataKeys:ye,OrdinaryDeleteMetadata:N};return x.registerProvider(b),b;function C(k,M,q){var de=v.get(k),Me=!1;if(j(de)){if(!q)return;de=new p,v.set(k,de),Me=!0}var Le=de.get(M);if(j(Le)){if(!q)return;if(Le=new p,de.set(M,Le),!_.setProvider(k,M,b))throw de.delete(M),Me&&v.delete(k),new Error("Wrong provider for target.")}return Le}o(C,"GetOrCreateMetadataMap");function V(k,M,q){var de=C(M,q,!1);return j(de)?!1:_e(de.has(k))}o(V,"OrdinaryHasOwnMetadata");function ge(k,M,q){var de=C(M,q,!1);if(!j(de))return de.get(k)}o(ge,"OrdinaryGetOwnMetadata");function $e(k,M,q,de){var Me=C(q,de,!0);Me.set(k,M)}o($e,"OrdinaryDefineOwnMetadata");function ye(k,M){var q=[],de=C(k,M,!1);if(j(de))return q;for(var Me=de.keys(),Le=re(Me),xt=0;;){var cr=Z(Le);if(!cr)return q.length=xt,q;var yr=X(cr);try{q[xt]=yr}catch(Kt){try{ee(Le)}finally{throw Kt}}xt++}}o(ye,"OrdinaryOwnMetadataKeys");function N(k,M,q){var de=C(M,q,!1);if(j(de)||!de.delete(k))return!1;if(de.size===0){var Me=v.get(M);j(Me)||(Me.delete(q),Me.size===0&&v.delete(Me))}return!0}o(N,"OrdinaryDeleteMetadata")}o(se,"CreateMetadataProvider");function ae(_){var v=_.defineMetadata,b=_.hasOwnMetadata,C=_.getOwnMetadata,V=_.getOwnMetadataKeys,ge=_.deleteMetadata,$e=new w,ye={isProviderFor:o(function(N,k){var M=$e.get(N);return!j(M)&&M.has(k)?!0:V(N,k).length?(j(M)&&(M=new g,$e.set(N,M)),M.add(k),!0):!1},"isProviderFor"),OrdinaryDefineOwnMetadata:v,OrdinaryHasOwnMetadata:b,OrdinaryGetOwnMetadata:C,OrdinaryOwnMetadataKeys:V,OrdinaryDeleteMetadata:ge};return ye}o(ae,"CreateFallbackProvider");function Y(_,v,b){var C=x.getProvider(_,v);if(!j(C))return C;if(b){if(x.setProvider(_,v,P))return P;throw new Error("Illegal state.")}}o(Y,"GetMetadataProvider");function oe(){var _={},v=[],b=(function(){function ye(N,k,M){this._index=0,this._keys=N,this._values=k,this._selector=M}return o(ye,"MapIterator"),ye.prototype["@@iterator"]=function(){return this},ye.prototype[a]=function(){return this},ye.prototype.next=function(){var N=this._index;if(N>=0&&N<this._keys.length){var k=this._selector(this._keys[N],this._values[N]);return N+1>=this._keys.length?(this._index=-1,this._keys=v,this._values=v):this._index++,{value:k,done:!1}}return{value:void 0,done:!0}},ye.prototype.throw=function(N){throw this._index>=0&&(this._index=-1,this._keys=v,this._values=v),N},ye.prototype.return=function(N){return this._index>=0&&(this._index=-1,this._keys=v,this._values=v),{value:N,done:!0}},ye})(),C=(function(){function ye(){this._keys=[],this._values=[],this._cacheKey=_,this._cacheIndex=-2}return o(ye,"Map"),Object.defineProperty(ye.prototype,"size",{get:o(function(){return this._keys.length},"get"),enumerable:!0,configurable:!0}),ye.prototype.has=function(N){return this._find(N,!1)>=0},ye.prototype.get=function(N){var k=this._find(N,!1);return k>=0?this._values[k]:void 0},ye.prototype.set=function(N,k){var M=this._find(N,!0);return this._values[M]=k,this},ye.prototype.delete=function(N){var k=this._find(N,!1);if(k>=0){for(var M=this._keys.length,q=k+1;q<M;q++)this._keys[q-1]=this._keys[q],this._values[q-1]=this._values[q];return this._keys.length--,this._values.length--,J(N,this._cacheKey)&&(this._cacheKey=_,this._cacheIndex=-2),!0}return!1},ye.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=_,this._cacheIndex=-2},ye.prototype.keys=function(){return new b(this._keys,this._values,V)},ye.prototype.values=function(){return new b(this._keys,this._values,ge)},ye.prototype.entries=function(){return new b(this._keys,this._values,$e)},ye.prototype["@@iterator"]=function(){return this.entries()},ye.prototype[a]=function(){return this.entries()},ye.prototype._find=function(N,k){if(!J(this._cacheKey,N)){this._cacheIndex=-1;for(var M=0;M<this._keys.length;M++)if(J(this._keys[M],N)){this._cacheIndex=M;break}}return this._cacheIndex<0&&k&&(this._cacheIndex=this._keys.length,this._keys.push(N),this._values.push(void 0)),this._cacheIndex},ye})();return C;function V(ye,N){return ye}function ge(ye,N){return N}function $e(ye,N){return[ye,N]}}o(oe,"CreateMapPolyfill");function De(){var _=(function(){function v(){this._map=new p}return o(v,"Set"),Object.defineProperty(v.prototype,"size",{get:o(function(){return this._map.size},"get"),enumerable:!0,configurable:!0}),v.prototype.has=function(b){return this._map.has(b)},v.prototype.add=function(b){return this._map.set(b,b),this},v.prototype.delete=function(b){return this._map.delete(b)},v.prototype.clear=function(){this._map.clear()},v.prototype.keys=function(){return this._map.keys()},v.prototype.values=function(){return this._map.keys()},v.prototype.entries=function(){return this._map.entries()},v.prototype["@@iterator"]=function(){return this.keys()},v.prototype[a]=function(){return this.keys()},v})();return _}o(De,"CreateSetPolyfill");function Oe(){var _=16,v=l.create(),b=C();return(function(){function N(){this._key=C()}return o(N,"WeakMap"),N.prototype.has=function(k){var M=V(k,!1);return M!==void 0?l.has(M,this._key):!1},N.prototype.get=function(k){var M=V(k,!1);return M!==void 0?l.get(M,this._key):void 0},N.prototype.set=function(k,M){var q=V(k,!0);return q[this._key]=M,this},N.prototype.delete=function(k){var M=V(k,!1);return M!==void 0?delete M[this._key]:!1},N.prototype.clear=function(){this._key=C()},N})();function C(){var N;do N="@@WeakMap@@"+ye();while(l.has(v,N));return v[N]=!0,N}function V(N,k){if(!n.call(N,b)){if(!k)return;Object.defineProperty(N,b,{value:l.create()})}return N[b]}function ge(N,k){for(var M=0;M<k;++M)N[M]=Math.random()*255|0;return N}function $e(N){if(typeof Uint8Array=="function"){var k=new Uint8Array(N);return typeof crypto<"u"?crypto.getRandomValues(k):typeof msCrypto<"u"?msCrypto.getRandomValues(k):ge(k,N),k}return ge(new Array(N),N)}function ye(){var N=$e(_);N[6]=N[6]&79|64,N[8]=N[8]&191|128;for(var k="",M=0;M<_;++M){var q=N[M];(M===4||M===6||M===8)&&(k+="-"),q<16&&(k+="0"),k+=q.toString(16).toLowerCase()}return k}}o(Oe,"CreateWeakMapPolyfill");function me(_){return _.__=void 0,delete _.__,_}o(me,"MakeDictionary")})})(K1||(K1={}))});var Fa=y(ff=>{var ac=class extends Error{static{o(this,"CommanderError")}constructor(e,t,n){super(n),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.code=t,this.exitCode=e,this.nestedError=void 0}},lf=class extends ac{static{o(this,"InvalidArgumentError")}constructor(e){super(1,"commander.invalidArgument",e),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name}};ff.CommanderError=ac;ff.InvalidArgumentError=lf});var oc=y(df=>{var{InvalidArgumentError:tw}=Fa(),hf=class{static{o(this,"Argument")}constructor(e,t){switch(this.description=t||"",this.variadic=!1,this.parseArg=void 0,this.defaultValue=void 0,this.defaultValueDescription=void 0,this.argChoices=void 0,e[0]){case"<":this.required=!0,this._name=e.slice(1,-1);break;case"[":this.required=!1,this._name=e.slice(1,-1);break;default:this.required=!0,this._name=e;break}this._name.endsWith("...")&&(this.variadic=!0,this._name=this._name.slice(0,-3))}name(){return this._name}_collectValue(e,t){return t===this.defaultValue||!Array.isArray(t)?[e]:(t.push(e),t)}default(e,t){return this.defaultValue=e,this.defaultValueDescription=t,this}argParser(e){return this.parseArg=e,this}choices(e){return this.argChoices=e.slice(),this.parseArg=(t,n)=>{if(!this.argChoices.includes(t))throw new tw(`Allowed choices are ${this.argChoices.join(", ")}.`);return this.variadic?this._collectValue(t,n):t},this}argRequired(){return this.required=!0,this}argOptional(){return this.required=!1,this}};function rw(r){let e=r.name()+(r.variadic===!0?"...":"");return r.required?"<"+e+">":"["+e+"]"}o(rw,"humanReadableArgName");df.Argument=hf;df.humanReadableArgName=rw});var gf=y(mf=>{var{humanReadableArgName:nw}=oc(),pf=class{static{o(this,"Help")}constructor(){this.helpWidth=void 0,this.minWidthToWrap=40,this.sortSubcommands=!1,this.sortOptions=!1,this.showGlobalOptions=!1}prepareContext(e){this.helpWidth=this.helpWidth??e.helpWidth??80}visibleCommands(e){let t=e.commands.filter(i=>!i._hidden),n=e._getHelpCommand();return n&&!n._hidden&&t.push(n),this.sortSubcommands&&t.sort((i,s)=>i.name().localeCompare(s.name())),t}compareOptions(e,t){let n=o(i=>i.short?i.short.replace(/^-/,""):i.long.replace(/^--/,""),"getSortKey");return n(e).localeCompare(n(t))}visibleOptions(e){let t=e.options.filter(i=>!i.hidden),n=e._getHelpOption();if(n&&!n.hidden){let i=n.short&&e._findOption(n.short),s=n.long&&e._findOption(n.long);!i&&!s?t.push(n):n.long&&!s?t.push(e.createOption(n.long,n.description)):n.short&&!i&&t.push(e.createOption(n.short,n.description))}return this.sortOptions&&t.sort(this.compareOptions),t}visibleGlobalOptions(e){if(!this.showGlobalOptions)return[];let t=[];for(let n=e.parent;n;n=n.parent){let i=n.options.filter(s=>!s.hidden);t.push(...i)}return this.sortOptions&&t.sort(this.compareOptions),t}visibleArguments(e){return e._argsDescription&&e.registeredArguments.forEach(t=>{t.description=t.description||e._argsDescription[t.name()]||""}),e.registeredArguments.find(t=>t.description)?e.registeredArguments:[]}subcommandTerm(e){let t=e.registeredArguments.map(n=>nw(n)).join(" ");return e._name+(e._aliases[0]?"|"+e._aliases[0]:"")+(e.options.length?" [options]":"")+(t?" "+t:"")}optionTerm(e){return e.flags}argumentTerm(e){return e.name()}longestSubcommandTermLength(e,t){return t.visibleCommands(e).reduce((n,i)=>Math.max(n,this.displayWidth(t.styleSubcommandTerm(t.subcommandTerm(i)))),0)}longestOptionTermLength(e,t){return t.visibleOptions(e).reduce((n,i)=>Math.max(n,this.displayWidth(t.styleOptionTerm(t.optionTerm(i)))),0)}longestGlobalOptionTermLength(e,t){return t.visibleGlobalOptions(e).reduce((n,i)=>Math.max(n,this.displayWidth(t.styleOptionTerm(t.optionTerm(i)))),0)}longestArgumentTermLength(e,t){return t.visibleArguments(e).reduce((n,i)=>Math.max(n,this.displayWidth(t.styleArgumentTerm(t.argumentTerm(i)))),0)}commandUsage(e){let t=e._name;e._aliases[0]&&(t=t+"|"+e._aliases[0]);let n="";for(let i=e.parent;i;i=i.parent)n=i.name()+" "+n;return n+t+" "+e.usage()}commandDescription(e){return e.description()}subcommandDescription(e){return e.summary()||e.description()}optionDescription(e){let t=[];if(e.argChoices&&t.push(`choices: ${e.argChoices.map(n=>JSON.stringify(n)).join(", ")}`),e.defaultValue!==void 0&&(e.required||e.optional||e.isBoolean()&&typeof e.defaultValue=="boolean")&&t.push(`default: ${e.defaultValueDescription||JSON.stringify(e.defaultValue)}`),e.presetArg!==void 0&&e.optional&&t.push(`preset: ${JSON.stringify(e.presetArg)}`),e.envVar!==void 0&&t.push(`env: ${e.envVar}`),t.length>0){let n=`(${t.join(", ")})`;return e.description?`${e.description} ${n}`:n}return e.description}argumentDescription(e){let t=[];if(e.argChoices&&t.push(`choices: ${e.argChoices.map(n=>JSON.stringify(n)).join(", ")}`),e.defaultValue!==void 0&&t.push(`default: ${e.defaultValueDescription||JSON.stringify(e.defaultValue)}`),t.length>0){let n=`(${t.join(", ")})`;return e.description?`${e.description} ${n}`:n}return e.description}formatItemList(e,t,n){return t.length===0?[]:[n.styleTitle(e),...t,""]}groupItems(e,t,n){let i=new Map;return e.forEach(s=>{let a=n(s);i.has(a)||i.set(a,[])}),t.forEach(s=>{let a=n(s);i.has(a)||i.set(a,[]),i.get(a).push(s)}),i}formatHelp(e,t){let n=t.padWidth(e,t),i=t.helpWidth??80;function s(h,p){return t.formatItem(h,n,p,t)}o(s,"callFormatItem");let a=[`${t.styleTitle("Usage:")} ${t.styleUsage(t.commandUsage(e))}`,""],c=t.commandDescription(e);c.length>0&&(a=a.concat([t.boxWrap(t.styleCommandDescription(c),i),""]));let u=t.visibleArguments(e).map(h=>s(t.styleArgumentTerm(t.argumentTerm(h)),t.styleArgumentDescription(t.argumentDescription(h))));if(a=a.concat(this.formatItemList("Arguments:",u,t)),this.groupItems(e.options,t.visibleOptions(e),h=>h.helpGroupHeading??"Options:").forEach((h,p)=>{let g=h.map(w=>s(t.styleOptionTerm(t.optionTerm(w)),t.styleOptionDescription(t.optionDescription(w))));a=a.concat(this.formatItemList(p,g,t))}),t.showGlobalOptions){let h=t.visibleGlobalOptions(e).map(p=>s(t.styleOptionTerm(t.optionTerm(p)),t.styleOptionDescription(t.optionDescription(p))));a=a.concat(this.formatItemList("Global Options:",h,t))}return this.groupItems(e.commands,t.visibleCommands(e),h=>h.helpGroup()||"Commands:").forEach((h,p)=>{let g=h.map(w=>s(t.styleSubcommandTerm(t.subcommandTerm(w)),t.styleSubcommandDescription(t.subcommandDescription(w))));a=a.concat(this.formatItemList(p,g,t))}),a.join(`
`)}displayWidth(e){return Y1(e).length}styleTitle(e){return e}styleUsage(e){return e.split(" ").map(t=>t==="[options]"?this.styleOptionText(t):t==="[command]"?this.styleSubcommandText(t):t[0]==="["||t[0]==="<"?this.styleArgumentText(t):this.styleCommandText(t)).join(" ")}styleCommandDescription(e){return this.styleDescriptionText(e)}styleOptionDescription(e){return this.styleDescriptionText(e)}styleSubcommandDescription(e){return this.styleDescriptionText(e)}styleArgumentDescription(e){return this.styleDescriptionText(e)}styleDescriptionText(e){return e}styleOptionTerm(e){return this.styleOptionText(e)}styleSubcommandTerm(e){return e.split(" ").map(t=>t==="[options]"?this.styleOptionText(t):t[0]==="["||t[0]==="<"?this.styleArgumentText(t):this.styleSubcommandText(t)).join(" ")}styleArgumentTerm(e){return this.styleArgumentText(e)}styleOptionText(e){return e}styleArgumentText(e){return e}styleSubcommandText(e){return e}styleCommandText(e){return e}padWidth(e,t){return Math.max(t.longestOptionTermLength(e,t),t.longestGlobalOptionTermLength(e,t),t.longestSubcommandTermLength(e,t),t.longestArgumentTermLength(e,t))}preformatted(e){return/\n[^\S\r\n]/.test(e)}formatItem(e,t,n,i){let a=" ".repeat(2);if(!n)return a+e;let c=e.padEnd(t+e.length-i.displayWidth(e)),u=2,l=(this.helpWidth??80)-t-u-2,h;return l<this.minWidthToWrap||i.preformatted(n)?h=n:h=i.boxWrap(n,l).replace(/\n/g,`
`+" ".repeat(t+u)),a+c+" ".repeat(u)+h.replace(/\n/g,`
${a}`)}boxWrap(e,t){if(t<this.minWidthToWrap)return e;let n=e.split(/\r\n|\n/),i=/[\s]*[^\s]+/g,s=[];return n.forEach(a=>{let c=a.match(i);if(c===null){s.push("");return}let u=[c.shift()],f=this.displayWidth(u[0]);c.forEach(l=>{let h=this.displayWidth(l);if(f+h<=t){u.push(l),f+=h;return}s.push(u.join(""));let p=l.trimStart();u=[p],f=this.displayWidth(p)}),s.push(u.join(""))}),s.join(`
`)}};function Y1(r){let e=/\x1b\[\d*(;\d*)*m/g;return r.replace(e,"")}o(Y1,"stripColor");mf.Help=pf;mf.stripColor=Y1});var Sf=y(vf=>{var{InvalidArgumentError:iw}=Fa(),yf=class{static{o(this,"Option")}constructor(e,t){this.flags=e,this.description=t||"",this.required=e.includes("<"),this.optional=e.includes("["),this.variadic=/\w\.\.\.[>\]]$/.test(e),this.mandatory=!1;let n=sw(e);this.short=n.shortFlag,this.long=n.longFlag,this.negate=!1,this.long&&(this.negate=this.long.startsWith("--no-")),this.defaultValue=void 0,this.defaultValueDescription=void 0,this.presetArg=void 0,this.envVar=void 0,this.parseArg=void 0,this.hidden=!1,this.argChoices=void 0,this.conflictsWith=[],this.implied=void 0,this.helpGroupHeading=void 0}default(e,t){return this.defaultValue=e,this.defaultValueDescription=t,this}preset(e){return this.presetArg=e,this}conflicts(e){return this.conflictsWith=this.conflictsWith.concat(e),this}implies(e){let t=e;return typeof e=="string"&&(t={[e]:!0}),this.implied=Object.assign(this.implied||{},t),this}env(e){return this.envVar=e,this}argParser(e){return this.parseArg=e,this}makeOptionMandatory(e=!0){return this.mandatory=!!e,this}hideHelp(e=!0){return this.hidden=!!e,this}_collectValue(e,t){return t===this.defaultValue||!Array.isArray(t)?[e]:(t.push(e),t)}choices(e){return this.argChoices=e.slice(),this.parseArg=(t,n)=>{if(!this.argChoices.includes(t))throw new iw(`Allowed choices are ${this.argChoices.join(", ")}.`);return this.variadic?this._collectValue(t,n):t},this}name(){return this.long?this.long.replace(/^--/,""):this.short.replace(/^-/,"")}attributeName(){return this.negate?Q1(this.name().replace(/^no-/,"")):Q1(this.name())}helpGroup(e){return this.helpGroupHeading=e,this}is(e){return this.short===e||this.long===e}isBoolean(){return!this.required&&!this.optional&&!this.negate}},_f=class{static{o(this,"DualOptions")}constructor(e){this.positiveOptions=new Map,this.negativeOptions=new Map,this.dualOptions=new Set,e.forEach(t=>{t.negate?this.negativeOptions.set(t.attributeName(),t):this.positiveOptions.set(t.attributeName(),t)}),this.negativeOptions.forEach((t,n)=>{this.positiveOptions.has(n)&&this.dualOptions.add(n)})}valueFromOption(e,t){let n=t.attributeName();if(!this.dualOptions.has(n))return!0;let i=this.negativeOptions.get(n).presetArg,s=i!==void 0?i:!1;return t.negate===(s===e)}};function Q1(r){return r.split("-").reduce((e,t)=>e+t[0].toUpperCase()+t.slice(1))}o(Q1,"camelcase");function sw(r){let e,t,n=/^-[^-]$/,i=/^--[^-]/,s=r.split(/[ |,]+/).concat("guard");if(n.test(s[0])&&(e=s.shift()),i.test(s[0])&&(t=s.shift()),!e&&n.test(s[0])&&(e=s.shift()),!e&&i.test(s[0])&&(e=t,t=s.shift()),s[0].startsWith("-")){let a=s[0],c=`option creation failed due to '${a}' in option flags '${r}'`;throw/^-[^-][^-]/.test(a)?new Error(`${c}
- a short flag is a single dash and a single character
  - either use a single dash and a single character (for a short flag)
  - or use a double dash for a long option (and can have two, like '--ws, --workspace')`):n.test(a)?new Error(`${c}
- too many short flags`):i.test(a)?new Error(`${c}
- too many long flags`):new Error(`${c}
- unrecognised flag format`)}if(e===void 0&&t===void 0)throw new Error(`option creation failed due to no flags found in '${r}'.`);return{shortFlag:e,longFlag:t}}o(sw,"splitOptionFlags");vf.Option=yf;vf.DualOptions=_f});var X1=y(J1=>{function aw(r,e){if(Math.abs(r.length-e.length)>3)return Math.max(r.length,e.length);let t=[];for(let n=0;n<=r.length;n++)t[n]=[n];for(let n=0;n<=e.length;n++)t[0][n]=n;for(let n=1;n<=e.length;n++)for(let i=1;i<=r.length;i++){let s=1;r[i-1]===e[n-1]?s=0:s=1,t[i][n]=Math.min(t[i-1][n]+1,t[i][n-1]+1,t[i-1][n-1]+s),i>1&&n>1&&r[i-1]===e[n-2]&&r[i-2]===e[n-1]&&(t[i][n]=Math.min(t[i][n],t[i-2][n-2]+1))}return t[r.length][e.length]}o(aw,"editDistance");function ow(r,e){if(!e||e.length===0)return"";e=Array.from(new Set(e));let t=r.startsWith("--");t&&(r=r.slice(2),e=e.map(a=>a.slice(2)));let n=[],i=3,s=.4;return e.forEach(a=>{if(a.length<=1)return;let c=aw(r,a),u=Math.max(r.length,a.length);(u-c)/u>s&&(c<i?(i=c,n=[a]):c===i&&n.push(a))}),n.sort((a,c)=>a.localeCompare(c)),t&&(n=n.map(a=>`--${a}`)),n.length>1?`
(Did you mean one of ${n.join(", ")}?)`:n.length===1?`
(Did you mean ${n[0]}?)`:""}o(ow,"suggestSimilar");J1.suggestSimilar=ow});var r0=y(Af=>{var cw=require("node:events").EventEmitter,wf=require("node:child_process"),Un=require("node:path"),cc=require("node:fs"),qe=require("node:process"),{Argument:uw,humanReadableArgName:lw}=oc(),{CommanderError:bf}=Fa(),{Help:fw,stripColor:hw}=gf(),{Option:Z1,DualOptions:dw}=Sf(),{suggestSimilar:e0}=X1(),Ef=class r extends cw{static{o(this,"Command")}constructor(e){super(),this.commands=[],this.options=[],this.parent=null,this._allowUnknownOption=!1,this._allowExcessArguments=!1,this.registeredArguments=[],this._args=this.registeredArguments,this.args=[],this.rawArgs=[],this.processedArgs=[],this._scriptPath=null,this._name=e||"",this._optionValues={},this._optionValueSources={},this._storeOptionsAsProperties=!1,this._actionHandler=null,this._executableHandler=!1,this._executableFile=null,this._executableDir=null,this._defaultCommandName=null,this._exitCallback=null,this._aliases=[],this._combineFlagAndOptionalValue=!0,this._description="",this._summary="",this._argsDescription=void 0,this._enablePositionalOptions=!1,this._passThroughOptions=!1,this._lifeCycleHooks={},this._showHelpAfterError=!1,this._showSuggestionAfterError=!0,this._savedState=null,this._outputConfiguration={writeOut:o(t=>qe.stdout.write(t),"writeOut"),writeErr:o(t=>qe.stderr.write(t),"writeErr"),outputError:o((t,n)=>n(t),"outputError"),getOutHelpWidth:o(()=>qe.stdout.isTTY?qe.stdout.columns:void 0,"getOutHelpWidth"),getErrHelpWidth:o(()=>qe.stderr.isTTY?qe.stderr.columns:void 0,"getErrHelpWidth"),getOutHasColors:o(()=>Tf()??(qe.stdout.isTTY&&qe.stdout.hasColors?.()),"getOutHasColors"),getErrHasColors:o(()=>Tf()??(qe.stderr.isTTY&&qe.stderr.hasColors?.()),"getErrHasColors"),stripColor:o(t=>hw(t),"stripColor")},this._hidden=!1,this._helpOption=void 0,this._addImplicitHelpCommand=void 0,this._helpCommand=void 0,this._helpConfiguration={},this._helpGroupHeading=void 0,this._defaultCommandGroup=void 0,this._defaultOptionGroup=void 0}copyInheritedSettings(e){return this._outputConfiguration=e._outputConfiguration,this._helpOption=e._helpOption,this._helpCommand=e._helpCommand,this._helpConfiguration=e._helpConfiguration,this._exitCallback=e._exitCallback,this._storeOptionsAsProperties=e._storeOptionsAsProperties,this._combineFlagAndOptionalValue=e._combineFlagAndOptionalValue,this._allowExcessArguments=e._allowExcessArguments,this._enablePositionalOptions=e._enablePositionalOptions,this._showHelpAfterError=e._showHelpAfterError,this._showSuggestionAfterError=e._showSuggestionAfterError,this}_getCommandAndAncestors(){let e=[];for(let t=this;t;t=t.parent)e.push(t);return e}command(e,t,n){let i=t,s=n;typeof i=="object"&&i!==null&&(s=i,i=null),s=s||{};let[,a,c]=e.match(/([^ ]+) *(.*)/),u=this.createCommand(a);return i&&(u.description(i),u._executableHandler=!0),s.isDefault&&(this._defaultCommandName=u._name),u._hidden=!!(s.noHelp||s.hidden),u._executableFile=s.executableFile||null,c&&u.arguments(c),this._registerCommand(u),u.parent=this,u.copyInheritedSettings(this),i?this:u}createCommand(e){return new r(e)}createHelp(){return Object.assign(new fw,this.configureHelp())}configureHelp(e){return e===void 0?this._helpConfiguration:(this._helpConfiguration=e,this)}configureOutput(e){return e===void 0?this._outputConfiguration:(this._outputConfiguration={...this._outputConfiguration,...e},this)}showHelpAfterError(e=!0){return typeof e!="string"&&(e=!!e),this._showHelpAfterError=e,this}showSuggestionAfterError(e=!0){return this._showSuggestionAfterError=!!e,this}addCommand(e,t){if(!e._name)throw new Error(`Command passed to .addCommand() must have a name
- specify the name in Command constructor or using .name()`);return t=t||{},t.isDefault&&(this._defaultCommandName=e._name),(t.noHelp||t.hidden)&&(e._hidden=!0),this._registerCommand(e),e.parent=this,e._checkForBrokenPassThrough(),this}createArgument(e,t){return new uw(e,t)}argument(e,t,n,i){let s=this.createArgument(e,t);return typeof n=="function"?s.default(i).argParser(n):s.default(n),this.addArgument(s),this}arguments(e){return e.trim().split(/ +/).forEach(t=>{this.argument(t)}),this}addArgument(e){let t=this.registeredArguments.slice(-1)[0];if(t?.variadic)throw new Error(`only the last argument can be variadic '${t.name()}'`);if(e.required&&e.defaultValue!==void 0&&e.parseArg===void 0)throw new Error(`a default value for a required argument is never used: '${e.name()}'`);return this.registeredArguments.push(e),this}helpCommand(e,t){if(typeof e=="boolean")return this._addImplicitHelpCommand=e,e&&this._defaultCommandGroup&&this._initCommandGroup(this._getHelpCommand()),this;let n=e??"help [command]",[,i,s]=n.match(/([^ ]+) *(.*)/),a=t??"display help for command",c=this.createCommand(i);return c.helpOption(!1),s&&c.arguments(s),a&&c.description(a),this._addImplicitHelpCommand=!0,this._helpCommand=c,(e||t)&&this._initCommandGroup(c),this}addHelpCommand(e,t){return typeof e!="object"?(this.helpCommand(e,t),this):(this._addImplicitHelpCommand=!0,this._helpCommand=e,this._initCommandGroup(e),this)}_getHelpCommand(){return this._addImplicitHelpCommand??(this.commands.length&&!this._actionHandler&&!this._findCommand("help"))?(this._helpCommand===void 0&&this.helpCommand(void 0,void 0),this._helpCommand):null}hook(e,t){let n=["preSubcommand","preAction","postAction"];if(!n.includes(e))throw new Error(`Unexpected value for event passed to hook : '${e}'.
Expecting one of '${n.join("', '")}'`);return this._lifeCycleHooks[e]?this._lifeCycleHooks[e].push(t):this._lifeCycleHooks[e]=[t],this}exitOverride(e){return e?this._exitCallback=e:this._exitCallback=t=>{if(t.code!=="commander.executeSubCommandAsync")throw t},this}_exit(e,t,n){this._exitCallback&&this._exitCallback(new bf(e,t,n)),qe.exit(e)}action(e){let t=o(n=>{let i=this.registeredArguments.length,s=n.slice(0,i);return this._storeOptionsAsProperties?s[i]=this:s[i]=this.opts(),s.push(this),e.apply(this,s)},"listener");return this._actionHandler=t,this}createOption(e,t){return new Z1(e,t)}_callParseArg(e,t,n,i){try{return e.parseArg(t,n)}catch(s){if(s.code==="commander.invalidArgument"){let a=`${i} ${s.message}`;this.error(a,{exitCode:s.exitCode,code:s.code})}throw s}}_registerOption(e){let t=e.short&&this._findOption(e.short)||e.long&&this._findOption(e.long);if(t){let n=e.long&&this._findOption(e.long)?e.long:e.short;throw new Error(`Cannot add option '${e.flags}'${this._name&&` to command '${this._name}'`} due to conflicting flag '${n}'
-  already used by option '${t.flags}'`)}this._initOptionGroup(e),this.options.push(e)}_registerCommand(e){let t=o(i=>[i.name()].concat(i.aliases()),"knownBy"),n=t(e).find(i=>this._findCommand(i));if(n){let i=t(this._findCommand(n)).join("|"),s=t(e).join("|");throw new Error(`cannot add command '${s}' as already have command '${i}'`)}this._initCommandGroup(e),this.commands.push(e)}addOption(e){this._registerOption(e);let t=e.name(),n=e.attributeName();if(e.negate){let s=e.long.replace(/^--no-/,"--");this._findOption(s)||this.setOptionValueWithSource(n,e.defaultValue===void 0?!0:e.defaultValue,"default")}else e.defaultValue!==void 0&&this.setOptionValueWithSource(n,e.defaultValue,"default");let i=o((s,a,c)=>{s==null&&e.presetArg!==void 0&&(s=e.presetArg);let u=this.getOptionValue(n);s!==null&&e.parseArg?s=this._callParseArg(e,s,u,a):s!==null&&e.variadic&&(s=e._collectValue(s,u)),s==null&&(e.negate?s=!1:e.isBoolean()||e.optional?s=!0:s=""),this.setOptionValueWithSource(n,s,c)},"handleOptionValue");return this.on("option:"+t,s=>{let a=`error: option '${e.flags}' argument '${s}' is invalid.`;i(s,a,"cli")}),e.envVar&&this.on("optionEnv:"+t,s=>{let a=`error: option '${e.flags}' value '${s}' from env '${e.envVar}' is invalid.`;i(s,a,"env")}),this}_optionEx(e,t,n,i,s){if(typeof t=="object"&&t instanceof Z1)throw new Error("To add an Option object use addOption() instead of option() or requiredOption()");let a=this.createOption(t,n);if(a.makeOptionMandatory(!!e.mandatory),typeof i=="function")a.default(s).argParser(i);else if(i instanceof RegExp){let c=i;i=o((u,f)=>{let l=c.exec(u);return l?l[0]:f},"fn"),a.default(s).argParser(i)}else a.default(i);return this.addOption(a)}option(e,t,n,i){return this._optionEx({},e,t,n,i)}requiredOption(e,t,n,i){return this._optionEx({mandatory:!0},e,t,n,i)}combineFlagAndOptionalValue(e=!0){return this._combineFlagAndOptionalValue=!!e,this}allowUnknownOption(e=!0){return this._allowUnknownOption=!!e,this}allowExcessArguments(e=!0){return this._allowExcessArguments=!!e,this}enablePositionalOptions(e=!0){return this._enablePositionalOptions=!!e,this}passThroughOptions(e=!0){return this._passThroughOptions=!!e,this._checkForBrokenPassThrough(),this}_checkForBrokenPassThrough(){if(this.parent&&this._passThroughOptions&&!this.parent._enablePositionalOptions)throw new Error(`passThroughOptions cannot be used for '${this._name}' without turning on enablePositionalOptions for parent command(s)`)}storeOptionsAsProperties(e=!0){if(this.options.length)throw new Error("call .storeOptionsAsProperties() before adding options");if(Object.keys(this._optionValues).length)throw new Error("call .storeOptionsAsProperties() before setting option values");return this._storeOptionsAsProperties=!!e,this}getOptionValue(e){return this._storeOptionsAsProperties?this[e]:this._optionValues[e]}setOptionValue(e,t){return this.setOptionValueWithSource(e,t,void 0)}setOptionValueWithSource(e,t,n){return this._storeOptionsAsProperties?this[e]=t:this._optionValues[e]=t,this._optionValueSources[e]=n,this}getOptionValueSource(e){return this._optionValueSources[e]}getOptionValueSourceWithGlobals(e){let t;return this._getCommandAndAncestors().forEach(n=>{n.getOptionValueSource(e)!==void 0&&(t=n.getOptionValueSource(e))}),t}_prepareUserArgs(e,t){if(e!==void 0&&!Array.isArray(e))throw new Error("first parameter to parse must be array or undefined");if(t=t||{},e===void 0&&t.from===void 0){qe.versions?.electron&&(t.from="electron");let i=qe.execArgv??[];(i.includes("-e")||i.includes("--eval")||i.includes("-p")||i.includes("--print"))&&(t.from="eval")}e===void 0&&(e=qe.argv),this.rawArgs=e.slice();let n;switch(t.from){case void 0:case"node":this._scriptPath=e[1],n=e.slice(2);break;case"electron":qe.defaultApp?(this._scriptPath=e[1],n=e.slice(2)):n=e.slice(1);break;case"user":n=e.slice(0);break;case"eval":n=e.slice(1);break;default:throw new Error(`unexpected parse option { from: '${t.from}' }`)}return!this._name&&this._scriptPath&&this.nameFromFilename(this._scriptPath),this._name=this._name||"program",n}parse(e,t){this._prepareForParse();let n=this._prepareUserArgs(e,t);return this._parseCommand([],n),this}async parseAsync(e,t){this._prepareForParse();let n=this._prepareUserArgs(e,t);return await this._parseCommand([],n),this}_prepareForParse(){this._savedState===null?this.saveStateBeforeParse():this.restoreStateBeforeParse()}saveStateBeforeParse(){this._savedState={_name:this._name,_optionValues:{...this._optionValues},_optionValueSources:{...this._optionValueSources}}}restoreStateBeforeParse(){if(this._storeOptionsAsProperties)throw new Error(`Can not call parse again when storeOptionsAsProperties is true.
- either make a new Command for each call to parse, or stop storing options as properties`);this._name=this._savedState._name,this._scriptPath=null,this.rawArgs=[],this._optionValues={...this._savedState._optionValues},this._optionValueSources={...this._savedState._optionValueSources},this.args=[],this.processedArgs=[]}_checkForMissingExecutable(e,t,n){if(cc.existsSync(e))return;let i=t?`searched for local subcommand relative to directory '${t}'`:"no directory for search for local subcommand, use .executableDir() to supply a custom directory",s=`'${e}' does not exist
 - if '${n}' is not meant to be an executable command, remove description parameter from '.command()' and use '.description()' instead
 - if the default executable name is not suitable, use the executableFile option to supply a custom name or path
 - ${i}`;throw new Error(s)}_executeSubCommand(e,t){t=t.slice();let n=!1,i=[".js",".ts",".tsx",".mjs",".cjs"];function s(l,h){let p=Un.resolve(l,h);if(cc.existsSync(p))return p;if(i.includes(Un.extname(h)))return;let g=i.find(w=>cc.existsSync(`${p}${w}`));if(g)return`${p}${g}`}o(s,"findFile"),this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let a=e._executableFile||`${this._name}-${e._name}`,c=this._executableDir||"";if(this._scriptPath){let l;try{l=cc.realpathSync(this._scriptPath)}catch{l=this._scriptPath}c=Un.resolve(Un.dirname(l),c)}if(c){let l=s(c,a);if(!l&&!e._executableFile&&this._scriptPath){let h=Un.basename(this._scriptPath,Un.extname(this._scriptPath));h!==this._name&&(l=s(c,`${h}-${e._name}`))}a=l||a}n=i.includes(Un.extname(a));let u;qe.platform!=="win32"?n?(t.unshift(a),t=t0(qe.execArgv).concat(t),u=wf.spawn(qe.argv[0],t,{stdio:"inherit"})):u=wf.spawn(a,t,{stdio:"inherit"}):(this._checkForMissingExecutable(a,c,e._name),t.unshift(a),t=t0(qe.execArgv).concat(t),u=wf.spawn(qe.execPath,t,{stdio:"inherit"})),u.killed||["SIGUSR1","SIGUSR2","SIGTERM","SIGINT","SIGHUP"].forEach(h=>{qe.on(h,()=>{u.killed===!1&&u.exitCode===null&&u.kill(h)})});let f=this._exitCallback;u.on("close",l=>{l=l??1,f?f(new bf(l,"commander.executeSubCommandAsync","(close)")):qe.exit(l)}),u.on("error",l=>{if(l.code==="ENOENT")this._checkForMissingExecutable(a,c,e._name);else if(l.code==="EACCES")throw new Error(`'${a}' not executable`);if(!f)qe.exit(1);else{let h=new bf(1,"commander.executeSubCommandAsync","(error)");h.nestedError=l,f(h)}}),this.runningCommand=u}_dispatchSubcommand(e,t,n){let i=this._findCommand(e);i||this.help({error:!0}),i._prepareForParse();let s;return s=this._chainOrCallSubCommandHook(s,i,"preSubcommand"),s=this._chainOrCall(s,()=>{if(i._executableHandler)this._executeSubCommand(i,t.concat(n));else return i._parseCommand(t,n)}),s}_dispatchHelpCommand(e){e||this.help();let t=this._findCommand(e);return t&&!t._executableHandler&&t.help(),this._dispatchSubcommand(e,[],[this._getHelpOption()?.long??this._getHelpOption()?.short??"--help"])}_checkNumberOfArguments(){this.registeredArguments.forEach((e,t)=>{e.required&&this.args[t]==null&&this.missingArgument(e.name())}),!(this.registeredArguments.length>0&&this.registeredArguments[this.registeredArguments.length-1].variadic)&&this.args.length>this.registeredArguments.length&&this._excessArguments(this.args)}_processArguments(){let e=o((n,i,s)=>{let a=i;if(i!==null&&n.parseArg){let c=`error: command-argument value '${i}' is invalid for argument '${n.name()}'.`;a=this._callParseArg(n,i,s,c)}return a},"myParseArg");this._checkNumberOfArguments();let t=[];this.registeredArguments.forEach((n,i)=>{let s=n.defaultValue;n.variadic?i<this.args.length?(s=this.args.slice(i),n.parseArg&&(s=s.reduce((a,c)=>e(n,c,a),n.defaultValue))):s===void 0&&(s=[]):i<this.args.length&&(s=this.args[i],n.parseArg&&(s=e(n,s,n.defaultValue))),t[i]=s}),this.processedArgs=t}_chainOrCall(e,t){return e?.then&&typeof e.then=="function"?e.then(()=>t()):t()}_chainOrCallHooks(e,t){let n=e,i=[];return this._getCommandAndAncestors().reverse().filter(s=>s._lifeCycleHooks[t]!==void 0).forEach(s=>{s._lifeCycleHooks[t].forEach(a=>{i.push({hookedCommand:s,callback:a})})}),t==="postAction"&&i.reverse(),i.forEach(s=>{n=this._chainOrCall(n,()=>s.callback(s.hookedCommand,this))}),n}_chainOrCallSubCommandHook(e,t,n){let i=e;return this._lifeCycleHooks[n]!==void 0&&this._lifeCycleHooks[n].forEach(s=>{i=this._chainOrCall(i,()=>s(this,t))}),i}_parseCommand(e,t){let n=this.parseOptions(t);if(this._parseOptionsEnv(),this._parseOptionsImplied(),e=e.concat(n.operands),t=n.unknown,this.args=e.concat(t),e&&this._findCommand(e[0]))return this._dispatchSubcommand(e[0],e.slice(1),t);if(this._getHelpCommand()&&e[0]===this._getHelpCommand().name())return this._dispatchHelpCommand(e[1]);if(this._defaultCommandName)return this._outputHelpIfRequested(t),this._dispatchSubcommand(this._defaultCommandName,e,t);this.commands.length&&this.args.length===0&&!this._actionHandler&&!this._defaultCommandName&&this.help({error:!0}),this._outputHelpIfRequested(n.unknown),this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let i=o(()=>{n.unknown.length>0&&this.unknownOption(n.unknown[0])},"checkForUnknownOptions"),s=`command:${this.name()}`;if(this._actionHandler){i(),this._processArguments();let a;return a=this._chainOrCallHooks(a,"preAction"),a=this._chainOrCall(a,()=>this._actionHandler(this.processedArgs)),this.parent&&(a=this._chainOrCall(a,()=>{this.parent.emit(s,e,t)})),a=this._chainOrCallHooks(a,"postAction"),a}if(this.parent?.listenerCount(s))i(),this._processArguments(),this.parent.emit(s,e,t);else if(e.length){if(this._findCommand("*"))return this._dispatchSubcommand("*",e,t);this.listenerCount("command:*")?this.emit("command:*",e,t):this.commands.length?this.unknownCommand():(i(),this._processArguments())}else this.commands.length?(i(),this.help({error:!0})):(i(),this._processArguments())}_findCommand(e){if(e)return this.commands.find(t=>t._name===e||t._aliases.includes(e))}_findOption(e){return this.options.find(t=>t.is(e))}_checkForMissingMandatoryOptions(){this._getCommandAndAncestors().forEach(e=>{e.options.forEach(t=>{t.mandatory&&e.getOptionValue(t.attributeName())===void 0&&e.missingMandatoryOptionValue(t)})})}_checkForConflictingLocalOptions(){let e=this.options.filter(n=>{let i=n.attributeName();return this.getOptionValue(i)===void 0?!1:this.getOptionValueSource(i)!=="default"});e.filter(n=>n.conflictsWith.length>0).forEach(n=>{let i=e.find(s=>n.conflictsWith.includes(s.attributeName()));i&&this._conflictingOption(n,i)})}_checkForConflictingOptions(){this._getCommandAndAncestors().forEach(e=>{e._checkForConflictingLocalOptions()})}parseOptions(e){let t=[],n=[],i=t;function s(l){return l.length>1&&l[0]==="-"}o(s,"maybeOption");let a=o(l=>/^-(\d+|\d*\.\d+)(e[+-]?\d+)?$/.test(l)?!this._getCommandAndAncestors().some(h=>h.options.map(p=>p.short).some(p=>/^-\d$/.test(p))):!1,"negativeNumberArg"),c=null,u=null,f=0;for(;f<e.length||u;){let l=u??e[f++];if(u=null,l==="--"){i===n&&i.push(l),i.push(...e.slice(f));break}if(c&&(!s(l)||a(l))){this.emit(`option:${c.name()}`,l);continue}if(c=null,s(l)){let h=this._findOption(l);if(h){if(h.required){let p=e[f++];p===void 0&&this.optionMissingArgument(h),this.emit(`option:${h.name()}`,p)}else if(h.optional){let p=null;f<e.length&&(!s(e[f])||a(e[f]))&&(p=e[f++]),this.emit(`option:${h.name()}`,p)}else this.emit(`option:${h.name()}`);c=h.variadic?h:null;continue}}if(l.length>2&&l[0]==="-"&&l[1]!=="-"){let h=this._findOption(`-${l[1]}`);if(h){h.required||h.optional&&this._combineFlagAndOptionalValue?this.emit(`option:${h.name()}`,l.slice(2)):(this.emit(`option:${h.name()}`),u=`-${l.slice(2)}`);continue}}if(/^--[^=]+=/.test(l)){let h=l.indexOf("="),p=this._findOption(l.slice(0,h));if(p&&(p.required||p.optional)){this.emit(`option:${p.name()}`,l.slice(h+1));continue}}if(i===t&&s(l)&&!(this.commands.length===0&&a(l))&&(i=n),(this._enablePositionalOptions||this._passThroughOptions)&&t.length===0&&n.length===0){if(this._findCommand(l)){t.push(l),n.push(...e.slice(f));break}else if(this._getHelpCommand()&&l===this._getHelpCommand().name()){t.push(l,...e.slice(f));break}else if(this._defaultCommandName){n.push(l,...e.slice(f));break}}if(this._passThroughOptions){i.push(l,...e.slice(f));break}i.push(l)}return{operands:t,unknown:n}}opts(){if(this._storeOptionsAsProperties){let e={},t=this.options.length;for(let n=0;n<t;n++){let i=this.options[n].attributeName();e[i]=i===this._versionOptionName?this._version:this[i]}return e}return this._optionValues}optsWithGlobals(){return this._getCommandAndAncestors().reduce((e,t)=>Object.assign(e,t.opts()),{})}error(e,t){this._outputConfiguration.outputError(`${e}
`,this._outputConfiguration.writeErr),typeof this._showHelpAfterError=="string"?this._outputConfiguration.writeErr(`${this._showHelpAfterError}
`):this._showHelpAfterError&&(this._outputConfiguration.writeErr(`
`),this.outputHelp({error:!0}));let n=t||{},i=n.exitCode||1,s=n.code||"commander.error";this._exit(i,s,e)}_parseOptionsEnv(){this.options.forEach(e=>{if(e.envVar&&e.envVar in qe.env){let t=e.attributeName();(this.getOptionValue(t)===void 0||["default","config","env"].includes(this.getOptionValueSource(t)))&&(e.required||e.optional?this.emit(`optionEnv:${e.name()}`,qe.env[e.envVar]):this.emit(`optionEnv:${e.name()}`))}})}_parseOptionsImplied(){let e=new dw(this.options),t=o(n=>this.getOptionValue(n)!==void 0&&!["default","implied"].includes(this.getOptionValueSource(n)),"hasCustomOptionValue");this.options.filter(n=>n.implied!==void 0&&t(n.attributeName())&&e.valueFromOption(this.getOptionValue(n.attributeName()),n)).forEach(n=>{Object.keys(n.implied).filter(i=>!t(i)).forEach(i=>{this.setOptionValueWithSource(i,n.implied[i],"implied")})})}missingArgument(e){let t=`error: missing required argument '${e}'`;this.error(t,{code:"commander.missingArgument"})}optionMissingArgument(e){let t=`error: option '${e.flags}' argument missing`;this.error(t,{code:"commander.optionMissingArgument"})}missingMandatoryOptionValue(e){let t=`error: required option '${e.flags}' not specified`;this.error(t,{code:"commander.missingMandatoryOptionValue"})}_conflictingOption(e,t){let n=o(a=>{let c=a.attributeName(),u=this.getOptionValue(c),f=this.options.find(h=>h.negate&&c===h.attributeName()),l=this.options.find(h=>!h.negate&&c===h.attributeName());return f&&(f.presetArg===void 0&&u===!1||f.presetArg!==void 0&&u===f.presetArg)?f:l||a},"findBestOptionFromValue"),i=o(a=>{let c=n(a),u=c.attributeName();return this.getOptionValueSource(u)==="env"?`environment variable '${c.envVar}'`:`option '${c.flags}'`},"getErrorMessage"),s=`error: ${i(e)} cannot be used with ${i(t)}`;this.error(s,{code:"commander.conflictingOption"})}unknownOption(e){if(this._allowUnknownOption)return;let t="";if(e.startsWith("--")&&this._showSuggestionAfterError){let i=[],s=this;do{let a=s.createHelp().visibleOptions(s).filter(c=>c.long).map(c=>c.long);i=i.concat(a),s=s.parent}while(s&&!s._enablePositionalOptions);t=e0(e,i)}let n=`error: unknown option '${e}'${t}`;this.error(n,{code:"commander.unknownOption"})}_excessArguments(e){if(this._allowExcessArguments)return;let t=this.registeredArguments.length,n=t===1?"":"s",s=`error: too many arguments${this.parent?` for '${this.name()}'`:""}. Expected ${t} argument${n} but got ${e.length}.`;this.error(s,{code:"commander.excessArguments"})}unknownCommand(){let e=this.args[0],t="";if(this._showSuggestionAfterError){let i=[];this.createHelp().visibleCommands(this).forEach(s=>{i.push(s.name()),s.alias()&&i.push(s.alias())}),t=e0(e,i)}let n=`error: unknown command '${e}'${t}`;this.error(n,{code:"commander.unknownCommand"})}version(e,t,n){if(e===void 0)return this._version;this._version=e,t=t||"-V, --version",n=n||"output the version number";let i=this.createOption(t,n);return this._versionOptionName=i.attributeName(),this._registerOption(i),this.on("option:"+i.name(),()=>{this._outputConfiguration.writeOut(`${e}
`),this._exit(0,"commander.version",e)}),this}description(e,t){return e===void 0&&t===void 0?this._description:(this._description=e,t&&(this._argsDescription=t),this)}summary(e){return e===void 0?this._summary:(this._summary=e,this)}alias(e){if(e===void 0)return this._aliases[0];let t=this;if(this.commands.length!==0&&this.commands[this.commands.length-1]._executableHandler&&(t=this.commands[this.commands.length-1]),e===t._name)throw new Error("Command alias can't be the same as its name");let n=this.parent?._findCommand(e);if(n){let i=[n.name()].concat(n.aliases()).join("|");throw new Error(`cannot add alias '${e}' to command '${this.name()}' as already have command '${i}'`)}return t._aliases.push(e),this}aliases(e){return e===void 0?this._aliases:(e.forEach(t=>this.alias(t)),this)}usage(e){if(e===void 0){if(this._usage)return this._usage;let t=this.registeredArguments.map(n=>lw(n));return[].concat(this.options.length||this._helpOption!==null?"[options]":[],this.commands.length?"[command]":[],this.registeredArguments.length?t:[]).join(" ")}return this._usage=e,this}name(e){return e===void 0?this._name:(this._name=e,this)}helpGroup(e){return e===void 0?this._helpGroupHeading??"":(this._helpGroupHeading=e,this)}commandsGroup(e){return e===void 0?this._defaultCommandGroup??"":(this._defaultCommandGroup=e,this)}optionsGroup(e){return e===void 0?this._defaultOptionGroup??"":(this._defaultOptionGroup=e,this)}_initOptionGroup(e){this._defaultOptionGroup&&!e.helpGroupHeading&&e.helpGroup(this._defaultOptionGroup)}_initCommandGroup(e){this._defaultCommandGroup&&!e.helpGroup()&&e.helpGroup(this._defaultCommandGroup)}nameFromFilename(e){return this._name=Un.basename(e,Un.extname(e)),this}executableDir(e){return e===void 0?this._executableDir:(this._executableDir=e,this)}helpInformation(e){let t=this.createHelp(),n=this._getOutputContext(e);t.prepareContext({error:n.error,helpWidth:n.helpWidth,outputHasColors:n.hasColors});let i=t.formatHelp(this,t);return n.hasColors?i:this._outputConfiguration.stripColor(i)}_getOutputContext(e){e=e||{};let t=!!e.error,n,i,s;return t?(n=o(c=>this._outputConfiguration.writeErr(c),"baseWrite"),i=this._outputConfiguration.getErrHasColors(),s=this._outputConfiguration.getErrHelpWidth()):(n=o(c=>this._outputConfiguration.writeOut(c),"baseWrite"),i=this._outputConfiguration.getOutHasColors(),s=this._outputConfiguration.getOutHelpWidth()),{error:t,write:o(c=>(i||(c=this._outputConfiguration.stripColor(c)),n(c)),"write"),hasColors:i,helpWidth:s}}outputHelp(e){let t;typeof e=="function"&&(t=e,e=void 0);let n=this._getOutputContext(e),i={error:n.error,write:n.write,command:this};this._getCommandAndAncestors().reverse().forEach(a=>a.emit("beforeAllHelp",i)),this.emit("beforeHelp",i);let s=this.helpInformation({error:n.error});if(t&&(s=t(s),typeof s!="string"&&!Buffer.isBuffer(s)))throw new Error("outputHelp callback must return a string or a Buffer");n.write(s),this._getHelpOption()?.long&&this.emit(this._getHelpOption().long),this.emit("afterHelp",i),this._getCommandAndAncestors().forEach(a=>a.emit("afterAllHelp",i))}helpOption(e,t){return typeof e=="boolean"?(e?(this._helpOption===null&&(this._helpOption=void 0),this._defaultOptionGroup&&this._initOptionGroup(this._getHelpOption())):this._helpOption=null,this):(this._helpOption=this.createOption(e??"-h, --help",t??"display help for command"),(e||t)&&this._initOptionGroup(this._helpOption),this)}_getHelpOption(){return this._helpOption===void 0&&this.helpOption(void 0,void 0),this._helpOption}addHelpOption(e){return this._helpOption=e,this._initOptionGroup(e),this}help(e){this.outputHelp(e);let t=Number(qe.exitCode??0);t===0&&e&&typeof e!="function"&&e.error&&(t=1),this._exit(t,"commander.help","(outputHelp)")}addHelpText(e,t){let n=["beforeAll","before","after","afterAll"];if(!n.includes(e))throw new Error(`Unexpected value for position to addHelpText.
Expecting one of '${n.join("', '")}'`);let i=`${e}Help`;return this.on(i,s=>{let a;typeof t=="function"?a=t({error:s.error,command:s.command}):a=t,a&&s.write(`${a}
`)}),this}_outputHelpIfRequested(e){let t=this._getHelpOption();t&&e.find(i=>t.is(i))&&(this.outputHelp(),this._exit(0,"commander.helpDisplayed","(outputHelp)"))}};function t0(r){return r.map(e=>{if(!e.startsWith("--inspect"))return e;let t,n="127.0.0.1",i="9229",s;return(s=e.match(/^(--inspect(-brk)?)$/))!==null?t=s[1]:(s=e.match(/^(--inspect(-brk|-port)?)=([^:]+)$/))!==null?(t=s[1],/^\d+$/.test(s[3])?i=s[3]:n=s[3]):(s=e.match(/^(--inspect(-brk|-port)?)=([^:]+):(\d+)$/))!==null&&(t=s[1],n=s[3],i=s[4]),t&&i!=="0"?`${t}=${n}:${parseInt(i)+1}`:e})}o(t0,"incrementNodeInspectorPort");function Tf(){if(qe.env.NO_COLOR||qe.env.FORCE_COLOR==="0"||qe.env.FORCE_COLOR==="false")return!1;if(qe.env.FORCE_COLOR||qe.env.CLICOLOR_FORCE!==void 0)return!0}o(Tf,"useColor");Af.Command=Ef;Af.useColor=Tf});var a0=y(Cr=>{var{Argument:n0}=oc(),{Command:xf}=r0(),{CommanderError:pw,InvalidArgumentError:i0}=Fa(),{Help:mw}=gf(),{Option:s0}=Sf();Cr.program=new xf;Cr.createCommand=r=>new xf(r);Cr.createOption=(r,e)=>new s0(r,e);Cr.createArgument=(r,e)=>new n0(r,e);Cr.Command=xf;Cr.Option=s0;Cr.Argument=n0;Cr.Help=mw;Cr.CommanderError=pw;Cr.InvalidArgumentError=i0;Cr.InvalidOptionArgumentError=i0});var Of=y(uc=>{"use strict";Object.defineProperty(uc,"__esModule",{value:!0});uc.AssetClass=void 0;var c0;(function(r){r.AREA="ems__Area",r.TASK="ems__Task",r.PROJECT="ems__Project",r.MEETING="ems__Meeting",r.INITIATIVE="ems__Initiative",r.TASK_PROTOTYPE="ems__TaskPrototype",r.MEETING_PROTOTYPE="ems__MeetingPrototype",r.EVENT_PROTOTYPE="exo__EventPrototype",r.PROJECT_PROTOTYPE="ems__ProjectPrototype",r.EVENT="exo__Event",r.DAILY_NOTE="pn__DailyNote",r.CONCEPT="ims__Concept",r.SESSION_START_EVENT="ems__SessionStartEvent",r.SESSION_END_EVENT="ems__SessionEndEvent",r.PROTOTYPE="exo__Prototype",r.CLASS="exo__Class"})(c0||(uc.AssetClass=c0={}))});var Cf=y(lc=>{"use strict";Object.defineProperty(lc,"__esModule",{value:!0});lc.EffortStatus=void 0;var u0;(function(r){r.DRAFT="ems__EffortStatusDraft",r.BACKLOG="ems__EffortStatusBacklog",r.ANALYSIS="ems__EffortStatusAnalysis",r.TODO="ems__EffortStatusToDo",r.DOING="ems__EffortStatusDoing",r.DONE="ems__EffortStatusDone",r.TRASHED="ems__EffortStatusTrashed"})(u0||(lc.EffortStatus=u0={}))});var f0=y(l0=>{"use strict";Object.defineProperty(l0,"__esModule",{value:!0})});var d0=y(h0=>{"use strict";Object.defineProperty(h0,"__esModule",{value:!0})});var m0=y(p0=>{"use strict";Object.defineProperty(p0,"__esModule",{value:!0})});var y0=y(g0=>{"use strict";Object.defineProperty(g0,"__esModule",{value:!0})});var gt=y(fc=>{"use strict";Object.defineProperty(fc,"__esModule",{value:!0});fc.IRI=void 0;var Pf=class r{static{o(this,"IRI")}constructor(e){let t=e.trim();if(t.length===0)throw new Error("IRI cannot be empty");if(!r.isValidIRI(t))throw new Error("Invalid IRI format");this._value=t}get value(){return this._value}equals(e){return this._value===e._value}toString(){return this._value}static isValidIRI(e){if(!e||e.trim().length===0||/\s/.test(e)||!/^[a-z][a-z0-9+.-]*:/i.test(e))return!1;let n=["http","https","ftp","ftps","file","mailto","tel","data","ws","wss","urn","obsidian"],i=e.match(/^([a-z][a-z0-9+.-]*?):/i);if(i){let s=i[1].toLowerCase();if(!n.includes(s))return!1}try{return new URL(e),!0}catch{return/^urn:[a-z0-9][a-z0-9-]{0,31}:[^\s]+$/i.test(e)}}};fc.IRI=Pf});var Lt=y(hc=>{"use strict";Object.defineProperty(hc,"__esModule",{value:!0});hc.Literal=void 0;var gw="http://www.w3.org/2001/XMLSchema#string",Ff=class{static{o(this,"Literal")}constructor(e,t,n){if(e.length===0)throw new Error("Literal value cannot be empty");if(t&&n)throw new Error("Literal cannot have both datatype and language tag");this._value=e,this._datatype=t,this._language=n?n.toLowerCase():void 0}get value(){return this._value}get datatype(){return this._datatype}get language(){return this._language}equals(e){if(this._value!==e._value||this._language!==e._language)return!1;let t=this.normalizedDatatype(),n=e.normalizedDatatype();return t===n}normalizedDatatype(){return!this._datatype||this._datatype.value===gw?null:this._datatype.value}toString(){let e=`"${this._value}"`;return this._datatype?e+=`^^<${this._datatype.value}>`:this._language&&(e+=`@${this._language}`),e}};hc.Literal=Ff});var Pr=y(pc=>{"use strict";Object.defineProperty(pc,"__esModule",{value:!0});pc.BlankNode=void 0;var dc=class r{static{o(this,"BlankNode")}constructor(e){let t=e.trim();if(t.length===0)throw new Error("BlankNode id cannot be empty");this._id=t}get id(){return this._id}equals(e){return this._id===e._id}toString(){return`_:${this._id}`}static generateId(){return`b${++r.counter}`}static create(){return new r(r.generateId())}};pc.BlankNode=dc;dc.counter=0});var wn=y(mc=>{"use strict";Object.defineProperty(mc,"__esModule",{value:!0});mc.Namespace=void 0;var _0=gt(),Xt=class{static{o(this,"Namespace")}constructor(e,t){if(e.trim().length===0)throw new Error("Namespace prefix cannot be empty");this._prefix=e,this._iri=new _0.IRI(t)}get prefix(){return this._prefix}get iri(){return this._iri}term(e){return new _0.IRI(`${this._iri.value}${e}`)}expand(e){let t=e.split(":");if(t.length!==2)return null;let[n,i]=t;return n!==this._prefix?null:this.term(i)}};mc.Namespace=Xt;Xt.RDF=new Xt("rdf","http://www.w3.org/1999/02/22-rdf-syntax-ns#");Xt.RDFS=new Xt("rdfs","http://www.w3.org/2000/01/rdf-schema#");Xt.OWL=new Xt("owl","http://www.w3.org/2002/07/owl#");Xt.XSD=new Xt("xsd","http://www.w3.org/2001/XMLSchema#");Xt.EXO=new Xt("exo","https://exocortex.my/ontology/exo#");Xt.EMS=new Xt("ems","https://exocortex.my/ontology/ems#")});var qi=y(gc=>{"use strict";Object.defineProperty(gc,"__esModule",{value:!0});gc.Triple=void 0;var If=gt(),Rf=Lt(),Df=Pr(),Nf=class{static{o(this,"Triple")}constructor(e,t,n){this._subject=e,this._predicate=t,this._object=n}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}equals(e){return!(!this.equalsNode(this._subject,e._subject)||!this._predicate.equals(e._predicate)||!this.equalsNode(this._object,e._object))}equalsNode(e,t){return e instanceof If.IRI&&t instanceof If.IRI||e instanceof Df.BlankNode&&t instanceof Df.BlankNode||e instanceof Rf.Literal&&t instanceof Rf.Literal?e.equals(t):!1}toString(){let e=this.nodeToString(this._subject),t=`<${this._predicate.value}>`,n=this.nodeToString(this._object);return`${e} ${t} ${n} .`}nodeToString(e){return e instanceof If.IRI?`<${e.value}>`:e instanceof Df.BlankNode||e instanceof Rf.Literal?e.toString():""}};gc.Triple=Nf});var v0=y(Fr=>{"use strict";Object.defineProperty(Fr,"__esModule",{value:!0});Fr.Triple=Fr.Namespace=Fr.BlankNode=Fr.Literal=Fr.IRI=void 0;var yw=gt();Object.defineProperty(Fr,"IRI",{enumerable:!0,get:o(function(){return yw.IRI},"get")});var _w=Lt();Object.defineProperty(Fr,"Literal",{enumerable:!0,get:o(function(){return _w.Literal},"get")});var vw=Pr();Object.defineProperty(Fr,"BlankNode",{enumerable:!0,get:o(function(){return vw.BlankNode},"get")});var Sw=wn();Object.defineProperty(Fr,"Namespace",{enumerable:!0,get:o(function(){return Sw.Namespace},"get")});var ww=qi();Object.defineProperty(Fr,"Triple",{enumerable:!0,get:o(function(){return ww.Triple},"get")})});var Bi=y(_c=>{"use strict";Object.defineProperty(_c,"__esModule",{value:!0});_c.WikiLinkHelpers=void 0;var yc=class{static{o(this,"WikiLinkHelpers")}static normalize(e){return e?e.replace(this.WIKI_LINK_PATTERN,"").trim():""}static normalizeArray(e){return e?(Array.isArray(e)?e:[e]).map(n=>this.normalize(n)).filter(n=>n.length>0):[]}static equals(e,t){return this.normalize(e)===this.normalize(t)}static includes(e,t){let n=this.normalizeArray(e),i=this.normalize(t);return n.includes(i)}};_c.WikiLinkHelpers=yc;yc.WIKI_LINK_PATTERN=/\[\[|\]\]/g});var Vt=y(xs=>{"use strict";Object.defineProperty(xs,"__esModule",{value:!0});xs.EffortStatus=xs.AssetClass=void 0;var bw=Of();Object.defineProperty(xs,"AssetClass",{enumerable:!0,get:o(function(){return bw.AssetClass},"get")});var Ew=Cf();Object.defineProperty(xs,"EffortStatus",{enumerable:!0,get:o(function(){return Ew.EffortStatus},"get")})});var ci=y(qt=>{"use strict";Object.defineProperty(qt,"__esModule",{value:!0});qt.hasClass=$i;qt.isAreaOrProject=Tw;qt.isEffort=Aw;qt.hasStatus=xw;qt.isAssetArchived=Ow;qt.hasEmptyProperties=Cw;qt.needsFolderRepair=Pw;qt.getTodayDateString=kf;qt.isPlannedForToday=Fw;qt.hasPlannedStartTimestamp=Iw;qt.extractDailyNoteDate=Rw;qt.isCurrentDateGteDay=Dw;qt.inheritsFromPrototype=b0;qt.isPrototypeClass=kw;var w0=Bi(),Ui=Vt();function $i(r,e){return r?(Array.isArray(r)?r:[r]).some(n=>w0.WikiLinkHelpers.normalize(n)===e):!1}o($i,"hasClass");function Tw(r){return $i(r,Ui.AssetClass.AREA)||$i(r,Ui.AssetClass.PROJECT)}o(Tw,"isAreaOrProject");function Aw(r){return $i(r,Ui.AssetClass.TASK)||$i(r,Ui.AssetClass.PROJECT)||$i(r,Ui.AssetClass.MEETING)}o(Aw,"isEffort");function xw(r,e){if(!r)return!1;let t=Array.isArray(r)?r[0]:r;return t?w0.WikiLinkHelpers.normalize(t)===e:!1}o(xw,"hasStatus");function Ow(r){if(r===!0||r===1)return!0;if(typeof r=="string"){let e=r.toLowerCase();return e==="true"||e==="yes"}return!1}o(Ow,"isAssetArchived");function Cw(r){return!r||Object.keys(r).length===0?!1:Object.values(r).some(e=>!!(e==null||typeof e=="string"&&e.trim()===""||Array.isArray(e)&&e.length===0||typeof e=="object"&&!Array.isArray(e)&&Object.keys(e).length===0))}o(Cw,"hasEmptyProperties");function Pw(r,e){if(!e)return!1;let t=r.replace(/\/$/,""),n=e.replace(/\/$/,"");return t!==n}o(Pw,"needsFolderRepair");function kf(){let r=new Date,e=r.getFullYear(),t=String(r.getMonth()+1).padStart(2,"0"),n=String(r.getDate()).padStart(2,"0");return`${e}-${t}-${n}`}o(kf,"getTodayDateString");function Fw(r){let e=r.ems__Effort_plannedStartTimestamp;if(!e)return!1;let t=kf();return typeof e=="string"?e.split("T")[0]===t:Array.isArray(e)&&e.length>0?String(e[0]).split("T")[0]===t:!1}o(Fw,"isPlannedForToday");function Iw(r){let e=r.ems__Effort_plannedStartTimestamp;return e?typeof e=="string"?e.trim().length>0:Array.isArray(e)&&e.length>0?String(e[0]).trim().length>0:!1:!1}o(Iw,"hasPlannedStartTimestamp");function Rw(r){let e=r.pn__DailyNote_day;if(!e)return null;if(typeof e=="string"){let t=e.match(/\[\[(.+?)\]\]/);return t?t[1]:e}if(Array.isArray(e)&&e.length>0){let t=String(e[0]),n=t.match(/\[\[(.+?)\]\]/);return n?n[1]:t}return null}o(Rw,"extractDailyNoteDate");function Dw(r){return kf()>=r}o(Dw,"isCurrentDateGteDay");function S0(r){return r?r.replace(/^["']|["']$/g,"").replace(/\[\[|\]\]/g,"").trim():""}o(S0,"normalizeWithQuotes");var Nw=10;function b0(r,e=Nw){let t=r.exo__Class_superClass;if(!t)return!1;let n=new Set,i=[],s=Array.isArray(t)?t:[t];for(let a of s){let c=S0(a);c&&i.push({className:c,depth:0})}for(;i.length>0;){let a=i.shift();if(!a)continue;let{className:c,depth:u}=a;if(u>e)continue;if(c===Ui.AssetClass.PROTOTYPE)return!0;if(n.has(c))continue;n.add(c);let f=`${c}__exo__Class_superClass`,l=r[f];if(l){let h=Array.isArray(l)?l:[l];for(let p of h){let g=S0(p);g&&!n.has(g)&&i.push({className:g,depth:u+1})}}}return!1}o(b0,"inheritsFromPrototype");function kw(r,e){return $i(r,Ui.AssetClass.CLASS)?b0(e):!1}o(kw,"isPrototypeClass")});var T0=y(Ia=>{"use strict";Object.defineProperty(Ia,"__esModule",{value:!0});Ia.canCreateTask=jw;Ia.canCreateRelatedTask=Mw;Ia.canConvertTaskToProject=Lw;var vc=ci(),E0=Vt();function jw(r){return(0,vc.isAreaOrProject)(r.instanceClass)}o(jw,"canCreateTask");function Mw(r){return!(!(0,vc.hasClass)(r.instanceClass,E0.AssetClass.TASK)||(0,vc.isAssetArchived)(r.isArchived))}o(Mw,"canCreateRelatedTask");function Lw(r){return(0,vc.hasClass)(r.instanceClass,E0.AssetClass.TASK)}o(Lw,"canConvertTaskToProject")});var A0=y(Os=>{"use strict";Object.defineProperty(Os,"__esModule",{value:!0});Os.canCreateProject=Vw;Os.canMoveToAnalysis=qw;Os.canMoveToToDo=Bw;Os.canConvertProjectToTask=Uw;var ui=ci(),li=Vt();function Vw(r){return(0,ui.hasClass)(r.instanceClass,li.AssetClass.AREA)||(0,ui.hasClass)(r.instanceClass,li.AssetClass.INITIATIVE)||(0,ui.hasClass)(r.instanceClass,li.AssetClass.PROJECT)}o(Vw,"canCreateProject");function qw(r){return(0,ui.hasClass)(r.instanceClass,li.AssetClass.PROJECT)?(0,ui.hasStatus)(r.currentStatus,li.EffortStatus.BACKLOG):!1}o(qw,"canMoveToAnalysis");function Bw(r){return(0,ui.hasClass)(r.instanceClass,li.AssetClass.PROJECT)?(0,ui.hasStatus)(r.currentStatus,li.EffortStatus.ANALYSIS):!1}o(Bw,"canMoveToToDo");function Uw(r){return(0,ui.hasClass)(r.instanceClass,li.AssetClass.PROJECT)}o(Uw,"canConvertProjectToTask")});var C0=y(Sc=>{"use strict";Object.defineProperty(Sc,"__esModule",{value:!0});Sc.canCreateChildArea=$w;Sc.canSetActiveFocus=Ww;var x0=ci(),O0=Vt();function $w(r){return(0,x0.hasClass)(r.instanceClass,O0.AssetClass.AREA)}o($w,"canCreateChildArea");function Ww(r){return(0,x0.hasClass)(r.instanceClass,O0.AssetClass.AREA)}o(Ww,"canSetActiveFocus")});var F0=y(lr=>{"use strict";Object.defineProperty(lr,"__esModule",{value:!0});lr.canPlanOnToday=Gw;lr.canPlanForEvening=Hw;lr.canShiftDayBackward=zw;lr.canShiftDayForward=Kw;lr.canSetDraftStatus=Yw;lr.canMoveToBacklog=Qw;lr.canStartEffort=Jw;lr.canMarkDone=Xw;lr.canTrashEffort=Zw;lr.canVoteOnEffort=eb;lr.canRollbackStatus=tb;lr.canArchiveTask=rb;var P0=Bi(),Ke=ci(),_r=Vt();function Gw(r){return!(!(0,Ke.isEffort)(r.instanceClass)||(0,Ke.isPlannedForToday)(r.metadata))}o(Gw,"canPlanOnToday");function Hw(r){return!(0,Ke.hasClass)(r.instanceClass,_r.AssetClass.TASK)&&!(0,Ke.hasClass)(r.instanceClass,_r.AssetClass.MEETING)?!1:(0,Ke.hasStatus)(r.currentStatus,_r.EffortStatus.BACKLOG)}o(Hw,"canPlanForEvening");function zw(r){return(0,Ke.isEffort)(r.instanceClass)?(0,Ke.hasPlannedStartTimestamp)(r.metadata):!1}o(zw,"canShiftDayBackward");function Kw(r){return(0,Ke.isEffort)(r.instanceClass)?(0,Ke.hasPlannedStartTimestamp)(r.metadata):!1}o(Kw,"canShiftDayForward");function Yw(r){return(0,Ke.isEffort)(r.instanceClass)?!r.currentStatus:!1}o(Yw,"canSetDraftStatus");function Qw(r){return(0,Ke.isEffort)(r.instanceClass)?(0,Ke.hasStatus)(r.currentStatus,_r.EffortStatus.DRAFT):!1}o(Qw,"canMoveToBacklog");function Jw(r){return(0,Ke.isEffort)(r.instanceClass)?(0,Ke.hasClass)(r.instanceClass,_r.AssetClass.TASK)||(0,Ke.hasClass)(r.instanceClass,_r.AssetClass.MEETING)?(0,Ke.hasStatus)(r.currentStatus,_r.EffortStatus.BACKLOG):(0,Ke.hasClass)(r.instanceClass,_r.AssetClass.PROJECT)?(0,Ke.hasStatus)(r.currentStatus,_r.EffortStatus.TODO):!1:!1}o(Jw,"canStartEffort");function Xw(r){return(0,Ke.isEffort)(r.instanceClass)?(0,Ke.hasStatus)(r.currentStatus,_r.EffortStatus.DOING):!1}o(Xw,"canMarkDone");function Zw(r){return(0,Ke.isEffort)(r.instanceClass)?r.currentStatus?!(Array.isArray(r.currentStatus)?r.currentStatus:[r.currentStatus]).some(n=>{let i=P0.WikiLinkHelpers.normalize(n);return i===_r.EffortStatus.TRASHED||i===_r.EffortStatus.DONE}):!0:!1}o(Zw,"canTrashEffort");function eb(r){return!(!(0,Ke.isEffort)(r.instanceClass)||(0,Ke.isAssetArchived)(r.isArchived))}o(eb,"canVoteOnEffort");function tb(r){if(!(0,Ke.isEffort)(r.instanceClass)||(0,Ke.isAssetArchived)(r.isArchived)||!r.currentStatus)return!1;let e=Array.isArray(r.currentStatus)?r.currentStatus[0]:r.currentStatus;return!(!e||P0.WikiLinkHelpers.normalize(e)===_r.EffortStatus.TRASHED)}o(tb,"canRollbackStatus");function rb(r){return!(0,Ke.isAssetArchived)(r.isArchived)}o(rb,"canArchiveTask")});var I0=y(Mr=>{"use strict";Object.defineProperty(Mr,"__esModule",{value:!0});Mr.canCreateEvent=nb;Mr.canCreateInstance=ib;Mr.canCleanProperties=sb;Mr.canRepairFolder=ab;Mr.canRenameToUid=ob;Mr.canCopyLabelToAliases=cb;Mr.canCreateNarrowerConcept=ub;Mr.canCreateSubclass=lb;Mr.canCreateTaskForDailyNote=fb;var fr=ci(),fi=Vt();function nb(r){return(0,fr.isAreaOrProject)(r.instanceClass)}o(nb,"canCreateEvent");function ib(r){return(0,fr.hasClass)(r.instanceClass,fi.AssetClass.TASK_PROTOTYPE)||(0,fr.hasClass)(r.instanceClass,fi.AssetClass.MEETING_PROTOTYPE)||(0,fr.hasClass)(r.instanceClass,fi.AssetClass.EVENT_PROTOTYPE)||(0,fr.hasClass)(r.instanceClass,fi.AssetClass.PROJECT_PROTOTYPE)?!0:(0,fr.isPrototypeClass)(r.instanceClass,r.metadata)}o(ib,"canCreateInstance");function sb(r){return(0,fr.hasEmptyProperties)(r.metadata)}o(sb,"canCleanProperties");function ab(r){return(0,fr.needsFolderRepair)(r.currentFolder,r.expectedFolder)}o(ab,"canRepairFolder");function ob(r,e){let t=r.metadata.exo__Asset_uid;return!t||(0,fr.hasClass)(r.instanceClass,fi.AssetClass.CONCEPT)?!1:e!==t}o(ob,"canRenameToUid");function cb(r){let e=r.metadata.exo__Asset_label;if(!e||typeof e!="string"||e.trim()==="")return!1;let t=e.trim(),n=r.metadata.aliases;return!n||!Array.isArray(n)||n.length===0?!0:!n.some(i=>typeof i!="string"?!1:i.trim()===t)}o(cb,"canCopyLabelToAliases");function ub(r){return(0,fr.hasClass)(r.instanceClass,fi.AssetClass.CONCEPT)}o(ub,"canCreateNarrowerConcept");function lb(r){return(0,fr.hasClass)(r.instanceClass,fi.AssetClass.CLASS)}o(lb,"canCreateSubclass");function fb(r){if(!(0,fr.hasClass)(r.instanceClass,fi.AssetClass.DAILY_NOTE)||r.isArchived)return!1;let e=(0,fr.extractDailyNoteDate)(r.metadata);return e?(0,fr.isCurrentDateGteDay)(e):!1}o(fb,"canCreateTaskForDailyNote")});var D0=y(R=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0});R.canCreateTaskForDailyNote=R.canCreateSubclass=R.canCreateNarrowerConcept=R.canCopyLabelToAliases=R.canRenameToUid=R.canRepairFolder=R.canCleanProperties=R.canCreateInstance=R.canCreateEvent=R.canArchiveTask=R.canRollbackStatus=R.canVoteOnEffort=R.canTrashEffort=R.canMarkDone=R.canStartEffort=R.canMoveToBacklog=R.canSetDraftStatus=R.canShiftDayForward=R.canShiftDayBackward=R.canPlanForEvening=R.canPlanOnToday=R.canSetActiveFocus=R.canCreateChildArea=R.canConvertProjectToTask=R.canMoveToToDo=R.canMoveToAnalysis=R.canCreateProject=R.canConvertTaskToProject=R.canCreateRelatedTask=R.canCreateTask=R.isPrototypeClass=R.inheritsFromPrototype=R.isCurrentDateGteDay=R.extractDailyNoteDate=R.hasPlannedStartTimestamp=R.isPlannedForToday=R.getTodayDateString=R.needsFolderRepair=R.hasEmptyProperties=R.isAssetArchived=R.hasStatus=R.isEffort=R.isAreaOrProject=R.hasClass=void 0;var hr=ci();Object.defineProperty(R,"hasClass",{enumerable:!0,get:o(function(){return hr.hasClass},"get")});Object.defineProperty(R,"isAreaOrProject",{enumerable:!0,get:o(function(){return hr.isAreaOrProject},"get")});Object.defineProperty(R,"isEffort",{enumerable:!0,get:o(function(){return hr.isEffort},"get")});Object.defineProperty(R,"hasStatus",{enumerable:!0,get:o(function(){return hr.hasStatus},"get")});Object.defineProperty(R,"isAssetArchived",{enumerable:!0,get:o(function(){return hr.isAssetArchived},"get")});Object.defineProperty(R,"hasEmptyProperties",{enumerable:!0,get:o(function(){return hr.hasEmptyProperties},"get")});Object.defineProperty(R,"needsFolderRepair",{enumerable:!0,get:o(function(){return hr.needsFolderRepair},"get")});Object.defineProperty(R,"getTodayDateString",{enumerable:!0,get:o(function(){return hr.getTodayDateString},"get")});Object.defineProperty(R,"isPlannedForToday",{enumerable:!0,get:o(function(){return hr.isPlannedForToday},"get")});Object.defineProperty(R,"hasPlannedStartTimestamp",{enumerable:!0,get:o(function(){return hr.hasPlannedStartTimestamp},"get")});Object.defineProperty(R,"extractDailyNoteDate",{enumerable:!0,get:o(function(){return hr.extractDailyNoteDate},"get")});Object.defineProperty(R,"isCurrentDateGteDay",{enumerable:!0,get:o(function(){return hr.isCurrentDateGteDay},"get")});Object.defineProperty(R,"inheritsFromPrototype",{enumerable:!0,get:o(function(){return hr.inheritsFromPrototype},"get")});Object.defineProperty(R,"isPrototypeClass",{enumerable:!0,get:o(function(){return hr.isPrototypeClass},"get")});var jf=T0();Object.defineProperty(R,"canCreateTask",{enumerable:!0,get:o(function(){return jf.canCreateTask},"get")});Object.defineProperty(R,"canCreateRelatedTask",{enumerable:!0,get:o(function(){return jf.canCreateRelatedTask},"get")});Object.defineProperty(R,"canConvertTaskToProject",{enumerable:!0,get:o(function(){return jf.canConvertTaskToProject},"get")});var wc=A0();Object.defineProperty(R,"canCreateProject",{enumerable:!0,get:o(function(){return wc.canCreateProject},"get")});Object.defineProperty(R,"canMoveToAnalysis",{enumerable:!0,get:o(function(){return wc.canMoveToAnalysis},"get")});Object.defineProperty(R,"canMoveToToDo",{enumerable:!0,get:o(function(){return wc.canMoveToToDo},"get")});Object.defineProperty(R,"canConvertProjectToTask",{enumerable:!0,get:o(function(){return wc.canConvertProjectToTask},"get")});var R0=C0();Object.defineProperty(R,"canCreateChildArea",{enumerable:!0,get:o(function(){return R0.canCreateChildArea},"get")});Object.defineProperty(R,"canSetActiveFocus",{enumerable:!0,get:o(function(){return R0.canSetActiveFocus},"get")});var Ir=F0();Object.defineProperty(R,"canPlanOnToday",{enumerable:!0,get:o(function(){return Ir.canPlanOnToday},"get")});Object.defineProperty(R,"canPlanForEvening",{enumerable:!0,get:o(function(){return Ir.canPlanForEvening},"get")});Object.defineProperty(R,"canShiftDayBackward",{enumerable:!0,get:o(function(){return Ir.canShiftDayBackward},"get")});Object.defineProperty(R,"canShiftDayForward",{enumerable:!0,get:o(function(){return Ir.canShiftDayForward},"get")});Object.defineProperty(R,"canSetDraftStatus",{enumerable:!0,get:o(function(){return Ir.canSetDraftStatus},"get")});Object.defineProperty(R,"canMoveToBacklog",{enumerable:!0,get:o(function(){return Ir.canMoveToBacklog},"get")});Object.defineProperty(R,"canStartEffort",{enumerable:!0,get:o(function(){return Ir.canStartEffort},"get")});Object.defineProperty(R,"canMarkDone",{enumerable:!0,get:o(function(){return Ir.canMarkDone},"get")});Object.defineProperty(R,"canTrashEffort",{enumerable:!0,get:o(function(){return Ir.canTrashEffort},"get")});Object.defineProperty(R,"canVoteOnEffort",{enumerable:!0,get:o(function(){return Ir.canVoteOnEffort},"get")});Object.defineProperty(R,"canRollbackStatus",{enumerable:!0,get:o(function(){return Ir.canRollbackStatus},"get")});Object.defineProperty(R,"canArchiveTask",{enumerable:!0,get:o(function(){return Ir.canArchiveTask},"get")});var $n=I0();Object.defineProperty(R,"canCreateEvent",{enumerable:!0,get:o(function(){return $n.canCreateEvent},"get")});Object.defineProperty(R,"canCreateInstance",{enumerable:!0,get:o(function(){return $n.canCreateInstance},"get")});Object.defineProperty(R,"canCleanProperties",{enumerable:!0,get:o(function(){return $n.canCleanProperties},"get")});Object.defineProperty(R,"canRepairFolder",{enumerable:!0,get:o(function(){return $n.canRepairFolder},"get")});Object.defineProperty(R,"canRenameToUid",{enumerable:!0,get:o(function(){return $n.canRenameToUid},"get")});Object.defineProperty(R,"canCopyLabelToAliases",{enumerable:!0,get:o(function(){return $n.canCopyLabelToAliases},"get")});Object.defineProperty(R,"canCreateNarrowerConcept",{enumerable:!0,get:o(function(){return $n.canCreateNarrowerConcept},"get")});Object.defineProperty(R,"canCreateSubclass",{enumerable:!0,get:o(function(){return $n.canCreateSubclass},"get")});Object.defineProperty(R,"canCreateTaskForDailyNote",{enumerable:!0,get:o(function(){return $n.canCreateTaskForDailyNote},"get")})});var N0=y(Wi=>{"use strict";var hb=Wi&&Wi.__createBinding||(Object.create?(function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:o(function(){return e[t]},"get")}),Object.defineProperty(r,n,i)}):(function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]})),db=Wi&&Wi.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&hb(e,r,t)};Object.defineProperty(Wi,"__esModule",{value:!0});db(D0(),Wi)});var j0=y(Ra=>{"use strict";Object.defineProperty(Ra,"__esModule",{value:!0});Ra.PropertyFieldType=void 0;Ra.rangeToFieldType=gb;var Pt;(function(r){r.Text="text",r.Number="number",r.Date="date",r.DateTime="datetime",r.Boolean="boolean",r.Reference="reference",r.Enum="enum",r.StatusSelect="status-select",r.SizeSelect="size-select",r.Wikilink="wikilink",r.Timestamp="timestamp",r.Unknown="unknown"})(Pt||(Ra.PropertyFieldType=Pt={}));var k0="http://www.w3.org/2001/XMLSchema#",pb="https://exocortex.my/ontology/exo#",mb="https://exocortex.my/ontology/ems#";function gb(r){if(!r)return Pt.Unknown;let e=r.trim();if(!e)return Pt.Unknown;if(e.startsWith(k0)){let t=e.substring(k0.length);return Mf(t)}if(e.startsWith("xsd:")){let t=e.substring(4);return Mf(t)}if(e.includes("XMLSchema#")){let t=e.indexOf("XMLSchema#"),n=e.substring(t+10);return Mf(n)}return e.startsWith(mb)||e.startsWith("ems:")?yb(e):e.startsWith(pb)||e.startsWith("exo:")||_b(e)?Pt.Reference:Pt.Text}o(gb,"rangeToFieldType");function Mf(r){switch(r.toLowerCase()){case"string":case"normalizedstring":case"token":case"language":case"nmtoken":case"name":case"ncname":case"anyuri":return Pt.Text;case"integer":case"int":case"long":case"short":case"byte":case"nonnegativeinteger":case"positiveinteger":case"nonpositiveinteger":case"negativeinteger":case"unsignedlong":case"unsignedint":case"unsignedshort":case"unsignedbyte":case"decimal":case"float":case"double":return Pt.Number;case"date":return Pt.Date;case"datetime":case"datetimestamp":return Pt.DateTime;case"boolean":return Pt.Boolean;case"time":return Pt.Timestamp;default:return Pt.Text}}o(Mf,"xsdTypeToFieldType");function yb(r){let e=r.toLowerCase();return e.includes("effortstatus")?Pt.StatusSelect:e.includes("tasksize")?Pt.SizeSelect:Pt.Reference}o(yb,"emsTypeToFieldType");function _b(r){let e=r.toLowerCase();return e.includes("exocortex.my/ontology")?!0:["asset","task","project","area","effort","class","property","concept"].some(n=>e.includes(n))}o(_b,"isClassReference")});var L0=y(Da=>{"use strict";Object.defineProperty(Da,"__esModule",{value:!0});Da.propertyNameToUri=vb;Da.uriToPropertyName=M0;Da.extractPropertyLabel=Sb;function vb(r){return r.replace(/^([a-z]+)__/,"$1:")}o(vb,"propertyNameToUri");function M0(r){if(r.startsWith("http://")||r.startsWith("https://")){let e=r.match(/\/([a-z]+)#([A-Za-z0-9_]+)$/);if(e)return`${e[1]}__${e[2]}`;let t=r.lastIndexOf("#"),n=r.lastIndexOf("/"),i=Math.max(t,n);return i>=0?r.substring(i+1):r}return r.replace(/^([a-z]+):/,"$1__")}o(M0,"uriToPropertyName");function Sb(r){let n=(r.includes(":")?M0(r):r).replace(/^[a-z]+__/,"").split("_");return(n.length>1?n.slice(1).join(" "):n[0]).replace(/([a-z])([A-Z])/g,"$1 $2").replace(/^./,s=>s.toUpperCase())}o(Sb,"extractPropertyLabel")});var bc={};ew(bc,{__assign:()=>Vf,__asyncDelegator:()=>Db,__asyncGenerator:()=>Rb,__asyncValues:()=>Nb,__await:()=>Na,__awaiter:()=>xb,__classPrivateFieldGet:()=>Lb,__classPrivateFieldSet:()=>Vb,__createBinding:()=>Cb,__decorate:()=>Eb,__exportStar:()=>Pb,__extends:()=>wb,__generator:()=>Ob,__importDefault:()=>Mb,__importStar:()=>jb,__makeTemplateObject:()=>kb,__metadata:()=>Ab,__param:()=>Tb,__read:()=>V0,__rest:()=>bb,__spread:()=>Fb,__spreadArrays:()=>Ib,__values:()=>qf});function wb(r,e){Lf(r,e);function t(){this.constructor=r}o(t,"__"),r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function bb(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t}function Eb(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}function Tb(r,e){return function(t,n){e(t,n,r)}}function Ab(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function xb(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return o(i,"adopt"),new(t||(t=Promise))(function(s,a){function c(l){try{f(n.next(l))}catch(h){a(h)}}o(c,"fulfilled");function u(l){try{f(n.throw(l))}catch(h){a(h)}}o(u,"rejected");function f(l){l.done?s(l.value):i(l.value).then(c,u)}o(f,"step"),f((n=n.apply(r,e||[])).next())})}function Ob(r,e){var t={label:0,sent:o(function(){if(s[0]&1)throw s[1];return s[1]},"sent"),trys:[],ops:[]},n,i,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(f){return function(l){return u([f,l])}}function u(f){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return t.label++,{value:f[1],done:!1};case 5:t.label++,i=f[1],f=[0];continue;case 7:f=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){t=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){t.label=f[1];break}if(f[0]===6&&t.label<s[1]){t.label=s[1],s=f;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(f);break}s[2]&&t.ops.pop(),t.trys.pop();continue}f=e.call(r,t)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Cb(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}function Pb(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function qf(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:o(function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}},"next")};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function V0(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(a)throw a.error}}return s}function Fb(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(V0(arguments[e]));return r}function Ib(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),i=0,e=0;e<t;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,i++)n[i]=s[a];return n}function Na(r){return this instanceof Na?(this.v=r,this):new Na(r)}function Rb(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(p){n[p]&&(i[p]=function(g){return new Promise(function(w,S){s.push([p,g,w,S])>1||c(p,g)})})}function c(p,g){try{u(n[p](g))}catch(w){h(s[0][3],w)}}function u(p){p.value instanceof Na?Promise.resolve(p.value.v).then(f,l):h(s[0][2],p)}function f(p){c("next",p)}function l(p){c("throw",p)}function h(p,g){p(g),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Db(r){var e,t;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=r[i]?function(a){return(t=!t)?{value:Na(r[i](a)),done:i==="return"}:s?s(a):a}:s}}function Nb(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof qf=="function"?qf(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=r[s]&&function(a){return new Promise(function(c,u){a=r[s](a),i(c,u,a.done,a.value)})}}function i(s,a,c,u){Promise.resolve(u).then(function(f){s({value:f,done:c})},a)}}function kb(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function jb(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function Mb(r){return r&&r.__esModule?r:{default:r}}function Lb(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function Vb(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}var Lf,Vf,Ec=ZS(()=>{Lf=o(function(r,e){return Lf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])},Lf(r,e)},"extendStatics");o(wb,"__extends");Vf=o(function(){return Vf=Object.assign||o(function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},"__assign"),Vf.apply(this,arguments)},"__assign");o(bb,"__rest");o(Eb,"__decorate");o(Tb,"__param");o(Ab,"__metadata");o(xb,"__awaiter");o(Ob,"__generator");o(Cb,"__createBinding");o(Pb,"__exportStar");o(qf,"__values");o(V0,"__read");o(Fb,"__spread");o(Ib,"__spreadArrays");o(Na,"__await");o(Rb,"__asyncGenerator");o(Db,"__asyncDelegator");o(Nb,"__asyncValues");o(kb,"__makeTemplateObject");o(jb,"__importStar");o(Mb,"__importDefault");o(Lb,"__classPrivateFieldGet");o(Vb,"__classPrivateFieldSet")});var $f=y(Uf=>{"use strict";Object.defineProperty(Uf,"__esModule",{value:!0});var Bf;(function(r){r[r.Transient=0]="Transient",r[r.Singleton=1]="Singleton",r[r.ResolutionScoped=2]="ResolutionScoped",r[r.ContainerScoped=3]="ContainerScoped"})(Bf||(Bf={}));Uf.default=Bf});var q0=y(Wf=>{"use strict";Object.defineProperty(Wf,"__esModule",{value:!0});var qb=$f();Object.defineProperty(Wf,"Lifecycle",{enumerable:!0,get:o(function(){return qb.default},"get")})});var Gi=y(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0});Lr.defineInjectionTokenMetadata=Lr.getParamInfo=Lr.INJECTION_TOKEN_METADATA_KEY=void 0;Lr.INJECTION_TOKEN_METADATA_KEY="injectionTokens";function Bb(r){let e=Reflect.getMetadata("design:paramtypes",r)||[],t=Reflect.getOwnMetadata(Lr.INJECTION_TOKEN_METADATA_KEY,r)||{};return Object.keys(t).forEach(n=>{e[+n]=t[n]}),e}o(Bb,"getParamInfo");Lr.getParamInfo=Bb;function Ub(r,e){return function(t,n,i){let s=Reflect.getOwnMetadata(Lr.INJECTION_TOKEN_METADATA_KEY,t)||{};s[i]=e?{token:r,transform:e.transformToken,transformArgs:e.args||[]}:r,Reflect.defineMetadata(Lr.INJECTION_TOKEN_METADATA_KEY,s,t)}}o(Ub,"defineInjectionTokenMetadata");Lr.defineInjectionTokenMetadata=Ub});var Gf=y(Tc=>{"use strict";Object.defineProperty(Tc,"__esModule",{value:!0});Tc.isClassProvider=void 0;function $b(r){return!!r.useClass}o($b,"isClassProvider");Tc.isClassProvider=$b});var Hf=y(Ac=>{"use strict";Object.defineProperty(Ac,"__esModule",{value:!0});Ac.isFactoryProvider=void 0;function Wb(r){return!!r.useFactory}o(Wb,"isFactoryProvider");Ac.isFactoryProvider=Wb});var Oc=y(Cs=>{"use strict";Object.defineProperty(Cs,"__esModule",{value:!0});Cs.delay=Cs.DelayedConstructor=void 0;var xc=class{static{o(this,"DelayedConstructor")}constructor(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}createProxy(e){let t={},n=!1,i,s=o(()=>(n||(i=e(this.wrap()),n=!0),i),"delayedObject");return new Proxy(t,this.createHandler(s))}createHandler(e){let t={},n=o(i=>{t[i]=(...s)=>{s[0]=e();let a=Reflect[i];return a(...s)}},"install");return this.reflectMethods.forEach(n),t}};Cs.DelayedConstructor=xc;function Gb(r){if(typeof r>"u")throw new Error("Attempt to `delay` undefined. Constructor must be wrapped in a callback");return new xc(r)}o(Gb,"delay");Cs.delay=Gb});var Cc=y(bn=>{"use strict";Object.defineProperty(bn,"__esModule",{value:!0});bn.isConstructorToken=bn.isTransformDescriptor=bn.isTokenDescriptor=bn.isNormalToken=void 0;var Hb=Oc();function zb(r){return typeof r=="string"||typeof r=="symbol"}o(zb,"isNormalToken");bn.isNormalToken=zb;function Kb(r){return typeof r=="object"&&"token"in r&&"multiple"in r}o(Kb,"isTokenDescriptor");bn.isTokenDescriptor=Kb;function Yb(r){return typeof r=="object"&&"token"in r&&"transform"in r}o(Yb,"isTransformDescriptor");bn.isTransformDescriptor=Yb;function Qb(r){return typeof r=="function"||r instanceof Hb.DelayedConstructor}o(Qb,"isConstructorToken");bn.isConstructorToken=Qb});var zf=y(Pc=>{"use strict";Object.defineProperty(Pc,"__esModule",{value:!0});Pc.isTokenProvider=void 0;function Jb(r){return!!r.useToken}o(Jb,"isTokenProvider");Pc.isTokenProvider=Jb});var Kf=y(Fc=>{"use strict";Object.defineProperty(Fc,"__esModule",{value:!0});Fc.isValueProvider=void 0;function Xb(r){return r.useValue!=null}o(Xb,"isValueProvider");Fc.isValueProvider=Xb});var Yf=y(Hi=>{"use strict";Object.defineProperty(Hi,"__esModule",{value:!0});var Zb=Gf();Object.defineProperty(Hi,"isClassProvider",{enumerable:!0,get:o(function(){return Zb.isClassProvider},"get")});var eE=Hf();Object.defineProperty(Hi,"isFactoryProvider",{enumerable:!0,get:o(function(){return eE.isFactoryProvider},"get")});var tE=Cc();Object.defineProperty(Hi,"isNormalToken",{enumerable:!0,get:o(function(){return tE.isNormalToken},"get")});var rE=zf();Object.defineProperty(Hi,"isTokenProvider",{enumerable:!0,get:o(function(){return rE.isTokenProvider},"get")});var nE=Kf();Object.defineProperty(Hi,"isValueProvider",{enumerable:!0,get:o(function(){return nE.isValueProvider},"get")})});var B0=y(Ic=>{"use strict";Object.defineProperty(Ic,"__esModule",{value:!0});Ic.isProvider=void 0;var iE=Gf(),sE=Kf(),aE=zf(),oE=Hf();function cE(r){return iE.isClassProvider(r)||sE.isValueProvider(r)||aE.isTokenProvider(r)||oE.isFactoryProvider(r)}o(cE,"isProvider");Ic.isProvider=cE});var Xf=y(Jf=>{"use strict";Object.defineProperty(Jf,"__esModule",{value:!0});var Qf=class{static{o(this,"RegistryBase")}constructor(){this._registryMap=new Map}entries(){return this._registryMap.entries()}getAll(e){return this.ensure(e),this._registryMap.get(e)}get(e){this.ensure(e);let t=this._registryMap.get(e);return t[t.length-1]||null}set(e,t){this.ensure(e),this._registryMap.get(e).push(t)}setAll(e,t){this._registryMap.set(e,t)}has(e){return this.ensure(e),this._registryMap.get(e).length>0}clear(){this._registryMap.clear()}ensure(e){this._registryMap.has(e)||this._registryMap.set(e,[])}};Jf.default=Qf});var U0=y(eh=>{"use strict";Object.defineProperty(eh,"__esModule",{value:!0});var uE=Xf(),Zf=class extends uE.default{static{o(this,"Registry")}};eh.default=Zf});var $0=y(rh=>{"use strict";Object.defineProperty(rh,"__esModule",{value:!0});var th=class{static{o(this,"ResolutionContext")}constructor(){this.scopedResolutions=new Map}};rh.default=th});var nh=y(Rc=>{"use strict";Object.defineProperty(Rc,"__esModule",{value:!0});Rc.formatErrorCtor=void 0;function lE(r,e){return r===null?`at position #${e}`:`"${r.split(",")[e].trim()}" at position #${e}`}o(lE,"formatDependency");function fE(r,e,t="    "){return[r,...e.message.split(`
`).map(n=>t+n)].join(`
`)}o(fE,"composeErrorMessage");function hE(r,e,t){let[,n=null]=r.toString().match(/constructor\(([\w, ]+)\)/)||[],i=lE(n,e);return fE(`Cannot inject the dependency ${i} of "${r.name}" constructor. Reason:`,t)}o(hE,"formatErrorCtor");Rc.formatErrorCtor=hE});var W0=y(Dc=>{"use strict";Object.defineProperty(Dc,"__esModule",{value:!0});Dc.isDisposable=void 0;function dE(r){return!(typeof r.dispose!="function"||r.dispose.length>0)}o(dE,"isDisposable");Dc.isDisposable=dE});var H0=y(zi=>{"use strict";Object.defineProperty(zi,"__esModule",{value:!0});zi.PostResolutionInterceptors=zi.PreResolutionInterceptors=void 0;var G0=Xf(),Nc=class extends G0.default{static{o(this,"PreResolutionInterceptors")}};zi.PreResolutionInterceptors=Nc;var kc=class extends G0.default{static{o(this,"PostResolutionInterceptors")}};zi.PostResolutionInterceptors=kc;var ih=class{static{o(this,"Interceptors")}constructor(){this.preResolution=new Nc,this.postResolution=new kc}};zi.default=ih});var hi=y(Wn=>{"use strict";Object.defineProperty(Wn,"__esModule",{value:!0});Wn.instance=Wn.typeInfo=void 0;var pE=(Ec(),cf(bc)),Zt=Yf(),mE=B0(),jc=Cc(),gE=U0(),dr=$f(),Mc=$0(),yE=nh(),_E=Oc(),vE=W0(),SE=H0();Wn.typeInfo=new Map;var sh=class r{static{o(this,"InternalDependencyContainer")}constructor(e){this.parent=e,this._registry=new gE.default,this.interceptors=new SE.default,this.disposed=!1,this.disposables=new Set}register(e,t,n={lifecycle:dr.default.Transient}){this.ensureNotDisposed();let i;if(mE.isProvider(t)?i=t:i={useClass:t},Zt.isTokenProvider(i)){let s=[e],a=i;for(;a!=null;){let c=a.useToken;if(s.includes(c))throw new Error(`Token registration cycle detected! ${[...s,c].join(" -> ")}`);s.push(c);let u=this._registry.get(c);u&&Zt.isTokenProvider(u.provider)?a=u.provider:a=null}}if((n.lifecycle===dr.default.Singleton||n.lifecycle==dr.default.ContainerScoped||n.lifecycle==dr.default.ResolutionScoped)&&(Zt.isValueProvider(i)||Zt.isFactoryProvider(i)))throw new Error(`Cannot use lifecycle "${dr.default[n.lifecycle]}" with ValueProviders or FactoryProviders`);return this._registry.set(e,{provider:i,options:n}),this}registerType(e,t){return this.ensureNotDisposed(),Zt.isNormalToken(t)?this.register(e,{useToken:t}):this.register(e,{useClass:t})}registerInstance(e,t){return this.ensureNotDisposed(),this.register(e,{useValue:t})}registerSingleton(e,t){if(this.ensureNotDisposed(),Zt.isNormalToken(e)){if(Zt.isNormalToken(t))return this.register(e,{useToken:t},{lifecycle:dr.default.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:dr.default.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}let n=e;return t&&!Zt.isNormalToken(t)&&(n=t),this.register(e,{useClass:n},{lifecycle:dr.default.Singleton})}resolve(e,t=new Mc.default,n=!1){this.ensureNotDisposed();let i=this.getRegistration(e);if(!i&&Zt.isNormalToken(e)){if(n)return;throw new Error(`Attempted to resolve unregistered dependency token: "${e.toString()}"`)}if(this.executePreResolutionInterceptor(e,"Single"),i){let s=this.resolveRegistration(i,t);return this.executePostResolutionInterceptor(e,s,"Single"),s}if(jc.isConstructorToken(e)){let s=this.construct(e,t);return this.executePostResolutionInterceptor(e,s,"Single"),s}throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")}executePreResolutionInterceptor(e,t){if(this.interceptors.preResolution.has(e)){let n=[];for(let i of this.interceptors.preResolution.getAll(e))i.options.frequency!="Once"&&n.push(i),i.callback(e,t);this.interceptors.preResolution.setAll(e,n)}}executePostResolutionInterceptor(e,t,n){if(this.interceptors.postResolution.has(e)){let i=[];for(let s of this.interceptors.postResolution.getAll(e))s.options.frequency!="Once"&&i.push(s),s.callback(e,t,n);this.interceptors.postResolution.setAll(e,i)}}resolveRegistration(e,t){if(this.ensureNotDisposed(),e.options.lifecycle===dr.default.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);let n=e.options.lifecycle===dr.default.Singleton,i=e.options.lifecycle===dr.default.ContainerScoped,s=n||i,a;return Zt.isValueProvider(e.provider)?a=e.provider.useValue:Zt.isTokenProvider(e.provider)?a=s?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):Zt.isClassProvider(e.provider)?a=s?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):Zt.isFactoryProvider(e.provider)?a=e.provider.useFactory(this):a=this.construct(e.provider,t),e.options.lifecycle===dr.default.ResolutionScoped&&t.scopedResolutions.set(e,a),a}resolveAll(e,t=new Mc.default,n=!1){this.ensureNotDisposed();let i=this.getAllRegistrations(e);if(!i&&Zt.isNormalToken(e)){if(n)return[];throw new Error(`Attempted to resolve unregistered dependency token: "${e.toString()}"`)}if(this.executePreResolutionInterceptor(e,"All"),i){let a=i.map(c=>this.resolveRegistration(c,t));return this.executePostResolutionInterceptor(e,a,"All"),a}let s=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,s,"All"),s}isRegistered(e,t=!1){return this.ensureNotDisposed(),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)}reset(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()}clearInstances(){this.ensureNotDisposed();for(let[e,t]of this._registry.entries())this._registry.setAll(e,t.filter(n=>!Zt.isValueProvider(n.provider)).map(n=>(n.instance=void 0,n)))}createChildContainer(){this.ensureNotDisposed();let e=new r(this);for(let[t,n]of this._registry.entries())n.some(({options:i})=>i.lifecycle===dr.default.ContainerScoped)&&e._registry.setAll(t,n.map(i=>i.options.lifecycle===dr.default.ContainerScoped?{provider:i.provider,options:i.options}:i));return e}beforeResolution(e,t,n={frequency:"Always"}){this.interceptors.preResolution.set(e,{callback:t,options:n})}afterResolution(e,t,n={frequency:"Always"}){this.interceptors.postResolution.set(e,{callback:t,options:n})}dispose(){return pE.__awaiter(this,void 0,void 0,function*(){this.disposed=!0;let e=[];this.disposables.forEach(t=>{let n=t.dispose();n&&e.push(n)}),yield Promise.all(e)})}getRegistration(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null}getAllRegistrations(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null}construct(e,t){if(e instanceof _E.DelayedConstructor)return e.createProxy(i=>this.resolve(i,t));let n=(()=>{let i=Wn.typeInfo.get(e);if(!i||i.length===0){if(e.length===0)return new e;throw new Error(`TypeInfo not known for "${e.name}"`)}let s=i.map(this.resolveParams(t,e));return new e(...s)})();return vE.isDisposable(n)&&this.disposables.add(n),n}resolveParams(e,t){return(n,i)=>{try{return jc.isTokenDescriptor(n)?jc.isTransformDescriptor(n)?n.multiple?this.resolve(n.transform).transform(this.resolveAll(n.token,new Mc.default,n.isOptional),...n.transformArgs):this.resolve(n.transform).transform(this.resolve(n.token,e,n.isOptional),...n.transformArgs):n.multiple?this.resolveAll(n.token,new Mc.default,n.isOptional):this.resolve(n.token,e,n.isOptional):jc.isTransformDescriptor(n)?this.resolve(n.transform,e).transform(this.resolve(n.token,e),...n.transformArgs):this.resolve(n,e)}catch(s){throw new Error(yE.formatErrorCtor(t,i,s))}}}ensureNotDisposed(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")}};Wn.instance=new sh;Wn.default=Wn.instance});var z0=y(oh=>{"use strict";Object.defineProperty(oh,"__esModule",{value:!0});var wE=Gi(),Gn=hi(),ah=Cc(),bE=nh();function EE(){return function(r){let e=wE.getParamInfo(r);return class extends r{constructor(...t){super(...t.concat(e.slice(t.length).map((n,i)=>{try{return ah.isTokenDescriptor(n)?ah.isTransformDescriptor(n)?n.multiple?Gn.instance.resolve(n.transform).transform(Gn.instance.resolveAll(n.token),...n.transformArgs):Gn.instance.resolve(n.transform).transform(Gn.instance.resolve(n.token),...n.transformArgs):n.multiple?Gn.instance.resolveAll(n.token):Gn.instance.resolve(n.token):ah.isTransformDescriptor(n)?Gn.instance.resolve(n.transform).transform(Gn.instance.resolve(n.token),...n.transformArgs):Gn.instance.resolve(n)}catch(s){let a=i+t.length;throw new Error(bE.formatErrorCtor(r,a,s))}})))}}}}o(EE,"autoInjectable");oh.default=EE});var K0=y(ch=>{"use strict";Object.defineProperty(ch,"__esModule",{value:!0});var TE=Gi();function AE(r,e){let t={token:r,multiple:!1,isOptional:e&&e.isOptional};return TE.defineInjectionTokenMetadata(t)}o(AE,"inject");ch.default=AE});var Lc=y(uh=>{"use strict";Object.defineProperty(uh,"__esModule",{value:!0});var xE=Gi(),OE=hi(),Y0=hi();function CE(r){return function(e){OE.typeInfo.set(e,xE.getParamInfo(e)),r&&r.token&&(Array.isArray(r.token)?r.token.forEach(t=>{Y0.instance.register(t,e)}):Y0.instance.register(r.token,e))}}o(CE,"injectable");uh.default=CE});var Q0=y(lh=>{"use strict";Object.defineProperty(lh,"__esModule",{value:!0});var PE=(Ec(),cf(bc)),FE=hi();function IE(r=[]){return function(e){return r.forEach(t=>{var{token:n,options:i}=t,s=PE.__rest(t,["token","options"]);return FE.instance.register(n,s,i)}),e}}o(IE,"registry");lh.default=IE});var J0=y(fh=>{"use strict";Object.defineProperty(fh,"__esModule",{value:!0});var RE=Lc(),DE=hi();function NE(){return function(r){RE.default()(r),DE.instance.registerSingleton(r)}}o(NE,"singleton");fh.default=NE});var X0=y(hh=>{"use strict";Object.defineProperty(hh,"__esModule",{value:!0});var kE=Gi();function jE(r,e){let t={token:r,multiple:!0,isOptional:e&&e.isOptional};return kE.defineInjectionTokenMetadata(t)}o(jE,"injectAll");hh.default=jE});var Z0=y(dh=>{"use strict";Object.defineProperty(dh,"__esModule",{value:!0});var ME=Gi();function LE(r,e,...t){let n={token:r,multiple:!0,transform:e,transformArgs:t};return ME.defineInjectionTokenMetadata(n)}o(LE,"injectAllWithTransform");dh.default=LE});var e2=y(ph=>{"use strict";Object.defineProperty(ph,"__esModule",{value:!0});var VE=Gi();function qE(r,e,...t){return VE.defineInjectionTokenMetadata(r,{transformToken:e,args:t})}o(qE,"injectWithTransform");ph.default=qE});var t2=y(mh=>{"use strict";Object.defineProperty(mh,"__esModule",{value:!0});var BE=Lc(),UE=hi();function $E(r,e){return function(t){BE.default()(t),UE.instance.register(e||t,t,{lifecycle:r})}}o($E,"scoped");mh.default=$E});var r2=y(Vr=>{"use strict";Object.defineProperty(Vr,"__esModule",{value:!0});var WE=z0();Object.defineProperty(Vr,"autoInjectable",{enumerable:!0,get:o(function(){return WE.default},"get")});var GE=K0();Object.defineProperty(Vr,"inject",{enumerable:!0,get:o(function(){return GE.default},"get")});var HE=Lc();Object.defineProperty(Vr,"injectable",{enumerable:!0,get:o(function(){return HE.default},"get")});var zE=Q0();Object.defineProperty(Vr,"registry",{enumerable:!0,get:o(function(){return zE.default},"get")});var KE=J0();Object.defineProperty(Vr,"singleton",{enumerable:!0,get:o(function(){return KE.default},"get")});var YE=X0();Object.defineProperty(Vr,"injectAll",{enumerable:!0,get:o(function(){return YE.default},"get")});var QE=Z0();Object.defineProperty(Vr,"injectAllWithTransform",{enumerable:!0,get:o(function(){return QE.default},"get")});var JE=e2();Object.defineProperty(Vr,"injectWithTransform",{enumerable:!0,get:o(function(){return JE.default},"get")});var XE=t2();Object.defineProperty(Vr,"scoped",{enumerable:!0,get:o(function(){return XE.default},"get")})});var n2=y(gh=>{"use strict";Object.defineProperty(gh,"__esModule",{value:!0});function ZE(r){let e;return t=>(e==null&&(e=r(t)),e)}o(ZE,"instanceCachingFactory");gh.default=ZE});var i2=y(yh=>{"use strict";Object.defineProperty(yh,"__esModule",{value:!0});function eT(r){let e=new WeakMap;return t=>{let n=e.get(t);return n==null&&(n=r(t),e.set(t,n)),n}}o(eT,"instancePerContainerCachingFactory");yh.default=eT});var s2=y(_h=>{"use strict";Object.defineProperty(_h,"__esModule",{value:!0});function tT(r,e,t,n=!0){let i,s;return a=>{let c=r(a);return(!n||s!==c)&&((s=c)?i=a.resolve(e):i=a.resolve(t)),i}}o(tT,"predicateAwareClassFactory");_h.default=tT});var a2=y(ka=>{"use strict";Object.defineProperty(ka,"__esModule",{value:!0});var rT=n2();Object.defineProperty(ka,"instanceCachingFactory",{enumerable:!0,get:o(function(){return rT.default},"get")});var nT=i2();Object.defineProperty(ka,"instancePerContainerCachingFactory",{enumerable:!0,get:o(function(){return nT.default},"get")});var iT=s2();Object.defineProperty(ka,"predicateAwareClassFactory",{enumerable:!0,get:o(function(){return iT.default},"get")})});var Ye=y(di=>{"use strict";Object.defineProperty(di,"__esModule",{value:!0});var vh=(Ec(),cf(bc));if(typeof Reflect>"u"||!Reflect.getMetadata)throw new Error(`tsyringe requires a reflect polyfill. Please add 'import "reflect-metadata"' to the top of your entry point.`);var sT=q0();Object.defineProperty(di,"Lifecycle",{enumerable:!0,get:o(function(){return sT.Lifecycle},"get")});vh.__exportStar(r2(),di);vh.__exportStar(a2(),di);vh.__exportStar(Yf(),di);var aT=Oc();Object.defineProperty(di,"delay",{enumerable:!0,get:o(function(){return aT.delay},"get")});var oT=hi();Object.defineProperty(di,"container",{enumerable:!0,get:o(function(){return oT.instance},"get")})});var o2=y(Sh=>{"use strict";Object.defineProperty(Sh,"__esModule",{value:!0});Sh.default="ffffffff-ffff-ffff-ffff-ffffffffffff"});var c2=y(wh=>{"use strict";Object.defineProperty(wh,"__esModule",{value:!0});wh.default="00000000-0000-0000-0000-000000000000"});var u2=y(bh=>{"use strict";Object.defineProperty(bh,"__esModule",{value:!0});bh.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i});var ja=y(Eh=>{"use strict";Object.defineProperty(Eh,"__esModule",{value:!0});var cT=u2();function uT(r){return typeof r=="string"&&cT.default.test(r)}o(uT,"validate");Eh.default=uT});var Ma=y(Th=>{"use strict";Object.defineProperty(Th,"__esModule",{value:!0});var lT=ja();function fT(r){if(!(0,lT.default)(r))throw TypeError("Invalid UUID");let e;return Uint8Array.of((e=parseInt(r.slice(0,8),16))>>>24,e>>>16&255,e>>>8&255,e&255,(e=parseInt(r.slice(9,13),16))>>>8,e&255,(e=parseInt(r.slice(14,18),16))>>>8,e&255,(e=parseInt(r.slice(19,23),16))>>>8,e&255,(e=parseInt(r.slice(24,36),16))/1099511627776&255,e/4294967296&255,e>>>24&255,e>>>16&255,e>>>8&255,e&255)}o(fT,"parse");Th.default=fT});var Hn=y(La=>{"use strict";Object.defineProperty(La,"__esModule",{value:!0});La.unsafeStringify=void 0;var hT=ja(),Ft=[];for(let r=0;r<256;++r)Ft.push((r+256).toString(16).slice(1));function l2(r,e=0){return(Ft[r[e+0]]+Ft[r[e+1]]+Ft[r[e+2]]+Ft[r[e+3]]+"-"+Ft[r[e+4]]+Ft[r[e+5]]+"-"+Ft[r[e+6]]+Ft[r[e+7]]+"-"+Ft[r[e+8]]+Ft[r[e+9]]+"-"+Ft[r[e+10]]+Ft[r[e+11]]+Ft[r[e+12]]+Ft[r[e+13]]+Ft[r[e+14]]+Ft[r[e+15]]).toLowerCase()}o(l2,"unsafeStringify");La.unsafeStringify=l2;function dT(r,e=0){let t=l2(r,e);if(!(0,hT.default)(t))throw TypeError("Stringified UUID is invalid");return t}o(dT,"stringify");La.default=dT});var Bc=y(Ah=>{"use strict";Object.defineProperty(Ah,"__esModule",{value:!0});var pT=require("crypto"),qc=new Uint8Array(256),Vc=qc.length;function mT(){return Vc>qc.length-16&&((0,pT.randomFillSync)(qc),Vc=0),qc.slice(Vc,Vc+=16)}o(mT,"rng");Ah.default=mT});var xh=y(qa=>{"use strict";Object.defineProperty(qa,"__esModule",{value:!0});qa.updateV1State=void 0;var f2=Bc(),gT=Hn(),Va={};function yT(r,e,t){let n,i=r?._v6??!1;if(r){let s=Object.keys(r);s.length===1&&s[0]==="_v6"&&(r=void 0)}if(r)n=h2(r.random??r.rng?.()??(0,f2.default)(),r.msecs,r.nsecs,r.clockseq,r.node,e,t);else{let s=Date.now(),a=(0,f2.default)();d2(Va,s,a),n=h2(a,Va.msecs,Va.nsecs,i?void 0:Va.clockseq,i?void 0:Va.node,e,t)}return e??(0,gT.unsafeStringify)(n)}o(yT,"v1");function d2(r,e,t){return r.msecs??=-1/0,r.nsecs??=0,e===r.msecs?(r.nsecs++,r.nsecs>=1e4&&(r.node=void 0,r.nsecs=0)):e>r.msecs?r.nsecs=0:e<r.msecs&&(r.node=void 0),r.node||(r.node=t.slice(10,16),r.node[0]|=1,r.clockseq=(t[8]<<8|t[9])&16383),r.msecs=e,r}o(d2,"updateV1State");qa.updateV1State=d2;function h2(r,e,t,n,i,s,a=0){if(r.length<16)throw new Error("Random bytes length must be >= 16");if(!s)s=new Uint8Array(16),a=0;else if(a<0||a+16>s.length)throw new RangeError(`UUID byte range ${a}:${a+15} is out of buffer bounds`);e??=Date.now(),t??=0,n??=(r[8]<<8|r[9])&16383,i??=r.slice(10,16),e+=122192928e5;let c=((e&268435455)*1e4+t)%4294967296;s[a++]=c>>>24&255,s[a++]=c>>>16&255,s[a++]=c>>>8&255,s[a++]=c&255;let u=e/4294967296*1e4&268435455;s[a++]=u>>>8&255,s[a++]=u&255,s[a++]=u>>>24&15|16,s[a++]=u>>>16&255,s[a++]=n>>>8|128,s[a++]=n&255;for(let f=0;f<6;++f)s[a++]=i[f];return s}o(h2,"v1Bytes");qa.default=yT});var Ch=y(Oh=>{"use strict";Object.defineProperty(Oh,"__esModule",{value:!0});var _T=Ma(),vT=Hn();function ST(r){let e=typeof r=="string"?(0,_T.default)(r):r,t=wT(e);return typeof r=="string"?(0,vT.unsafeStringify)(t):t}o(ST,"v1ToV6");Oh.default=ST;function wT(r){return Uint8Array.of((r[6]&15)<<4|r[7]>>4&15,(r[7]&15)<<4|(r[4]&240)>>4,(r[4]&15)<<4|(r[5]&240)>>4,(r[5]&15)<<4|(r[0]&240)>>4,(r[0]&15)<<4|(r[1]&240)>>4,(r[1]&15)<<4|(r[2]&240)>>4,96|r[2]&15,r[3],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15])}o(wT,"_v1ToV6")});var p2=y(Ph=>{"use strict";Object.defineProperty(Ph,"__esModule",{value:!0});var bT=require("crypto");function ET(r){return Array.isArray(r)?r=Buffer.from(r):typeof r=="string"&&(r=Buffer.from(r,"utf8")),(0,bT.createHash)("md5").update(r).digest()}o(ET,"md5");Ph.default=ET});var Ba=y(zn=>{"use strict";Object.defineProperty(zn,"__esModule",{value:!0});zn.URL=zn.DNS=zn.stringToBytes=void 0;var m2=Ma(),TT=Hn();function g2(r){r=unescape(encodeURIComponent(r));let e=new Uint8Array(r.length);for(let t=0;t<r.length;++t)e[t]=r.charCodeAt(t);return e}o(g2,"stringToBytes");zn.stringToBytes=g2;zn.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8";zn.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function AT(r,e,t,n,i,s){let a=typeof t=="string"?g2(t):t,c=typeof n=="string"?(0,m2.default)(n):n;if(typeof n=="string"&&(n=(0,m2.default)(n)),n?.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+a.length);if(u.set(c),u.set(a,c.length),u=e(u),u[6]=u[6]&15|r,u[8]=u[8]&63|128,i){s=s||0;for(let f=0;f<16;++f)i[s+f]=u[f];return i}return(0,TT.unsafeStringify)(u)}o(AT,"v35");zn.default=AT});var _2=y(Ki=>{"use strict";Object.defineProperty(Ki,"__esModule",{value:!0});Ki.URL=Ki.DNS=void 0;var xT=p2(),Fh=Ba(),y2=Ba();Object.defineProperty(Ki,"DNS",{enumerable:!0,get:o(function(){return y2.DNS},"get")});Object.defineProperty(Ki,"URL",{enumerable:!0,get:o(function(){return y2.URL},"get")});function Ih(r,e,t,n){return(0,Fh.default)(48,xT.default,r,e,t,n)}o(Ih,"v3");Ih.DNS=Fh.DNS;Ih.URL=Fh.URL;Ki.default=Ih});var v2=y(Rh=>{"use strict";Object.defineProperty(Rh,"__esModule",{value:!0});var OT=require("crypto");Rh.default={randomUUID:OT.randomUUID}});var w2=y(Dh=>{"use strict";Object.defineProperty(Dh,"__esModule",{value:!0});var S2=v2(),CT=Bc(),PT=Hn();function FT(r,e,t){if(S2.default.randomUUID&&!e&&!r)return S2.default.randomUUID();r=r||{};let n=r.random??r.rng?.()??(0,CT.default)();if(n.length<16)throw new Error("Random bytes length must be >= 16");if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){if(t=t||0,t<0||t+16>e.length)throw new RangeError(`UUID byte range ${t}:${t+15} is out of buffer bounds`);for(let i=0;i<16;++i)e[t+i]=n[i];return e}return(0,PT.unsafeStringify)(n)}o(FT,"v4");Dh.default=FT});var b2=y(Nh=>{"use strict";Object.defineProperty(Nh,"__esModule",{value:!0});var IT=require("crypto");function RT(r){return Array.isArray(r)?r=Buffer.from(r):typeof r=="string"&&(r=Buffer.from(r,"utf8")),(0,IT.createHash)("sha1").update(r).digest()}o(RT,"sha1");Nh.default=RT});var T2=y(Yi=>{"use strict";Object.defineProperty(Yi,"__esModule",{value:!0});Yi.URL=Yi.DNS=void 0;var DT=b2(),kh=Ba(),E2=Ba();Object.defineProperty(Yi,"DNS",{enumerable:!0,get:o(function(){return E2.DNS},"get")});Object.defineProperty(Yi,"URL",{enumerable:!0,get:o(function(){return E2.URL},"get")});function jh(r,e,t,n){return(0,kh.default)(80,DT.default,r,e,t,n)}o(jh,"v5");jh.DNS=kh.DNS;jh.URL=kh.URL;Yi.default=jh});var A2=y(Mh=>{"use strict";Object.defineProperty(Mh,"__esModule",{value:!0});var NT=Hn(),kT=xh(),jT=Ch();function MT(r,e,t){r??={},t??=0;let n=(0,kT.default)({...r,_v6:!0},new Uint8Array(16));if(n=(0,jT.default)(n),e){for(let i=0;i<16;i++)e[t+i]=n[i];return e}return(0,NT.unsafeStringify)(n)}o(MT,"v6");Mh.default=MT});var x2=y(Lh=>{"use strict";Object.defineProperty(Lh,"__esModule",{value:!0});var LT=Ma(),VT=Hn();function qT(r){let e=typeof r=="string"?(0,LT.default)(r):r,t=BT(e);return typeof r=="string"?(0,VT.unsafeStringify)(t):t}o(qT,"v6ToV1");Lh.default=qT;function BT(r){return Uint8Array.of((r[3]&15)<<4|r[4]>>4&15,(r[4]&15)<<4|(r[5]&240)>>4,(r[5]&15)<<4|r[6]&15,r[7],(r[1]&15)<<4|(r[2]&240)>>4,(r[2]&15)<<4|(r[3]&240)>>4,16|(r[0]&240)>>4,(r[0]&15)<<4|(r[1]&240)>>4,r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15])}o(BT,"_v6ToV1")});var F2=y(Ua=>{"use strict";Object.defineProperty(Ua,"__esModule",{value:!0});Ua.updateV7State=void 0;var O2=Bc(),UT=Hn(),Vh={};function $T(r,e,t){let n;if(r)n=C2(r.random??r.rng?.()??(0,O2.default)(),r.msecs,r.seq,e,t);else{let i=Date.now(),s=(0,O2.default)();P2(Vh,i,s),n=C2(s,Vh.msecs,Vh.seq,e,t)}return e??(0,UT.unsafeStringify)(n)}o($T,"v7");function P2(r,e,t){return r.msecs??=-1/0,r.seq??=0,e>r.msecs?(r.seq=t[6]<<23|t[7]<<16|t[8]<<8|t[9],r.msecs=e):(r.seq=r.seq+1|0,r.seq===0&&r.msecs++),r}o(P2,"updateV7State");Ua.updateV7State=P2;function C2(r,e,t,n,i=0){if(r.length<16)throw new Error("Random bytes length must be >= 16");if(!n)n=new Uint8Array(16),i=0;else if(i<0||i+16>n.length)throw new RangeError(`UUID byte range ${i}:${i+15} is out of buffer bounds`);return e??=Date.now(),t??=r[6]*127<<24|r[7]<<16|r[8]<<8|r[9],n[i++]=e/1099511627776&255,n[i++]=e/4294967296&255,n[i++]=e/16777216&255,n[i++]=e/65536&255,n[i++]=e/256&255,n[i++]=e&255,n[i++]=112|t>>>28&15,n[i++]=t>>>20&255,n[i++]=128|t>>>14&63,n[i++]=t>>>6&255,n[i++]=t<<2&255|r[10]&3,n[i++]=r[11],n[i++]=r[12],n[i++]=r[13],n[i++]=r[14],n[i++]=r[15],n}o(C2,"v7Bytes");Ua.default=$T});var I2=y(qh=>{"use strict";Object.defineProperty(qh,"__esModule",{value:!0});var WT=ja();function GT(r){if(!(0,WT.default)(r))throw TypeError("Invalid UUID");return parseInt(r.slice(14,15),16)}o(GT,"version");qh.default=GT});var qr=y(Ue=>{"use strict";Object.defineProperty(Ue,"__esModule",{value:!0});Ue.version=Ue.validate=Ue.v7=Ue.v6ToV1=Ue.v6=Ue.v5=Ue.v4=Ue.v3=Ue.v1ToV6=Ue.v1=Ue.stringify=Ue.parse=Ue.NIL=Ue.MAX=void 0;var HT=o2();Object.defineProperty(Ue,"MAX",{enumerable:!0,get:o(function(){return HT.default},"get")});var zT=c2();Object.defineProperty(Ue,"NIL",{enumerable:!0,get:o(function(){return zT.default},"get")});var KT=Ma();Object.defineProperty(Ue,"parse",{enumerable:!0,get:o(function(){return KT.default},"get")});var YT=Hn();Object.defineProperty(Ue,"stringify",{enumerable:!0,get:o(function(){return YT.default},"get")});var QT=xh();Object.defineProperty(Ue,"v1",{enumerable:!0,get:o(function(){return QT.default},"get")});var JT=Ch();Object.defineProperty(Ue,"v1ToV6",{enumerable:!0,get:o(function(){return JT.default},"get")});var XT=_2();Object.defineProperty(Ue,"v3",{enumerable:!0,get:o(function(){return XT.default},"get")});var ZT=w2();Object.defineProperty(Ue,"v4",{enumerable:!0,get:o(function(){return ZT.default},"get")});var e4=T2();Object.defineProperty(Ue,"v5",{enumerable:!0,get:o(function(){return e4.default},"get")});var t4=A2();Object.defineProperty(Ue,"v6",{enumerable:!0,get:o(function(){return t4.default},"get")});var r4=x2();Object.defineProperty(Ue,"v6ToV1",{enumerable:!0,get:o(function(){return r4.default},"get")});var n4=F2();Object.defineProperty(Ue,"v7",{enumerable:!0,get:o(function(){return n4.default},"get")});var i4=ja();Object.defineProperty(Ue,"validate",{enumerable:!0,get:o(function(){return i4.default},"get")});var s4=I2();Object.defineProperty(Ue,"version",{enumerable:!0,get:o(function(){return s4.default},"get")})});var Br=y(Uc=>{"use strict";Object.defineProperty(Uc,"__esModule",{value:!0});Uc.MetadataHelpers=void 0;var Bh=class{static{o(this,"MetadataHelpers")}static findAllReferencingProperties(e,t){let n=[];for(let[i,s]of Object.entries(e))this.containsReference(s,t)&&n.push(i);return n}static findReferencingProperty(e,t){for(let[n,i]of Object.entries(e))if(this.containsReference(i,t))return n}static containsReference(e,t){if(!e)return!1;let n=t.replace(/\.md$/,"");if(typeof e=="string"){let i=/\[\[([^\]]+)\]\]/g,s;for(;(s=i.exec(e))!==null;){let c=s[1].split("|")[0].trim();if(c===n||c.endsWith(`/${n}`))return!0}return!1}return Array.isArray(e)?e.some(i=>this.containsReference(i,t)):!1}static isAssetArchived(e){let t=e?.exo__Asset_isArchived;if(t!=null){if(t===!0||t===1)return!0;if(typeof t=="string"){let i=t.toLowerCase().trim();if(i==="true"||i==="yes"||i==="1")return!0}if(typeof t=="boolean")return t}let n=e?.archived;if(n==null)return!1;if(typeof n=="boolean")return n;if(typeof n=="number")return n!==0;if(typeof n=="string"){let i=n.toLowerCase().trim();return i==="true"||i==="yes"||i==="1"}return!1}static getPropertyValue(e,t){return t==="Name"||t==="title"?e.title:t==="created"?e.created:t==="modified"?e.modified:t==="path"?e.path:e.metadata?.[t]}static ensureQuoted(e){return!e||e==='""'?'""':e.startsWith('"')&&e.endsWith('"')?e:`"${e}"`}static buildFileContent(e,t){let n=Object.entries(e).map(([s,a])=>{if(Array.isArray(a)){let c=a.map(u=>`  - ${u}`).join(`
`);return`${s}:
${c}`}return`${s}: ${a}`}).join(`
`),i=t?`
${t}
`:`
`;return`---
${n}
---
${i}`}};Uc.MetadataHelpers=Bh});var pr=y($c=>{"use strict";Object.defineProperty($c,"__esModule",{value:!0});$c.DateFormatter=void 0;var Uh=class r{static{o(this,"DateFormatter")}static toISOTimestamp(e){return e.toISOString().replace(/\.\d{3}Z$/,"Z")}static toLocalTimestamp(e){let t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0"),s=String(e.getHours()).padStart(2,"0"),a=String(e.getMinutes()).padStart(2,"0"),c=String(e.getSeconds()).padStart(2,"0");return`${t}-${n}-${i}T${s}:${a}:${c}`}static toDateWikilink(e){let t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`"[[${t}-${n}-${i}]]"`}static getTodayWikilink(){return r.toDateWikilink(new Date)}static toDateString(e){let t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${t}-${n}-${i}`}static parseWikilink(e){let n=e.replace(/^["']|["']$/g,"").match(/\[\[(\d{4}-\d{2}-\d{2})\]\]/);return n?n[1]:null}static addDays(e,t){let n=new Date(e);return n.setDate(n.getDate()+t),n}static isSameDay(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}static getTodayStartTimestamp(){let e=new Date;return e.setHours(0,0,0,0),r.toLocalTimestamp(e)}static toTimestampAtStartOfDay(e){let t=e.split("-").map(Number);if(t.length!==3||t.some(isNaN))throw new Error(`Invalid date format: ${e}. Expected YYYY-MM-DD`);let[n,i,s]=t,a=new Date(n,i-1,s,0,0,0,0);if(isNaN(a.getTime()))throw new Error(`Invalid date values: ${e}`);return r.toLocalTimestamp(a)}static normalizeTimestamp(e){if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$/.test(e))return e;let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`Invalid timestamp format: ${e}`);return r.toISOTimestamp(t)}static isISOTimestamp(e){return/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$/.test(e)}};$c.DateFormatter=Uh});var $a=y(Wc=>{"use strict";Object.defineProperty(Wc,"__esModule",{value:!0});Wc.MetadataExtractor=void 0;var a4=Br(),$h=class{static{o(this,"MetadataExtractor")}constructor(e){this.vault=e}extractMetadata(e){return e?this.vault.getFrontmatter(e)||{}:{}}extractInstanceClass(e){return e.exo__Instance_class||null}extractStatus(e){return e.ems__Effort_status||null}extractIsArchived(e){return a4.MetadataHelpers.isAssetArchived(e)}static extractIsDefinedBy(e){let t=e.exo__Asset_isDefinedBy||'""';return Array.isArray(t)&&(t=t[0]||'""'),t}extractExpectedFolder(e){let t=e.exo__Asset_isDefinedBy;if(!t)return null;let n=Array.isArray(t)?t[0]:t;if(!n||typeof n!="string")return null;let i=n.replace(/["'[\]]/g,"").trim();if(!i)return null;let s=i.split("/");return s.pop(),s.join("/")}extractCommandVisibilityContext(e){let t=this.extractMetadata(e),n=this.extractInstanceClass(t),i=this.extractStatus(t),s=this.extractIsArchived(t),a=e.parent?.path||"",c=this.extractExpectedFolder(t);return{instanceClass:n,currentStatus:i,metadata:t,isArchived:s,currentFolder:a,expectedFolder:c}}extractCache(e){return e?this.vault.getFrontmatter(e):null}};Wc.MetadataExtractor=$h});var Gc=y(Qi=>{"use strict";var o4=Qi&&Qi.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s};Object.defineProperty(Qi,"__esModule",{value:!0});Qi.TaskFrontmatterGenerator=void 0;var c4=Ye(),R2=qr(),Wh=pr(),u4=Bi(),D2=$a(),N2=Br(),ct=Vt(),l4=ci(),f4={[ct.AssetClass.AREA]:"ems__Effort_area",[ct.AssetClass.PROJECT]:"ems__Effort_parent",[ct.AssetClass.TASK_PROTOTYPE]:"exo__Asset_prototype",[ct.AssetClass.MEETING_PROTOTYPE]:"exo__Asset_prototype",[ct.AssetClass.EVENT_PROTOTYPE]:"exo__Asset_prototype",[ct.AssetClass.PROJECT_PROTOTYPE]:"exo__Asset_prototype"},h4={[ct.AssetClass.AREA]:ct.AssetClass.TASK,[ct.AssetClass.PROJECT]:ct.AssetClass.TASK,[ct.AssetClass.TASK_PROTOTYPE]:ct.AssetClass.TASK,[ct.AssetClass.MEETING_PROTOTYPE]:ct.AssetClass.MEETING,[ct.AssetClass.EVENT_PROTOTYPE]:ct.AssetClass.EVENT,[ct.AssetClass.PROJECT_PROTOTYPE]:ct.AssetClass.PROJECT},Gh=class{static{o(this,"TaskFrontmatterGenerator")}generateTaskFrontmatter(e,t,n,i,s,a,c){let u=new Date,f=Wh.DateFormatter.toLocalTimestamp(u),l=D2.MetadataExtractor.extractIsDefinedBy(e),h=u4.WikiLinkHelpers.normalize(n),p=f4[h],g=h4[h]||ct.AssetClass.TASK,w={};w.exo__Asset_isDefinedBy=N2.MetadataHelpers.ensureQuoted(l),w.exo__Asset_uid=s||(0,R2.v4)(),w.exo__Asset_createdAt=f,w.exo__Instance_class=[`"[[${g}]]"`],w.ems__Effort_status='"[[ems__EffortStatusDraft]]"',p?w[p]=`"[[${t}]]"`:(0,l4.isPrototypeClass)(n,e)&&(w.exo__Asset_prototype=`"[[${t}]]"`);let S=i;if(g===ct.AssetClass.MEETING&&(!i||i.trim()==="")){let x=e.exo__Asset_label||t,P=Wh.DateFormatter.toDateString(u);S=`${x} ${P}`}if(S&&S.trim()!==""){let x=S.trim();w.exo__Asset_label=x,w.aliases=[x]}return a&&(w.ems__Task_size=a),c&&(w.ems__Effort_plannedStartTimestamp=c),w}generateRelatedTaskFrontmatter(e,t,n,i,s){let a=new Date,c=Wh.DateFormatter.toLocalTimestamp(a),u=D2.MetadataExtractor.extractIsDefinedBy(e),f={};if(f.exo__Asset_isDefinedBy=N2.MetadataHelpers.ensureQuoted(u),f.exo__Asset_uid=i||(0,R2.v4)(),f.exo__Asset_createdAt=c,f.exo__Instance_class=[`"[[${ct.AssetClass.TASK}]]"`],f.ems__Effort_status='"[[ems__EffortStatusDraft]]"',f.exo__Asset_relates=[`"[[${t}]]"`],n&&n.trim()!==""){let l=n.trim();f.exo__Asset_label=l,f.aliases=[l]}return s&&(f.ems__Task_size=s),f}};Qi.TaskFrontmatterGenerator=Gh;Qi.TaskFrontmatterGenerator=Gh=o4([(0,c4.injectable)()],Gh)});var Hc=y(Ji=>{"use strict";var d4=Ji&&Ji.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s};Object.defineProperty(Ji,"__esModule",{value:!0});Ji.AlgorithmExtractor=void 0;var p4=Ye(),Hh=class{static{o(this,"AlgorithmExtractor")}extractH2Section(e,t){let n=e.split(`
`),i=`## ${t}`,s=!1,a=[];for(let u of n){if(u.trim()===i){s=!0;continue}if(s){if(u.startsWith("## ")||u.startsWith("# "))break;a.push(u)}}return a.length===0?null:a.join(`
`).trim()||null}};Ji.AlgorithmExtractor=Hh;Ji.AlgorithmExtractor=Hh=d4([(0,p4.injectable)()],Hh)});var j2=y(k2=>{"use strict";Object.defineProperty(k2,"__esModule",{value:!0})});var rt=y(zc=>{"use strict";Object.defineProperty(zc,"__esModule",{value:!0});zc.DI_TOKENS=void 0;zc.DI_TOKENS={IFileSystemAdapter:Symbol.for("IFileSystemAdapter"),IVaultAdapter:Symbol.for("IVaultAdapter"),IVaultContext:Symbol.for("IVaultContext"),IMultiVaultManager:Symbol.for("IMultiVaultManager"),ILogger:Symbol.for("ILogger"),IEventBus:Symbol.for("IEventBus"),IConfiguration:Symbol.for("IConfiguration"),INotificationService:Symbol.for("INotificationService"),TaskCreationService:Symbol.for("TaskCreationService"),ProjectCreationService:Symbol.for("ProjectCreationService"),AreaCreationService:Symbol.for("AreaCreationService"),ClassCreationService:Symbol.for("ClassCreationService"),ConceptCreationService:Symbol.for("ConceptCreationService"),FleetingNoteCreationService:Symbol.for("FleetingNoteCreationService"),SupervisionCreationService:Symbol.for("SupervisionCreationService"),TaskFrontmatterGenerator:Symbol.for("TaskFrontmatterGenerator"),DynamicFrontmatterGenerator:Symbol.for("DynamicFrontmatterGenerator"),AlgorithmExtractor:Symbol.for("AlgorithmExtractor"),TaskStatusService:Symbol.for("TaskStatusService"),EffortStatusWorkflow:Symbol.for("EffortStatusWorkflow"),StatusTimestampService:Symbol.for("StatusTimestampService"),PropertyCleanupService:Symbol.for("PropertyCleanupService"),FolderRepairService:Symbol.for("FolderRepairService"),LabelToAliasService:Symbol.for("LabelToAliasService"),RenameToUidService:Symbol.for("RenameToUidService"),PlanningService:Symbol.for("PlanningService"),EffortVotingService:Symbol.for("EffortVotingService"),SessionEventService:Symbol.for("SessionEventService"),AssetConversionService:Symbol.for("AssetConversionService"),NoteToRDFConverter:Symbol.for("NoteToRDFConverter"),AreaHierarchyBuilder:Symbol.for("AreaHierarchyBuilder"),URIConstructionService:Symbol.for("URIConstructionService")}});var Kh=y(It=>{"use strict";var m4=It&&It.__createBinding||(Object.create?(function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:o(function(){return e[t]},"get")}),Object.defineProperty(r,n,i)}):(function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]})),g4=It&&It.__setModuleDefault||(Object.create?(function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}):function(r,e){r.default=e}),y4=It&&It.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},_4=It&&It.__importStar||(function(){var r=o(function(e){return r=Object.getOwnPropertyNames||function(t){var n=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[n.length]=i);return n},r(e)},"ownKeys");return function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n=r(e),i=0;i<n.length;i++)n[i]!=="default"&&m4(t,e,n[i]);return g4(t,e),t}})(),v4=It&&It.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},S4=It&&It.__param||function(r,e){return function(t,n){e(t,n,r)}};Object.defineProperty(It,"__esModule",{value:!0});It.TaskCreationService=void 0;var M2=Ye(),L2=qr(),w4=Bi(),V2=Br(),b4=Vt(),E4=Gc(),T4=Hc(),QD=_4(j2()),A4=rt(),zh=class{static{o(this,"TaskCreationService")}constructor(e,t,n){this.vault=e,this.frontmatterGenerator=t,this.algorithmExtractor=n}async createTask(e,t,n,i,s,a){let c=(0,L2.v4)(),u=`${c}.md`,f=this.frontmatterGenerator.generateTaskFrontmatter(t,e.basename,n,i,c,s,a),l="";if(w4.WikiLinkHelpers.normalize(n)===b4.AssetClass.TASK_PROTOTYPE){let x=await this.vault.read(e),P=this.algorithmExtractor.extractH2Section(x,"Algorithm");P&&(l=`## Algorithm

${P}`)}let p=V2.MetadataHelpers.buildFileContent(f,l),g=e.parent?.path||"",w=g?`${g}/${u}`:u;return await this.vault.create(w,p)}async createRelatedTask(e,t,n,i){let s=(0,L2.v4)(),a=`${s}.md`,c=this.frontmatterGenerator.generateRelatedTaskFrontmatter(t,e.basename,n,s,i),u=V2.MetadataHelpers.buildFileContent(c),f=e.parent?.path||"",l=f?`${f}/${a}`:a,h=await this.vault.create(l,u);return await this.addRelationToSourceFile(e,s),h}generateTaskFrontmatter(e,t,n,i,s,a,c){return this.frontmatterGenerator.generateTaskFrontmatter(e,t,n,i,s,a,c)}generateRelatedTaskFrontmatter(e,t,n,i,s){return this.frontmatterGenerator.generateRelatedTaskFrontmatter(e,t,n,i,s)}extractH2Section(e,t){return this.algorithmExtractor.extractH2Section(e,t)}async addRelationToSourceFile(e,t){let n=await this.vault.read(e),i=this.addRelationToFrontmatter(n,t);await this.vault.modify(e,i)}addRelationToFrontmatter(e,t){let n=/^---\r?\n([\s\S]*?)\r?\n---/,i=e.match(n),s=e.includes(`\r
`)?`\r
`:`
`;if(!i)return`---${s}exo__Asset_relates:${s}  - "[[${t}]]"${s}---${s}${e}`;let c=i[1];if(c.includes("exo__Asset_relates:")){let u=c.match(/exo__Asset_relates:\r?\n((?: {2}- .*\r?\n)*)/);if(u){let f=u[1],l=`  - "[[${t}]]"${s}`;c=c.replace(/exo__Asset_relates:\r?\n((?: {2}- .*\r?\n)*)/,`exo__Asset_relates:${s}${f}${l}`)}}else c+=`${s}exo__Asset_relates:${s}  - "[[${t}]]"`;return e.replace(n,`---${s}${c}${s}---`)}};It.TaskCreationService=zh;It.TaskCreationService=zh=y4([(0,M2.injectable)(),S4(0,(0,M2.inject)(A4.DI_TOKENS.IVaultAdapter)),v4("design:paramtypes",[Object,E4.TaskFrontmatterGenerator,T4.AlgorithmExtractor])],zh)});var Qh=y(Ur=>{"use strict";var x4=Ur&&Ur.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},O4=Ur&&Ur.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},C4=Ur&&Ur.__param||function(r,e){return function(t,n){e(t,n,r)}};Object.defineProperty(Ur,"__esModule",{value:!0});Ur.ProjectCreationService=void 0;var q2=Ye(),B2=qr(),P4=Bi(),Kc=Vt(),F4=pr(),I4=$a(),U2=Br(),R4=rt(),D4={[Kc.AssetClass.AREA]:"ems__Effort_area",[Kc.AssetClass.INITIATIVE]:"ems__Effort_parent",[Kc.AssetClass.PROJECT]:"ems__Effort_parent"},Yh=class{static{o(this,"ProjectCreationService")}constructor(e){this.vault=e}async createProject(e,t,n,i){let s=(0,B2.v4)(),a=`${s}.md`,c=this.generateProjectFrontmatter(t,e.basename,n,i,s),u=U2.MetadataHelpers.buildFileContent(c),f=e.parent?.path||"",l=f?`${f}/${a}`:a;return await this.vault.create(l,u)}generateProjectFrontmatter(e,t,n,i,s){let a=new Date,c=F4.DateFormatter.toLocalTimestamp(a),u=I4.MetadataExtractor.extractIsDefinedBy(e),f=P4.WikiLinkHelpers.normalize(n),l=D4[f]||"ems__Effort_area",h={};if(h.exo__Asset_isDefinedBy=U2.MetadataHelpers.ensureQuoted(u),h.exo__Asset_uid=s||(0,B2.v4)(),h.exo__Asset_createdAt=c,h.exo__Instance_class=[`"[[${Kc.AssetClass.PROJECT}]]"`],h.ems__Effort_status='"[[ems__EffortStatusDraft]]"',h[l]=`"[[${t}]]"`,i&&i.trim()!==""){let p=i.trim();h.exo__Asset_label=p,h.aliases=[p]}return h}};Ur.ProjectCreationService=Yh;Ur.ProjectCreationService=Yh=x4([(0,q2.injectable)(),C4(0,(0,q2.inject)(R4.DI_TOKENS.IVaultAdapter)),O4("design:paramtypes",[Object])],Yh)});var Ps=y(Qc=>{"use strict";Object.defineProperty(Qc,"__esModule",{value:!0});Qc.FrontmatterService=void 0;var Yc=class r{static{o(this,"FrontmatterService")}parse(e){let t=e.match(r.FRONTMATTER_REGEX);return t?{exists:!0,content:t[1],originalContent:e}:{exists:!1,content:"",originalContent:e}}updateProperty(e,t,n){let i=this.parse(e);if(!i.exists)return this.createFrontmatter(e,{[t]:n});let s=i.content;if(this.hasProperty(s,t)){let a=new RegExp(`${this.escapeRegex(t)}:.*$`,"m");s=s.replace(a,`${t}: ${n}`)}else{let a=s.length>0?`
`:"";s+=`${a}${t}: ${n}`}return e.replace(r.FRONTMATTER_REGEX,`---
${s}
---`)}addProperty(e,t,n){return this.updateProperty(e,t,n)}removeProperty(e,t){let n=this.parse(e);if(!n.exists||!this.hasProperty(n.content,t))return e;let i=new RegExp(`
?${this.escapeRegex(t)}:.*(?:
 {2}- .*)*`,"gm"),s=n.content.replace(i,"");return e.replace(r.FRONTMATTER_REGEX,`---
${s}
---`)}hasProperty(e,t){return e.includes(`${t}:`)}createFrontmatter(e,t){let i=`---
${Object.entries(t).map(([a,c])=>`${a}: ${c}`).join(`
`)}
---`,s=e.startsWith(`
`)?"":`
`;return`${i}${s}${e}`}getPropertyValue(e,t){let n=new RegExp(`${this.escapeRegex(t)}:\\s*(.*)$`,"m"),i=e.match(n);return i?i[1].trim():null}escapeRegex(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}};Qc.FrontmatterService=Yc;Yc.FRONTMATTER_REGEX=/^---\n([\s\S]*?)\n---/});var Jc=y(Xi=>{"use strict";var N4=Xi&&Xi.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s};Object.defineProperty(Xi,"__esModule",{value:!0});Xi.EffortStatusWorkflow=void 0;var k4=Ye(),vr=Vt(),Jh=class{static{o(this,"EffortStatusWorkflow")}getPreviousStatus(e,t){let n=this.normalizeStatus(e);if(n===vr.EffortStatus.DRAFT)return null;if(n===vr.EffortStatus.BACKLOG)return this.wrapStatus(vr.EffortStatus.DRAFT);if(n===vr.EffortStatus.ANALYSIS)return this.wrapStatus(vr.EffortStatus.BACKLOG);if(n===vr.EffortStatus.TODO)return this.wrapStatus(vr.EffortStatus.ANALYSIS);if(n===vr.EffortStatus.DOING)return this.hasInstanceClass(t,vr.AssetClass.PROJECT)?this.wrapStatus(vr.EffortStatus.TODO):this.wrapStatus(vr.EffortStatus.BACKLOG);if(n===vr.EffortStatus.DONE)return this.wrapStatus(vr.EffortStatus.DOING)}normalizeStatus(e){return e.replace(/["'[\]]/g,"").trim()}wrapStatus(e){return`"[[${e}]]"`}hasInstanceClass(e,t){return e?(Array.isArray(e)?e:[e]).some(i=>i.replace(/["'[\]]/g,"").trim()===t):!1}};Xi.EffortStatusWorkflow=Jh;Xi.EffortStatusWorkflow=Jh=N4([(0,k4.injectable)()],Jh)});var Xc=y($r=>{"use strict";var j4=$r&&$r.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},M4=$r&&$r.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},L4=$r&&$r.__param||function(r,e){return function(t,n){e(t,n,r)}};Object.defineProperty($r,"__esModule",{value:!0});$r.StatusTimestampService=void 0;var $2=Ye(),V4=Ps(),Wa=pr(),q4=rt(),Xh=class{static{o(this,"StatusTimestampService")}constructor(e){this.vault=e,this.frontmatterService=new V4.FrontmatterService}async addStartTimestamp(e){let t=await this.vault.read(e),n=Wa.DateFormatter.toLocalTimestamp(new Date),i=this.frontmatterService.updateProperty(t,"ems__Effort_startTimestamp",n);await this.vault.modify(e,i)}async addEndTimestamp(e,t){let n=await this.vault.read(e),i=t||new Date,s=Wa.DateFormatter.toLocalTimestamp(i),a=this.frontmatterService.updateProperty(n,"ems__Effort_endTimestamp",s);await this.vault.modify(e,a)}async addResolutionTimestamp(e){let t=await this.vault.read(e),n=Wa.DateFormatter.toLocalTimestamp(new Date),i=this.frontmatterService.updateProperty(t,"ems__Effort_resolutionTimestamp",n);await this.vault.modify(e,i)}async addEndAndResolutionTimestamps(e,t){let n=await this.vault.read(e),i=t||new Date,s=Wa.DateFormatter.toLocalTimestamp(i),a=this.frontmatterService.updateProperty(n,"ems__Effort_endTimestamp",s);a=this.frontmatterService.updateProperty(a,"ems__Effort_resolutionTimestamp",s),await this.vault.modify(e,a)}async removeStartTimestamp(e){let t=await this.vault.read(e),n=this.frontmatterService.removeProperty(t,"ems__Effort_startTimestamp");await this.vault.modify(e,n)}async removeEndTimestamp(e){let t=await this.vault.read(e),n=this.frontmatterService.removeProperty(t,"ems__Effort_endTimestamp");await this.vault.modify(e,n)}async removeResolutionTimestamp(e){let t=await this.vault.read(e),n=this.frontmatterService.removeProperty(t,"ems__Effort_resolutionTimestamp");await this.vault.modify(e,n)}async removeEndAndResolutionTimestamps(e){let t=await this.vault.read(e),n=this.frontmatterService.removeProperty(t,"ems__Effort_endTimestamp");n=this.frontmatterService.removeProperty(n,"ems__Effort_resolutionTimestamp"),await this.vault.modify(e,n)}async shiftPlannedEndTimestamp(e,t){let n=await this.vault.read(e),i=this.frontmatterService.parse(n);if(!i.exists)return;let s=this.frontmatterService.getPropertyValue(i.content,"ems__Effort_plannedEndTimestamp");if(!s)return;let a=new Date(s.replace(/["']/g,""));if(isNaN(a.getTime()))return;let c=new Date(a.getTime()+t),u=Wa.DateFormatter.toLocalTimestamp(c),f=this.frontmatterService.updateProperty(n,"ems__Effort_plannedEndTimestamp",u);await this.vault.modify(e,f)}};$r.StatusTimestampService=Xh;$r.StatusTimestampService=Xh=j4([(0,$2.injectable)(),L4(0,(0,$2.inject)(q4.DI_TOKENS.IVaultAdapter)),M4("design:paramtypes",[Object])],Xh)});var ed=y(Wr=>{"use strict";var B4=Wr&&Wr.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},U4=Wr&&Wr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},$4=Wr&&Wr.__param||function(r,e){return function(t,n){e(t,n,r)}};Object.defineProperty(Wr,"__esModule",{value:!0});Wr.TaskStatusService=void 0;var W2=Ye(),W4=Ps(),Zi=pr(),G4=Jc(),H4=Xc(),z4=rt(),Zh=class{static{o(this,"TaskStatusService")}constructor(e,t,n){this.vault=e,this.workflow=t,this.timestampService=n,this.frontmatterService=new W4.FrontmatterService}async setDraftStatus(e){await this.updateStatus(e,"ems__EffortStatusDraft")}async moveToBacklog(e){await this.updateStatus(e,"ems__EffortStatusBacklog")}async moveToAnalysis(e){await this.updateStatus(e,"ems__EffortStatusAnalysis")}async moveToToDo(e){await this.updateStatus(e,"ems__EffortStatusToDo")}async startEffort(e){let t=await this.vault.read(e),n=Zi.DateFormatter.toLocalTimestamp(new Date),i=this.frontmatterService.updateProperty(t,"ems__Effort_status",'"[[ems__EffortStatusDoing]]"');i=this.frontmatterService.updateProperty(i,"ems__Effort_startTimestamp",n),await this.vault.modify(e,i)}async markTaskAsDone(e){let t=await this.vault.read(e),n=Zi.DateFormatter.toLocalTimestamp(new Date),i=this.frontmatterService.updateProperty(t,"ems__Effort_status",'"[[ems__EffortStatusDone]]"');i=this.frontmatterService.updateProperty(i,"ems__Effort_endTimestamp",n),i=this.frontmatterService.updateProperty(i,"ems__Effort_resolutionTimestamp",n),await this.vault.modify(e,i)}async syncEffortEndTimestamp(e,t){await this.timestampService.addEndAndResolutionTimestamps(e,t)}async shiftPlannedEndTimestamp(e,t){await this.timestampService.shiftPlannedEndTimestamp(e,t)}async trashEffort(e){let t=await this.vault.read(e),n=Zi.DateFormatter.toLocalTimestamp(new Date),i=this.frontmatterService.updateProperty(t,"ems__Effort_status",'"[[ems__EffortStatusTrashed]]"');i=this.frontmatterService.updateProperty(i,"ems__Effort_resolutionTimestamp",n),await this.vault.modify(e,i)}async archiveTask(e){let t=await this.vault.read(e),n=this.frontmatterService.updateProperty(t,"archived","true");n=this.frontmatterService.removeProperty(n,"aliases"),await this.vault.modify(e,n)}async planOnToday(e){let t=await this.vault.read(e),n=Zi.DateFormatter.getTodayStartTimestamp(),i=this.frontmatterService.updateProperty(t,"ems__Effort_plannedStartTimestamp",n);await this.vault.modify(e,i)}async planForEvening(e){let t=await this.vault.read(e),n=new Date;n.setHours(19,0,0,0);let i=Zi.DateFormatter.toLocalTimestamp(n),s=this.frontmatterService.updateProperty(t,"ems__Effort_plannedStartTimestamp",i);await this.vault.modify(e,s)}async shiftDayBackward(e){await this.shiftDay(e,-1)}async shiftDayForward(e){await this.shiftDay(e,1)}async rollbackStatus(e){let t=await this.vault.read(e),n=this.extractCurrentStatus(t),i=this.extractInstanceClass(t);if(!n)throw new Error("No current status to rollback from");let s=this.workflow.getPreviousStatus(n,i);if(s===void 0)throw new Error("Cannot rollback from current status");let a=t;s===null?a=this.frontmatterService.removeProperty(a,"ems__Effort_status"):a=this.frontmatterService.updateProperty(a,"ems__Effort_status",s);let c=this.workflow.normalizeStatus(n);c==="ems__EffortStatusDone"?(a=this.frontmatterService.removeProperty(a,"ems__Effort_endTimestamp"),a=this.frontmatterService.removeProperty(a,"ems__Effort_resolutionTimestamp")):c==="ems__EffortStatusDoing"&&(a=this.frontmatterService.removeProperty(a,"ems__Effort_startTimestamp")),await this.vault.modify(e,a)}async updateStatus(e,t){let n=await this.vault.read(e),i=this.frontmatterService.updateProperty(n,"ems__Effort_status",`"[[${t}]]"`);await this.vault.modify(e,i)}async shiftDay(e,t){let n=await this.vault.read(e),i=this.extractPlannedStartTimestamp(n);if(!i)throw new Error("ems__Effort_plannedStartTimestamp property not found");let s=this.parseDateFromTimestamp(i);if(!s)throw new Error("Invalid date format in ems__Effort_plannedStartTimestamp");let a=Zi.DateFormatter.addDays(s,t);a.setHours(0,0,0,0);let c=Zi.DateFormatter.toLocalTimestamp(a),u=this.frontmatterService.updateProperty(n,"ems__Effort_plannedStartTimestamp",c);await this.vault.modify(e,u)}parseDateFromTimestamp(e){let t=new Date(e);return isNaN(t.getTime())?null:t}extractPlannedStartTimestamp(e){let t=this.frontmatterService.parse(e);return t.exists?this.frontmatterService.getPropertyValue(t.content,"ems__Effort_plannedStartTimestamp"):null}extractCurrentStatus(e){let t=this.frontmatterService.parse(e);return t.exists?this.frontmatterService.getPropertyValue(t.content,"ems__Effort_status"):null}extractInstanceClass(e){let t=this.frontmatterService.parse(e);if(!t.exists)return null;let n=t.content.match(/exo__Instance_class:\s*\n((?:\s*-\s*.*\n?)+)/);return n?n[1].split(`
`).filter(s=>s.trim()).map(s=>s.replace(/^\s*-\s*/,"").trim()):this.frontmatterService.getPropertyValue(t.content,"exo__Instance_class")}};Wr.TaskStatusService=Zh;Wr.TaskStatusService=Zh=B4([(0,W2.injectable)(),$4(0,(0,W2.inject)(z4.DI_TOKENS.IVaultAdapter)),U4("design:paramtypes",[Object,G4.EffortStatusWorkflow,H4.StatusTimestampService])],Zh)});var rd=y(Gr=>{"use strict";var K4=Gr&&Gr.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},Y4=Gr&&Gr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},Q4=Gr&&Gr.__param||function(r,e){return function(t,n){e(t,n,r)}};Object.defineProperty(Gr,"__esModule",{value:!0});Gr.AreaCreationService=void 0;var G2=Ye(),H2=qr(),J4=Vt(),X4=pr(),Z4=$a(),z2=Br(),eA=rt(),td=class{static{o(this,"AreaCreationService")}constructor(e){this.vault=e}async createChildArea(e,t,n){let i=(0,H2.v4)(),s=`${i}.md`,a=this.generateChildAreaFrontmatter(t,e.basename,n,i),c=z2.MetadataHelpers.buildFileContent(a),u=e.parent?.path||"",f=u?`${u}/${s}`:s;return await this.vault.create(f,c)}generateChildAreaFrontmatter(e,t,n,i){let s=new Date,a=X4.DateFormatter.toLocalTimestamp(s),c=Z4.MetadataExtractor.extractIsDefinedBy(e),u={};if(u.exo__Asset_isDefinedBy=z2.MetadataHelpers.ensureQuoted(c),u.exo__Asset_uid=i||(0,H2.v4)(),u.exo__Asset_createdAt=a,u.exo__Instance_class=[`"[[${J4.AssetClass.AREA}]]"`],u.ems__Area_parent=`"[[${t}]]"`,n&&n.trim()!==""){let f=n.trim();u.exo__Asset_label=f,u.aliases=[f]}return u}};Gr.AreaCreationService=td;Gr.AreaCreationService=td=K4([(0,G2.injectable)(),Q4(0,(0,G2.inject)(eA.DI_TOKENS.IVaultAdapter)),Y4("design:paramtypes",[Object])],td)});var id=y(Hr=>{"use strict";var tA=Hr&&Hr.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},rA=Hr&&Hr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},nA=Hr&&Hr.__param||function(r,e){return function(t,n){e(t,n,r)}};Object.defineProperty(Hr,"__esModule",{value:!0});Hr.AreaHierarchyBuilder=void 0;var K2=Ye(),Y2=Vt(),iA=rt(),nd=class{static{o(this,"AreaHierarchyBuilder")}constructor(e){this.vault=e}buildHierarchy(e,t){let n=this.vault.getAbstractFileByPath(e);if(!this.isFile(n))return null;let i=this.vault.getFrontmatter(n)||{};if(this.extractInstanceClass(i)!==Y2.AssetClass.AREA)return null;let a=this.collectAllAreasFromVault(),c=new Set;return this.buildTree(e,a,c,0)}isFile(e){return e&&typeof e=="object"&&"basename"in e&&"path"in e}extractInstanceClass(e){let t=e.exo__Instance_class||"";return Array.isArray(t)?this.cleanWikiLink(t[0]||""):this.cleanWikiLink(t)}cleanWikiLink(e){return typeof e!="string"?"":e.replace(/^\[\[|\]\]$/g,"").trim()}collectAllAreasFromVault(){let e=new Map,t=new Map,n=this.vault.getAllFiles();for(let i of n){let s=this.vault.getFrontmatter(i)||{};if(this.extractInstanceClass(s)===Y2.AssetClass.AREA){let c=this.extractParentPath(s);e.set(i.path,{path:i.path,title:i.basename,label:s.exo__Asset_label||void 0,isArchived:this.isArchived(s),depth:0,parentPath:c||void 0}),t.set(i.basename,i.path)}}for(let[,i]of e.entries())i.parentPath&&t.has(i.parentPath)&&(i.parentPath=t.get(i.parentPath));return e}extractParentPath(e){let t=e.ems__Area_parent;if(!t)return null;if(Array.isArray(t)){let n=t[0]||"";return this.cleanWikiLink(n)}return this.cleanWikiLink(t)}isArchived(e){let t=e.exo__Asset_archived;if(t===!0||t==="true")return!0;if(Array.isArray(t)&&t.length>0){let n=t[0];return n===!0||n==="true"}return!1}buildTree(e,t,n,i){if(n.has(e))return null;n.add(e);let s=t.get(e);if(!s)return null;let a=[];for(let[c,u]of t.entries())if(u.parentPath===e){let f=this.buildTree(c,t,n,i+1);f&&a.push(f)}return a.sort((c,u)=>{let f=c.label||c.title,l=u.label||u.title;return f.localeCompare(l)}),{path:s.path,title:s.title,label:s.label,isArchived:s.isArchived,depth:i,parentPath:s.parentPath,children:a}}};Hr.AreaHierarchyBuilder=nd;Hr.AreaHierarchyBuilder=nd=tA([(0,K2.injectable)(),nA(0,(0,K2.inject)(iA.DI_TOKENS.IVaultAdapter)),rA("design:paramtypes",[Object])],nd)});var ad=y(zr=>{"use strict";var sA=zr&&zr.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},aA=zr&&zr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},oA=zr&&zr.__param||function(r,e){return function(t,n){e(t,n,r)}};Object.defineProperty(zr,"__esModule",{value:!0});zr.ClassCreationService=void 0;var Q2=Ye(),cA=qr(),uA=pr(),lA=Br(),fA=rt(),sd=class{static{o(this,"ClassCreationService")}constructor(e){this.vault=e}async createSubclass(e,t,n){let i=(0,cA.v4)(),s=this.generateFileName(t),a=s.endsWith(".md")?s:`${s}.md`,c=this.generateClassFrontmatter(e.basename,t,i,n),u=lA.MetadataHelpers.buildFileContent(c),f="classes",l=`${f}/${a}`;return this.vault.getAbstractFileByPath(f)||await this.vault.createFolder(f),await this.vault.create(l,u)}generateFileName(e){return e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}generateClassFrontmatter(e,t,n,i){let s=new Date,a=uA.DateFormatter.toLocalTimestamp(s),c={};c.exo__Asset_uid=n,c.exo__Asset_label=t,c.exo__Asset_createdAt=a,c.exo__Instance_class=['"[[exo__Class]]"'],c.exo__Class_superClass=`"[[${e}]]"`;let u=i.exo__Asset_isDefinedBy||'"[[Ontology/EXO]]"';return c.exo__Asset_isDefinedBy=u,c.aliases=[t],c}};zr.ClassCreationService=sd;zr.ClassCreationService=sd=sA([(0,Q2.injectable)(),oA(0,(0,Q2.inject)(fA.DI_TOKENS.IVaultAdapter)),aA("design:paramtypes",[Object])],sd)});var cd=y(Kr=>{"use strict";var hA=Kr&&Kr.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},dA=Kr&&Kr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},pA=Kr&&Kr.__param||function(r,e){return function(t,n){e(t,n,r)}};Object.defineProperty(Kr,"__esModule",{value:!0});Kr.ConceptCreationService=void 0;var J2=Ye(),mA=qr(),gA=pr(),yA=Br(),_A=Vt(),vA=rt(),od=class{static{o(this,"ConceptCreationService")}constructor(e){this.vault=e}async createNarrowerConcept(e,t,n,i){let s=(0,mA.v4)(),a=t.endsWith(".md")?t:`${t}.md`,c=this.generateConceptFrontmatter(e.basename,n,i,s),u=yA.MetadataHelpers.buildFileContent(c),f="concepts",l=`${f}/${a}`;return this.vault.getAbstractFileByPath(f)||await this.vault.createFolder(f),await this.vault.create(l,u)}generateConceptFrontmatter(e,t,n,i){let s=new Date,a=gA.DateFormatter.toLocalTimestamp(s),c={};return c.exo__Asset_isDefinedBy='"[[!concepts]]"',c.exo__Asset_uid=i,c.exo__Asset_createdAt=a,c.exo__Instance_class=[`"[[${_A.AssetClass.CONCEPT}]]"`],c.ims__Concept_broader=`"[[${e}]]"`,c.ims__Concept_definition=t,n.length>0&&(c.aliases=n),c}};Kr.ConceptCreationService=od;Kr.ConceptCreationService=od=hA([(0,J2.injectable)(),pA(0,(0,J2.inject)(vA.DI_TOKENS.IVaultAdapter)),dA("design:paramtypes",[Object])],od)});var ld=y(Yr=>{"use strict";var SA=Yr&&Yr.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},wA=Yr&&Yr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},bA=Yr&&Yr.__param||function(r,e){return function(t,n){e(t,n,r)}};Object.defineProperty(Yr,"__esModule",{value:!0});Yr.EffortVotingService=void 0;var X2=Ye(),EA=rt(),ud=class{static{o(this,"EffortVotingService")}constructor(e){this.vault=e}async incrementEffortVotes(e){let t=await this.vault.read(e),i=this.extractVoteCount(t)+1,s=this.updateFrontmatterWithVotes(t,i);return await this.vault.modify(e,s),i}extractVoteCount(e){let t=/^---\r?\n([\s\S]*?)\r?\n---/,n=e.match(t);if(!n)return 0;let s=n[1].match(/ems__Effort_votes:\s*(\d+)/);return s&&s[1]?parseInt(s[1],10):0}updateFrontmatterWithVotes(e,t){let n=/^---\r?\n([\s\S]*?)\r?\n---/,i=e.match(n),s=e.includes(`\r
`)?`\r
`:`
`;if(!i)return`---${s}ems__Effort_votes: ${t}${s}---${s}${e}`;let c=i[1];return c.includes("ems__Effort_votes:")?c=c.replace(/ems__Effort_votes:.*$/m,`ems__Effort_votes: ${t}`):c+=`${s}ems__Effort_votes: ${t}`,e.replace(n,`---${s}${c}${s}---`)}};Yr.EffortVotingService=ud;Yr.EffortVotingService=ud=SA([(0,X2.injectable)(),bA(0,(0,X2.inject)(EA.DI_TOKENS.IVaultAdapter)),wA("design:paramtypes",[Object])],ud)});var hd=y(Qr=>{"use strict";var TA=Qr&&Qr.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},AA=Qr&&Qr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},xA=Qr&&Qr.__param||function(r,e){return function(t,n){e(t,n,r)}};Object.defineProperty(Qr,"__esModule",{value:!0});Qr.FolderRepairService=void 0;var Z2=Ye(),OA=rt(),fd=class{static{o(this,"FolderRepairService")}constructor(e){this.vault=e}async getExpectedFolder(e,t){let n=t?.exo__Asset_isDefinedBy;if(!n)return null;let i=this.extractReference(n);if(!i)return null;let s=this.vault.getFirstLinkpathDest(i,e.path);return s?this.getFileFolder(s):null}async repairFolder(e,t){let n=`${t}/${e.name}`;if(this.vault.getAbstractFileByPath(n))throw new Error(`Cannot move file: ${n} already exists`);await this.ensureFolderExists(t),await this.vault.rename(e,n)}getFileFolder(e){return e.parent?.path||""}extractReference(e){if(typeof e!="string")return null;let t=e.trim().replace(/^["']|["']$/g,"");return t=t.replace(/^\[\[|\]\]$/g,""),t||null}async ensureFolderExists(e){if(!e)return;let t=this.vault.getAbstractFileByPath(e);if(!(t&&"children"in t))try{await this.vault.createFolder(e)}catch(n){if(n instanceof Error&&n.message.includes("Folder already exists"))return;throw n}}};Qr.FolderRepairService=fd;Qr.FolderRepairService=fd=TA([(0,Z2.injectable)(),xA(0,(0,Z2.inject)(OA.DI_TOKENS.IVaultAdapter)),AA("design:paramtypes",[Object])],fd)});var pd=y(Jr=>{"use strict";var CA=Jr&&Jr.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},PA=Jr&&Jr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},FA=Jr&&Jr.__param||function(r,e){return function(t,n){e(t,n,r)}};Object.defineProperty(Jr,"__esModule",{value:!0});Jr.LabelToAliasService=void 0;var eg=Ye(),IA=rt(),dd=class{static{o(this,"LabelToAliasService")}constructor(e){this.vault=e}async copyLabelToAliases(e){let t=await this.vault.read(e),n=this.extractLabel(t);if(!n)throw new Error("No exo__Asset_label found in file");let i=this.addLabelToAliases(t,n);await this.vault.modify(e,i)}extractLabel(e){let t=/^---\r?\n([\s\S]*?)\r?\n---/,n=e.match(t);if(!n)return null;let s=n[1].match(/exo__Asset_label:\s*["']?([^"'\r\n]+)["']?/);return s&&s[1]?s[1].trim():null}addLabelToAliases(e,t){let n=/^---\r?\n([\s\S]*?)\r?\n---/,i=e.match(n),s=e.includes(`\r
`)?`\r
`:`
`;if(!i)return`---${s}aliases:${s}  - "${t}"${s}---${s}${e}`;let c=i[1];return c.includes("aliases:")?c.match(/(aliases:\r?\n(?: {2}- .*\r?\n)*)/)&&(c=c.replace(/(aliases:\r?\n(?: {2}- .*\r?\n)*)/,`$1  - "${t}"${s}`)):c+=`${s}aliases:${s}  - "${t}"`,e.replace(n,`---${s}${c}${s}---`)}};Jr.LabelToAliasService=dd;Jr.LabelToAliasService=dd=CA([(0,eg.injectable)(),FA(0,(0,eg.inject)(IA.DI_TOKENS.IVaultAdapter)),PA("design:paramtypes",[Object])],dd)});var md=y(eu=>{"use strict";Object.defineProperty(eu,"__esModule",{value:!0});eu.LoggingService=void 0;var Zc=class{static{o(this,"LoggingService")}static setVerbose(e){this.isVerbose=e}static debug(e,t){this.isVerbose&&console.debug(`[Exocortex] ${e}`,t??"")}static info(e,t){console.log(`[Exocortex] ${e}`,t??"")}static warn(e,t){console.warn(`[Exocortex] ${e}`,t??"")}static error(e,t){console.error(`[Exocortex ERROR] ${e}`,t??""),t?.stack&&console.error(t.stack)}};eu.LoggingService=Zc;Zc.isVerbose=!1});var _d=y(Xr=>{"use strict";var RA=Xr&&Xr.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},DA=Xr&&Xr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},tg=Xr&&Xr.__param||function(r,e){return function(t,n){e(t,n,r)}};Object.defineProperty(Xr,"__esModule",{value:!0});Xr.PropertyCleanupService=void 0;var gd=Ye(),rg=rt(),yd=class{static{o(this,"PropertyCleanupService")}constructor(e,t){this.vault=e,this.logger=t,this.logger.debug("PropertyCleanupService initialized")}async cleanEmptyProperties(e){this.logger.debug("Cleaning empty properties",{path:e.path});let t=await this.vault.read(e),n=this.removeEmptyPropertiesFromContent(t);await this.vault.modify(e,n),this.logger.info("Empty properties cleaned",{path:e.path})}removeEmptyPropertiesFromContent(e){let t=/^---\n([\s\S]*?)\n---/,n=e.match(t);if(!n)return e;let s=n[1].split(`
`),a=[],c=0;for(;c<s.length;){let f=s[c],l=f.trim();if(l===""){a.push(f),c++;continue}let h=l.match(/^([^:]+):\s*(.*)$/);if(h){let p=h[2];if(p===""&&c+1<s.length&&s[c+1].match(/^\s+- /)){let w=[],S=c+1;for(;S<s.length&&s[S].match(/^\s+- /);)w.push(s[S]),S++;if(w.every(P=>{let F=P.replace(/^\s+- /,"").trim();return this.isEmptyValue(F)})){c=S;continue}else{a.push(f);for(let P=c+1;P<S;P++)a.push(s[P]);c=S;continue}}if(this.isEmptyValue(p)){c++;continue}a.push(f),c++}else l.match(/^\s*- /)||a.push(f),c++}let u=a.join(`
`);return e.replace(t,`---
${u}
---`)}isEmptyValue(e){let t=e.trim();return t===""||t==="null"||t==="undefined"||t==="[]"||t==="{}"||t==='""'||t==="''"}};Xr.PropertyCleanupService=yd;Xr.PropertyCleanupService=yd=RA([(0,gd.injectable)(),tg(0,(0,gd.inject)(rg.DI_TOKENS.IVaultAdapter)),tg(1,(0,gd.inject)(rg.DI_TOKENS.ILogger)),DA("design:paramtypes",[Object,Object])],yd)});var Sd=y(Zr=>{"use strict";var NA=Zr&&Zr.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},kA=Zr&&Zr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},jA=Zr&&Zr.__param||function(r,e){return function(t,n){e(t,n,r)}};Object.defineProperty(Zr,"__esModule",{value:!0});Zr.RenameToUidService=void 0;var ng=Ye(),MA=rt(),vd=class{static{o(this,"RenameToUidService")}constructor(e){this.vault=e}async renameToUid(e,t){let n=t.exo__Asset_uid;if(!n)throw new Error("Asset has no exo__Asset_uid property");let i=e.basename,s=n;if(i===s)throw new Error("File is already named according to UID");let a=t.exo__Asset_label;if(!a||a.trim()===""){let l=this.isAssetArchived(t);await this.updateLabel(e,i,l)}let u=e.parent?.path||"",f=u?`${u}/${s}.md`:`${s}.md`;await this.vault.updateLinks(e.path,f,i),await this.vault.rename(e,f)}async updateLabel(e,t,n){await this.vault.process(e,i=>{let s=/^---\n([\s\S]*?)\n---/,a=i.match(s);if(!a)return i;let c=a[1],u=n?`${c}
exo__Asset_label: ${t}`:`${c}
exo__Asset_label: ${t}
aliases:
  - ${t}`;return i.replace(s,`---
${u}
---`)})}isAssetArchived(e){if(e?.exo__Asset_isArchived===!0)return!0;let t=e?.archived;if(t==null)return!1;if(typeof t=="boolean")return t;if(typeof t=="number")return t!==0;if(typeof t=="string"){let n=t.toLowerCase().trim();return n==="true"||n==="yes"||n==="1"}return!1}};Zr.RenameToUidService=vd;Zr.RenameToUidService=vd=NA([(0,ng.injectable)(),jA(0,(0,ng.inject)(MA.DI_TOKENS.IVaultAdapter)),kA("design:paramtypes",[Object])],vd)});var bd=y(en=>{"use strict";var LA=en&&en.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},VA=en&&en.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},qA=en&&en.__param||function(r,e){return function(t,n){e(t,n,r)}};Object.defineProperty(en,"__esModule",{value:!0});en.SupervisionCreationService=void 0;var ig=Ye(),BA=qr(),UA=pr(),$A=rt(),wd=class{static{o(this,"SupervisionCreationService")}constructor(e){this.vault=e}async createSupervision(e){let t=(0,BA.v4)(),n=`${t}.md`,i=this.generateFrontmatter(t),s=this.generateBody(e),a=this.buildFileContent(i,s),c=`01 Inbox/${n}`;return await this.vault.create(c,a)}generateFrontmatter(e){let t=new Date,n=UA.DateFormatter.toLocalTimestamp(t);return{exo__Asset_isDefinedBy:'"[[!kitelev]]"',exo__Asset_uid:e,exo__Asset_createdAt:n,exo__Instance_class:['"[[ztlk__FleetingNote]]"'],ztlk__FleetingNote_type:'"[[CBT-Diary Record]]"'}}generateBody(e){return[{label:"\u0421\u0438\u0442\u0443\u0430\u0446\u0438\u044F/\u0442\u0440\u0438\u0433\u0433\u0435\u0440",value:e.situation},{label:"\u042D\u043C\u043E\u0446\u0438\u0438",value:e.emotions},{label:"\u041C\u044B\u0441\u043B\u0438",value:e.thoughts},{label:"\u041F\u043E\u0432\u0435\u0434\u0435\u043D\u0438\u0435",value:e.behavior},{label:"\u041A\u0440\u0430\u0442\u043A\u043E\u0441\u0440\u043E\u0447\u043D\u044B\u0435 \u043F\u043E\u0441\u043B\u0435\u0434\u0441\u0442\u0432\u0438\u044F \u043F\u043E\u0432\u0435\u0434\u0435\u043D\u0438\u044F",value:e.shortTermConsequences},{label:"\u0414\u043E\u043B\u0433\u043E\u0441\u0440\u043E\u0447\u043D\u044B\u0435 \u043F\u043E\u0441\u043B\u0435\u0434\u0441\u0442\u0432\u0438\u044F \u043F\u043E\u0432\u0435\u0434\u0435\u043D\u0438\u044F",value:e.longTermConsequences}].map(n=>`- ${n.label}: ${n.value}`).join(`
`)}buildFileContent(e,t){return`---
${Object.entries(e).map(([i,s])=>{if(Array.isArray(s)){let a=s.map(c=>`  - ${c}`).join(`
`);return`${i}:
${a}`}return`${i}: ${s}`}).join(`
`)}
---

${t}
`}};en.SupervisionCreationService=wd;en.SupervisionCreationService=wd=LA([(0,ig.injectable)(),qA(0,(0,ig.inject)($A.DI_TOKENS.IVaultAdapter)),VA("design:paramtypes",[Object])],wd)});var Td=y(tn=>{"use strict";var WA=tn&&tn.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},GA=tn&&tn.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},HA=tn&&tn.__param||function(r,e){return function(t,n){e(t,n,r)}},Ed;Object.defineProperty(tn,"__esModule",{value:!0});tn.FleetingNoteCreationService=void 0;var sg=Ye(),zA=qr(),KA=pr(),YA=Br(),QA=rt(),tu=Ed=class{static{o(this,"FleetingNoteCreationService")}constructor(e){this.vault=e}async createFleetingNote(e){let t=(0,zA.v4)(),n=`${t}.md`,i=this.generateFrontmatter(t,e),s=YA.MetadataHelpers.buildFileContent(i),a=`${Ed.INBOX_FOLDER}/${n}`;return await this.vault.create(a,s)}generateFrontmatter(e,t){let n=new Date,i=KA.DateFormatter.toLocalTimestamp(n),s=t.trim();return{exo__Asset_isDefinedBy:'"[[!kitelev]]"',exo__Asset_uid:e,exo__Asset_createdAt:i,exo__Instance_class:['"[[ztlk__FleetingNote]]"'],exo__Asset_label:s,aliases:[s]}}};tn.FleetingNoteCreationService=tu;tu.INBOX_FOLDER="01 Inbox";tn.FleetingNoteCreationService=tu=Ed=WA([(0,sg.injectable)(),HA(0,(0,sg.inject)(QA.DI_TOKENS.IVaultAdapter)),GA("design:paramtypes",[Object])],tu)});var xd=y(es=>{"use strict";var JA=es&&es.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s};Object.defineProperty(es,"__esModule",{value:!0});es.DynamicFrontmatterGenerator=void 0;var XA=Ye(),ZA=qr(),Ga=pr(),Ad=class{static{o(this,"DynamicFrontmatterGenerator")}generate(e,t,n,i){let s={},a=new Date;i?.isDefinedBy&&(s.exo__Asset_isDefinedBy=this.ensureQuoted(i.isDefinedBy)),s.exo__Asset_uid=i?.uid||(0,ZA.v4)(),s.exo__Asset_createdAt=i?.createdAt||Ga.DateFormatter.toLocalTimestamp(a),s.exo__Instance_class=[this.formatWikilink(e)];let c=new Map;for(let f of n)c.set(f.name,f.type);for(let[f,l]of Object.entries(t)){if(l==null||f==="exo__Asset_uid"||f==="exo__Asset_createdAt"||f==="exo__Instance_class"||f==="exo__Asset_isDefinedBy")continue;let h=c.get(f);s[f]=this.formatValue(l,h)}let u=t.exo__Asset_label;if(u&&typeof u=="string"&&u.trim()!==""){let f=u.trim();s.exo__Asset_label=f,s.aliases=[f]}return s}formatValue(e,t){if(e==null)return null;if(!t)return this.formatInferredValue(e);switch(t){case"text":return this.formatText(e);case"wikilink":return this.formatWikilink(e);case"status-select":case"size-select":return this.formatWikilink(e);case"number":return this.formatNumber(e);case"boolean":return this.formatBoolean(e);case"timestamp":return this.formatTimestamp(e);default:return this.formatText(e)}}formatText(e){return typeof e=="string"?e:String(e)}formatWikilink(e){let t=String(e);return t.startsWith('"[[')&&t.endsWith(']]"')?t:t.startsWith("[[")&&t.endsWith("]]")?`"${t}"`:`"[[${t}]]"`}formatNumber(e){if(typeof e=="number")return e;let t=Number(e);return isNaN(t)?0:t}formatBoolean(e){if(typeof e=="boolean")return e;if(typeof e=="string"){let t=e.toLowerCase().trim();return t==="true"||t==="yes"||t==="1"}return typeof e=="number"?e!==0:!!e}formatTimestamp(e){if(e instanceof Date)return Ga.DateFormatter.toLocalTimestamp(e);if(typeof e=="string"){if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}$/.test(e))return e;if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$/.test(e))return e.replace("Z","");let t=new Date(e);return isNaN(t.getTime())?e:Ga.DateFormatter.toLocalTimestamp(t)}if(typeof e=="number"){let t=new Date(e);if(!isNaN(t.getTime()))return Ga.DateFormatter.toLocalTimestamp(t)}return String(e)}formatInferredValue(e){return typeof e=="boolean"||typeof e=="number"?e:e instanceof Date?Ga.DateFormatter.toLocalTimestamp(e):typeof e=="string"?e.startsWith("[[")||e.startsWith('"[[')?this.formatWikilink(e):e:String(e)}ensureQuoted(e){return!e||e==='""'?'""':e.startsWith('"')&&e.endsWith('"')?e:`"${e}"`}generateYAML(e,t,n,i){let s=this.generate(e,t,n,i);return this.toYAML(s)}toYAML(e){return`---
${Object.entries(e).map(([n,i])=>{if(Array.isArray(i)){let s=i.map(a=>`  - ${a}`).join(`
`);return`${n}:
${s}`}return`${n}: ${i}`}).join(`
`)}
---`}};es.DynamicFrontmatterGenerator=Ad;es.DynamicFrontmatterGenerator=Ad=JA([(0,XA.injectable)()],Ad)});var Cd=y(rn=>{"use strict";var ex=rn&&rn.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},tx=rn&&rn.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},rx=rn&&rn.__param||function(r,e){return function(t,n){e(t,n,r)}};Object.defineProperty(rn,"__esModule",{value:!0});rn.PlanningService=void 0;var ag=Ye(),nx=Ps(),ix=pr(),sx=rt(),Od=class{static{o(this,"PlanningService")}constructor(e){this.vault=e,this.frontmatterService=new nx.FrontmatterService}async planOnToday(e){let t=this.vault.getAbstractFileByPath(e);if(!t||!this.isFile(t))throw new Error(`File not found: ${e}`);let n=await this.vault.read(t),i=ix.DateFormatter.getTodayStartTimestamp(),s=this.frontmatterService.updateProperty(n,"ems__Effort_plannedStartTimestamp",i);await this.vault.modify(t,s)}isFile(e){return"basename"in e}};rn.PlanningService=Od;rn.PlanningService=Od=ex([(0,ag.injectable)(),rx(0,(0,ag.inject)(sx.DI_TOKENS.IVaultAdapter)),tx("design:paramtypes",[Object])],Od)});var Fd=y(nn=>{"use strict";var ax=nn&&nn.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},ox=nn&&nn.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},cx=nn&&nn.__param||function(r,e){return function(t,n){e(t,n,r)}};Object.defineProperty(nn,"__esModule",{value:!0});nn.AssetConversionService=void 0;var og=Ye(),cg=Vt(),ux=Ps(),ru=md(),lx=rt(),Pd=class{static{o(this,"AssetConversionService")}constructor(e){this.vault=e,this.frontmatterService=new ux.FrontmatterService}async convertTaskToProject(e){try{let t=await this.vault.read(e),n=this.removeInstanceClassProperty(t);return n=this.frontmatterService.updateProperty(n,"exo__Instance_class",`["[[${cg.AssetClass.PROJECT}]]"]`),await this.vault.modify(e,n),ru.LoggingService.info(`Converted Task to Project: ${e.basename} (${e.path})`),e}catch(t){let n=`Failed to convert Task to Project: ${e.path}`;throw ru.LoggingService.error(n,t instanceof Error?t:void 0),new Error(n)}}async convertProjectToTask(e){try{let t=await this.vault.read(e),n=this.removeInstanceClassProperty(t);return n=this.frontmatterService.updateProperty(n,"exo__Instance_class",`["[[${cg.AssetClass.TASK}]]"]`),await this.vault.modify(e,n),ru.LoggingService.info(`Converted Project to Task: ${e.basename} (${e.path})`),e}catch(t){let n=`Failed to convert Project to Task: ${e.path}`;throw ru.LoggingService.error(n,t instanceof Error?t:void 0),new Error(n)}}removeInstanceClassProperty(e){let t=this.frontmatterService.parse(e);if(!t.exists)return e;let n=/^exo__Instance_class:.*$(\n  -.*$)*/gm,i=t.content.replace(n,"").replace(/\n\n+/g,`
`).trim();return e.replace(/^---\n[\s\S]*?\n---/,`---
${i}
---`)}};nn.AssetConversionService=Pd;nn.AssetConversionService=Pd=ax([(0,og.injectable)(),cx(0,(0,og.inject)(lx.DI_TOKENS.IVaultAdapter)),ox("design:paramtypes",[Object])],Pd)});var Rd=y(sn=>{"use strict";var fx=sn&&sn.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},hx=sn&&sn.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},dx=sn&&sn.__param||function(r,e){return function(t,n){e(t,n,r)}};Object.defineProperty(sn,"__esModule",{value:!0});sn.SessionEventService=void 0;var ug=Ye(),px=qr(),lg=Vt(),mx=pr(),gx=Br(),yx=rt(),Id=class{static{o(this,"SessionEventService")}constructor(e){this.vault=e,this.folderPathCache=null,this.defaultOntologyAsset=null}setDefaultOntologyAsset(e){this.defaultOntologyAsset=e,this.folderPathCache=null}async createSessionStartEvent(e){return this.createSessionEvent(e,lg.AssetClass.SESSION_START_EVENT)}async createSessionEndEvent(e){return this.createSessionEvent(e,lg.AssetClass.SESSION_END_EVENT)}async getOntologyAssetFolder(){if(this.folderPathCache!==null)return this.folderPathCache;if(!this.defaultOntologyAsset){let n=this.vault.getDefaultNewFileParent();return this.folderPathCache=n?.path||"",this.folderPathCache}let e=this.vault.getAllFiles();for(let n of e)if(n.basename===this.defaultOntologyAsset){let i=n.parent?.path||"";return this.folderPathCache=i,this.folderPathCache}let t=this.vault.getDefaultNewFileParent();return this.folderPathCache=t?.path||"",this.folderPathCache}async createSessionEvent(e,t){let n=(0,px.v4)(),i=mx.DateFormatter.toLocalTimestamp(new Date),s=this.defaultOntologyAsset?`"[[${this.defaultOntologyAsset}]]"`:'"[[!kitelev]]"',a={exo__Asset_uid:n,exo__Asset_createdAt:i,exo__Asset_isDefinedBy:s,exo__Instance_class:[`"[[${t}]]"`],ems__SessionEvent_timestamp:i,ems__Session_area:`"[[${e}]]"`},c=gx.MetadataHelpers.buildFileContent(a),u=await this.getOntologyAssetFolder();u&&!await this.vault.exists(u)&&await this.vault.createFolder(u);let f=u?`${u}/${n}.md`:`${n}.md`;return await this.vault.create(f,c)}};sn.SessionEventService=Id;sn.SessionEventService=Id=fx([(0,ug.injectable)(),dx(0,(0,ug.inject)(yx.DI_TOKENS.IVaultAdapter)),hx("design:paramtypes",[Object])],Id)});var Nd=y(an=>{"use strict";var _x=an&&an.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},vx=an&&an.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},Sx=an&&an.__param||function(r,e){return function(t,n){e(t,n,r)}};Object.defineProperty(an,"__esModule",{value:!0});an.URIConstructionService=void 0;var fg=Ye(),wx=rt(),Dd=class{static{o(this,"URIConstructionService")}constructor(e){this.fileSystem=e,this.defaultOntologyURL="https://exocortex.my/default/",this.strictValidation=!0}configure(e){e?.defaultOntologyURL&&(this.defaultOntologyURL=e.defaultOntologyURL),e?.strictValidation!==void 0&&(this.strictValidation=e.strictValidation)}async constructAssetURI(e){let t=this.extractUID(e);if(!t){if(this.strictValidation)throw new Error(`Asset missing exo__Asset_uid: ${e.path}`);return console.warn(`Asset ${e.path} missing UID, using filename fallback`),this.constructFallbackURI(e)}let n=await this.resolveOntologyURL(e);if(!this.validateOntologyURL(n))throw new Error(`Invalid ontology URL: ${n}`);return`${n.endsWith("/")?n:`${n}/`}${t}`}validateOntologyURL(e){if(!e)return!1;try{let t=new URL(e);return t.protocol==="http:"||t.protocol==="https:"}catch{return!1}}async resolveOntologyURL(e){let t=e.frontmatter?.exo__Asset_isDefinedBy;if(!t)return this.defaultOntologyURL;let n=this.extractWikiLink(t),i=n,s=await this.fileSystem.fileExists(n);return!s&&!n.endsWith(".md")&&(i=`${n}.md`,s=await this.fileSystem.fileExists(i)),s?(await this.fileSystem.getFileMetadata(i))?.exo__Ontology_url||this.defaultOntologyURL:(console.warn(`Ontology file not found: ${n}, using default`),this.defaultOntologyURL)}extractUID(e){return e.frontmatter?.exo__Asset_uid||null}extractWikiLink(e){return e.replace(/^\[\[|\]\]$/g,"")}constructFallbackURI(e){let t=e.path.split("/").pop()?.replace(".md","")||"unknown";return`${this.defaultOntologyURL}${t}`}};an.URIConstructionService=Dd;an.URIConstructionService=Dd=_x([(0,fg.injectable)(),Sx(0,(0,fg.inject)(wx.DI_TOKENS.IFileSystemAdapter)),vx("design:paramtypes",[Object])],Dd)});var hg=y(nu=>{"use strict";Object.defineProperty(nu,"__esModule",{value:!0});nu.EffortSortingHelpers=void 0;var kd=class r{static{o(this,"EffortSortingHelpers")}static getTimeFromTimestamp(e){if(!e)return"00:00:00";let t=new Date(e);if(isNaN(t.getTime()))return"00:00:00";let n=String(t.getHours()).padStart(2,"0"),i=String(t.getMinutes()).padStart(2,"0"),s=String(t.getSeconds()).padStart(2,"0");return`${n}:${i}:${s}`}static sortByStartTime(e,t){let n=r.getTimeFromTimestamp(e.startTimestamp),i=r.getTimeFromTimestamp(t.startTimestamp),s=n==="00:00:00",a=i==="00:00:00";return s&&!a?1:!s&&a?-1:n.localeCompare(i)}static sortByPriority(e,t){if(e.isTrashed!==t.isTrashed)return e.isTrashed?1:-1;if(e.isDone!==t.isDone)return e.isDone?1:-1;let n=typeof e.metadata.ems__Effort_votes=="number"?e.metadata.ems__Effort_votes:0,i=typeof t.metadata.ems__Effort_votes=="number"?t.metadata.ems__Effort_votes:0;return n!==i?i-n:e.startTime&&t.startTime?e.startTime.localeCompare(t.startTime):e.startTime?-1:t.startTime?1:0}};nu.EffortSortingHelpers=kd});var Md=y(iu=>{"use strict";Object.defineProperty(iu,"__esModule",{value:!0});iu.NTriplesSerializer=void 0;var jd=class{static{o(this,"NTriplesSerializer")}serialize(e,t={}){let n=t.newline??`
`;return e.length===0?"":e.map(i=>i.toString()).join(n)+n}serializeChunk(e,t){return e.length===0?"":e.map(n=>n.toString()).join(t)+t}};iu.NTriplesSerializer=jd});var dg=y(su=>{"use strict";Object.defineProperty(su,"__esModule",{value:!0});su.TurtleSerializer=void 0;var Fs=wn(),bx=Md(),Ex={rdf:Fs.Namespace.RDF.iri.value,rdfs:Fs.Namespace.RDFS.iri.value,owl:Fs.Namespace.OWL.iri.value,xsd:Fs.Namespace.XSD.iri.value,exo:Fs.Namespace.EXO.iri.value,ems:Fs.Namespace.EMS.iri.value},Ld=class{static{o(this,"TurtleSerializer")}constructor(){this.nTriplesSerializer=new bx.NTriplesSerializer}serialize(e,t={}){let n=t.newline??`
`,i=this.composePrefixes(t),s=this.serializePrefixes(i,n),a=this.nTriplesSerializer.serialize(e,{newline:n}).trimEnd();return s?a?`${s}${n}${n}${a}${n}`:`${s}${n}`:a?`${a}${n}`:""}serializePrefixes(e,t){let n=Object.entries(e);return n.length===0?"":n.map(([i,s])=>`@prefix ${i}: <${s}> .`).join(t)}composePrefixes(e){return e.includeDefaultPrefixes??!0?{...Ex,...e.prefixes??{}}:{...e.prefixes??{}}}serializeTriplesOnly(e,t){return this.nTriplesSerializer.serializeChunk(e,t).trimEnd()}};su.TurtleSerializer=Ld});var gg=y(au=>{"use strict";Object.defineProperty(au,"__esModule",{value:!0});au.JSONLDSerializer=void 0;var pg=gt(),mg=Pr(),Tx=Lt(),Is=wn(),Ax={rdf:Is.Namespace.RDF.iri.value,rdfs:Is.Namespace.RDFS.iri.value,owl:Is.Namespace.OWL.iri.value,xsd:Is.Namespace.XSD.iri.value,exo:Is.Namespace.EXO.iri.value,ems:Is.Namespace.EMS.iri.value},Vd=class{static{o(this,"JSONLDSerializer")}toDocument(e,t={}){let n={...Ax,...t.context??{}},i=new Map;for(let s of e){let a=this.subjectToId(s.subject),c=this.compactIri(s.predicate.value,n),u=this.objectToJSONLD(s.object,n),f=i.get(a)??{"@id":a},l=f[c];l===void 0?f[c]=u:Array.isArray(l)?l.push(u):f[c]=[l,u],i.set(a,f)}return{"@context":n,"@graph":Array.from(i.values())}}serialize(e,t={}){let n=this.toDocument(e,t),i=t.pretty?t.indent??2:void 0;return JSON.stringify(n,null,i)}subjectToId(e){return e instanceof pg.IRI?e.value:e instanceof mg.BlankNode?`_:${e.id}`:String(e)}compactIri(e,t){for(let[n,i]of Object.entries(t))if(e.startsWith(i)){let s=e.slice(i.length);if(s.length>0)return`${n}:${s}`}return e}objectToJSONLD(e,t){if(e instanceof pg.IRI)return{"@id":e.value};if(e instanceof mg.BlankNode)return{"@id":`_:${e.id}`};if(e instanceof Tx.Literal){let n={"@value":e.value};return e.datatype?n["@type"]=this.compactIri(e.datatype.value,t):e.language&&(n["@language"]=e.language),n}return e}};au.JSONLDSerializer=Vd});var Ud=y(ou=>{"use strict";Object.defineProperty(ou,"__esModule",{value:!0});ou.NTriplesParser=void 0;var xx=qi(),yg=gt(),qd=Lt(),Ox=Pr(),Rs=wn(),Cx={rdf:Rs.Namespace.RDF.iri.value,rdfs:Rs.Namespace.RDFS.iri.value,owl:Rs.Namespace.OWL.iri.value,xsd:Rs.Namespace.XSD.iri.value,exo:Rs.Namespace.EXO.iri.value,ems:Rs.Namespace.EMS.iri.value},Bd=class{static{o(this,"NTriplesParser")}parse(e,t={}){let n={prefixes:{...Cx,...t.prefixes??{}},strict:t.strict??!1},i=[];return e.split(/\r?\n/).forEach((a,c)=>{let u=a.trim();!u||u.startsWith("#")||i.push(this.parseLine(u,c+1,n))}),i}parseLine(e,t,n){if(!e.endsWith("."))throw new Error(`Invalid RDF statement at line ${t}: missing '.' terminator`);let s=e.slice(0,-1).trim(),a=this.parseSubject(s,t,n);s=a.rest.trim();let c=this.parsePredicate(s,t,n);s=c.rest.trim();let u=this.parseObject(s,t,n);if(s=u.rest.trim(),s.length>0)throw new Error(`Unexpected tokens after object at line ${t}`);return new xx.Triple(a.node,c.node,u.node)}parseSubject(e,t,n){return e.startsWith("<")?this.consumeIRI(e,t,n):e.startsWith("_:")?this.consumeBlankNode(e,t):this.consumePrefixedName(e,t,n)}parsePredicate(e,t,n){return e.startsWith("<")?this.consumeIRI(e,t,n):this.consumePrefixedName(e,t,n)}parseObject(e,t,n){return e.startsWith("<")?this.consumeIRI(e,t,n):e.startsWith("_:")?this.consumeBlankNode(e,t):e.startsWith('"')?this.consumeLiteral(e,t,n):this.consumePrefixedName(e,t,n)}consumePrefixedName(e,t,n){let i=e.match(/^([a-zA-Z_][\w-]*):([^\s]+)(?:\s+(.*))?$/);if(!i)throw new Error(`Invalid token at line ${t}: ${e}`);let[,s,a,c]=i,u=n.prefixes[s];if(!u)throw new Error(`Unknown prefix "${s}" at line ${t}`);return{node:new yg.IRI(`${u}${a}`),rest:(c??"").trimStart()}}consumeIRI(e,t,n){let i=this.findClosingBracket(e,"<",">");if(i===-1)throw new Error(`Invalid IRI at line ${t}`);let s=e.slice(1,i),a=new yg.IRI(s),c=e.slice(i+1).trimStart();return{node:a,rest:c}}consumeBlankNode(e,t){let n=e.match(/^_:(\w+)(?:\s+(.*))?$/);if(!n)throw new Error(`Invalid blank node identifier at line ${t}`);let[,i,s]=n;return{node:new Ox.BlankNode(i),rest:(s??"").trimStart()}}consumeLiteral(e,t,n){let{value:i,rest:s}=this.consumeQuotedString(e,t),a=s.trimStart();if(a.startsWith("^^")){a=a.slice(2).trimStart();let c=a.startsWith("<")?this.consumeIRI(a,t,n):this.consumePrefixedName(a,t,n);return{node:new qd.Literal(i,c.node),rest:c.rest}}if(a.startsWith("@")){let c=a.match(/^@([a-zA-Z-]+)(?:\s+(.*))?$/);if(!c)throw new Error(`Invalid language tag at line ${t}`);let[,u,f]=c;return{node:new qd.Literal(i,void 0,u),rest:(f??"").trimStart()}}return{node:new qd.Literal(i),rest:a}}consumeQuotedString(e,t){if(!e.startsWith('"'))throw new Error(`Expected quoted string at line ${t}`);let n="";for(let i=1;i<e.length;i++){let s=e[i];if(s==="\\"){if(i+1>=e.length)throw new Error(`Invalid escape sequence at line ${t}`);let a=e[i+1];switch(a){case"t":n+="	",i+=1;break;case"b":n+="\b",i+=1;break;case"n":n+=`
`,i+=1;break;case"r":n+="\r",i+=1;break;case"f":n+="\f",i+=1;break;case'"':n+='"',i+=1;break;case"\\":n+="\\",i+=1;break;case"u":{let c=e.slice(i+2,i+6);if(c.length!==4||!/^[0-9a-fA-F]{4}$/.test(c))throw new Error(`Invalid \\u escape at line ${t}`);n+=String.fromCharCode(parseInt(c,16)),i+=5;break}case"U":{let c=e.slice(i+2,i+10);if(c.length!==8||!/^[0-9a-fA-F]{8}$/.test(c))throw new Error(`Invalid \\U escape at line ${t}`);n+=String.fromCodePoint(parseInt(c,16)),i+=9;break}default:throw new Error(`Unknown escape sequence \\${a} at line ${t}`)}continue}if(s==='"'){let a=e.slice(i+1);return{value:n,rest:a}}n+=s}throw new Error(`Unterminated string literal at line ${t}`)}findClosingBracket(e,t,n){let i=0;for(let s=0;s<e.length;s++){let a=e[s];if(a===t){i++;continue}if(a===n&&(i--,i===0))return s}return-1}};ou.NTriplesParser=Bd});var _g=y(cu=>{"use strict";Object.defineProperty(cu,"__esModule",{value:!0});cu.TurtleParser=void 0;var Ds=wn(),Px=Ud(),Fx={rdf:Ds.Namespace.RDF.iri.value,rdfs:Ds.Namespace.RDFS.iri.value,owl:Ds.Namespace.OWL.iri.value,xsd:Ds.Namespace.XSD.iri.value,exo:Ds.Namespace.EXO.iri.value,ems:Ds.Namespace.EMS.iri.value},Ix=/^@prefix\s+([a-zA-Z_][\w-]*):\s*<([^>]+)>\s*\.$/,$d=class{static{o(this,"TurtleParser")}constructor(){this.nTriplesParser=new Px.NTriplesParser}parse(e,t={}){let n={...Fx,...t.prefixes??{}},i=this.collectStatements(e),s=[];return i.forEach(({statement:a,lineNumber:c})=>{if(this.isPrefixStatement(a)){let f=a.match(Ix);if(!f)throw new Error(`Invalid prefix declaration at line ${c}`);let[,l,h]=f;n[l]=h;return}if(a.includes(";")||a.includes(","))throw new Error(`Complex Turtle statements with ';' or ',' are not supported (line ${c})`);let u=this.normalizeShortcuts(a);s.push(this.nTriplesParser.parseLine(u,c,{prefixes:n,strict:!1}))}),s}collectStatements(e){let t=e.split(/\r?\n/),n=[],i="",s=0;if(t.forEach((a,c)=>{let u=a.trim();!u||u.startsWith("#")||(i||(s=c+1),i=i?`${i} ${u}`:u,u.endsWith(".")&&(n.push({statement:i,lineNumber:s}),i=""))}),i)throw new Error(`Unterminated Turtle statement near line ${s}`);return n}isPrefixStatement(e){return e.startsWith("@prefix")}normalizeShortcuts(e){return e.includes(" a ")?e.replace(/\sa\s/g," rdf:type "):e}};cu.TurtleParser=$d});var vg=y(uu=>{"use strict";Object.defineProperty(uu,"__esModule",{value:!0});uu.RDFSerializer=void 0;var Ns=qi(),ts=gt(),ks=Lt(),Wd=Pr(),En=wn(),Rx=dg(),Dx=Md(),Nx=gg(),kx=_g(),jx=Ud(),Mx=1024,Lx=`
`,Vx={rdf:En.Namespace.RDF.iri.value,rdfs:En.Namespace.RDFS.iri.value,owl:En.Namespace.OWL.iri.value,xsd:En.Namespace.XSD.iri.value,exo:En.Namespace.EXO.iri.value,ems:En.Namespace.EMS.iri.value},Gd=class{static{o(this,"RDFSerializer")}constructor(e){this.store=e,this.turtleSerializer=new Rx.TurtleSerializer,this.nTriplesSerializer=new Dx.NTriplesSerializer,this.jsonldSerializer=new Nx.JSONLDSerializer,this.turtleParser=new kx.TurtleParser,this.nTriplesParser=new jx.NTriplesParser}async serialize(e,t={}){let n=await this.store.match();return this.serializeTriples(n,e,t)}serializeTriples(e,t,n={}){switch(t){case"turtle":return this.turtleSerializer.serialize(e,{prefixes:n.prefixes,includeDefaultPrefixes:n.includeDefaultPrefixes,newline:n.newline});case"n-triples":return this.nTriplesSerializer.serialize(e,{newline:n.newline});case"json-ld":return this.jsonldSerializer.serialize(e,{context:n.prefixes,pretty:n.pretty,indent:n.indent});default:throw new Error(`Unsupported serialization format: ${t}`)}}stream(e,t={}){let n=t.newline??Lx,i=t.batchSize??Mx,s=t.includeDefaultPrefixes,a=t.prefixes,c=this,u=!1,f=[],l=[],h=0,p=o(async()=>{if(!u){if(l=await c.store.match(),e==="json-ld"){let w=c.jsonldSerializer.toDocument(l,{context:a,pretty:!1});f.push(...c.buildJsonLdChunks(w))}else if(e==="turtle"){let w=c.turtleSerializer.serializePrefixes(c.composePrefixes(a,s),n);w&&f.push(`${w}${n}${n}`)}u=!0}},"ensureInitialized");return{async next(){if(await p(),f.length>0)return{value:f.shift(),done:!1};if(e==="json-ld")return{value:void 0,done:!0};if(h>=l.length)return{value:void 0,done:!0};let w=l.slice(h,h+i);h+=w.length;let S="";if(e==="turtle"){let x=c.turtleSerializer.serializeTriplesOnly(w,n);x&&(S=`${x}${n}`)}else e==="n-triples"&&(S=c.nTriplesSerializer.serializeChunk(w,n));return S?{value:S,done:!1}:this.next()},async return(){return f=[],l=[],h=0,{value:void 0,done:!0}},[Symbol.asyncIterator](){return this}}}async load(e,t,n={}){let i=this.parse(e,t,n);return n.mode!=="append"&&await this.store.clear(),await this.store.addAll(i),i.length}parse(e,t,n={}){switch(t){case"turtle":return this.turtleParser.parse(e,this.buildTurtleParseOptions(n));case"n-triples":return this.nTriplesParser.parse(e,this.buildNTriplesParseOptions(n));case"json-ld":return this.parseJsonLd(e,n);default:throw new Error(`Unsupported serialization format: ${t}`)}}buildTurtleParseOptions(e){return{prefixes:this.composePrefixes(e.prefixes,!0),strict:e.strict}}buildNTriplesParseOptions(e){return{prefixes:this.composePrefixes(e.prefixes,!0),strict:e.strict}}composePrefixes(e,t){return t??!0?{...Vx,...e??{}}:{...e??{}}}parseJsonLd(e,t){let n;try{n=JSON.parse(e)}catch(f){throw new Error(`Invalid JSON-LD document: ${f.message}`)}let i=this.composePrefixes(t.prefixes,!0),s=this.extractContext(n),a={...i,...s},c=this.extractGraph(n),u=[];return c.forEach((f,l)=>{if(!f||typeof f!="object"||Array.isArray(f))throw new Error(`Invalid JSON-LD node at index ${l}`);let h=this.parseSubjectFromNode(f,a,l),p=Object.entries(f);for(let[g,w]of p){if(g==="@id"||g==="@context")continue;if(g==="@type"){this.collectTypeTriples(h,w,u,a);continue}let S=this.expandTerm(g,a),x=new ts.IRI(S);this.collectTriplesForValue(h,x,w,u,a)}}),u}extractContext(e){if(!e||typeof e!="object"||Array.isArray(e))return{};let t=e["@context"];if(!t||typeof t!="object"||Array.isArray(t))return{};let n={};return Object.entries(t).forEach(([i,s])=>{typeof s=="string"&&(n[i]=s)}),n}extractGraph(e){if(Array.isArray(e))return e;if(!e||typeof e!="object")return[];let t=e["@graph"];return Array.isArray(t)?t:[e]}parseSubjectFromNode(e,t,n){let i=e["@id"];if(typeof i=="string"){if(i.startsWith("_:"))return new Wd.BlankNode(i.slice(2));if(this.isAbsoluteIri(i))return new ts.IRI(i);let s=this.expandTerm(i,t);return new ts.IRI(s)}return new Wd.BlankNode(`jsonld_${n}`)}collectTypeTriples(e,t,n,i){let s=En.Namespace.RDF.term("type");(Array.isArray(t)?t:[t]).forEach(c=>{if(typeof c!="string")throw new Error("Invalid @type value in JSON-LD node");let u=this.expandTerm(c,i);n.push(new Ns.Triple(e,s,new ts.IRI(u)))})}collectTriplesForValue(e,t,n,i,s){if(n!=null){if(Array.isArray(n)){n.forEach(a=>this.collectTriplesForValue(e,t,a,i,s));return}if(typeof n=="object"){let a=n;if(typeof a["@id"]=="string"){let c=this.parseIdNode(a["@id"],s);i.push(new Ns.Triple(e,t,c));return}if(a["@value"]!==void 0){let c=this.parseLiteralObject(a,s);i.push(new Ns.Triple(e,t,c));return}}if(typeof n=="string"){i.push(new Ns.Triple(e,t,new ks.Literal(n)));return}if(typeof n=="number"){let a=Number.isInteger(n)?En.Namespace.XSD.term("integer"):En.Namespace.XSD.term("decimal");i.push(new Ns.Triple(e,t,new ks.Literal(n.toString(),a)));return}if(typeof n=="boolean"){let a=En.Namespace.XSD.term("boolean");i.push(new Ns.Triple(e,t,new ks.Literal(n.toString(),a)));return}throw new Error("Unsupported JSON-LD value encountered")}}parseIdNode(e,t){if(e.startsWith("_:"))return new Wd.BlankNode(e.slice(2));if(this.isAbsoluteIri(e))return new ts.IRI(e);let n=this.expandTerm(e,t);return new ts.IRI(n)}parseLiteralObject(e,t){let n=e["@value"];if(typeof n!="string")throw new Error("JSON-LD literal values must be strings");if(typeof e["@language"]=="string")return new ks.Literal(n,void 0,e["@language"]);if(typeof e["@type"]=="string"){let i=this.expandTerm(e["@type"],t);return new ks.Literal(n,new ts.IRI(i))}return new ks.Literal(n)}expandTerm(e,t){if(this.isAbsoluteIri(e))return e;let n=e.indexOf(":");if(n>0){let s=e.slice(0,n),a=e.slice(n+1),c=t[s];if(!c)throw new Error(`Unknown prefix "${s}" in JSON-LD document`);return`${c}${a}`}let i=t["@vocab"];if(i)return`${i}${e}`;throw new Error(`Unable to expand JSON-LD term "${e}"`)}isAbsoluteIri(e){return/^[a-z][a-z0-9+.-]*:/i.test(e)}buildJsonLdChunks(e){let t=[],n=JSON.stringify(e["@context"]);return t.push(`{"@context":${n},"@graph":[`),e["@graph"].forEach((i,s)=>{let a=JSON.stringify(i);s>0?t.push(`,${a}`):t.push(a)}),t.push(`]}
`),t}};uu.RDFSerializer=Gd});var Sg=y(pi=>{"use strict";Object.defineProperty(pi,"__esModule",{value:!0});pi.TransactionError=pi.TripleNotFoundError=pi.TripleAlreadyExistsError=void 0;var Hd=class extends Error{static{o(this,"TripleAlreadyExistsError")}constructor(e){super(`Triple already exists: ${e.toString()}`),this.name="TripleAlreadyExistsError"}};pi.TripleAlreadyExistsError=Hd;var zd=class extends Error{static{o(this,"TripleNotFoundError")}constructor(e){super(`Triple not found: ${e.toString()}`),this.name="TripleNotFoundError"}};pi.TripleNotFoundError=zd;var Kd=class extends Error{static{o(this,"TransactionError")}constructor(e){super(e),this.name="TransactionError"}};pi.TransactionError=Kd});var Qd=y(lu=>{"use strict";Object.defineProperty(lu,"__esModule",{value:!0});lu.LRUCache=void 0;var Yd=class{static{o(this,"LRUCache")}constructor(e){this.maxSize=e,this.cache=new Map}get(e){let t=this.cache.get(e);return t!==void 0&&(this.cache.delete(e),this.cache.set(e,t)),t}set(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){let n=this.cache.keys().next().value;n!==void 0&&this.cache.delete(n)}this.cache.set(e,t)}clear(){this.cache.clear()}size(){return this.cache.size}};lu.LRUCache=Yd});var wg=y(fu=>{"use strict";Object.defineProperty(fu,"__esModule",{value:!0});fu.InMemoryTripleStore=void 0;var mi=Sg(),qx=gt(),Bx=Pr(),Ux=Lt(),$x=wn(),Wx=Qd(),Gx=$x.Namespace.XSD.term("string").value,Jd=class{static{o(this,"InMemoryTripleStore")}constructor(){this.triples=new Map,this.spo=new Map,this.sop=new Map,this.pso=new Map,this.pos=new Map,this.osp=new Map,this.ops=new Map,this.queryCache=new Wx.LRUCache(1e3)}async add(e){let t=this.getTripleKey(e);if(this.triples.has(t))return;this.triples.set(t,e);let n=this.getNodeKey(e.subject),i=this.getNodeKey(e.predicate),s=this.getNodeKey(e.object);this.addToIndex(this.spo,n,i,s),this.addToIndex(this.sop,n,s,i),this.addToIndex(this.pso,i,n,s),this.addToIndex(this.pos,i,s,n),this.addToIndex(this.osp,s,n,i),this.addToIndex(this.ops,s,i,n),this.queryCache.clear()}async remove(e){let t=this.getTripleKey(e);if(!this.triples.has(t))return!1;this.triples.delete(t);let n=this.getNodeKey(e.subject),i=this.getNodeKey(e.predicate),s=this.getNodeKey(e.object);return this.removeFromIndex(this.spo,n,i,s),this.removeFromIndex(this.sop,n,s,i),this.removeFromIndex(this.pso,i,n,s),this.removeFromIndex(this.pos,i,s,n),this.removeFromIndex(this.osp,s,n,i),this.removeFromIndex(this.ops,s,i,n),this.queryCache.clear(),!0}async has(e){let t=this.getTripleKey(e);return this.triples.has(t)}async match(e,t,n){let i=this.getMatchCacheKey(e,t,n),s=this.queryCache.get(i);if(s!==void 0)return s;let a;return!e&&!t&&!n?a=Array.from(this.triples.values()):e&&t&&n?a=this.matchSPO(e,t,n):e&&t?a=this.matchSP(e,t):e&&n?a=this.matchSO(e,n):t&&n?a=this.matchPO(t,n):e?a=this.matchS(e):t?a=this.matchP(t):n?a=this.matchO(n):a=[],this.queryCache.set(i,a),a}async addAll(e){for(let t of e)await this.add(t)}async removeAll(e){let t=0;for(let n of e)await this.remove(n)&&t++;return t}async clear(){this.triples.clear(),this.spo.clear(),this.sop.clear(),this.pso.clear(),this.pos.clear(),this.osp.clear(),this.ops.clear(),this.queryCache.clear()}async count(){return this.triples.size}async subjects(){let e=new Set;for(let t of this.triples.values())e.add(t.subject);return Array.from(e)}async predicates(){let e=new Set;for(let t of this.triples.values())e.add(t.predicate);return Array.from(e)}async objects(){let e=new Set;for(let t of this.triples.values())e.add(t.object);return Array.from(e)}async beginTransaction(){return new Xd(this)}matchSPO(e,t,n){let i=this.getNodeKey(e),s=this.getNodeKey(t),a=this.getNodeKey(n),c=this.spo.get(i);if(!c)return[];let u=c.get(s);if(!u)return[];if(u.has(a)){let f=this.buildTripleKey(i,s,a),l=this.triples.get(f);return l?[l]:[]}return[]}matchSP(e,t){let n=this.getNodeKey(e),i=this.getNodeKey(t),s=this.spo.get(n);if(!s)return[];let a=s.get(i);return a?this.getTriplesByKeys(Array.from(a).map(c=>this.buildTripleKey(n,i,c))):[]}matchSO(e,t){let n=this.getNodeKey(e),i=this.getNodeKey(t),s=this.sop.get(n);if(!s)return[];let a=s.get(i);return a?this.getTriplesByKeys(Array.from(a).map(c=>this.buildTripleKey(n,c,i))):[]}matchPO(e,t){let n=this.getNodeKey(e),i=this.getNodeKey(t),s=this.pos.get(n);if(!s)return[];let a=s.get(i);return a?this.getTriplesByKeys(Array.from(a).map(c=>this.buildTripleKey(c,n,i))):[]}matchS(e){let t=this.getNodeKey(e),n=this.spo.get(t);if(!n)return[];let i=[];for(let[s,a]of n.entries())for(let c of a)i.push(this.buildTripleKey(t,s,c));return this.getTriplesByKeys(i)}matchP(e){let t=this.getNodeKey(e),n=this.pso.get(t);if(!n)return[];let i=[];for(let[s,a]of n.entries())for(let c of a)i.push(this.buildTripleKey(s,t,c));return this.getTriplesByKeys(i)}matchO(e){let t=this.getNodeKey(e),n=this.osp.get(t);if(!n)return[];let i=[];for(let[s,a]of n.entries())for(let c of a)i.push(this.buildTripleKey(s,c,t));return this.getTriplesByKeys(i)}getTriplesByKeys(e){let t=[];for(let n of e){let i=this.triples.get(n);i&&t.push(i)}return t}addToIndex(e,t,n,i){e.has(t)||e.set(t,new Map);let s=e.get(t);s.has(n)||s.set(n,new Set),s.get(n).add(i)}removeFromIndex(e,t,n,i){let s=e.get(t);if(!s)return;let a=s.get(n);a&&(a.delete(i),a.size===0&&s.delete(n),s.size===0&&e.delete(t))}getTripleKey(e){let t=this.getNodeKey(e.subject),n=this.getNodeKey(e.predicate),i=this.getNodeKey(e.object);return this.buildTripleKey(t,n,i)}buildTripleKey(e,t,n){return`${e}|${t}|${n}`}getNodeKey(e){if(e instanceof qx.IRI)return`i:${e.value}`;if(e instanceof Bx.BlankNode)return`b:${e.id}`;if(e instanceof Ux.Literal){let t=`l:${e.value}`;return e.datatype&&e.datatype.value!==Gx?t+=`^^${e.datatype.value}`:e.language&&(t+=`@${e.language}`),t}return""}getMatchCacheKey(e,t,n){let i=e?this.getNodeKey(e):"?",s=t?this.getNodeKey(t):"?",a=n?this.getNodeKey(n):"?";return`${i}|${s}|${a}`}};fu.InMemoryTripleStore=Jd;var Xd=class{static{o(this,"InMemoryTransaction")}constructor(e){this.store=e,this.operations=[],this.committed=!1,this.rolledBack=!1}async add(e){if(this.committed)throw new mi.TransactionError("Transaction already committed");if(this.rolledBack)throw new mi.TransactionError("Transaction already rolled back");this.operations.push({type:"add",triple:e})}async remove(e){if(this.committed)throw new mi.TransactionError("Transaction already committed");if(this.rolledBack)throw new mi.TransactionError("Transaction already rolled back");return this.operations.push({type:"remove",triple:e}),!0}async commit(){if(this.committed)throw new mi.TransactionError("Transaction already committed");if(this.rolledBack)throw new mi.TransactionError("Transaction already rolled back");for(let e of this.operations)e.type==="add"?await this.store.add(e.triple):await this.store.remove(e.triple);this.committed=!0,this.operations=[]}async rollback(){if(this.committed)throw new mi.TransactionError("Transaction already committed");if(this.rolledBack)throw new mi.TransactionError("Transaction already rolled back");this.operations=[],this.rolledBack=!0}}});var Eg=y(hu=>{"use strict";Object.defineProperty(hu,"__esModule",{value:!0});hu.RDFVocabularyMapper=void 0;var Sr=qi(),bg=gt(),he=wn(),Zd=class{static{o(this,"RDFVocabularyMapper")}constructor(){this.propertyMappings=new Map([["exo__Instance_class",he.Namespace.RDF.term("type")],["exo__Asset_isDefinedBy",he.Namespace.RDFS.term("isDefinedBy")],["exo__Class_superClass",he.Namespace.RDFS.term("subClassOf")],["exo__Property_range",he.Namespace.RDFS.term("range")],["exo__Property_domain",he.Namespace.RDFS.term("domain")],["exo__Property_superProperty",he.Namespace.RDFS.term("subPropertyOf")]])}generateClassHierarchyTriples(){let e=[];return e.push(new Sr.Triple(he.Namespace.EXO.term("Asset"),he.Namespace.RDFS.term("subClassOf"),he.Namespace.RDFS.term("Resource"))),e.push(new Sr.Triple(he.Namespace.EXO.term("Class"),he.Namespace.RDFS.term("subClassOf"),he.Namespace.RDFS.term("Class"))),e.push(new Sr.Triple(he.Namespace.EXO.term("Property"),he.Namespace.RDFS.term("subClassOf"),he.Namespace.RDF.term("Property"))),e.push(new Sr.Triple(he.Namespace.EMS.term("Task"),he.Namespace.RDFS.term("subClassOf"),he.Namespace.EXO.term("Asset"))),e.push(new Sr.Triple(he.Namespace.EMS.term("Project"),he.Namespace.RDFS.term("subClassOf"),he.Namespace.EXO.term("Asset"))),e.push(new Sr.Triple(he.Namespace.EMS.term("Area"),he.Namespace.RDFS.term("subClassOf"),he.Namespace.EXO.term("Asset"))),e}generatePropertyHierarchyTriples(){let e=[];return e.push(new Sr.Triple(he.Namespace.EXO.term("Instance_class"),he.Namespace.RDFS.term("subPropertyOf"),he.Namespace.RDF.term("type"))),e.push(new Sr.Triple(he.Namespace.EXO.term("Asset_isDefinedBy"),he.Namespace.RDFS.term("subPropertyOf"),he.Namespace.RDFS.term("isDefinedBy"))),e.push(new Sr.Triple(he.Namespace.EXO.term("Class_superClass"),he.Namespace.RDFS.term("subPropertyOf"),he.Namespace.RDFS.term("subClassOf"))),e.push(new Sr.Triple(he.Namespace.EXO.term("Property_range"),he.Namespace.RDFS.term("subPropertyOf"),he.Namespace.RDFS.term("range"))),e.push(new Sr.Triple(he.Namespace.EXO.term("Property_domain"),he.Namespace.RDFS.term("subPropertyOf"),he.Namespace.RDFS.term("domain"))),e.push(new Sr.Triple(he.Namespace.EXO.term("Property_superProperty"),he.Namespace.RDFS.term("subPropertyOf"),he.Namespace.RDFS.term("subPropertyOf"))),e}generateMappedTriple(e,t,n){let i=this.propertyMappings.get(t);if(!i)return null;let s;if(n instanceof bg.IRI)s=n;else{let a=n.match(/^(ems|exo)__(.+)$/);if(a){let[,c,u]=a;s=(c==="ems"?he.Namespace.EMS:he.Namespace.EXO).term(u)}else s=new bg.IRI(n)}return new Sr.Triple(e,i,s)}hasMappingFor(e){return this.propertyMappings.has(e)}};hu.RDFVocabularyMapper=Zd});var tp=y(on=>{"use strict";var Hx=on&&on.__decorate||function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},zx=on&&on.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},Kx=on&&on.__param||function(r,e){return function(t,n){e(t,n,r)}};Object.defineProperty(on,"__esModule",{value:!0});on.NoteToRDFConverter=void 0;var Tg=Ye(),du=qi(),Yx=gt(),Tn=Lt(),Kn=wn(),Qx=rt(),ep=class{static{o(this,"NoteToRDFConverter")}constructor(e){this.vault=e,this.OBSIDIAN_VAULT_SCHEME="obsidian://vault/"}async convertNote(e){let t=this.vault.getFrontmatter(e);if(!t)return[];let n=[],i=this.notePathToIRI(e.path),s=Kn.Namespace.EXO.term("Asset_fileName");n.push(new du.Triple(i,s,new Tn.Literal(e.basename)));for(let[a,c]of Object.entries(t)){if(!this.isExocortexProperty(a))continue;let u=this.propertyKeyToIRI(a),f=Array.isArray(c)?c:[c];for(let l of f)if(a==="exo__Instance_class"){let h=this.valueToClassURI(l);n.push(new du.Triple(i,u,h))}else{let h=await this.valueToRDFObject(l,e);n.push(new du.Triple(i,u,h))}if(a==="exo__Instance_class")for(let l of f){let h=this.expandClassValue(l);if(h){let p=Kn.Namespace.RDF.term("type");n.push(new du.Triple(i,p,h))}}}return n}async convertVault(){let e=this.vault.getAllFiles(),t=[];for(let n of e)try{let i=await this.convertNote(n);t.push(...i)}catch(i){console.warn(`\u26A0\uFE0F Skipping file with invalid IRI: ${n.path}`),console.warn(`   Reason: ${i instanceof Error?i.message:String(i)}`);continue}return t}notePathToIRI(e){let t=encodeURI(e);return new Yx.IRI(`${this.OBSIDIAN_VAULT_SCHEME}${t}`)}isExocortexProperty(e){return e.startsWith("exo__")||e.startsWith("ems__")}propertyKeyToIRI(e){if(e.startsWith("exo__")){let t=e.substring(5);return Kn.Namespace.EXO.term(t)}if(e.startsWith("ems__")){let t=e.substring(5);return Kn.Namespace.EMS.term(t)}throw new Error(`Invalid property key: ${e}`)}async valueToRDFObject(e,t){if(typeof e=="string"){let n=this.removeQuotes(e),i=this.extractWikilink(n);if(i){let s=this.vault.getFirstLinkpathDest(i,t.path);if(s)return this.notePathToIRI(s.path);if(this.isClassReference(i)){let a=this.expandClassValue(i);if(a)return a}return new Tn.Literal(n)}if(this.isClassReference(n)){let s=this.expandClassValue(n);if(s)return s}return this.isISO8601DateTime(n)?new Tn.Literal(n,Kn.Namespace.XSD.term("dateTime")):new Tn.Literal(n)}return typeof e=="boolean"?new Tn.Literal(e.toString()):typeof e=="number"?new Tn.Literal(e.toString(),Kn.Namespace.XSD.term("decimal")):e instanceof Date?new Tn.Literal(e.toISOString(),Kn.Namespace.XSD.term("dateTime")):new Tn.Literal(String(e))}isISO8601DateTime(e){return/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{1,3})?(Z|[+-]\d{2}:\d{2})?$/.test(e)}removeQuotes(e){let t=e.trim();return t.startsWith('"')&&t.endsWith('"')||t.startsWith("'")&&t.endsWith("'")?t.substring(1,t.length-1):e}extractWikilink(e){let t=e.match(/^\[\[([^\]]+)\]\]$/);return t?t[1]:null}valueToClassURI(e){if(typeof e!="string")return new Tn.Literal(String(e));let t=this.removeQuotes(e),i=this.extractWikilink(t)||t,s=this.expandClassValue(i);return s||new Tn.Literal(t)}isClassReference(e){return(e.startsWith("ems__")||e.startsWith("exo__"))&&!/\s/.test(e)}expandClassValue(e){let t=this.removeQuotes(e);if(t.startsWith("ems__")){let n=t.substring(5);return Kn.Namespace.EMS.term(n)}if(t.startsWith("exo__")){let n=t.substring(5);return Kn.Namespace.EXO.term(n)}return null}};on.NoteToRDFConverter=ep;on.NoteToRDFConverter=ep=Hx([(0,Tg.injectable)(),Kx(0,(0,Tg.inject)(Qx.DI_TOKENS.IVaultAdapter)),zx("design:paramtypes",[Object])],ep)});var rp=y((kk,Ag)=>{var js=class{static{o(this,"Wildcard")}constructor(){return Jx||this}equals(e){return e&&this.termType===e.termType}};Object.defineProperty(js.prototype,"value",{enumerable:!0,value:"*"});Object.defineProperty(js.prototype,"termType",{enumerable:!0,value:"Wildcard"});var Jx=new js;Ag.exports.Wildcard=js});var Og=y((Mk,xg)=>{var Xx=(function(){var r=o(function(A,E,O,I){for(O=O||{},I=A.length;I--;O[A[I]]=E);return O},"o"),e=[6,12,13,15,16,24,32,36,41,45,100,110,113,115,116,123,126,131,197,224,229,308,329,330,331,332,333],t=[2,247],n=[100,110,113,115,116,123,126,131,329,330,331,332,333],i=[2,409],s=[1,18],a=[1,27],c=[13,16,45,197,224,229,308],u=[28,29,53],f=[28,53],l=[1,42],h=[1,45],p=[1,41],g=[1,44],w=[123,126],S=[1,67],x=[39,45,87],P=[13,16,45,197,224,308],F=[1,87],L=[2,281],$=[1,86],K=[13,16,45,82,87,89,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312],Fe=[6,28,29,53,63,70,73,81,83,85],Xe=[6,13,16,28,29,53,63,70,73,81,83,85,87,308],at=[6,13,16,28,29,45,53,63,70,73,81,82,83,85,87,89,197,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314],B=[6,13,16,28,29,31,39,45,47,48,53,63,70,73,81,82,83,85,87,89,109,112,121,123,126,128,159,160,161,163,164,174,193,197,224,229,231,232,242,246,250,263,265,272,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314,317,318,335,337,338,340,341,342,343,344,345,346],ce=[13,16,308],Ce=[112,132,327,334],Ze=[13,16,112,132,308],Ge=[1,111],ze=[1,117],Ne=[112,132,327,328,334],ke=[13,16,112,132,308,328],Pe=[28,29,45,53,87],G=[1,138],D=[1,151],je=[1,128],Be=[1,127],j=[1,129],le=[1,140],be=[1,141],W=[1,142],Ee=[1,143],Te=[1,144],_e=[1,145],Ae=[1,147],ue=[1,148],ve=[2,457],fe=[1,158],Se=[1,159],xe=[1,160],J=[1,152],te=[1,153],re=[1,156],X=[1,171],Z=[1,172],ee=[1,173],Q=[1,174],ne=[1,175],ie=[1,176],se=[1,167],ae=[1,168],Y=[1,169],oe=[1,170],De=[1,157],Oe=[1,166],me=[1,161],_=[1,162],v=[1,163],b=[1,164],C=[1,165],V=[6,13,16,29,31,45,82,85,87,89,112,159,160,161,163,164,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335],ge=[1,195],$e=[6,31,73,81,83,85],ye=[2,285],N=[1,199],k=[1,201],M=[6,31,70,73,81,83,85],q=[2,283],de=[1,207],Me=[1,218],Le=[1,223],xt=[1,219],cr=[1,225],yr=[1,226],Kt=[1,224],s1=[6,63,70,73,81,83,85],a1=[1,236],o1=[2,334],c1=[1,243],u1=[1,241],Ot=[6,193],Lo=[2,349],l1=[2,339],si=[28,128],f1=[47,48,193,272],Vo=[47,48,193,242,272],ms=[47,48,193,242,246,272],gs=[47,48,193,242,246,250,263,265,272,290,297,298,299,300,301,302,341,342,343,344,345,346],St=[39,47,48,193,242,246,250,263,265,272,290,297,298,299,300,301,302,338,341,342,343,344,345,346],h1=[1,271],d1=[1,270],lt=[6,13,16,29,31,39,45,47,48,70,73,76,78,81,82,83,85,87,89,112,159,160,161,163,164,193,231,242,246,250,263,265,268,269,270,271,272,273,274,276,277,279,280,283,285,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335,338,341,342,343,344,345,346,347,348,349,350,351],p1=[1,281],m1=[1,280],Yt=[13,16,29,31,39,45,47,48,82,85,87,89,112,159,160,161,163,164,174,193,197,224,229,231,232,242,246,250,263,265,272,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314,317,318,335,338,341,342,343,344,345,346],va=[45,89],qo=[13,16,29,31,39,45,47,48,82,85,87,89,112,159,160,161,163,164,174,193,197,224,229,231,232,242,246,250,263,265,272,290,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314,317,318,335,338,341,342,343,344,345,346],Bo=[13,16,31,82,174,294,295,296,297,298,299,300,301,302,303,304,305,306,308,312],Uo=[31,89],$o=[48,87],Fi=[6,13,16,45,48,82,87,89,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,337,338],pn=[6,13,16,39,45,48,82,87,89,231,263,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,337,338,340],g1=[1,313],ys=[6,85],ql=[6,31,81,83,85],y1=[2,361],Nn=[2,353],Ii=[1,343],Sa=[31,112,335],kn=[13,16,29,31,45,48,82,85,87,89,112,159,160,161,163,164,193,197,224,229,231,232,272,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,317,318,335],Bl=[13,16,29,31,45,48,82,85,87,89,112,159,160,161,163,164,193,197,224,229,231,232,272,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314,317,318,335],_1=[6,109,193],Ri=[31,112],ft=[13,16,45,82,87,224,263,265,268,269,270,271,273,274,276,277,279,280,283,285,294,295,296,297,298,299,300,301,302,303,304,305,306,308,312,346,347,348,349,350,351],Ul=[1,390],$l=[1,391],ai=[13,16,87,197,308,314],v1=[13,16,39,45,82,87,224,263,265,268,269,270,271,273,274,276,277,279,280,283,285,294,295,296,297,298,299,300,301,302,303,304,305,306,308,312,346,347,348,349,350,351],Wo=[1,417],Go=[1,418],S1=[13,16,48,197,229,308],oi=[6,31,85],w1=[6,13,16,31,45,73,81,83,85,268,269,270,271,273,274,276,277,279,280,283,285,308,346,347,348,349,350,351],Wl=[6,13,16,29,31,45,73,76,78,81,82,83,85,87,89,112,159,160,161,163,164,231,268,269,270,271,273,274,276,277,279,280,283,285,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335,346,347,348,349,350,351],Di=[29,31,85,112,159,160,161,163,164],Ho=[1,443],zo=[1,444],b1=[1,449],Ni=[31,112,193,232,318,335],Ko=[13,16,45,48,82,87,89,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312],E1=[13,16,31,45,48,82,87,89,112,193,231,232,272,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,317,318,335],Gl=[13,16,29,31,45,48,82,85,87,89,112,159,160,161,163,164,193,231,232,272,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,317,318,335],wa=[13,16,31,48,82,174,294,295,296,297,298,299,300,301,302,303,304,305,306,308,312],ba=[31,45],T1=[1,507],A1=[1,508],x1=[6,13,16,29,31,39,45,47,48,63,70,73,76,78,81,82,83,85,87,89,112,159,160,161,163,164,193,231,242,246,250,263,265,268,269,270,271,272,273,274,276,277,279,280,283,285,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335,336,338,341,342,343,344,345,346,347,348,349,350,351],Yo=[29,31,85,112,159,160,161,163,164,335],ki=[6,13,16,31,45,70,73,81,83,85,87,268,269,270,271,273,274,276,277,279,280,283,285,308,346,347,348,349,350,351],O1=[13,16,31,45,48,82,87,89,112,193,197,231,232,272,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,317,318,335],C1=[2,352],Hl=[13,16,197,308,314],P1=[1,565],_s=[6,13,16,31,45,76,78,81,83,85,87,268,269,270,271,273,274,276,277,279,280,283,285,308,346,347,348,349,350,351],F1=[13,16,29,31,45,82,85,87,89,112,159,160,161,163,164,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312],jn=[13,16,29,31,45,82,85,87,89,112,159,160,161,163,164,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335],I1=[13,16,87,308],Mn=[2,364],vs=[29,31,85,112,159,160,161,163,164,193,232,318,335],Qo=[31,112,193,232,272,318,335],Ln=[2,359],R1=[13,16,48,82,174,294,295,296,297,298,299,300,301,302,303,304,305,306,308,312],Jo=[29,31,85,112,159,160,161,163,164,193,232,272,318,335],D1=[13,16,31,45,82,87,89,112,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312],N1=[2,347],zl={trace:o(function(){},"trace"),yy:{},symbols_:{error:2,QueryOrUpdate:3,Prologue:4,QueryOrUpdate_group0:5,EOF:6,Query:7,Qry:8,Query_option0:9,Prologue_repetition0:10,BaseDecl:11,BASE:12,IRIREF:13,PrefixDecl:14,PREFIX:15,PNAME_NS:16,SelectClauseWildcard:17,Qry_repetition0:18,WhereClause:19,SolutionModifierNoGroup:20,SelectClauseVars:21,Qry_repetition1:22,SolutionModifier:23,CONSTRUCT:24,ConstructTemplate:25,Qry_repetition2:26,Qry_repetition3:27,WHERE:28,"{":29,Qry_option0:30,"}":31,DESCRIBE:32,Qry_group0:33,Qry_repetition4:34,Qry_option1:35,ASK:36,Qry_repetition5:37,SelectClauseBase:38,"*":39,SelectClauseVars_repetition_plus0:40,SELECT:41,SelectClauseBase_option0:42,SelectClauseItem:43,Var:44,"(":45,Expression:46,AS:47,")":48,SubSelect:49,SubSelect_option0:50,SubSelect_option1:51,DatasetClause:52,FROM:53,DatasetClause_option0:54,iri:55,WhereClause_option0:56,GroupGraphPattern:57,SolutionModifier_option0:58,SolutionModifierNoGroup_option0:59,SolutionModifierNoGroup_option1:60,SolutionModifierNoGroup_option2:61,GroupClause:62,GROUP:63,BY:64,GroupClause_repetition_plus0:65,GroupCondition:66,BuiltInCall:67,FunctionCall:68,HavingClause:69,HAVING:70,HavingClause_repetition_plus0:71,OrderClause:72,ORDER:73,OrderClause_repetition_plus0:74,OrderCondition:75,ASC:76,BrackettedExpression:77,DESC:78,Constraint:79,LimitOffsetClauses:80,LIMIT:81,INTEGER:82,OFFSET:83,ValuesClause:84,VALUES:85,InlineData:86,VAR:87,InlineData_repetition0:88,NIL:89,InlineData_repetition1:90,InlineData_repetition_plus2:91,InlineData_repetition3:92,DataBlock:93,DataBlockValueList:94,DataBlockValueList_repetition_plus0:95,Update:96,Update_repetition0:97,Update1:98,Update_option0:99,LOAD:100,Update1_option0:101,Update1_option1:102,Update1_group0:103,Update1_option2:104,GraphRefAll:105,Update1_group1:106,Update1_option3:107,GraphOrDefault:108,TO:109,CREATE:110,Update1_option4:111,GRAPH:112,INSERTDATA:113,QuadPattern:114,DELETEDATA:115,DELETEWHERE:116,Update1_option5:117,InsertDeleteClause:118,Update1_repetition0:119,IntoGraphClause:120,INTO:121,GraphRef:122,DELETE:123,InsertDeleteClause_option0:124,InsertClause:125,INSERT:126,UsingClause:127,USING:128,UsingClause_option0:129,WithClause:130,WITH:131,DEFAULT:132,GraphOrDefault_option0:133,GraphRefAll_group0:134,Quads:135,Quads_option0:136,Quads_repetition0:137,QuadsNotTriples:138,VarOrIri:139,QuadsNotTriples_option0:140,QuadsNotTriples_option1:141,QuadsNotTriples_option2:142,TriplesTemplate:143,TriplesTemplate_repetition0:144,TriplesSameSubject:145,TriplesTemplate_option0:146,GroupGraphPatternSub:147,GroupGraphPatternSub_option0:148,GroupGraphPatternSub_repetition0:149,GroupGraphPatternSubTail:150,GraphPatternNotTriples:151,GroupGraphPatternSubTail_option0:152,GroupGraphPatternSubTail_option1:153,TriplesBlock:154,TriplesBlock_repetition0:155,TriplesSameSubjectPath:156,TriplesBlock_option0:157,GroupOrUnionGraphPattern:158,OPTIONAL:159,MINUS:160,SERVICE:161,GraphPatternNotTriples_option0:162,FILTER:163,BIND:164,InlineDataOneVar:165,InlineDataFull:166,InlineDataOneVar_repetition0:167,InlineDataFull_repetition0:168,InlineDataFull_repetition_plus1:169,InlineDataFull_repetition2:170,DataBlockValue:171,Literal:172,QuotedTriple:173,UNDEF:174,GroupOrUnionGraphPattern_repetition0:175,ArgList:176,ArgList_option0:177,ArgList_repetition0:178,ExpressionList:179,ExpressionList_repetition0:180,ConstructTemplate_option0:181,ConstructTriples:182,ConstructTriples_repetition0:183,ConstructTriples_option0:184,VarOrTermOrQuotedTP:185,PropertyListNotEmpty:186,TriplesNode:187,PropertyList:188,PropertyList_option0:189,VerbObjectList:190,PropertyListNotEmpty_repetition0:191,SemiOptionalVerbObjectList:192,";":193,SemiOptionalVerbObjectList_option0:194,Verb:195,ObjectList:196,a:197,ObjectList_repetition0:198,Object:199,GraphNode:200,Object_option0:201,PropertyListPathNotEmpty:202,TriplesNodePath:203,TriplesSameSubjectPath_option0:204,O:205,PropertyListPathNotEmpty_repetition0:206,PropertyListPathNotEmptyTail:207,O_group0:208,ObjectListPath:209,ObjectListPath_repetition0:210,ObjectPath:211,GraphNodePath:212,ObjectPath_option0:213,Path:214,Path_repetition0:215,PathSequence:216,PathSequence_repetition0:217,PathEltOrInverse:218,PathElt:219,PathPrimary:220,PathElt_option0:221,PathEltOrInverse_option0:222,IriOrA:223,"!":224,PathNegatedPropertySet:225,PathOneInPropertySet:226,PathNegatedPropertySet_repetition0:227,PathNegatedPropertySet_option0:228,"^":229,TriplesNode_repetition_plus0:230,"[":231,"]":232,TriplesNodePath_repetition_plus0:233,VarOrTermOrQuotedTPExpr:234,VarOrTerm:235,GraphTerm:236,BlankNode:237,ConditionalOrExpression:238,ConditionalAndExpression:239,ConditionalOrExpression_repetition0:240,ConditionalOrExpressionTail:241,"||":242,RelationalExpression:243,ConditionalAndExpression_repetition0:244,ConditionalAndExpressionTail:245,"&&":246,NumericExpression:247,RelationalExpression_group0:248,RelationalExpression_option0:249,IN:250,MultiplicativeExpression:251,NumericExpression_repetition0:252,AdditiveExpressionTail:253,AdditiveExpressionTail_group0:254,NumericLiteralPositive:255,AdditiveExpressionTail_repetition0:256,NumericLiteralNegative:257,AdditiveExpressionTail_repetition1:258,UnaryExpression:259,MultiplicativeExpression_repetition0:260,MultiplicativeExpressionTail:261,MultiplicativeExpressionTail_group0:262,"+":263,PrimaryExpression:264,"-":265,ExprQuotedTP:266,Aggregate:267,FUNC_ARITY0:268,FUNC_ARITY1:269,FUNC_ARITY1_SPARQL_STAR:270,FUNC_ARITY2:271,",":272,FUNC_ARITY3:273,FUNC_ARITY3_SPARQL_STAR:274,BuiltInCall_group0:275,BOUND:276,BNODE:277,BuiltInCall_option0:278,EXISTS:279,COUNT:280,Aggregate_option0:281,Aggregate_group0:282,FUNC_AGGREGATE:283,Aggregate_option1:284,GROUP_CONCAT:285,Aggregate_option2:286,Aggregate_option3:287,GroupConcatSeparator:288,SEPARATOR:289,"=":290,String:291,LANGTAG:292,"^^":293,DECIMAL:294,DOUBLE:295,BOOLEAN:296,INTEGER_POSITIVE:297,DECIMAL_POSITIVE:298,DOUBLE_POSITIVE:299,INTEGER_NEGATIVE:300,DECIMAL_NEGATIVE:301,DOUBLE_NEGATIVE:302,STRING_LITERAL1:303,STRING_LITERAL2:304,STRING_LITERAL_LONG1:305,STRING_LITERAL_LONG2:306,PrefixedName:307,PNAME_LN:308,BLANK_NODE_LABEL:309,ANON:310,QuotedTP:311,"<<":312,qtSubjectOrObject:313,">>":314,DataValueTerm:315,AnnotationPattern:316,"{|":317,"|}":318,AnnotationPatternPath:319,ExprVarOrTerm:320,QueryOrUpdate_group0_option0:321,Prologue_repetition0_group0:322,Qry_group0_repetition_plus0:323,SelectClauseBase_option0_group0:324,DISTINCT:325,REDUCED:326,NAMED:327,SILENT:328,CLEAR:329,DROP:330,ADD:331,MOVE:332,COPY:333,ALL:334,".":335,UNION:336,"|":337,"/":338,PathElt_option0_group0:339,"?":340,"!=":341,"<":342,">":343,"<=":344,">=":345,NOT:346,CONCAT:347,COALESCE:348,SUBSTR:349,REGEX:350,REPLACE:351,$accept:0,$end:1},terminals_:{2:"error",6:"EOF",12:"BASE",13:"IRIREF",15:"PREFIX",16:"PNAME_NS",24:"CONSTRUCT",28:"WHERE",29:"{",31:"}",32:"DESCRIBE",36:"ASK",39:"*",41:"SELECT",45:"(",47:"AS",48:")",53:"FROM",63:"GROUP",64:"BY",70:"HAVING",73:"ORDER",76:"ASC",78:"DESC",81:"LIMIT",82:"INTEGER",83:"OFFSET",85:"VALUES",87:"VAR",89:"NIL",100:"LOAD",109:"TO",110:"CREATE",112:"GRAPH",113:"INSERTDATA",115:"DELETEDATA",116:"DELETEWHERE",121:"INTO",123:"DELETE",126:"INSERT",128:"USING",131:"WITH",132:"DEFAULT",159:"OPTIONAL",160:"MINUS",161:"SERVICE",163:"FILTER",164:"BIND",174:"UNDEF",193:";",197:"a",224:"!",229:"^",231:"[",232:"]",242:"||",246:"&&",250:"IN",263:"+",265:"-",268:"FUNC_ARITY0",269:"FUNC_ARITY1",270:"FUNC_ARITY1_SPARQL_STAR",271:"FUNC_ARITY2",272:",",273:"FUNC_ARITY3",274:"FUNC_ARITY3_SPARQL_STAR",276:"BOUND",277:"BNODE",279:"EXISTS",280:"COUNT",283:"FUNC_AGGREGATE",285:"GROUP_CONCAT",289:"SEPARATOR",290:"=",292:"LANGTAG",293:"^^",294:"DECIMAL",295:"DOUBLE",296:"BOOLEAN",297:"INTEGER_POSITIVE",298:"DECIMAL_POSITIVE",299:"DOUBLE_POSITIVE",300:"INTEGER_NEGATIVE",301:"DECIMAL_NEGATIVE",302:"DOUBLE_NEGATIVE",303:"STRING_LITERAL1",304:"STRING_LITERAL2",305:"STRING_LITERAL_LONG1",306:"STRING_LITERAL_LONG2",308:"PNAME_LN",309:"BLANK_NODE_LABEL",310:"ANON",312:"<<",314:">>",317:"{|",318:"|}",325:"DISTINCT",326:"REDUCED",327:"NAMED",328:"SILENT",329:"CLEAR",330:"DROP",331:"ADD",332:"MOVE",333:"COPY",334:"ALL",335:".",336:"UNION",337:"|",338:"/",340:"?",341:"!=",342:"<",343:">",344:"<=",345:">=",346:"NOT",347:"CONCAT",348:"COALESCE",349:"SUBSTR",350:"REGEX",351:"REPLACE"},productions_:[0,[3,3],[7,2],[4,1],[11,2],[14,3],[8,4],[8,4],[8,5],[8,7],[8,5],[8,4],[17,2],[21,2],[38,2],[43,1],[43,5],[49,4],[49,4],[52,3],[19,2],[23,2],[20,3],[62,3],[66,1],[66,1],[66,3],[66,5],[66,1],[69,2],[72,3],[75,2],[75,2],[75,1],[75,1],[80,2],[80,2],[80,4],[80,4],[84,2],[86,4],[86,4],[86,6],[86,2],[94,3],[96,3],[98,4],[98,3],[98,5],[98,4],[98,2],[98,2],[98,2],[98,5],[120,2],[118,3],[118,1],[125,2],[127,3],[130,2],[108,1],[108,2],[122,2],[105,1],[105,1],[114,3],[135,2],[138,7],[143,3],[57,3],[57,3],[147,2],[150,3],[154,3],[151,1],[151,2],[151,2],[151,3],[151,4],[151,2],[151,6],[151,1],[93,1],[93,1],[165,4],[166,4],[166,6],[171,1],[171,1],[171,1],[171,1],[158,2],[79,1],[79,1],[79,1],[68,2],[176,1],[176,5],[179,1],[179,4],[25,3],[182,3],[145,2],[145,2],[188,1],[186,2],[192,2],[190,2],[195,1],[195,1],[196,2],[199,2],[156,2],[156,2],[202,2],[207,1],[207,2],[205,2],[209,2],[211,2],[214,2],[216,2],[219,2],[218,2],[220,1],[220,2],[220,3],[225,1],[225,1],[225,4],[226,1],[226,2],[187,3],[187,3],[203,3],[203,3],[200,1],[200,1],[212,1],[212,1],[234,1],[235,1],[235,1],[139,1],[139,1],[44,1],[236,1],[236,1],[236,1],[236,1],[46,1],[238,2],[241,2],[239,2],[245,2],[243,1],[243,3],[243,4],[247,2],[253,2],[253,2],[253,2],[251,2],[261,2],[259,2],[259,2],[259,2],[259,1],[264,1],[264,1],[264,1],[264,1],[264,1],[264,1],[264,1],[77,3],[67,1],[67,2],[67,4],[67,4],[67,6],[67,8],[67,8],[67,2],[67,4],[67,2],[67,4],[67,3],[267,5],[267,5],[267,6],[288,4],[172,1],[172,2],[172,3],[172,1],[172,1],[172,1],[172,1],[172,1],[172,1],[255,1],[255,1],[255,1],[257,1],[257,1],[257,1],[291,1],[291,1],[291,1],[291,1],[55,1],[55,1],[307,1],[307,1],[237,1],[237,1],[311,5],[173,5],[313,1],[313,1],[313,1],[313,1],[313,1],[315,1],[315,1],[315,1],[185,1],[185,1],[185,1],[316,3],[319,3],[266,5],[320,1],[320,1],[320,1],[223,1],[223,1],[321,0],[321,1],[5,1],[5,1],[5,1],[9,0],[9,1],[322,1],[322,1],[10,0],[10,2],[18,0],[18,2],[22,0],[22,2],[26,0],[26,2],[27,0],[27,2],[30,0],[30,1],[323,1],[323,2],[33,1],[33,1],[34,0],[34,2],[35,0],[35,1],[37,0],[37,2],[40,1],[40,2],[324,1],[324,1],[42,0],[42,1],[50,0],[50,1],[51,0],[51,1],[54,0],[54,1],[56,0],[56,1],[58,0],[58,1],[59,0],[59,1],[60,0],[60,1],[61,0],[61,1],[65,1],[65,2],[71,1],[71,2],[74,1],[74,2],[88,0],[88,2],[90,0],[90,2],[91,1],[91,2],[92,0],[92,2],[95,1],[95,2],[97,0],[97,4],[99,0],[99,2],[101,0],[101,1],[102,0],[102,1],[103,1],[103,1],[104,0],[104,1],[106,1],[106,1],[106,1],[107,0],[107,1],[111,0],[111,1],[117,0],[117,1],[119,0],[119,2],[124,0],[124,1],[129,0],[129,1],[133,0],[133,1],[134,1],[134,1],[134,1],[136,0],[136,1],[137,0],[137,2],[140,0],[140,1],[141,0],[141,1],[142,0],[142,1],[144,0],[144,3],[146,0],[146,1],[148,0],[148,1],[149,0],[149,2],[152,0],[152,1],[153,0],[153,1],[155,0],[155,3],[157,0],[157,1],[162,0],[162,1],[167,0],[167,2],[168,0],[168,2],[169,1],[169,2],[170,0],[170,2],[175,0],[175,3],[177,0],[177,1],[178,0],[178,3],[180,0],[180,3],[181,0],[181,1],[183,0],[183,3],[184,0],[184,1],[189,0],[189,1],[191,0],[191,2],[194,0],[194,1],[198,0],[198,3],[201,0],[201,1],[204,0],[204,1],[206,0],[206,2],[208,1],[208,1],[210,0],[210,3],[213,0],[213,1],[215,0],[215,3],[217,0],[217,3],[339,1],[339,1],[339,1],[221,0],[221,1],[222,0],[222,1],[227,0],[227,3],[228,0],[228,1],[230,1],[230,2],[233,1],[233,2],[240,0],[240,2],[244,0],[244,2],[248,1],[248,1],[248,1],[248,1],[248,1],[248,1],[249,0],[249,1],[252,0],[252,2],[254,1],[254,1],[256,0],[256,2],[258,0],[258,2],[260,0],[260,2],[262,1],[262,1],[275,1],[275,1],[275,1],[275,1],[275,1],[278,0],[278,1],[281,0],[281,1],[282,1],[282,1],[284,0],[284,1],[286,0],[286,1],[287,0],[287,1]],performAction:o(function(E,O,I,H,pe,d,Jt){var m=d.length-1;switch(pe){case 1:if(d[m-1]=d[m-1]||{},we.base&&(d[m-1].base=we.base),we.base="",d[m-1].prefixes=we.prefixes,we.prefixes=null,we.pathOnly){if(d[m-1].type==="path"||"termType"in d[m-1])return d[m-1];throw new Error("Received full SPARQL query in path only mode")}else if(d[m-1].type==="path"||"termType"in d[m-1])throw new Error("Received only path in full SPARQL mode");if(d[m-1].type==="update"){let He={};for(let tt of d[m-1].updates)if(tt.updateType==="insert"){let Ve={};for(let We of tt.insert)if(We.type==="bgp"||We.type==="graph")for(let ur of We.triples)ur.subject.termType==="BlankNode"&&(Ve[ur.subject.value]=!0),ur.predicate.termType==="BlankNode"&&(Ve[ur.predicate.value]=!0),ur.object.termType==="BlankNode"&&(Ve[ur.object.value]=!0);for(let We of Object.keys(Ve)){if(He[We])throw new Error("Detected reuse blank node across different INSERT DATA clauses");He[We]=!0}}}return d[m-1];case 2:this.$={...d[m-1],...d[m],type:"query"};break;case 4:we.base=Ea(d[m]);break;case 5:we.prefixes||(we.prefixes={}),d[m-1]=d[m-1].substr(0,d[m-1].length-1),d[m]=Ea(d[m]),we.prefixes[d[m-1]]=d[m];break;case 6:this.$={...d[m-3],...Li(d[m-2]),...d[m-1],...d[m]};break;case 7:if(!we.skipValidation&&(tf(d[m-3].variables.map(tt=>ef(tt.expression))).some(tt=>tt.aggregation==="count"&&!(tt.expression instanceof Xo))||d[m].group)){for(let tt of d[m-3].variables)if(tt.termType==="Variable"){if(!d[m].group||!d[m].group.map(Ve=>Es(Ve)).includes(Es(tt)))throw Error("Projection of ungrouped variable (?"+Es(tt)+")")}else if(ef(tt.expression).length===0){let Ve=GS(tt.expression);for(let We of Ve)if(!d[m].group||!d[m].group.map||!d[m].group.map(ur=>Es(ur)).includes(Es(We)))throw Error("Use of ungrouped variable in projection of operation (?"+Es(We)+")")}}let _n=d[m-1].where.filter(He=>He.type==="query");if(_n.length>0){let He=d[m-3].variables.filter(Ve=>Ve.variable&&Ve.variable.value).map(Ve=>Ve.variable.value),tt=tf(_n.map(Ve=>Ve.variables)).map(Ve=>Ve.value||Ve.variable.value);for(let Ve of He)if(tt.indexOf(Ve)>=0)throw Error("Target id of 'AS' (?"+Ve+") already used in subquery")}this.$=ot(d[m-3],Li(d[m-2]),d[m-1],d[m]);break;case 8:this.$=ot({queryType:"CONSTRUCT",template:d[m-3]},Li(d[m-2]),d[m-1],d[m]);break;case 9:this.$=ot({queryType:"CONSTRUCT",template:d[m-2]=d[m-2]?d[m-2].triples:[]},Li(d[m-5]),{where:[{type:"bgp",triples:Mi([],d[m-2])}]},d[m]);break;case 10:this.$=ot({queryType:"DESCRIBE",variables:d[m-3]==="*"?[new Xo]:d[m-3]},Li(d[m-2]),d[m-1],d[m]);break;case 11:this.$=ot({queryType:"ASK"},Li(d[m-2]),d[m-1],d[m]);break;case 12:this.$=ot(d[m-1],{variables:[new Xo]});break;case 13:let Ca=d[m].map(He=>He.value||He.variable.value),Ts=HS(Ca);if(Ts.length>0)throw Error("Two or more of the resulting columns have the same name (?"+Ts[0]+")");this.$=ot(d[m-1],{variables:d[m]});break;case 14:this.$=ot({queryType:"SELECT"},d[m]&&(d[m-1]=Qt(d[m]),d[m]={},d[m][d[m-1]]=!0,d[m]));break;case 16:case 27:this.$=Ss(d[m-3],{variable:d[m-1]});break;case 17:case 18:this.$=ot(d[m-3],d[m-2],d[m-1],d[m],{type:"query"});break;case 19:case 58:this.$={iri:d[m],named:!!d[m-1]};break;case 20:this.$={where:d[m].patterns};break;case 21:this.$=ot(d[m-1],d[m]);break;case 22:this.$=ot(d[m-2],d[m-1],d[m]);break;case 23:this.$={group:d[m]};break;case 24:case 25:case 28:case 31:case 33:case 34:this.$=Ss(d[m]);break;case 26:this.$=Ss(d[m-1]);break;case 29:this.$={having:d[m]};break;case 30:this.$={order:d[m]};break;case 32:this.$=Ss(d[m],{descending:!0});break;case 35:this.$={limit:bs(d[m])};break;case 36:this.$={offset:bs(d[m])};break;case 37:this.$={limit:bs(d[m-2]),offset:bs(d[m])};break;case 38:this.$={limit:bs(d[m]),offset:bs(d[m-2])};break;case 39:case 43:this.$={type:"values",values:d[m]};break;case 40:case 84:this.$=d[m-1].map(He=>({[d[m-3]]:He}));break;case 41:case 85:this.$=d[m-1].map(()=>({}));break;case 42:case 86:var yn=d[m-4].length;d[m-4]=d[m-4].map(Kl),this.$=d[m-1].map(function(He){if(He.length!==yn)throw Error("Inconsistent VALUES length");for(var tt={},Ve=0;Ve<yn;Ve++)tt["?"+d[m-4][Ve].value]=He[Ve];return tt});break;case 44:case 65:case 100:case 126:case 175:this.$=d[m-1];break;case 45:this.$={type:"update",updates:Vn(d[m-2],d[m-1])};break;case 46:this.$=ot({type:"load",silent:!!d[m-2],source:d[m-1]},d[m]&&{destination:d[m]});break;case 47:this.$={type:Qt(d[m-2]),silent:!!d[m-1],graph:d[m]};break;case 48:this.$={type:Qt(d[m-4]),silent:!!d[m-3],source:d[m-2],destination:d[m]};break;case 49:this.$={type:"create",silent:!!d[m-2],graph:{type:"graph",name:d[m]}};break;case 50:this.$={updateType:"insert",insert:G1(d[m])};break;case 51:this.$={updateType:"delete",delete:sf(G1(d[m]))};break;case 52:this.$={updateType:"deletewhere",delete:sf(d[m])};break;case 53:this.$={updateType:"insertdelete",...d[m-4],...d[m-3],...Li(d[m-2],"using"),where:d[m].patterns};break;case 54:case 57:case 62:case 167:case 191:case 236:this.$=d[m];break;case 55:this.$={delete:sf(d[m-1]),insert:d[m]||[]};break;case 56:this.$={delete:[],insert:d[m]};break;case 59:this.$={graph:d[m]};break;case 60:this.$={type:"graph",default:!0};break;case 61:case 63:this.$={type:"graph",name:d[m]};break;case 64:this.$={[Qt(d[m])]:!0};break;case 66:this.$=d[m-1]?mn(d[m],[d[m-1]]):mn(d[m]);break;case 67:var xa=ot(d[m-3]||{triples:[]},{type:"graph",name:d[m-5]});this.$=d[m]?[xa,d[m]]:[xa];break;case 68:case 73:this.$={type:"bgp",triples:mn(d[m-2],[d[m-1]])};break;case 69:this.$={type:"group",patterns:[d[m-1]]};break;case 70:for(let He of d[m-1].filter(tt=>tt.type==="bind")){let tt=d[m-1].indexOf(He),Ve=new Set;for(let We of d[m-1].slice(0,tt))(We.type==="group"||We.type==="bgp")&&$1(We).forEach(ur=>Ve.add(ur));if(Ve.has(He.variable.value))throw Error("Variable used to bind is already bound (?"+He.variable.value+")")}this.$={type:"group",patterns:d[m-1]};break;case 71:this.$=d[m-1]?mn([d[m-1]],d[m]):mn(d[m]);break;case 72:this.$=d[m]?[d[m-2],d[m]]:d[m-2];break;case 75:this.$=ot(d[m],{type:"optional"});break;case 76:this.$=ot(d[m],{type:"minus"});break;case 77:this.$=ot(d[m],{type:"graph",name:d[m-1]});break;case 78:this.$=ot(d[m],{type:"service",name:d[m-1],silent:!!d[m-2]});break;case 79:this.$={type:"filter",expression:d[m]};break;case 80:this.$={type:"bind",variable:d[m-1],expression:d[m-3]};break;case 89:this.$=Aa(d[m]);break;case 90:this.$=void 0;break;case 91:this.$=d[m-1].length?{type:"union",patterns:mn(d[m-1].map(Ql),[Ql(d[m])])}:d[m];break;case 95:this.$={...d[m],function:d[m-1]};break;case 96:this.$={type:"functionCall",args:[]};break;case 97:this.$={type:"functionCall",args:Vn(d[m-2],d[m-1]),distinct:!!d[m-3]};break;case 98:case 115:case 128:case 247:case 249:case 251:case 253:case 255:case 263:case 267:case 297:case 299:case 303:case 307:case 328:case 341:case 349:case 355:case 361:case 367:case 369:case 373:case 375:case 379:case 381:case 385:case 391:case 395:case 401:case 405:case 409:case 411:case 420:case 428:case 430:case 440:case 444:case 446:case 448:this.$=[];break;case 99:this.$=Vn(d[m-2],d[m-1]);break;case 101:this.$=mn(d[m-2],[d[m-1]]);break;case 102:case 112:this.$=nf(d[m].map(He=>ot(qn(d[m-1]),He)));break;case 103:this.$=nf(Mi(d[m].map(He=>ot(qn(d[m-1].entity),He)),d[m-1].triples));break;case 105:this.$=mn([d[m-1]],d[m]);break;case 106:this.$=mn(d[m]);break;case 107:this.$=Zl(d[m-1],d[m]);break;case 109:case 237:this.$=we.factory.namedNode(kS);break;case 110:case 118:this.$=Vn(d[m-1],d[m]);break;case 111:this.$=d[m]?{annotation:d[m],object:d[m-1]}:d[m-1];break;case 113:this.$=d[m]?nf(Mi(d[m].map(He=>ot(qn(d[m-1].entity),He)),d[m-1].triples)):d[m-1].triples;break;case 114:this.$=Zl(...d[m-1],d[m]);break;case 116:this.$=Zl(...d[m]);break;case 117:case 159:case 163:this.$=[d[m-1],d[m]];break;case 119:this.$=d[m]?{object:d[m-1],annotation:d[m]}:d[m-1];break;case 120:this.$=d[m-1].length?ws("|",Vn(d[m-1],d[m])):d[m];break;case 121:this.$=d[m-1].length?ws("/",Vn(d[m-1],d[m])):d[m];break;case 122:this.$=d[m]?ws(d[m],[d[m-1]]):d[m-1];break;case 123:this.$=d[m-1]?ws(d[m-1],[d[m]]):d[m];break;case 125:case 131:this.$=ws(d[m-1],[d[m]]);break;case 129:this.$=ws("|",Vn(d[m-2],d[m-1]));break;case 132:case 134:this.$=$S(d[m-1]);break;case 133:case 135:this.$=WS(d[m-1]);break;case 140:this.$={entity:d[m],triples:[]};break;case 145:this.$=Kl(d[m]);break;case 149:this.$=we.factory.namedNode(k1);break;case 151:case 153:case 158:case 162:this.$=Yl(d[m-1],d[m]);break;case 152:this.$=["||",d[m]];break;case 154:this.$=["&&",d[m]];break;case 156:this.$=Ct(d[m-1],[d[m-2],d[m]]);break;case 157:this.$=Ct(d[m-2]?"notin":"in",[d[m-3],d[m]]);break;case 160:this.$=["+",Yl(d[m-1],d[m])];break;case 161:var tc=gn(d[m-1].value.replace("-",""),d[m-1].datatype);this.$=["-",Yl(tc,d[m])];break;case 164:this.$=Ct("UPLUS",[d[m]]);break;case 165:this.$=Ct(d[m-1],[d[m]]);break;case 166:this.$=Ct("UMINUS",[d[m]]);break;case 177:this.$=Ct(Qt(d[m-1]));break;case 178:this.$=Ct(Qt(d[m-3]),[d[m-1]]);break;case 179:this.$=Aa(Ct(Qt(d[m-3]),[d[m-1]]));break;case 180:this.$=Ct(Qt(d[m-5]),[d[m-3],d[m-1]]);break;case 181:this.$=Ct(Qt(d[m-7]),[d[m-5],d[m-3],d[m-1]]);break;case 182:this.$=Aa(Ct(Qt(d[m-7]),[d[m-5],d[m-3],d[m-1]]));break;case 183:this.$=Ct(Qt(d[m-1]),d[m]);break;case 184:this.$=Ct("bound",[Kl(d[m-1])]);break;case 185:this.$=Ct(d[m-1],[]);break;case 186:this.$=Ct(d[m-3],[d[m-1]]);break;case 187:this.$=Ct(d[m-2]?"notexists":"exists",[Ql(d[m])]);break;case 188:case 189:this.$=Ss(d[m-1],{type:"aggregate",aggregation:Qt(d[m-4]),distinct:!!d[m-2]});break;case 190:this.$=Ss(d[m-2],{type:"aggregate",aggregation:Qt(d[m-5]),distinct:!!d[m-3],separator:typeof d[m-1]=="string"?d[m-1]:" "});break;case 192:this.$=gn(d[m]);break;case 193:this.$=VS(d[m-1],Qt(d[m].substr(1)));break;case 194:this.$=gn(d[m-2],d[m]);break;case 195:case 204:this.$=gn(d[m],j1);break;case 196:case 205:this.$=gn(d[m],M1);break;case 197:case 206:this.$=gn(Qt(d[m]),L1);break;case 200:this.$=gn(d[m].toLowerCase(),LS);break;case 201:this.$=gn(d[m].substr(1),j1);break;case 202:this.$=gn(d[m].substr(1),M1);break;case 203:this.$=gn(d[m].substr(1).toLowerCase(),L1);break;case 207:case 208:this.$=U1(d[m],1);break;case 209:case 210:this.$=U1(d[m],3);break;case 211:this.$=we.factory.namedNode(Ea(d[m]));break;case 213:var rc=d[m].indexOf(":"),Oa=d[m].substr(0,rc),nc=we.prefixes[Oa];if(!nc)throw new Error("Unknown prefix: "+Oa);var it=Ea(nc+d[m].substr(rc+1));this.$=we.factory.namedNode(it);break;case 214:if(d[m]=d[m].substr(0,d[m].length-1),!(d[m]in we.prefixes))throw new Error("Unknown prefix: "+d[m]);var it=Ea(we.prefixes[d[m]]);this.$=we.factory.namedNode(it);break;case 215:this.$=Ta(d[m].replace(/^(_:)/,""));break;case 216:this.$=Ta();break;case 217:case 218:case 232:this.$=Aa(Jl(d[m-3],d[m-2],d[m-1]));break;case 230:case 231:this.$=Aa(d[m-1]);break;case 248:case 250:case 252:case 254:case 256:case 260:case 264:case 268:case 270:case 292:case 294:case 296:case 298:case 300:case 302:case 304:case 306:case 329:case 342:case 356:case 368:case 370:case 372:case 374:case 392:case 402:case 425:case 427:case 429:case 431:case 441:case 445:case 447:case 449:d[m-1].push(d[m]);break;case 259:case 269:case 291:case 293:case 295:case 301:case 305:case 371:case 424:case 426:this.$=[d[m]];break;case 308:d[m-3].push(d[m-2]);break;case 350:case 362:case 376:case 380:case 382:case 386:case 396:case 406:case 410:case 412:case 421:d[m-2].push(d[m-1]);break}},"anonymous"),table:[r(e,t,{3:1,4:2,10:3}),{1:[3]},r(n,[2,307],{5:4,7:5,321:6,214:7,8:8,96:9,215:10,17:11,21:12,97:16,38:17,6:[2,238],13:i,16:i,45:i,197:i,224:i,229:i,308:i,24:[1,13],32:[1,14],36:[1,15],41:s}),r([6,13,16,24,32,36,41,45,100,110,113,115,116,123,126,131,197,224,229,308,329,330,331,332,333],[2,3],{322:19,11:20,14:21,12:[1,22],15:[1,23]}),{6:[1,24]},{6:[2,240]},{6:[2,241]},{6:[2,242]},{6:[2,243],9:25,84:26,85:a},{6:[2,239]},r(c,[2,411],{216:28,217:29}),r(u,[2,249],{18:30}),r(u,[2,251],{22:31}),r(f,[2,255],{25:32,27:33,29:[1,34]}),{13:l,16:h,33:35,39:[1,37],44:39,55:40,87:p,139:38,307:43,308:g,323:36},r(u,[2,267],{37:46}),r(w,[2,326],{98:47,103:49,106:50,117:55,130:61,100:[1,48],110:[1,51],113:[1,52],115:[1,53],116:[1,54],131:[1,62],329:[1,56],330:[1,57],331:[1,58],332:[1,59],333:[1,60]}),{39:[1,63],40:64,43:65,44:66,45:S,87:p},r(x,[2,273],{42:68,324:69,325:[1,70],326:[1,71]}),r(e,[2,248]),r(e,[2,245]),r(e,[2,246]),{13:[1,72]},{16:[1,73]},{1:[2,1]},{6:[2,2]},{6:[2,244]},{45:[1,77],85:[1,78],86:74,87:[1,75],89:[1,76]},r([6,13,16,45,48,82,87,89,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312],[2,120],{337:[1,79]}),r(P,[2,418],{218:80,222:81,229:[1,82]}),{19:83,28:F,29:L,52:84,53:$,56:85},{19:88,28:F,29:L,52:89,53:$,56:85},r(u,[2,253],{26:90}),{28:[1,91],52:92,53:$},r(K,[2,385],{181:93,182:94,183:95,31:[2,383]}),r(Fe,[2,263],{34:96}),r(Fe,[2,261],{44:39,55:40,307:43,139:97,13:l,16:h,87:p,308:g}),r(Fe,[2,262]),r(Xe,[2,259]),r(at,[2,143]),r(at,[2,144]),r([6,13,16,28,29,31,39,45,47,48,53,63,70,73,76,78,81,82,83,85,87,89,112,159,160,161,163,164,193,197,224,229,231,232,242,246,250,263,265,268,269,270,271,272,273,274,276,277,279,280,283,285,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314,317,318,335,338,341,342,343,344,345,346,347,348,349,350,351],[2,145]),r(B,[2,211]),r(B,[2,212]),r(B,[2,213]),r(B,[2,214]),{19:98,28:F,29:L,52:99,53:$,56:85},{6:[2,309],99:100,193:[1,101]},r(ce,[2,311],{101:102,328:[1,103]}),r(Ce,[2,317],{104:104,328:[1,105]}),r(Ze,[2,322],{107:106,328:[1,107]}),{111:108,112:[2,324],328:[1,109]},{29:Ge,114:110},{29:Ge,114:112},{29:Ge,114:113},{118:114,123:[1,115],125:116,126:ze},r(Ne,[2,315]),r(Ne,[2,316]),r(ke,[2,319]),r(ke,[2,320]),r(ke,[2,321]),r(w,[2,327]),{13:l,16:h,55:118,307:43,308:g},r(u,[2,12]),r(u,[2,13],{44:66,43:119,45:S,87:p}),r(Pe,[2,269]),r(Pe,[2,15]),{13:l,16:h,44:136,45:G,46:120,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},r(x,[2,14]),r(x,[2,274]),r(x,[2,271]),r(x,[2,272]),r(e,[2,4]),{13:[1,177]},r(V,[2,39]),{29:[1,178]},{29:[1,179]},{87:[1,181],91:180},{45:[1,187],87:[1,185],89:[1,186],93:182,165:183,166:184},r(c,[2,410]),r([6,13,16,45,48,82,87,89,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,337],[2,121],{338:[1,188]}),{13:l,16:h,45:[1,193],55:194,197:ge,219:189,220:190,223:191,224:[1,192],307:43,308:g},r(P,[2,419]),r($e,ye,{20:196,59:197,69:198,70:N}),r(u,[2,250]),{29:k,57:200},r(ce,[2,279],{54:202,327:[1,203]}),{29:[2,282]},r(M,q,{23:204,58:205,62:206,63:de}),r(u,[2,252]),{19:208,28:F,29:L,52:209,53:$,56:85},{29:[1,210]},r(f,[2,256]),{31:[1,211]},{31:[2,384]},{13:l,16:h,44:215,45:Me,55:220,82:D,87:p,89:Le,145:212,172:221,185:213,187:214,231:xt,236:216,237:222,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,309:cr,310:yr,311:217,312:Kt},r(s1,[2,265],{56:85,35:227,52:228,19:229,28:F,29:L,53:$}),r(Xe,[2,260]),r(M,q,{58:205,62:206,23:230,63:de}),r(u,[2,268]),{6:[2,45]},r(e,t,{10:3,4:231}),{13:l,16:h,55:232,307:43,308:g},r(ce,[2,312]),{105:233,112:a1,122:234,132:[1,237],134:235,327:[1,238],334:[1,239]},r(Ce,[2,318]),r(ce,o1,{108:240,133:242,112:c1,132:u1}),r(Ze,[2,323]),{112:[1,244]},{112:[2,325]},r(Ot,[2,50]),r(K,Lo,{135:245,136:246,143:247,144:248,31:l1,112:l1}),r(Ot,[2,51]),r(Ot,[2,52]),r(si,[2,328],{119:249}),{29:Ge,114:250},r(si,[2,56]),{29:Ge,114:251},r(w,[2,59]),r(Pe,[2,270]),{47:[1,252]},r(f1,[2,150]),r(Vo,[2,428],{240:253}),r(ms,[2,430],{244:254}),r(ms,[2,155],{248:255,249:256,250:[2,438],290:[1,257],341:[1,258],342:[1,259],343:[1,260],344:[1,261],345:[1,262],346:[1,263]}),r(gs,[2,440],{252:264}),r(St,[2,448],{260:265}),{13:l,16:h,44:136,45:G,55:133,67:132,68:134,77:131,82:D,87:p,172:135,255:154,257:155,264:266,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},{13:l,16:h,44:136,45:G,55:133,67:132,68:134,77:131,82:D,87:p,172:135,255:154,257:155,264:267,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},{13:l,16:h,44:136,45:G,55:133,67:132,68:134,77:131,82:D,87:p,172:135,255:154,257:155,264:268,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},r(St,[2,167]),r(St,[2,168]),r(St,[2,169]),r(St,[2,170],{176:269,45:h1,89:d1}),r(St,[2,171]),r(St,[2,172]),r(St,[2,173]),r(St,[2,174]),{13:l,16:h,44:136,45:G,46:272,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},r(lt,[2,176]),{89:[1,273]},{45:[1,274]},{45:[1,275]},{45:[1,276]},{45:[1,277]},{45:[1,278]},{45:p1,89:m1,179:279},{45:[1,282]},{45:[1,284],89:[1,283]},{279:[1,285]},r(Yt,[2,192],{292:[1,286],293:[1,287]}),r(Yt,[2,195]),r(Yt,[2,196]),r(Yt,[2,197]),r(Yt,[2,198]),r(Yt,[2,199]),r(Yt,[2,200]),{13:l,16:h,44:39,55:40,82:D,87:p,139:289,172:291,255:154,257:155,266:290,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,320:288},{45:[1,292]},{45:[1,293]},{45:[1,294]},r(va,[2,452]),r(va,[2,453]),r(va,[2,454]),r(va,[2,455]),r(va,[2,456]),{279:[2,458]},r(qo,[2,207]),r(qo,[2,208]),r(qo,[2,209]),r(qo,[2,210]),r(Yt,[2,201]),r(Yt,[2,202]),r(Yt,[2,203]),r(Yt,[2,204]),r(Yt,[2,205]),r(Yt,[2,206]),r(e,[2,5]),r(Bo,[2,297],{88:295}),r(Uo,[2,299],{90:296}),{48:[1,297],87:[1,298]},r($o,[2,301]),r(V,[2,43]),r(V,[2,82]),r(V,[2,83]),{29:[1,299]},{29:[1,300]},{87:[1,302],169:301},r(c,[2,412]),r(Fi,[2,123]),r(Fi,[2,416],{221:303,339:304,39:[1,306],263:[1,307],340:[1,305]}),r(pn,[2,124]),{13:l,16:h,45:[1,311],55:194,89:[1,310],197:ge,223:312,225:308,226:309,229:g1,307:43,308:g},r(c,i,{215:10,214:314}),r(pn,[2,236]),r(pn,[2,237]),r(ys,[2,6]),r(ql,[2,287],{60:315,72:316,73:[1,317]}),r($e,[2,286]),{13:l,16:h,45:G,55:323,67:321,68:322,71:318,77:320,79:319,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,307:43,308:g,346:Oe,347:me,348:_,349:v,350:b,351:C},r([6,31,63,70,73,81,83,85],[2,20]),r(K,y1,{38:17,49:324,147:325,17:326,21:327,148:328,154:329,155:330,29:Nn,31:Nn,85:Nn,112:Nn,159:Nn,160:Nn,161:Nn,163:Nn,164:Nn,41:s}),{13:l,16:h,55:331,307:43,308:g},r(ce,[2,280]),r(ys,[2,7]),r($e,ye,{59:197,69:198,20:332,70:N}),r(M,[2,284]),{64:[1,333]},r(M,q,{58:205,62:206,23:334,63:de}),r(u,[2,254]),r(K,Lo,{144:248,30:335,143:336,31:[2,257]}),r(u,[2,100]),{31:[2,387],184:337,335:[1,338]},{13:l,16:h,44:39,55:40,87:p,139:342,186:339,190:340,195:341,197:Ii,307:43,308:g},r(Sa,[2,389],{44:39,55:40,307:43,190:340,195:341,139:342,188:344,189:345,186:346,13:l,16:h,87:p,197:Ii,308:g}),r(kn,[2,227]),r(kn,[2,228]),r(kn,[2,229]),{13:l,16:h,44:215,45:Me,55:220,82:D,87:p,89:Le,172:221,185:351,187:350,200:348,230:347,231:xt,234:349,236:216,237:222,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,309:cr,310:yr,311:217,312:Kt},{13:l,16:h,44:39,55:40,87:p,139:342,186:352,190:340,195:341,197:Ii,307:43,308:g},r(kn,[2,146]),r(kn,[2,147]),r(kn,[2,148]),r(kn,[2,149]),{13:l,16:h,44:354,55:355,82:D,87:p,172:357,237:356,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,309:cr,310:yr,311:358,312:Kt,313:353},r(Bl,[2,215]),r(Bl,[2,216]),r(M,q,{58:205,62:206,23:359,63:de}),r(Fe,[2,264]),r(s1,[2,266]),r(ys,[2,11]),r(n,[2,308],{6:[2,310]}),r(Ot,[2,313],{102:360,120:361,121:[1,362]}),r(Ot,[2,47]),r(Ot,[2,63]),r(Ot,[2,64]),{13:l,16:h,55:363,307:43,308:g},r(Ot,[2,336]),r(Ot,[2,337]),r(Ot,[2,338]),{109:[1,364]},r(_1,[2,60]),{13:l,16:h,55:365,307:43,308:g},r(ce,[2,335]),{13:l,16:h,55:366,307:43,308:g},{31:[1,367]},r(Ri,[2,341],{137:368}),r(Ri,[2,340]),{13:l,16:h,44:215,45:Me,55:220,82:D,87:p,89:Le,145:369,172:221,185:213,187:214,231:xt,236:216,237:222,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,309:cr,310:yr,311:217,312:Kt},{28:[1,370],127:371,128:[1,372]},r(si,[2,330],{124:373,125:374,126:ze}),r(si,[2,57]),{44:375,87:p},r(f1,[2,151],{241:376,242:[1,377]}),r(Vo,[2,153],{245:378,246:[1,379]}),{13:l,16:h,44:136,45:G,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,247:380,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},{250:[1,381]},r(ft,[2,432]),r(ft,[2,433]),r(ft,[2,434]),r(ft,[2,435]),r(ft,[2,436]),r(ft,[2,437]),{250:[2,439]},r([47,48,193,242,246,250,272,290,341,342,343,344,345,346],[2,158],{253:382,254:383,255:384,257:385,263:[1,386],265:[1,387],297:X,298:Z,299:ee,300:Q,301:ne,302:ie}),r(gs,[2,162],{261:388,262:389,39:Ul,338:$l}),r(St,[2,164]),r(St,[2,165]),r(St,[2,166]),r(lt,[2,95]),r(lt,[2,96]),r(ft,[2,377],{177:392,325:[1,393]}),{48:[1,394]},r(lt,[2,177]),{13:l,16:h,44:136,45:G,46:395,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},{13:l,16:h,44:136,45:G,46:396,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},{13:l,16:h,44:136,45:G,46:397,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},{13:l,16:h,44:136,45:G,46:398,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},{13:l,16:h,44:136,45:G,46:399,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},r(lt,[2,183]),r(lt,[2,98]),r(ft,[2,381],{180:400}),{87:[1,401]},r(lt,[2,185]),{13:l,16:h,44:136,45:G,46:402,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},{29:k,57:403},r(Yt,[2,193]),{13:l,16:h,55:404,307:43,308:g},{13:l,16:h,44:39,55:40,87:p,139:342,195:405,197:Ii,307:43,308:g},r(ai,[2,233]),r(ai,[2,234]),r(ai,[2,235]),r(v1,[2,459],{281:406,325:[1,407]}),r(ft,[2,463],{284:408,325:[1,409]}),r(ft,[2,465],{286:410,325:[1,411]}),{13:l,16:h,31:[1,412],55:414,82:D,171:413,172:415,173:416,174:Wo,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:Go},{31:[1,419],89:[1,420]},{29:[1,421]},r($o,[2,302]),r(Bo,[2,367],{167:422}),r(Uo,[2,369],{168:423}),{48:[1,424],87:[1,425]},r($o,[2,371]),r(Fi,[2,122]),r(Fi,[2,417]),r(Fi,[2,413]),r(Fi,[2,414]),r(Fi,[2,415]),r(pn,[2,125]),r(pn,[2,127]),r(pn,[2,128]),r(S1,[2,420],{227:426}),r(pn,[2,130]),{13:l,16:h,55:194,197:ge,223:427,307:43,308:g},{48:[1,428]},r(oi,[2,289],{61:429,80:430,81:[1,431],83:[1,432]}),r(ql,[2,288]),{64:[1,433]},r($e,[2,29],{307:43,267:139,275:146,278:149,77:320,67:321,68:322,55:323,79:434,13:l,16:h,45:G,268:le,269:be,270:W,271:Ee,273:Te,274:_e,276:Ae,277:ue,279:ve,280:fe,283:Se,285:xe,308:g,346:Oe,347:me,348:_,349:v,350:b,351:C}),r(w1,[2,293]),r(Wl,[2,92]),r(Wl,[2,93]),r(Wl,[2,94]),{45:h1,89:d1,176:269},{31:[1,435]},{31:[1,436]},{19:437,28:F,29:L,56:85},{19:438,28:F,29:L,56:85},r(Di,[2,355],{149:439}),r(Di,[2,354]),{13:l,16:h,44:215,45:Ho,55:220,82:D,87:p,89:Le,156:440,172:221,185:441,203:442,231:zo,236:216,237:222,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,309:cr,310:yr,311:217,312:Kt},r(Fe,[2,19]),r(oi,[2,21]),{13:l,16:h,44:450,45:b1,55:323,65:445,66:446,67:447,68:448,87:p,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,307:43,308:g,346:Oe,347:me,348:_,349:v,350:b,351:C},r(ys,[2,8]),{31:[1,451]},{31:[2,258]},{31:[2,101]},r(K,[2,386],{31:[2,388]}),r(Sa,[2,102]),r(Ni,[2,391],{191:452}),r(K,[2,395],{196:453,198:454}),r(K,[2,108]),r(K,[2,109]),r(Sa,[2,103]),r(Sa,[2,104]),r(Sa,[2,390]),{13:l,16:h,44:215,45:Me,48:[1,455],55:220,82:D,87:p,89:Le,172:221,185:351,187:350,200:456,231:xt,234:349,236:216,237:222,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,309:cr,310:yr,311:217,312:Kt},r(Ko,[2,424]),r(E1,[2,136]),r(E1,[2,137]),r(Gl,[2,140]),{232:[1,457]},{13:l,16:h,44:39,55:40,87:p,139:342,195:458,197:Ii,307:43,308:g},r(ai,[2,219]),r(ai,[2,220]),r(ai,[2,221]),r(ai,[2,222]),r(ai,[2,223]),r(ys,[2,10]),r(Ot,[2,46]),r(Ot,[2,314]),{112:a1,122:459},r(Ot,[2,62]),r(ce,o1,{133:242,108:460,112:c1,132:u1}),r(_1,[2,61]),r(Ot,[2,49]),r([6,28,126,128,193],[2,65]),{31:[2,66],112:[1,462],138:461},r(Ri,[2,351],{146:463,335:[1,464]}),{29:k,57:465},r(si,[2,329]),r(ce,[2,332],{129:466,327:[1,467]}),r(si,[2,55]),r(si,[2,331]),{48:[1,468]},r(Vo,[2,429]),{13:l,16:h,44:136,45:G,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,239:469,243:123,247:124,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},r(ms,[2,431]),{13:l,16:h,44:136,45:G,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,243:470,247:124,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},r(ms,[2,156]),{45:p1,89:m1,179:471},r(gs,[2,441]),{13:l,16:h,44:136,45:G,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,251:472,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},r(St,[2,444],{256:473}),r(St,[2,446],{258:474}),r(ft,[2,442]),r(ft,[2,443]),r(St,[2,449]),{13:l,16:h,44:136,45:G,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,255:154,257:155,259:475,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},r(ft,[2,450]),r(ft,[2,451]),r(ft,[2,379],{178:476}),r(ft,[2,378]),r([6,13,16,29,31,39,45,47,48,73,76,78,81,82,83,85,87,89,112,159,160,161,163,164,193,231,242,246,250,263,265,268,269,270,271,272,273,274,276,277,279,280,283,285,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335,338,341,342,343,344,345,346,347,348,349,350,351],[2,175]),{48:[1,477]},{48:[1,478]},{272:[1,479]},{272:[1,480]},{272:[1,481]},{13:l,16:h,44:136,45:G,46:482,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},{48:[1,483]},{48:[1,484]},r(lt,[2,187]),r(Yt,[2,194]),{13:l,16:h,44:39,55:40,82:D,87:p,139:289,172:291,255:154,257:155,266:290,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,320:485},{13:l,16:h,39:[1,487],44:136,45:G,46:488,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,282:486,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},r(v1,[2,460]),{13:l,16:h,44:136,45:G,46:489,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},r(ft,[2,464]),{13:l,16:h,44:136,45:G,46:490,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},r(ft,[2,466]),r(V,[2,40]),r(Bo,[2,298]),r(wa,[2,87]),r(wa,[2,88]),r(wa,[2,89]),r(wa,[2,90]),{13:l,16:h,55:492,82:D,172:493,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,311:494,312:Kt,315:491},r(V,[2,41]),r(Uo,[2,300]),r(ba,[2,303],{92:495}),{13:l,16:h,31:[1,496],55:414,82:D,171:497,172:415,173:416,174:Wo,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:Go},{31:[1,498],89:[1,499]},{29:[1,500]},r($o,[2,372]),{13:l,16:h,48:[2,422],55:194,197:ge,223:312,226:502,228:501,229:g1,307:43,308:g},r(pn,[2,131]),r(pn,[2,126]),r(oi,[2,22]),r(oi,[2,290]),{82:[1,503]},{82:[1,504]},{13:l,16:h,44:510,45:G,55:323,67:321,68:322,74:505,75:506,76:T1,77:320,78:A1,79:509,87:p,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,307:43,308:g,346:Oe,347:me,348:_,349:v,350:b,351:C},r(w1,[2,294]),r(x1,[2,69]),r(x1,[2,70]),r($e,ye,{59:197,69:198,20:511,70:N}),r(M,q,{58:205,62:206,23:512,63:de}),{29:[2,375],31:[2,71],84:522,85:a,112:[1,518],150:513,151:514,158:515,159:[1,516],160:[1,517],161:[1,519],163:[1,520],164:[1,521],175:523},r(Di,[2,363],{157:524,335:[1,525]}),r(c,i,{215:10,202:526,205:527,208:528,214:529,44:530,87:p}),r(Yo,[2,399],{215:10,205:527,208:528,214:529,44:530,204:531,202:532,13:i,16:i,45:i,197:i,224:i,229:i,308:i,87:p}),{13:l,16:h,44:215,45:Ho,55:220,82:D,87:p,89:Le,172:221,185:351,203:536,212:534,231:zo,233:533,234:535,236:216,237:222,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,309:cr,310:yr,311:217,312:Kt},r(c,i,{215:10,205:527,208:528,214:529,44:530,202:537,87:p}),r(M,[2,23],{307:43,267:139,275:146,278:149,55:323,67:447,68:448,44:450,66:538,13:l,16:h,45:b1,87:p,268:le,269:be,270:W,271:Ee,273:Te,274:_e,276:Ae,277:ue,279:ve,280:fe,283:Se,285:xe,308:g,346:Oe,347:me,348:_,349:v,350:b,351:C}),r(ki,[2,291]),r(ki,[2,24]),r(ki,[2,25]),{13:l,16:h,44:136,45:G,46:539,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},r(ki,[2,28]),r(M,q,{58:205,62:206,23:540,63:de}),r([31,112,232,318,335],[2,105],{192:541,193:[1,542]}),r(Ni,[2,107]),{13:l,16:h,44:215,45:Me,55:220,82:D,87:p,89:Le,172:221,185:351,187:350,199:543,200:544,231:xt,234:349,236:216,237:222,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,309:cr,310:yr,311:217,312:Kt},r(O1,[2,132]),r(Ko,[2,425]),r(O1,[2,133]),{13:l,16:h,44:354,55:355,82:D,87:p,172:357,237:356,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,309:cr,310:yr,311:358,312:Kt,313:545},r(Ot,[2,54]),r(Ot,[2,48]),r(Ri,[2,342]),{13:l,16:h,44:39,55:40,87:p,139:546,307:43,308:g},r(Ri,[2,68]),r(K,[2,350],{31:C1,112:C1}),r(Ot,[2,53]),{13:l,16:h,55:547,307:43,308:g},r(ce,[2,333]),r(Pe,[2,16]),r(Vo,[2,152]),r(ms,[2,154]),r(ms,[2,157]),r(gs,[2,159]),r(gs,[2,160],{262:389,261:548,39:Ul,338:$l}),r(gs,[2,161],{262:389,261:549,39:Ul,338:$l}),r(St,[2,163]),{13:l,16:h,44:136,45:G,46:550,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},r(lt,[2,178]),r(lt,[2,179]),{13:l,16:h,44:136,45:G,46:551,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},{13:l,16:h,44:136,45:G,46:552,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},{13:l,16:h,44:136,45:G,46:553,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},{48:[1,554],272:[1,555]},r(lt,[2,184]),r(lt,[2,186]),{314:[1,556]},{48:[1,557]},{48:[2,461]},{48:[2,462]},{48:[1,558]},{48:[2,467],193:[1,561],287:559,288:560},{13:l,16:h,55:194,197:ge,223:562,307:43,308:g},r(Hl,[2,224]),r(Hl,[2,225]),r(Hl,[2,226]),{31:[1,563],45:P1,94:564},r(V,[2,84]),r(Bo,[2,368]),r(V,[2,85]),r(Uo,[2,370]),r(ba,[2,373],{170:566}),{48:[1,567]},{48:[2,423],337:[1,568]},r(oi,[2,35],{83:[1,569]}),r(oi,[2,36],{81:[1,570]}),r(ql,[2,30],{307:43,267:139,275:146,278:149,77:320,67:321,68:322,55:323,79:509,44:510,75:571,13:l,16:h,45:G,76:T1,78:A1,87:p,268:le,269:be,270:W,271:Ee,273:Te,274:_e,276:Ae,277:ue,279:ve,280:fe,283:Se,285:xe,308:g,346:Oe,347:me,348:_,349:v,350:b,351:C}),r(_s,[2,295]),{45:G,77:572},{45:G,77:573},r(_s,[2,33]),r(_s,[2,34]),{31:[2,275],50:574,84:575,85:a},{31:[2,277],51:576,84:577,85:a},r(Di,[2,356]),r(F1,[2,357],{152:578,335:[1,579]}),r(jn,[2,74]),{29:k,57:580},{29:k,57:581},{13:l,16:h,44:39,55:40,87:p,139:582,307:43,308:g},r(I1,[2,365],{162:583,328:[1,584]}),{13:l,16:h,45:G,55:323,67:321,68:322,77:320,79:585,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,307:43,308:g,346:Oe,347:me,348:_,349:v,350:b,351:C},{45:[1,586]},r(jn,[2,81]),{29:k,57:587},r(Di,[2,73]),r(K,[2,362],{29:Mn,31:Mn,85:Mn,112:Mn,159:Mn,160:Mn,161:Mn,163:Mn,164:Mn}),r(Yo,[2,112]),r(vs,[2,401],{206:588}),r(K,[2,405],{209:589,210:590}),r(K,[2,403]),r(K,[2,404]),r(Yo,[2,113]),r(Yo,[2,400]),{13:l,16:h,44:215,45:Ho,48:[1,591],55:220,82:D,87:p,89:Le,172:221,185:351,203:536,212:592,231:zo,234:535,236:216,237:222,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,309:cr,310:yr,311:217,312:Kt},r(Ko,[2,426]),r(Gl,[2,138]),r(Gl,[2,139]),{232:[1,593]},r(ki,[2,292]),{47:[1,595],48:[1,594]},r(ys,[2,9]),r(Ni,[2,392]),r(Ni,[2,393],{44:39,55:40,307:43,195:341,139:342,194:596,190:597,13:l,16:h,87:p,197:Ii,308:g}),r(Ni,[2,110],{272:[1,598]}),r(Qo,[2,397],{201:599,316:600,317:[1,601]}),{314:[1,602]},{29:[1,603]},r(si,[2,58]),r(St,[2,445]),r(St,[2,447]),{48:[1,604],272:[1,605]},{48:[1,606]},{272:[1,607]},{272:[1,608]},r(lt,[2,99]),r(ft,[2,382]),r([13,16,39,47,48,87,193,197,242,246,250,263,265,272,290,297,298,299,300,301,302,308,314,338,341,342,343,344,345,346],[2,232]),r(lt,[2,188]),r(lt,[2,189]),{48:[1,609]},{48:[2,468]},{289:[1,610]},{13:l,16:h,55:492,82:D,172:493,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,311:494,312:Kt,315:611},r(V,[2,42]),r(ba,[2,304]),{13:l,16:h,55:414,82:D,95:612,171:613,172:415,173:416,174:Wo,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:Go},{31:[1,614],45:P1,94:615},r(pn,[2,129]),r(S1,[2,421]),{82:[1,616]},{82:[1,617]},r(_s,[2,296]),r(_s,[2,31]),r(_s,[2,32]),{31:[2,17]},{31:[2,276]},{31:[2,18]},{31:[2,278]},r(K,y1,{155:330,153:618,154:619,29:Ln,31:Ln,85:Ln,112:Ln,159:Ln,160:Ln,161:Ln,163:Ln,164:Ln}),r(F1,[2,358]),r(jn,[2,75]),r(jn,[2,76]),{29:k,57:620},{13:l,16:h,44:39,55:40,87:p,139:621,307:43,308:g},r(I1,[2,366]),r(jn,[2,79]),{13:l,16:h,44:136,45:G,46:622,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},r(jn,[2,91],{336:[1,623]}),r([29,31,85,112,159,160,161,163,164,232,318,335],[2,114],{207:624,193:[1,625]}),r(vs,[2,117]),{13:l,16:h,44:215,45:Ho,55:220,82:D,87:p,89:Le,172:221,185:351,203:536,211:626,212:627,231:zo,234:535,236:216,237:222,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,309:cr,310:yr,311:217,312:Kt},r(kn,[2,134]),r(Ko,[2,427]),r(kn,[2,135]),r(ki,[2,26]),{44:628,87:p},r(Ni,[2,106]),r(Ni,[2,394]),r(K,[2,396]),r(Qo,[2,111]),r(Qo,[2,398]),{13:l,16:h,44:39,55:40,87:p,139:342,186:629,190:340,195:341,197:Ii,307:43,308:g},r(Bl,[2,217]),r(K,Lo,{144:248,140:630,143:631,31:[2,343]}),r(lt,[2,97]),r(ft,[2,380]),r(lt,[2,180]),{13:l,16:h,44:136,45:G,46:632,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},{13:l,16:h,44:136,45:G,46:633,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Be,264:130,265:j,266:137,267:139,268:le,269:be,270:W,271:Ee,273:Te,274:_e,275:146,276:Ae,277:ue,278:149,279:ve,280:fe,283:Se,285:xe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Oe,347:me,348:_,349:v,350:b,351:C},r(lt,[2,190]),{290:[1,634]},{314:[1,635]},{13:l,16:h,48:[1,636],55:414,82:D,171:637,172:415,173:416,174:Wo,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ne,302:ie,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:Go},r(R1,[2,305]),r(V,[2,86]),r(ba,[2,374]),r(oi,[2,37]),r(oi,[2,38]),r(Di,[2,72]),r(Di,[2,360]),r(jn,[2,77]),{29:k,57:638},{47:[1,639]},{29:[2,376]},r(vs,[2,402]),r(vs,[2,115],{215:10,208:528,214:529,44:530,205:640,13:i,16:i,45:i,197:i,224:i,229:i,308:i,87:p}),r(vs,[2,118],{272:[1,641]}),r(Jo,[2,407],{213:642,319:643,317:[1,644]}),{48:[1,645]},{318:[1,646]},{31:[1,647]},{31:[2,344]},{48:[1,648]},{48:[1,649]},{291:650,303:se,304:ae,305:Y,306:oe},r(wa,[2,218]),r(ba,[2,44]),r(R1,[2,306]),r(jn,[2,78]),{44:651,87:p},r(vs,[2,116]),r(K,[2,406]),r(Jo,[2,119]),r(Jo,[2,408]),r(c,i,{215:10,205:527,208:528,214:529,44:530,202:652,87:p}),r(ki,[2,27]),r(Qo,[2,230]),r(D1,[2,345],{141:653,335:[1,654]}),r(lt,[2,181]),r(lt,[2,182]),{48:[2,191]},{48:[1,655]},{318:[1,656]},r(K,Lo,{144:248,142:657,143:658,31:N1,112:N1}),r(D1,[2,346]),r(jn,[2,80]),r(Jo,[2,231]),r(Ri,[2,67]),r(Ri,[2,348])],defaultActions:{5:[2,240],6:[2,241],7:[2,242],9:[2,239],24:[2,1],25:[2,2],26:[2,244],87:[2,282],94:[2,384],100:[2,45],109:[2,325],166:[2,458],263:[2,439],336:[2,258],337:[2,101],487:[2,461],488:[2,462],560:[2,468],574:[2,17],575:[2,276],576:[2,18],577:[2,278],623:[2,376],631:[2,344],650:[2,191]},parseError:o(function(E,O){if(O.recoverable)this.trace(E);else{var I=new Error(E);throw I.hash=O,I}},"parseError"),parse:o(function(E){var O=this,I=[0],H=[],pe=[null],d=[],Jt=this.table,m="",yn=0,xa=0,tc=0,rc=2,Oa=1,nc=d.slice.call(arguments,1),it=Object.create(this.lexer),_n={yy:{}};for(var Ca in this.yy)Object.prototype.hasOwnProperty.call(this.yy,Ca)&&(_n.yy[Ca]=this.yy[Ca]);it.setInput(E,_n.yy),_n.yy.lexer=it,_n.yy.parser=this,typeof it.yylloc>"u"&&(it.yylloc={});var Ts=it.yylloc;d.push(Ts);var He=it.options&&it.options.ranges;typeof _n.yy.parseError=="function"?this.parseError=_n.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function tt(vn){I.length=I.length-2*vn,pe.length=pe.length-vn,d.length=d.length-vn}o(tt,"popStack");for(var Ve=o(function(){var vn;return vn=it.lex()||Oa,typeof vn!="number"&&(vn=O.symbols_[vn]||vn),vn},"lex"),We,ur,Vi,Or,b8,af,As={},ic,Bn,H1,sc;;){if(Vi=I[I.length-1],this.defaultActions[Vi]?Or=this.defaultActions[Vi]:((We===null||typeof We>"u")&&(We=Ve()),Or=Jt[Vi]&&Jt[Vi][We]),typeof Or>"u"||!Or.length||!Or[0]){var of="";sc=[];for(ic in Jt[Vi])this.terminals_[ic]&&ic>rc&&sc.push("'"+this.terminals_[ic]+"'");it.showPosition?of="Parse error on line "+(yn+1)+`:
`+it.showPosition()+`
Expecting `+sc.join(", ")+", got '"+(this.terminals_[We]||We)+"'":of="Parse error on line "+(yn+1)+": Unexpected "+(We==Oa?"end of input":"'"+(this.terminals_[We]||We)+"'"),this.parseError(of,{text:it.match,token:this.terminals_[We]||We,line:it.yylineno,loc:Ts,expected:sc})}if(Or[0]instanceof Array&&Or.length>1)throw new Error("Parse Error: multiple actions possible at state: "+Vi+", token: "+We);switch(Or[0]){case 1:I.push(We),pe.push(it.yytext),d.push(it.yylloc),I.push(Or[1]),We=null,ur?(We=ur,ur=null):(xa=it.yyleng,m=it.yytext,yn=it.yylineno,Ts=it.yylloc,tc>0&&tc--);break;case 2:if(Bn=this.productions_[Or[1]][1],As.$=pe[pe.length-Bn],As._$={first_line:d[d.length-(Bn||1)].first_line,last_line:d[d.length-1].last_line,first_column:d[d.length-(Bn||1)].first_column,last_column:d[d.length-1].last_column},He&&(As._$.range=[d[d.length-(Bn||1)].range[0],d[d.length-1].range[1]]),af=this.performAction.apply(As,[m,xa,yn,_n.yy,Or[1],pe,d].concat(nc)),typeof af<"u")return af;Bn&&(I=I.slice(0,-1*Bn*2),pe=pe.slice(0,-1*Bn),d=d.slice(0,-1*Bn)),I.push(this.productions_[Or[1]][0]),pe.push(As.$),d.push(As._$),H1=Jt[I[I.length-2]][I[I.length-1]],I.push(H1);break;case 3:return!0}}return!0},"parse")},Xo=rp().Wildcard,Zo="http://www.w3.org/1999/02/22-rdf-syntax-ns#",kS=Zo+"type",jS=Zo+"first",MS=Zo+"rest",k1=Zo+"nil",ec="http://www.w3.org/2001/XMLSchema#",j1=ec+"integer",M1=ec+"decimal",L1=ec+"double",LS=ec+"boolean",ji="",V1="",q1="";function Qt(A){return A.toLowerCase()}o(Qt,"lowercase");function Vn(A,E){return A.push(E),A}o(Vn,"appendTo");function Mi(A,E){return A.push.apply(A,E),A}o(Mi,"appendAllTo");function ot(A){A||(A={});for(var E=1,O=arguments.length,I;E<O&&(I=arguments[E]||{});E++)for(var H in I)A[H]=I[H];return A}o(ot,"extend");function mn(){for(var A=[],E=0,O=arguments.length;E<O;E++)A=A.concat.apply(A,arguments[E]);return A}o(mn,"unionAll");function Ea(A){if(A[0]==="<"&&(A=A.substring(1,A.length-1)),/^[a-z][a-z0-9.+-]*:/i.test(A))return A;if(!we.base)throw new Error("Cannot resolve relative IRI "+A+" because no base IRI was set.");switch(ji!==we.base&&(ji=we.base,V1=ji.replace(/[^\/:]*$/,""),q1=ji.match(/^(?:[a-z]+:\/*)?[^\/]*/)[0]),A[0]){case void 0:return ji;case"#":return ji+A;case"?":return ji.replace(/(?:\?.*)?$/,A);case"/":return q1+A;default:return V1+A}}o(Ea,"resolveIRI");function Kl(A){if(A){var E=A[0];if(E==="?"||E==="$")return we.factory.variable(A.substr(1))}return A}o(Kl,"toVar");function Ct(A,E){return{type:"operation",operator:A,args:E||[]}}o(Ct,"operation");function Ss(A,E){var O={expression:A==="*"?new Xo:A};if(E)for(var I in E)O[I]=E[I];return O}o(Ss,"expression");function ws(A,E){return{type:"path",pathType:A,items:E}}o(ws,"path");function Yl(A,E){for(var O=0,I=E.length,H;O<I&&(H=E[O]);O++)A=Ct(H[0],[A,H[1]]);return A}o(Yl,"createOperationTree");function Li(A,E){var O=[],I=[],H=A.length,pe,d={};if(!H)return null;for(var Jt=0;Jt<H&&(pe=A[Jt]);Jt++)(pe.named?I:O).push(pe.iri);return d[E||"from"]={default:O,named:I},d}o(Li,"groupDatasets");function bs(A){return parseInt(A,10)}o(bs,"toInt");function Ql(A){return A.type==="group"&&A.patterns.length===1?A.patterns[0]:A}o(Ql,"degroupSingle");function gn(A,E){return E&&E.termType!=="NamedNode"&&(E=we.factory.namedNode(E)),we.factory.literal(A,E)}o(gn,"createTypedLiteral");function VS(A,E){return we.factory.literal(A,E)}o(VS,"createLangLiteral");function Jl(A,E,O){if(!("termType"in E))throw new Error("Nested triples cannot contain paths");return we.factory.quad(A,E,O)}o(Jl,"nestedTriple");function qn(A,E,O,I){var H={};return A!=null&&(H.subject=A),E!=null&&(H.predicate=E),O!=null&&(H.object=O),I!=null&&(H.annotations=I),H}o(qn,"triple");function Ta(A){return typeof A=="string"?A.startsWith("e_")?we.factory.blankNode(A):we.factory.blankNode("e_"+A):we.factory.blankNode("g_"+B1++)}o(Ta,"blank");var B1=0;we._resetBlanks=function(){B1=0};var qS=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\(.)/g,BS={"\\":"\\","'":"'",'"':'"',t:"	",b:"\b",n:`
`,r:"\r",f:"\f"},US=/[\uD800-\uDBFF]([^\uDC00-\uDFFF]|$)/,Xl=String.fromCharCode;function U1(A,E){A=A.substring(E,A.length-E);try{A=A.replace(qS,function(O,I,H,pe){var d;if(I){if(d=parseInt(I,16),isNaN(d))throw new Error;return Xl(d)}else if(H){if(d=parseInt(H,16),isNaN(d))throw new Error;return d<65535?Xl(d):Xl(55296+((d-=65536)>>10),56320+(d&1023))}else{var Jt=BS[pe];if(!Jt)throw new Error;return Jt}})}catch{return""}if(US.exec(A))throw new Error("Invalid unicode codepoint of surrogate pair without corresponding codepoint in "+A);return A}o(U1,"unescapeString");function $S(A){var E=Ta(),O=E,I=[],H,pe=[];A.forEach(function(yn){I.push(yn.entity),Mi(pe,yn.triples)});for(var d=0,Jt=0,m=I.length,H=Array(m*2);d<m;)H[Jt++]=qn(O,we.factory.namedNode(jS),I[d]),H[Jt++]=qn(O,we.factory.namedNode(MS),O=++d<m?Ta():we.factory.namedNode(k1));return{entity:E,triples:Mi(H,pe)}}o($S,"createList");function WS(A){var E=Ta();return{entity:E,triples:A.map(function(O){return ot(qn(E),O)})}}o(WS,"createAnonymousObject");function Zl(A,E,O){var I=[],H=[];return E.forEach(function(pe){let d=null;pe.annotation&&(d=pe.annotation,pe=pe.object),I.push(qn(null,A,pe.entity,d)),Mi(H,pe.triples)}),mn(I,O||[],H)}o(Zl,"objectListToTriples");function S8(A){for(var E=[],O,I=0,H;H=A[I];I++)switch(H.type){case"bgp":H.triples.length&&(O?Mi(O.triples,H.triples):Vn(E,O=H));break;default:(!H.patterns||H.patterns.length>0)&&(Vn(E,H),O=null)}return E}o(S8,"mergeAdjacentBGPs");function Es(A){return A.variable?A.variable.value:A.value||A.expression.value}o(Es,"getExpressionId");function ef(A){if(!A)return[];if(A.type==="aggregate")return[A];if(A.type==="operation"){let E=[];for(let O of A.args)E.push(...ef(O));return E}return[]}o(ef,"getAggregatesOfExpression");function GS(A){let E=new Set,O=o(function(I){I&&(I.termType==="Variable"?E.add(I):I.type==="operation"&&I.args.forEach(O))},"visitExpression");return O(A),E}o(GS,"getVariablesFromExpression");function tf(A,E=1,O=[]){for(let I of A)E>0&&I instanceof Array?tf(I,E-1,O):O.push(I);return O}o(tf,"flatten");function rf(A){return A.termType==="Variable"}o(rf,"isVariable");function $1(A){if(A.triples){let E=[];for(let O of A.triples)rf(O.subject)&&E.push(O.subject.value),rf(O.predicate)&&E.push(O.predicate.value),rf(O.object)&&E.push(O.object.value);return E}else if(A.patterns){let E=[];for(let O of A.patterns)E.push(...$1(O));return E}return[]}o($1,"getBoundVarsFromGroupGraphPattern");function HS(A){let E=A.slice().sort(),O=[];for(let I=0;I<E.length-1;I++)E[I+1]==E[I]&&O.push(E[I]);return O}o(HS,"getDuplicatesInArray");function Aa(A){if(!we.sparqlStar)throw new Error("SPARQL-star support is not enabled");return A}o(Aa,"ensureSparqlStar");function W1(A,E,O){for(let I of E){let H=qn("subject"in I?I.subject:A,I.predicate,I.object);O.push(H),I.annotations&&W1(Jl(A,I.predicate,I.object),I.annotations,O)}}o(W1,"_applyAnnotations");function nf(A){if(we.sparqlStar){let E=[];return A.forEach(O=>{let I=qn(O.subject,O.predicate,O.object);E.push(I),O.annotations&&W1(Jl(O.subject,O.predicate,O.object),O.annotations,E)}),E}return A}o(nf,"applyAnnotations");function w8(A){if(!we.sparqlStarNestedQuads)throw new Error("Lenient SPARQL-star support with nested quads is not enabled");return A}o(w8,"ensureSparqlStarNestedQuads");function G1(A){for(let E of A){if(E.type==="graph"&&E.name.termType==="Variable")throw new Error("Detected illegal variable in GRAPH");if(E.type==="bgp"||E.type==="graph"){for(let O of E.triples)if(O.subject.termType==="Variable"||O.predicate.termType==="Variable"||O.object.termType==="Variable")throw new Error("Detected illegal variable in BGP")}}return A}o(G1,"ensureNoVariables");function sf(A){for(let E of A)if(E.type==="bgp"){for(let O of E.triples)if(O.subject.termType==="BlankNode"||O.predicate.termType==="BlankNode"||O.object.termType==="BlankNode")throw new Error("Detected illegal blank node in BGP")}return A}o(sf,"ensureNoBnodes");var zS=(function(){var A={EOF:1,parseError:o(function(O,I){if(this.yy.parser)this.yy.parser.parseError(O,I);else throw new Error(O)},"parseError"),setInput:o(function(E,O){return this.yy=O||this.yy||{},this._input=E,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},"setInput"),input:o(function(){var E=this._input[0];this.yytext+=E,this.yyleng++,this.offset++,this.match+=E,this.matched+=E;var O=E.match(/(?:\r\n?|\n).*/g);return O?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),E},"input"),unput:o(function(E){var O=E.length,I=E.split(/(?:\r\n?|\n)/g);this._input=E+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-O),this.offset-=O;var H=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),I.length-1&&(this.yylineno-=I.length-1);var pe=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:I?(I.length===H.length?this.yylloc.first_column:0)+H[H.length-I.length].length-I[0].length:this.yylloc.first_column-O},this.options.ranges&&(this.yylloc.range=[pe[0],pe[0]+this.yyleng-O]),this.yyleng=this.yytext.length,this},"unput"),more:o(function(){return this._more=!0,this},"more"),reject:o(function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},"reject"),less:o(function(E){this.unput(this.match.slice(E))},"less"),pastInput:o(function(){var E=this.matched.substr(0,this.matched.length-this.match.length);return(E.length>20?"...":"")+E.substr(-20).replace(/\n/g,"")},"pastInput"),upcomingInput:o(function(){var E=this.match;return E.length<20&&(E+=this._input.substr(0,20-E.length)),(E.substr(0,20)+(E.length>20?"...":"")).replace(/\n/g,"")},"upcomingInput"),showPosition:o(function(){var E=this.pastInput(),O=new Array(E.length+1).join("-");return E+this.upcomingInput()+`
`+O+"^"},"showPosition"),test_match:o(function(E,O){var I,H,pe;if(this.options.backtrack_lexer&&(pe={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(pe.yylloc.range=this.yylloc.range.slice(0))),H=E[0].match(/(?:\r\n?|\n).*/g),H&&(this.yylineno+=H.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:H?H[H.length-1].length-H[H.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+E[0].length},this.yytext+=E[0],this.match+=E[0],this.matches=E,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(E[0].length),this.matched+=E[0],I=this.performAction.call(this,this.yy,this,O,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),I)return I;if(this._backtrack){for(var d in pe)this[d]=pe[d];return!1}return!1},"test_match"),next:o(function(){if(this.done)return this.EOF;this._input||(this.done=!0);var E,O,I,H;this._more||(this.yytext="",this.match="");for(var pe=this._currentRules(),d=0;d<pe.length;d++)if(I=this._input.match(this.rules[pe[d]]),I&&(!O||I[0].length>O[0].length)){if(O=I,H=d,this.options.backtrack_lexer){if(E=this.test_match(I,pe[d]),E!==!1)return E;if(this._backtrack){O=!1;continue}else return!1}else if(!this.options.flex)break}return O?(E=this.test_match(O,pe[H]),E!==!1?E:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},"next"),lex:o(function(){var O=this.next();return O||this.lex()},"lex"),begin:o(function(O){this.conditionStack.push(O)},"begin"),popState:o(function(){var O=this.conditionStack.length-1;return O>0?this.conditionStack.pop():this.conditionStack[0]},"popState"),_currentRules:o(function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},"_currentRules"),topState:o(function(O){return O=this.conditionStack.length-1-Math.abs(O||0),O>=0?this.conditionStack[O]:"INITIAL"},"topState"),pushState:o(function(O){this.begin(O)},"pushState"),stateStackSize:o(function(){return this.conditionStack.length},"stateStackSize"),options:{flex:!0,"case-insensitive":!0},performAction:o(function(O,I,H,pe){var d=pe;switch(H){case 0:break;case 1:return 12;case 2:return 15;case 3:return 41;case 4:return 325;case 5:return 326;case 6:return 45;case 7:return 47;case 8:return 48;case 9:return 39;case 10:return 24;case 11:return 28;case 12:return 29;case 13:return 31;case 14:return 32;case 15:return 36;case 16:return 53;case 17:return 327;case 18:return 63;case 19:return 64;case 20:return 70;case 21:return 73;case 22:return 76;case 23:return 78;case 24:return 81;case 25:return 83;case 26:return 85;case 27:return 193;case 28:return 100;case 29:return 328;case 30:return 121;case 31:return 329;case 32:return 330;case 33:return 110;case 34:return 331;case 35:return 109;case 36:return 332;case 37:return 333;case 38:return 113;case 39:return 115;case 40:return 116;case 41:return 131;case 42:return 123;case 43:return 126;case 44:return 128;case 45:return 132;case 46:return 112;case 47:return 334;case 48:return 335;case 49:return 159;case 50:return 161;case 51:return 164;case 52:return 174;case 53:return 160;case 54:return 336;case 55:return 163;case 56:return 312;case 57:return 314;case 58:return 317;case 59:return 318;case 60:return 272;case 61:return 197;case 62:return 337;case 63:return 338;case 64:return 229;case 65:return 340;case 66:return 263;case 67:return 224;case 68:return 231;case 69:return 232;case 70:return 242;case 71:return 246;case 72:return 290;case 73:return 341;case 74:return 342;case 75:return 343;case 76:return 344;case 77:return 345;case 78:return 250;case 79:return 346;case 80:return 265;case 81:return 276;case 82:return 277;case 83:return 268;case 84:return 269;case 85:return 270;case 86:return 271;case 87:return 347;case 88:return 348;case 89:return 273;case 90:return 274;case 91:return 350;case 92:return 349;case 93:return 351;case 94:return 279;case 95:return 280;case 96:return 283;case 97:return 285;case 98:return 289;case 99:return 293;case 100:return 296;case 101:return 13;case 102:return 16;case 103:return 308;case 104:return 309;case 105:return 87;case 106:return 292;case 107:return 82;case 108:return 294;case 109:return 295;case 110:return 297;case 111:return 298;case 112:return 299;case 113:return 300;case 114:return 301;case 115:return 302;case 116:return"EXPONENT";case 117:return 303;case 118:return 304;case 119:return 305;case 120:return 306;case 121:return 89;case 122:return 310;case 123:return 6;case 124:return"INVALID";case 125:console.log(I.yytext);break}},"anonymous"),rules:[/^(?:\s+|(#[^\n\r]*))/i,/^(?:BASE)/i,/^(?:PREFIX)/i,/^(?:SELECT)/i,/^(?:DISTINCT)/i,/^(?:REDUCED)/i,/^(?:\()/i,/^(?:AS)/i,/^(?:\))/i,/^(?:\*)/i,/^(?:CONSTRUCT)/i,/^(?:WHERE)/i,/^(?:\{)/i,/^(?:\})/i,/^(?:DESCRIBE)/i,/^(?:ASK)/i,/^(?:FROM)/i,/^(?:NAMED)/i,/^(?:GROUP)/i,/^(?:BY)/i,/^(?:HAVING)/i,/^(?:ORDER)/i,/^(?:ASC)/i,/^(?:DESC)/i,/^(?:LIMIT)/i,/^(?:OFFSET)/i,/^(?:VALUES)/i,/^(?:;)/i,/^(?:LOAD)/i,/^(?:SILENT)/i,/^(?:INTO)/i,/^(?:CLEAR)/i,/^(?:DROP)/i,/^(?:CREATE)/i,/^(?:ADD)/i,/^(?:TO)/i,/^(?:MOVE)/i,/^(?:COPY)/i,/^(?:INSERT((\s+|(#[^\n\r]*)\n\r?)+)DATA)/i,/^(?:DELETE((\s+|(#[^\n\r]*)\n\r?)+)DATA)/i,/^(?:DELETE((\s+|(#[^\n\r]*)\n\r?)+)WHERE)/i,/^(?:WITH)/i,/^(?:DELETE)/i,/^(?:INSERT)/i,/^(?:USING)/i,/^(?:DEFAULT)/i,/^(?:GRAPH)/i,/^(?:ALL)/i,/^(?:\.)/i,/^(?:OPTIONAL)/i,/^(?:SERVICE)/i,/^(?:BIND)/i,/^(?:UNDEF)/i,/^(?:MINUS)/i,/^(?:UNION)/i,/^(?:FILTER)/i,/^(?:<<)/i,/^(?:>>)/i,/^(?:\{\|)/i,/^(?:\|\})/i,/^(?:,)/i,/^(?:a)/i,/^(?:\|)/i,/^(?:\/)/i,/^(?:\^)/i,/^(?:\?)/i,/^(?:\+)/i,/^(?:!)/i,/^(?:\[)/i,/^(?:\])/i,/^(?:\|\|)/i,/^(?:&&)/i,/^(?:=)/i,/^(?:!=)/i,/^(?:<)/i,/^(?:>)/i,/^(?:<=)/i,/^(?:>=)/i,/^(?:IN)/i,/^(?:NOT)/i,/^(?:-)/i,/^(?:BOUND)/i,/^(?:BNODE)/i,/^(?:(RAND|NOW|UUID|STRUUID))/i,/^(?:(LANG|DATATYPE|IRI|URI|ABS|CEIL|FLOOR|ROUND|STRLEN|STR|UCASE|LCASE|ENCODE_FOR_URI|YEAR|MONTH|DAY|HOURS|MINUTES|SECONDS|TIMEZONE|TZ|MD5|SHA1|SHA256|SHA384|SHA512|isIRI|isURI|isBLANK|isLITERAL|isNUMERIC))/i,/^(?:(SUBJECT|PREDICATE|OBJECT|isTRIPLE))/i,/^(?:(LANGMATCHES|CONTAINS|STRSTARTS|STRENDS|STRBEFORE|STRAFTER|STRLANG|STRDT|sameTerm))/i,/^(?:CONCAT)/i,/^(?:COALESCE)/i,/^(?:IF)/i,/^(?:TRIPLE)/i,/^(?:REGEX)/i,/^(?:SUBSTR)/i,/^(?:REPLACE)/i,/^(?:EXISTS)/i,/^(?:COUNT)/i,/^(?:SUM|MIN|MAX|AVG|SAMPLE)/i,/^(?:GROUP_CONCAT)/i,/^(?:SEPARATOR)/i,/^(?:\^\^)/i,/^(?:true|false)/i,/^(?:(<(?:[^<>\"\{\}\|\^`\\\u0000-\u0020])*>))/i,/^(?:((([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])(?:(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|\.)*(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040]))?)?:))/i,/^(?:(((([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])(?:(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|\.)*(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040]))?)?:)((?:((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|:|[0-9]|((%([0-9A-Fa-f])([0-9A-Fa-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%))))(?:(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|\.|:|((%([0-9A-Fa-f])([0-9A-Fa-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%))))*(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|:|((%([0-9A-Fa-f])([0-9A-Fa-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%)))))?)))/i,/^(?:(_:(?:((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|[0-9])(?:(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|\.)*(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040]))?))/i,/^(?:([\?\$]((?:((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|[0-9])(?:((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])*)))/i,/^(?:(@[a-zA-Z]+(?:-[a-zA-Z0-9]+)*))/i,/^(?:([0-9]+))/i,/^(?:([0-9]*\.[0-9]+))/i,/^(?:([0-9]+\.[0-9]*([eE][+-]?[0-9]+)|\.([0-9])+([eE][+-]?[0-9]+)|([0-9])+([eE][+-]?[0-9]+)))/i,/^(?:(\+([0-9]+)))/i,/^(?:(\+([0-9]*\.[0-9]+)))/i,/^(?:(\+([0-9]+\.[0-9]*([eE][+-]?[0-9]+)|\.([0-9])+([eE][+-]?[0-9]+)|([0-9])+([eE][+-]?[0-9]+))))/i,/^(?:(-([0-9]+)))/i,/^(?:(-([0-9]*\.[0-9]+)))/i,/^(?:(-([0-9]+\.[0-9]*([eE][+-]?[0-9]+)|\.([0-9])+([eE][+-]?[0-9]+)|([0-9])+([eE][+-]?[0-9]+))))/i,/^(?:([eE][+-]?[0-9]+))/i,/^(?:('(?:(?:[^\u0027\u005C\u000A\u000D])|(\\[tbnrf\\\"']|\\u([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])|\\U([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])))*'))/i,/^(?:("(?:(?:[^\u0022\u005C\u000A\u000D])|(\\[tbnrf\\\"']|\\u([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])|\\U([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])))*"))/i,/^(?:('''(?:(?:'|'')?(?:[^'\\]|(\\[tbnrf\\\"']|\\u([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])|\\U([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f]))))*'''))/i,/^(?:("""(?:(?:"|"")?(?:[^\"\\]|(\\[tbnrf\\\"']|\\u([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])|\\U([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f]))))*"""))/i,/^(?:(\((\u0020|\u0009|\u000D|\u000A)*\)))/i,/^(?:(\[(\u0020|\u0009|\u000D|\u000A)*\]))/i,/^(?:$)/i,/^(?:.)/i,/^(?:.)/i],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125],inclusive:!0}}};return A})();zl.lexer=zS;function we(){this.yy={}}return o(we,"Parser"),we.prototype=zl,zl.Parser=we,new we})();xg.exports=Xx});var Ig=y((Vk,Fg)=>{var Zx="http://www.w3.org/2001/XMLSchema#integer",e5="http://www.w3.org/2001/XMLSchema#string";function Je(r){this._options=r=r||{};var e=r.prefixes||{};this._prefixByIri={};var t=[];for(var n in e){var i=e[n];Ha(i)&&(this._prefixByIri[i]=n,t.push(i))}var s=t.join("|").replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&");this._prefixRegex=new RegExp("^("+s+")([a-zA-Z][\\-_a-zA-Z0-9]*)$"),this._usedPrefixes={},this._sparqlStar=r.sparqlStar,this._indent=Ha(r.indent)?r.indent:"  ",this._newline=Ha(r.newline)?r.newline:`
`,this._explicitDatatype=!!r.explicitDatatype}o(Je,"Generator");Je.prototype.toQuery=function(r){var e="";return r.queryType&&(e+=r.queryType.toUpperCase()+" "),r.reduced&&(e+="REDUCED "),r.distinct&&(e+="DISTINCT "),r.variables?e+=wr(r.variables,void 0,function(t){return/^[?$]/.test(t)?t:gi(t)?this.toEntity(t):"("+this.toExpression(t.expression)+" AS "+pu(t.variable)+")"},this)+" ":r.template&&(e+=this.group(r.template,!0)+this._newline),r.from&&(e+=this.graphs("FROM ",r.from.default)+this.graphs("FROM NAMED ",r.from.named)),r.where&&(e+="WHERE "+this.group(r.where,!0)+this._newline),r.updates&&(e+=wr(r.updates,";"+this._newline,this.toUpdate,this)),r.group&&(e+="GROUP BY "+wr(r.group,void 0,function(t){var n=gi(t.expression)?this.toEntity(t.expression):"("+this.toExpression(t.expression)+")";return t.variable?"("+n+" AS "+pu(t.variable)+")":n},this)+this._newline),r.having&&(e+="HAVING ("+wr(r.having,void 0,this.toExpression,this)+")"+this._newline),r.order&&(e+="ORDER BY "+wr(r.order,void 0,function(t){var n="("+this.toExpression(t.expression)+")";return t.descending?"DESC "+n:n},this)+this._newline),r.offset&&(e+="OFFSET "+r.offset+this._newline),r.limit&&(e+="LIMIT "+r.limit+this._newline),r.values&&(e+=this.values(r)),e=this.baseAndPrefixes(r)+e,e.trim()};Je.prototype.baseAndPrefixes=function(r){var e=r.base?"BASE <"+r.base+">"+this._newline:"",t="";for(var n in r.prefixes)(this._options.allPrefixes||this._usedPrefixes[n])&&(t+="PREFIX "+n+": <"+r.prefixes[n]+">"+this._newline);return e+t};Je.prototype.toPattern=function(r){var e=r.type||r instanceof Array&&"array"||(r.subject&&r.predicate&&r.object?"triple":"");if(!(e in this))throw new Error("Unknown entry type: "+e);return this[e](r)};Je.prototype.triple=function(r){return this.toEntity(r.subject)+" "+this.toEntity(r.predicate)+" "+this.toEntity(r.object)+"."};Je.prototype.array=function(r){return wr(r,this._newline,this.toPattern,this)};Je.prototype.bgp=function(r){return this.encodeTriples(r.triples)};Je.prototype.encodeTriples=function(r){if(!r.length)return"";for(var e=[],t=void 0,n=void 0,i=0;i<r.length;i++){var s=r[i];rs(s.subject,t)?rs(s.predicate,n)?e.push(","):(n=s.predicate,e.push(";"+this._newline,this._indent,this.toEntity(n))):(t&&e.push("."+this._newline),t=s.subject,n=s.predicate,e.push(this.toEntity(t)," ",this.toEntity(n))),e.push(" ",this.toEntity(s.object))}return e.push("."),e.join("")};Je.prototype.graph=function(r){return"GRAPH "+this.toEntity(r.name)+" "+this.group(r)};Je.prototype.graphs=function(r,e){return!e||e.length===0?"":wr(e,"",function(t){return r+this.toEntity(t)+this._newline},this)};Je.prototype.group=function(r,e){return r=e!==!0?this.array(r.patterns||r.triples):this.toPattern(r.type!=="group"?r:r.patterns),r.indexOf(this._newline)===-1?"{ "+r+" }":"{"+this._newline+this.indent(r)+this._newline+"}"};Je.prototype.query=function(r){return this.toQuery(r)};Je.prototype.filter=function(r){return"FILTER("+this.toExpression(r.expression)+")"};Je.prototype.bind=function(r){return"BIND("+this.toExpression(r.expression)+" AS "+pu(r.variable)+")"};Je.prototype.optional=function(r){return"OPTIONAL "+this.group(r)};Je.prototype.union=function(r){return wr(r.patterns,this._newline+"UNION"+this._newline,function(e){return this.group(e,!0)},this)};Je.prototype.minus=function(r){return"MINUS "+this.group(r)};Je.prototype.values=function(r){var e=Object.keys(r.values.reduce(function(i,s){for(var a in s)i[a]=!0;return i},{})),t,n;return e.length===1?t=n="":(t="(",n=")"),"VALUES "+t+e.join(" ")+n+" {"+this._newline+wr(r.values,this._newline,function(i){return"  "+t+wr(e,void 0,function(s){return i[s]?this.toEntity(i[s]):"UNDEF"},this)+n},this)+this._newline+"}"};Je.prototype.service=function(r){return"SERVICE "+(r.silent?"SILENT ":"")+this.toEntity(r.name)+" "+this.group(r)};Je.prototype.toExpression=function(r){if(gi(r))return this.toEntity(r);switch(r.type.toLowerCase()){case"aggregate":return r.aggregation.toUpperCase()+"("+(r.distinct?"DISTINCT ":"")+this.toExpression(r.expression)+(typeof r.separator=="string"?'; SEPARATOR = "'+r.separator.replace(Cg,Pg)+'"':"")+")";case"functioncall":return this.toEntity(r.function)+"("+wr(r.args,", ",this.toExpression,this)+")";case"operation":var e=r.operator.toUpperCase(),t=r.args||[];switch(r.operator.toLowerCase()){case"<":case">":case">=":case"<=":case"&&":case"||":case"=":case"!=":case"+":case"-":case"*":case"/":return(gi(t[0])?this.toEntity(t[0]):"("+this.toExpression(t[0])+")")+" "+e+" "+(gi(t[1])?this.toEntity(t[1]):"("+this.toExpression(t[1])+")");case"!":return"!("+this.toExpression(t[0])+")";case"uplus":return"+("+this.toExpression(t[0])+")";case"uminus":return"-("+this.toExpression(t[0])+")";case"notin":e="NOT IN";case"in":return this.toExpression(t[0])+" "+e+"("+(Ha(t[1])?t[1]:wr(t[1],", ",this.toExpression,this))+")";case"notexists":e="NOT EXISTS";case"exists":return e+" "+this.group(t[0],!0);default:return e+"("+wr(t,", ",this.toExpression,this)+")"}default:throw new Error("Unknown expression type: "+r.type)}};Je.prototype.toEntity=function(r){if(gi(r))switch(r.termType){case"Wildcard":return"*";case"Variable":return pu(r);case"BlankNode":return"_:"+r.value;case"Literal":var e=r.value||"",t=r.language||"",n=r.datatype;if(r='"'+e.replace(Cg,Pg)+'"',t)r+="@"+t;else if(n){if(!this._explicitDatatype)switch(n.value){case e5:return r;case Zx:if(/^\d+$/.test(e))return e+" "}r+="^^"+this.encodeIRI(n.value)}return r;case"Quad":if(!this._sparqlStar)throw new Error("SPARQL* support is not enabled");return r.graph&&r.graph.termType!=="DefaultGraph"?"<< GRAPH "+this.toEntity(r.graph)+" { "+this.toEntity(r.subject)+" "+this.toEntity(r.predicate)+" "+this.toEntity(r.object)+" }  >>":"<< "+this.toEntity(r.subject)+" "+this.toEntity(r.predicate)+" "+this.toEntity(r.object)+" >>";default:return this.encodeIRI(r.value)}else{var i=r.items.map(this.toEntity,this),s=r.pathType;switch(s){case"^":case"!":return s+i[0];case"*":case"+":case"?":return"("+i[0]+s+")";default:return"("+i.join(s)+")"}}};var Cg=/["\\\t\n\r\b\f]/g,Pg=o(function(r){return t5[r]},"escapeReplacer"),t5={"\\":"\\\\",'"':'\\"',"	":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};Je.prototype.encodeIRI=function(r){var e=this._prefixRegex.exec(r);if(e){var t=this._prefixByIri[e[1]];return this._usedPrefixes[t]=!0,t+":"+e[2]}return"<"+r+">"};Je.prototype.toUpdate=function(r){switch(r.type||r.updateType){case"load":return"LOAD"+(r.source?" "+this.toEntity(r.source):"")+(r.destination?" INTO GRAPH "+this.toEntity(r.destination):"");case"insert":return"INSERT DATA "+this.group(r.insert,!0);case"delete":return"DELETE DATA "+this.group(r.delete,!0);case"deletewhere":return"DELETE WHERE "+this.group(r.delete,!0);case"insertdelete":return(r.graph?"WITH "+this.toEntity(r.graph)+this._newline:"")+(r.delete.length?"DELETE "+this.group(r.delete,!0)+this._newline:"")+(r.insert.length?"INSERT "+this.group(r.insert,!0)+this._newline:"")+(r.using?this.graphs("USING ",r.using.default):"")+(r.using?this.graphs("USING NAMED ",r.using.named):"")+"WHERE "+this.group(r.where,!0);case"add":case"copy":case"move":return r.type.toUpperCase()+" "+(r.silent?"SILENT ":"")+(r.source.default?"DEFAULT":this.toEntity(r.source.name))+" TO "+this.toEntity(r.destination.name);case"create":case"clear":case"drop":return r.type.toUpperCase()+(r.silent?" SILENT ":" ")+(r.graph.default?"DEFAULT":r.graph.named?"NAMED":r.graph.all?"ALL":"GRAPH "+this.toEntity(r.graph.name));default:throw new Error("Unknown update query type: "+r.type)}};Je.prototype.indent=function(r){return r.replace(/^/gm,this._indent)};function pu(r){return"?"+r.value}o(pu,"variableToString");function Ha(r){return typeof r=="string"}o(Ha,"isString");function gi(r){return typeof r.termType=="string"}o(gi,"isTerm");function rs(r,e){if(!r||!gi(r)||!e||!gi(e)||r.termType!==e.termType)return!1;switch(r.termType){case"Literal":return r.value===e.value&&r.language===e.language&&rs(r.datatype,e.datatype);case"Quad":return rs(r.subject,e.subject)&&rs(r.predicate,e.predicate)&&rs(r.object,e.object)&&rs(r.graph,e.graph);default:return r.value===e.value}}o(rs,"equalTerms");function wr(r,e,t,n){return r.map(t,n).join(Ha(e)?e:" ")}o(wr,"mapJoin");function r5(r={}){return{stringify:o(function(e){var t=Object.create(r);return t.prefixes=e.prefixes,new Je(t).toQuery(e)},"stringify"),createGenerator:o(function(){return new Je(r)},"createGenerator")}}o(r5,"_Generator");Fg.exports={Generator:r5}});var ip=y(mu=>{"use strict";Object.defineProperty(mu,"__esModule",{value:!0});mu.BlankNode=void 0;var np=class{static{o(this,"BlankNode")}constructor(e){this.termType="BlankNode",this.value=e}equals(e){return!!e&&e.termType==="BlankNode"&&e.value===this.value}};mu.BlankNode=np});var sp=y(gu=>{"use strict";Object.defineProperty(gu,"__esModule",{value:!0});gu.DefaultGraph=void 0;var za=class{static{o(this,"DefaultGraph")}constructor(){this.termType="DefaultGraph",this.value=""}equals(e){return!!e&&e.termType==="DefaultGraph"}};gu.DefaultGraph=za;za.INSTANCE=new za});var _u=y(yu=>{"use strict";Object.defineProperty(yu,"__esModule",{value:!0});yu.NamedNode=void 0;var ap=class{static{o(this,"NamedNode")}constructor(e){this.termType="NamedNode",this.value=e}equals(e){return!!e&&e.termType==="NamedNode"&&e.value===this.value}};yu.NamedNode=ap});var op=y(vu=>{"use strict";Object.defineProperty(vu,"__esModule",{value:!0});vu.Literal=void 0;var Rg=_u(),Ka=class r{static{o(this,"Literal")}constructor(e,t){this.termType="Literal",this.value=e,typeof t=="string"?(this.language=t,this.datatype=r.RDF_LANGUAGE_STRING):t?(this.language="",this.datatype=t):(this.language="",this.datatype=r.XSD_STRING)}equals(e){return!!e&&e.termType==="Literal"&&e.value===this.value&&e.language===this.language&&this.datatype.equals(e.datatype)}};vu.Literal=Ka;Ka.RDF_LANGUAGE_STRING=new Rg.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString");Ka.XSD_STRING=new Rg.NamedNode("http://www.w3.org/2001/XMLSchema#string")});var up=y(Su=>{"use strict";Object.defineProperty(Su,"__esModule",{value:!0});Su.Quad=void 0;var cp=class{static{o(this,"Quad")}constructor(e,t,n,i){this.termType="Quad",this.value="",this.subject=e,this.predicate=t,this.object=n,this.graph=i}equals(e){return!!e&&(e.termType==="Quad"||!e.termType)&&this.subject.equals(e.subject)&&this.predicate.equals(e.predicate)&&this.object.equals(e.object)&&this.graph.equals(e.graph)}};Su.Quad=cp});var fp=y(wu=>{"use strict";Object.defineProperty(wu,"__esModule",{value:!0});wu.Variable=void 0;var lp=class{static{o(this,"Variable")}constructor(e){this.termType="Variable",this.value=e}equals(e){return!!e&&e.termType==="Variable"&&e.value===this.value}};wu.Variable=lp});var Ng=y(bu=>{"use strict";Object.defineProperty(bu,"__esModule",{value:!0});bu.DataFactory=void 0;var n5=ip(),i5=sp(),Dg=op(),s5=_u(),a5=up(),o5=fp(),c5=0,hp=class{static{o(this,"DataFactory")}constructor(e){this.blankNodeCounter=0,e=e||{},this.blankNodePrefix=e.blankNodePrefix||`df_${c5++}_`}namedNode(e){return new s5.NamedNode(e)}blankNode(e){return new n5.BlankNode(e||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(e,t){return new Dg.Literal(e,t)}variable(e){return new o5.Variable(e)}defaultGraph(){return i5.DefaultGraph.INSTANCE}quad(e,t,n,i){return new a5.Quad(e,t,n,i||this.defaultGraph())}fromTerm(e){switch(e.termType){case"NamedNode":return this.namedNode(e.value);case"BlankNode":return this.blankNode(e.value);case"Literal":return e.language?this.literal(e.value,e.language):e.datatype.equals(Dg.Literal.XSD_STRING)?this.literal(e.value):this.literal(e.value,this.fromTerm(e.datatype));case"Variable":return this.variable(e.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(e.subject),this.fromTerm(e.predicate),this.fromTerm(e.object),this.fromTerm(e.graph))}}fromQuad(e){return this.fromTerm(e)}resetBlankNodeCounter(){this.blankNodeCounter=0}};bu.DataFactory=hp});var kg=y(br=>{"use strict";var u5=br&&br.__createBinding||(Object.create?(function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:o(function(){return e[t]},"get")}),Object.defineProperty(r,n,i)}):(function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]})),ns=br&&br.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&u5(e,r,t)};Object.defineProperty(br,"__esModule",{value:!0});ns(ip(),br);ns(Ng(),br);ns(sp(),br);ns(op(),br);ns(_u(),br);ns(up(),br);ns(fp(),br)});var Mg=y((nj,jg)=>{var{Parser:Yn}=Og(),{Generator:l5}=Ig(),{Wildcard:f5}=rp(),{DataFactory:h5}=kg();function d5({prefixes:r,baseIRI:e,factory:t,pathOnly:n,sparqlStar:i,skipValidation:s,skipUngroupedVariableCheck:a}={}){let c={};for(let f in r??{})c[f]=r[f];let u=new Yn;return u.parse=function(){return Yn.base=e||"",Yn.prefixes=Object.create(c),Yn.factory=t||new h5,Yn.sparqlStar=!!i,Yn.pathOnly=!!n,Yn.skipValidation=!!s||!!a,Yn.prototype.parse.apply(u,arguments)},u._resetBlanks=Yn._resetBlanks,u}o(d5,"_Parser");jg.exports={Parser:d5,Generator:l5,Wildcard:f5}});var pp=y(Ms=>{"use strict";Object.defineProperty(Ms,"__esModule",{value:!0});Ms.CaseWhenTransformerError=Ms.CaseWhenTransformer=void 0;var dp=class{static{o(this,"CaseWhenTransformer")}transform(e){let t=e,n,i=0,s=100;do if(n=t,t=this.transformSinglePass(t),i++,i>s)throw new Qn("Too many nested CASE expressions (max 100 iterations)");while(t!==n);return t}transformSinglePass(e){let t=this.findCasePositions(e);if(t.length===0)return e;let n=e;for(let i=t.length-1;i>=0;i--){let s=t[i],a=this.extractCaseExpression(n,s);if(a){let c=this.convertCaseToIf(a.content);n=n.substring(0,s)+c+n.substring(s+a.length)}}return n}findCasePositions(e){let t=[],n=e.toUpperCase(),i=0;for(;i<e.length;){if(e[i]==="'"||e[i]==='"'){let s=e[i];for(i++;i<e.length&&e[i]!==s;)e[i]==="\\"&&i++,i++;i++;continue}if(n.substring(i,i+4)==="CASE"&&this.isWordBoundary(e,i,4)){t.push(i),i+=4;continue}i++}return t}extractCaseExpression(e,t){let n=1,i=t+4,s=e.toUpperCase();for(;i<e.length&&n>0;){if(e[i]==="'"||e[i]==='"'){let a=e[i];for(i++;i<e.length&&e[i]!==a;)e[i]==="\\"&&i++,i++;i++;continue}if(s.substring(i,i+4)==="CASE"&&this.isWordBoundary(e,i,4)){n++,i+=4;continue}if(s.substring(i,i+3)==="END"&&this.isWordBoundary(e,i,3)){if(n--,n===0){let a=e.substring(t,i+3);return{content:a,length:a.length}}i+=3;continue}i++}if(n>0)throw new Qn(`Unclosed CASE expression at position ${t}`);return null}isWordBoundary(e,t,n){let i=t>0?e[t-1]:"",s=t===0||!/[a-zA-Z0-9_?$]/.test(i),a=t+n<e.length?e[t+n]:"",c=t+n>=e.length||!/[a-zA-Z0-9_]/.test(a);return s&&c}convertCaseToIf(e){let t=this.extractWhenClauses(e),n=this.extractElseClause(e);if(t.length===0)throw new Qn("CASE expression must have at least one WHEN clause");let i=n!==null?n:'""';for(let s=t.length-1;s>=0;s--){let{condition:a,result:c}=t[s];i=`IF(${a}, ${c}, ${i})`}return i}extractWhenClauses(e){let t=[],n=e.replace(/^\s*CASE\s+/i,"").replace(/\s*END\s*$/i,""),i=this.findKeywordPositions(n,"WHEN"),s=this.findKeywordPositions(n,"ELSE"),a=s.length>0?s[0]:n.length;for(let c=0;c<i.length;c++){let u=i[c]+4,f=c+1<i.length?i[c+1]:a,l=n.substring(u,f).trim(),h=this.parseWhenClause(l);h&&t.push(h)}return t}findKeywordPositions(e,t){let n=[],i=e.toUpperCase(),s=0,a=0;for(;s<e.length;){let c=e[s];if(c==="'"||c==='"'){let u=c;for(s++;s<e.length&&e[s]!==u;)e[s]==="\\"&&s++,s++;s++;continue}if(c==="("){a++,s++;continue}if(c===")"){a--,s++;continue}if(a===0&&i.substring(s,s+t.length)===t&&this.isWordBoundary(e,s,t.length)){n.push(s),s+=t.length;continue}s++}return n}parseWhenClause(e){let t=this.findKeywordPositions(e,"THEN");if(t.length===0)throw new Qn(`WHEN clause missing THEN keyword: ${e.substring(0,50)}...`);let n=t[0],i=e.substring(0,n).trim(),s=e.substring(n+4).trim();if(!i)throw new Qn("WHEN clause has empty condition");if(!s)throw new Qn("WHEN clause has empty result");return{condition:i,result:s}}extractElseClause(e){let t=e.replace(/^\s*CASE\s+/i,"").replace(/\s*END\s*$/i,""),n=this.findKeywordPositions(t,"ELSE");if(n.length>0){let i=n[0];return t.substring(i+4).trim()}return null}};Ms.CaseWhenTransformer=dp;var Qn=class extends Error{static{o(this,"CaseWhenTransformerError")}constructor(e){super(`CASE WHEN transformation error: ${e}`),this.name="CaseWhenTransformerError"}};Ms.CaseWhenTransformerError=Qn});var qg=y(Rr=>{"use strict";var p5=Rr&&Rr.__createBinding||(Object.create?(function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:o(function(){return e[t]},"get")}),Object.defineProperty(r,n,i)}):(function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]})),m5=Rr&&Rr.__setModuleDefault||(Object.create?(function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}):function(r,e){r.default=e}),g5=Rr&&Rr.__importStar||(function(){var r=o(function(e){return r=Object.getOwnPropertyNames||function(t){var n=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[n.length]=i);return n},r(e)},"ownKeys");return function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n=r(e),i=0;i<n.length;i++)n[i]!=="default"&&p5(t,e,n[i]);return m5(t,e),t}})();Object.defineProperty(Rr,"__esModule",{value:!0});Rr.SPARQLParser=Rr.SPARQLParseError=void 0;var Lg=g5(Mg()),Vg=pp(),An=class extends Error{static{o(this,"SPARQLParseError")}constructor(e,t,n,i){super(e,i?{cause:i}:void 0),this.name="SPARQLParseError",this.line=t,this.column=n}};Rr.SPARQLParseError=An;var mp=class{static{o(this,"SPARQLParser")}constructor(){this.parser=new Lg.Parser,this.generator=new Lg.Generator,this.caseWhenTransformer=new Vg.CaseWhenTransformer}parse(e){try{let t=this.caseWhenTransformer.transform(e),n=this.parser.parse(t);return this.validateQuery(n),n}catch(t){if(t instanceof Vg.CaseWhenTransformerError)throw new An(t.message);if(t instanceof Error){let n=t.message.match(/line (\d+), column (\d+)/),i=n?parseInt(n[1],10):void 0,s=n?parseInt(n[2],10):void 0;throw new An(`SPARQL syntax error: ${t.message}`,i,s,t)}throw t}}toString(e){try{return this.generator.stringify(e)}catch(t){throw t instanceof Error?new An(`Failed to serialize SPARQL query: ${t.message}`,void 0,void 0,t):t}}getQueryType(e){if("queryType"in e&&e.type==="query")return e.queryType;throw new An("Query does not have a valid queryType property")}isSelectQuery(e){return"queryType"in e&&e.type==="query"&&e.queryType==="SELECT"}isConstructQuery(e){return"queryType"in e&&e.type==="query"&&e.queryType==="CONSTRUCT"}isAskQuery(e){return"queryType"in e&&e.type==="query"&&e.queryType==="ASK"}isDescribeQuery(e){return"queryType"in e&&e.type==="query"&&e.queryType==="DESCRIBE"}validateQuery(e){if(!e||typeof e!="object")throw new An("Invalid query: not an object");if(e.type!=="query"&&e.type!=="update")throw new An(`Invalid type: expected "query" or "update", got "${e.type}"`);if(e.type==="query"){let t=["SELECT","CONSTRUCT","ASK","DESCRIBE"];if(!t.includes(e.queryType))throw new An(`Invalid query type: expected one of ${t.join(", ")}, got "${e.queryType}"`)}}};Rr.SPARQLParser=mp});var Bg=y(Ls=>{"use strict";Object.defineProperty(Ls,"__esModule",{value:!0});Ls.AlgebraTranslator=Ls.AlgebraTranslatorError=void 0;var Ie=class extends Error{static{o(this,"AlgebraTranslatorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="AlgebraTranslatorError"}};Ls.AlgebraTranslatorError=Ie;var gp=class{static{o(this,"AlgebraTranslator")}constructor(){this.aggregateCounter=0}translate(e){if(e.type!=="query")throw new Ie("Only query operations are supported (not updates)");if(e.queryType==="SELECT")return this.translateSelect(e);if(e.queryType==="CONSTRUCT")return this.translateConstruct(e);if(e.queryType==="ASK")return this.translateAsk(e);throw new Ie(`Query type ${e.queryType} not yet supported`)}translateSelect(e){let t;if(!e.where||e.where.length===0)throw new Ie("SELECT query must have WHERE clause");t=this.translateWhere(e.where),this.aggregateCounter=0;let n=new Map,i=this.extractAggregatesWithMapping(e.variables,n),s=this.extractGroupVariables(e.group);if((i.length>0||s.length>0)&&(t={type:"group",variables:s,aggregates:i,input:t}),e.variables&&e.variables.length>0){for(let c of e.variables){let u=c;if(u.expression&&u.variable){if(u.expression.type==="aggregate")continue;let f=this.transformExpressionWithAggregateVars(u.expression,n);t={type:"extend",variable:u.variable.value,expression:f,input:t}}}let a=e.variables.filter(c=>c.termType==="Variable"||c.variable).map(c=>c.termType==="Variable"?c.value:c.variable.value);a.length>0&&(t={type:"project",variables:a,input:t})}return e.distinct&&(t={type:"distinct",input:t}),e.reduced&&(t={type:"reduced",input:t}),e.order&&e.order.length>0&&(t={type:"orderby",comparators:e.order.map(a=>this.translateOrderComparator(a)),input:t}),(e.limit!==void 0||e.offset!==void 0)&&(t={type:"slice",limit:e.limit,offset:e.offset,input:t}),t}translateConstruct(e){let t=this.translateConstructTemplate(e.template??[]);if(!e.where||e.where.length===0)throw new Ie("CONSTRUCT query must have WHERE clause");let n=this.translateWhere(e.where);return{type:"construct",template:t,where:n}}translateConstructTemplate(e){return!e||!Array.isArray(e)?[]:e.map(t=>this.translateTriple(t))}translateAsk(e){return{type:"ask",where:e.where&&e.where.length>0?this.translateWhere(e.where):{type:"bgp",triples:[]}}}extractAggregatesWithMapping(e,t){if(!e)return[];let n=[];for(let i of e)!i.expression||!i.variable||(i.expression.type==="aggregate"?(n.push({variable:i.variable.value,expression:this.translateAggregateExpression(i.expression)}),t.set(i.expression,i.variable.value)):this.collectNestedAggregates(i.expression,n,t));return n}collectNestedAggregates(e,t,n){if(e){if(e.type==="aggregate"){let i=`__agg${this.aggregateCounter++}`;t.push({variable:i,expression:this.translateAggregateExpression(e)}),n.set(e,i)}else if(e.type==="operation"&&e.args)for(let i of e.args)this.collectNestedAggregates(i,t,n)}}transformExpressionWithAggregateVars(e,t){if(t.has(e))return{type:"variable",name:t.get(e)};if(e.type==="operation"&&e.args){let n=e.args.map(c=>this.transformExpressionWithAggregateVars(c,t)),i=["=","!=","<",">","<=",">="],s=["&&","||","!"],a=["+","-","*","/"];return i.includes(e.operator)?{type:"comparison",operator:e.operator,left:n[0],right:n[1]}:s.includes(e.operator)?{type:"logical",operator:e.operator,operands:n}:a.includes(e.operator)?{type:"arithmetic",operator:e.operator,left:n[0],right:n[1]}:{type:"function",function:e.operator,args:n}}return this.translateExpression(e)}extractGroupVariables(e){return e?e.filter(t=>t.expression&&t.expression.termType==="Variable").map(t=>t.expression.value):[]}translateAggregateExpression(e){return{type:"aggregate",aggregation:e.aggregation.toLowerCase(),expression:e.expression?this.translateExpression(e.expression):void 0,distinct:e.distinct||!1,separator:e.separator}}translateWhere(e){if(e.length===0)throw new Ie("Empty WHERE clause");let t=e.filter(a=>a.type==="filter"),n=e.filter(a=>a.type==="bind"),i=e.filter(a=>a.type!=="filter"&&a.type!=="bind"),s;i.length===0?s={type:"bgp",triples:[]}:i.length===1?s=this.translatePattern(i[0]):s=i.map(c=>this.translatePattern(c)).reduce((c,u)=>({type:"join",left:c,right:u}));for(let a of n)s=this.translateBind(a,s);for(let a of t)s={type:"filter",expression:this.translateExpression(a.expression),input:s};return s}translatePattern(e){if(!e||!e.type)throw new Ie("Invalid pattern: missing type");switch(e.type){case"bgp":return this.translateBGP(e);case"filter":return this.translateFilter(e);case"optional":return this.translateOptional(e);case"union":return this.translateUnion(e);case"minus":return this.translateMinus(e);case"values":return this.translateValues(e);case"group":return this.translateWhere(e.patterns);case"query":return this.translateSubquery(e);default:throw new Ie(`Unsupported pattern type: ${e.type}`)}}translateBGP(e){if(!e.triples||!Array.isArray(e.triples))throw new Ie("BGP pattern must have triples array");return{type:"bgp",triples:e.triples.map(t=>this.translateTriple(t))}}translateTriple(e){if(!e.subject||!e.predicate||!e.object)throw new Ie("Triple must have subject, predicate, and object");return{subject:this.translateTripleElement(e.subject),predicate:this.translatePredicate(e.predicate),object:this.translateTripleElement(e.object)}}translatePredicate(e){return e.type==="path"?this.translatePropertyPath(e):this.translateTripleElement(e)}translatePropertyPath(e){if(!e.pathType)throw new Ie("Property path must have pathType");if(!e.items||!Array.isArray(e.items))throw new Ie("Property path must have items array");let t=e.items.map(n=>this.translatePathItem(n));switch(e.pathType){case"/":return{type:"path",pathType:"/",items:t};case"|":return{type:"path",pathType:"|",items:t};case"^":if(t.length!==1)throw new Ie("Inverse path must have exactly one item");return{type:"path",pathType:"^",items:[t[0]]};case"+":if(t.length!==1)throw new Ie("OneOrMore path must have exactly one item");return{type:"path",pathType:"+",items:[t[0]]};case"*":if(t.length!==1)throw new Ie("ZeroOrMore path must have exactly one item");return{type:"path",pathType:"*",items:[t[0]]};case"?":if(t.length!==1)throw new Ie("ZeroOrOne path must have exactly one item");return{type:"path",pathType:"?",items:[t[0]]};default:throw new Ie(`Unsupported property path type: ${e.pathType}`)}}translatePathItem(e){if(e.type==="path")return this.translatePropertyPath(e);if(e.termType==="NamedNode")return{type:"iri",value:e.value};throw new Ie(`Unsupported path item type: ${e.type||e.termType}`)}translateTripleElement(e){if(!e||!e.termType)throw new Ie("Triple element must have termType");switch(e.termType){case"Variable":return{type:"variable",value:e.value};case"NamedNode":return{type:"iri",value:e.value};case"Literal":return{type:"literal",value:e.value,datatype:e.datatype?.value,language:e.language};case"BlankNode":return{type:"blank",value:e.value};default:throw new Ie(`Unsupported term type: ${e.termType}`)}}translateFilter(e){if(!e.expression)throw new Ie("Filter pattern must have expression");let t=e.patterns?this.translateWhere(e.patterns):{type:"bgp",triples:[]};return{type:"filter",expression:this.translateExpression(e.expression),input:t}}translateExpression(e){if(!e)throw new Ie("Expression cannot be null or undefined");if(e.type==="operation")return this.translateOperationExpression(e);if(e.type==="functioncall"||e.type==="functionCall")return{type:"functionCall",function:e.function,args:e.args.map(t=>this.translateExpression(t))};if(e.termType)return this.translateTermExpression(e);throw new Ie(`Unsupported expression structure: ${JSON.stringify(e)}`)}translateOperationExpression(e){let t=["=","!=","<",">","<=",">="],n=["&&","||","!"],i=["+","-","*","/"];return t.includes(e.operator)?{type:"comparison",operator:e.operator,left:this.translateExpression(e.args[0]),right:this.translateExpression(e.args[1])}:n.includes(e.operator)?{type:"logical",operator:e.operator,operands:e.args.map(s=>this.translateExpression(s))}:i.includes(e.operator)?{type:"arithmetic",operator:e.operator,left:this.translateExpression(e.args[0]),right:this.translateExpression(e.args[1])}:e.operator==="exists"||e.operator==="notexists"?this.translateExistsExpression(e):e.operator==="in"||e.operator==="notin"?this.translateInExpression(e):{type:"function",function:e.operator,args:e.args.map(s=>this.translateExpression(s))}}translateExistsExpression(e){if(!e.args||e.args.length!==1)throw new Ie("EXISTS/NOT EXISTS must have exactly one pattern argument");let t=e.args[0],n;return t.type==="group"&&t.patterns?n=this.translateWhere(t.patterns):t.type==="bgp"?n=this.translateBGP(t):n=this.translatePattern(t),{type:"exists",negated:e.operator==="notexists",pattern:n}}translateInExpression(e){if(!e.args||e.args.length!==2)throw new Ie("IN/NOT IN must have exactly 2 arguments (expression and list)");let t=e.args[0],n=e.args[1];if(!Array.isArray(n))throw new Ie("IN/NOT IN second argument must be an array of values");return{type:"in",expression:this.translateExpression(t),list:n.map(i=>this.translateExpression(i)),negated:e.operator==="notin"}}translateTermExpression(e){if(e.termType==="Variable")return{type:"variable",name:e.value};if(e.termType==="Literal"){let t=e.value;return e.datatype&&(e.datatype.value.includes("#integer")||e.datatype.value.includes("#decimal")?t=parseFloat(e.value):e.datatype.value.includes("#boolean")&&(t=e.value==="true")),{type:"literal",value:t,datatype:e.datatype?.value}}return{type:"literal",value:String(e.value||e)}}translateOptional(e){if(!e.patterns||e.patterns.length===0)throw new Ie("OPTIONAL pattern must have patterns");return{type:"leftjoin",left:{type:"bgp",triples:[]},right:this.translateWhere(e.patterns),expression:e.expression?this.translateExpression(e.expression):void 0}}translateUnion(e){if(!e.patterns||e.patterns.length<2)throw new Ie("UNION pattern must have at least 2 patterns");let t=o(i=>i.patterns&&Array.isArray(i.patterns)?this.translateWhere(i.patterns):this.translateWhere([i]),"translateBranch"),n={type:"union",left:t(e.patterns[0]),right:t(e.patterns[1])};for(let i=2;i<e.patterns.length;i++)n={type:"union",left:n,right:t(e.patterns[i])};return n}translateMinus(e){if(!e.patterns||e.patterns.length===0)throw new Ie("MINUS pattern must have patterns");return{type:"minus",left:{type:"bgp",triples:[]},right:this.translateWhere(e.patterns)}}translateValues(e){if(!e.values||!Array.isArray(e.values))throw new Ie("VALUES pattern must have values array");let t=new Set;for(let i of e.values)for(let s of Object.keys(i)){let a=s.startsWith("?")?s.slice(1):s;t.add(a)}let n=e.values.map(i=>this.translateValuesBinding(i));return{type:"values",variables:Array.from(t),bindings:n}}translateValuesBinding(e){let t={};for(let[n,i]of Object.entries(e)){let s=n.startsWith("?")?n.slice(1):n,a=i;if(a.termType==="NamedNode")t[s]={type:"iri",value:a.value};else if(a.termType==="Literal")t[s]={type:"literal",value:a.value,datatype:a.datatype?.value,language:a.language||void 0};else throw new Ie(`Unsupported VALUES term type: ${a.termType}`)}return t}translateBind(e,t){if(!e.variable||!e.expression)throw new Ie("BIND pattern must have variable and expression");return{type:"extend",variable:e.variable.value,expression:this.translateExpression(e.expression),input:t}}translateOrderComparator(e){return{expression:this.translateExpression(e.expression),descending:e.descending||!1}}translateSubquery(e){if(e.queryType!=="SELECT")throw new Ie(`Only SELECT subqueries are supported, got: ${e.queryType}`);return{type:"subquery",query:this.translateSelect(e)}}};Ls.AlgebraTranslator=gp});var Ug=y(Eu=>{"use strict";Object.defineProperty(Eu,"__esModule",{value:!0});Eu.AlgebraOptimizer=void 0;var yp=class{static{o(this,"AlgebraOptimizer")}constructor(){this.stats=new Map}optimize(e){let t=e;return t=this.eliminateEmptyBGPInFilterJoin(t),t=this.filterPushDown(t),t=this.joinReordering(t),t}eliminateEmptyBGPInFilterJoin(e){if(e.type==="join"){if(e.left.type==="filter"){let t=e.left;if(t.input.type==="bgp"&&t.input.triples.length===0)return{type:"filter",expression:t.expression,input:this.eliminateEmptyBGPInFilterJoin(e.right)}}if(e.right.type==="filter"){let t=e.right;if(t.input.type==="bgp"&&t.input.triples.length===0)return{type:"filter",expression:t.expression,input:this.eliminateEmptyBGPInFilterJoin(e.left)}}return{type:"join",left:this.eliminateEmptyBGPInFilterJoin(e.left),right:this.eliminateEmptyBGPInFilterJoin(e.right)}}return e.type==="filter"?{...e,input:this.eliminateEmptyBGPInFilterJoin(e.input)}:e.type==="leftjoin"?{...e,left:this.eliminateEmptyBGPInFilterJoin(e.left),right:this.eliminateEmptyBGPInFilterJoin(e.right)}:e.type==="union"?{...e,left:this.eliminateEmptyBGPInFilterJoin(e.left),right:this.eliminateEmptyBGPInFilterJoin(e.right)}:e.type==="minus"?{...e,left:this.eliminateEmptyBGPInFilterJoin(e.left),right:this.eliminateEmptyBGPInFilterJoin(e.right)}:e.type==="project"?{...e,input:this.eliminateEmptyBGPInFilterJoin(e.input)}:e.type==="orderby"?{...e,input:this.eliminateEmptyBGPInFilterJoin(e.input)}:e.type==="slice"?{...e,input:this.eliminateEmptyBGPInFilterJoin(e.input)}:e.type==="distinct"?{...e,input:this.eliminateEmptyBGPInFilterJoin(e.input)}:e}filterPushDown(e){return e.type==="filter"?this.pushDownFilter(e):e.type==="join"?{type:"join",left:this.filterPushDown(e.left),right:this.filterPushDown(e.right)}:e.type==="leftjoin"?{...e,left:this.filterPushDown(e.left),right:this.filterPushDown(e.right)}:e.type==="union"?{type:"union",left:this.filterPushDown(e.left),right:this.filterPushDown(e.right)}:e.type==="minus"?{...e,left:this.filterPushDown(e.left),right:this.filterPushDown(e.right)}:e.type==="project"?{...e,input:this.filterPushDown(e.input)}:e.type==="orderby"?{...e,input:this.filterPushDown(e.input)}:e.type==="slice"?{...e,input:this.filterPushDown(e.input)}:e.type==="distinct"?{...e,input:this.filterPushDown(e.input)}:e}pushDownFilter(e){let t=e.input;if(t.type==="join"){let n=this.getFilterVariables(e.expression),i=this.getOperationVariables(t.left),s=this.getOperationVariables(t.right),a=n.every(u=>i.has(u)),c=n.every(u=>s.has(u));return a&&!c?{type:"join",left:{type:"filter",expression:e.expression,input:this.filterPushDown(t.left)},right:this.filterPushDown(t.right)}:c&&!a?{type:"join",left:this.filterPushDown(t.left),right:{type:"filter",expression:e.expression,input:this.filterPushDown(t.right)}}:{type:"filter",expression:e.expression,input:{type:"join",left:this.filterPushDown(t.left),right:this.filterPushDown(t.right)}}}return t.type==="union"?{type:"union",left:{type:"filter",expression:e.expression,input:this.filterPushDown(t.left)},right:{type:"filter",expression:e.expression,input:this.filterPushDown(t.right)}}:{type:"filter",expression:e.expression,input:this.filterPushDown(t)}}getFilterVariables(e){let t=[];if(e.type==="variable")t.push(e.name);else if(e.type==="comparison")t.push(...this.getFilterVariables(e.left)),t.push(...this.getFilterVariables(e.right));else if(e.type==="logical")for(let n of e.operands)t.push(...this.getFilterVariables(n));else if(e.type==="function")for(let n of e.args)t.push(...this.getFilterVariables(n));return Array.from(new Set(t))}getOperationVariables(e){let t=new Set;if(e.type==="bgp")for(let n of e.triples)n.subject.type==="variable"&&t.add(n.subject.value),n.predicate.type==="variable"&&t.add(n.predicate.value),n.object.type==="variable"&&t.add(n.object.value);else if(e.type==="join"){let n=this.getOperationVariables(e.left),i=this.getOperationVariables(e.right);return new Set([...n,...i])}else{if(e.type==="filter")return this.getOperationVariables(e.input);if(e.type==="leftjoin"){let n=this.getOperationVariables(e.left),i=this.getOperationVariables(e.right);return new Set([...n,...i])}else if(e.type==="union"){let n=this.getOperationVariables(e.left),i=this.getOperationVariables(e.right);return new Set([...n,...i])}else{if(e.type==="minus")return this.getOperationVariables(e.left);if(e.type==="project")return new Set(e.variables)}}return t}joinReordering(e){return e.type==="join"?this.reorderJoin(e):e.type==="filter"?{...e,input:this.joinReordering(e.input)}:e.type==="leftjoin"?{...e,left:this.joinReordering(e.left),right:this.joinReordering(e.right)}:e.type==="union"?{...e,left:this.joinReordering(e.left),right:this.joinReordering(e.right)}:e.type==="minus"?{...e,left:this.joinReordering(e.left),right:this.joinReordering(e.right)}:e.type==="project"?{...e,input:this.joinReordering(e.input)}:e.type==="orderby"?{...e,input:this.joinReordering(e.input)}:e.type==="slice"?{...e,input:this.joinReordering(e.input)}:e.type==="distinct"?{...e,input:this.joinReordering(e.input)}:e}reorderJoin(e){let t=this.estimateCost(e.left);return this.estimateCost(e.right)<t?{type:"join",left:this.joinReordering(e.right),right:this.joinReordering(e.left)}:{type:"join",left:this.joinReordering(e.left),right:this.joinReordering(e.right)}}estimateCost(e){if(e.type==="bgp"){let t=e.triples.length*100;for(let n of e.triples)n.subject.type==="variable"&&(t+=10),n.predicate.type==="variable"&&(t+=20),n.object.type==="variable"&&(t+=10);return t}return e.type==="filter"?this.estimateCost(e.input)*.3:e.type==="join"?this.estimateCost(e.left)*this.estimateCost(e.right):e.type==="leftjoin"?this.estimateCost(e.left)+this.estimateCost(e.right)*.5:e.type==="union"?this.estimateCost(e.left)+this.estimateCost(e.right):e.type==="minus"?this.estimateCost(e.left)+this.estimateCost(e.right)*.3:100}setStatistics(e,t){this.stats.set(e,t)}getStatistics(e){return this.stats.get(e)}};Eu.AlgebraOptimizer=yp});var $g=y(Tu=>{"use strict";Object.defineProperty(Tu,"__esModule",{value:!0});Tu.AlgebraSerializer=void 0;var _p=class{static{o(this,"AlgebraSerializer")}toString(e,t=0){let n="  ".repeat(t);switch(e.type){case"bgp":return`${n}BGP [
${e.triples.map(f=>`${n}  ${this.tripleToString(f)}`).join(`
`)}
${n}]`;case"filter":return`${n}Filter(
${n}  ${this.expressionToString(e.expression)}
${this.toString(e.input,t+1)}
${n})`;case"join":return`${n}Join(
${this.toString(e.left,t+1)}
${this.toString(e.right,t+1)}
${n})`;case"leftjoin":let i=e.expression?` ${this.expressionToString(e.expression)}`:"";return`${n}LeftJoin(${i}
${this.toString(e.left,t+1)}
${this.toString(e.right,t+1)}
${n})`;case"union":return`${n}Union(
${this.toString(e.left,t+1)}
${this.toString(e.right,t+1)}
${n})`;case"minus":return`${n}Minus(
${this.toString(e.left,t+1)}
${this.toString(e.right,t+1)}
${n})`;case"project":return`${n}Project [${e.variables.map(f=>`?${f}`).join(", ")}](
${this.toString(e.input,t+1)}
${n})`;case"orderby":let s=e.comparators.map(f=>`${this.expressionToString(f.expression)} ${f.descending?"DESC":"ASC"}`).join(", ");return`${n}OrderBy [${s}](
${this.toString(e.input,t+1)}
${n})`;case"slice":let a=[];return e.offset!==void 0&&a.push(`OFFSET ${e.offset}`),e.limit!==void 0&&a.push(`LIMIT ${e.limit}`),`${n}Slice [${a.join(", ")}](
${this.toString(e.input,t+1)}
${n})`;case"distinct":return`${n}Distinct(
${this.toString(e.input,t+1)}
${n})`;case"group":let c=e.variables.length>0?`[${e.variables.map(f=>`?${f}`).join(", ")}]`:"[]",u=e.aggregates.length>0?e.aggregates.map(f=>`?${f.variable} = ${f.expression.aggregation}(${f.expression.distinct?"DISTINCT ":""}${f.expression.expression?this.expressionToString(f.expression.expression):"*"})`).join(", "):"";return`${n}Group ${c}${u?` [${u}]`:""}(
${this.toString(e.input,t+1)}
${n})`;case"extend":return`${n}Extend (?${e.variable} = ${this.expressionToString(e.expression)})(
${this.toString(e.input,t+1)}
${n})`;case"subquery":return`${n}Subquery(
${this.toString(e.query,t+1)}
${n})`;default:return`${n}Unknown(${e.type})`}}tripleToString(e){return`${this.elementToString(e.subject)} ${this.predicateToString(e.predicate)} ${this.elementToString(e.object)}`}predicateToString(e){return this.isPropertyPath(e)?this.propertyPathToString(e):this.elementToString(e)}isPropertyPath(e){return e.type==="path"}propertyPathToString(e){let t=e.items.map(n=>n.type==="path"?`(${this.propertyPathToString(n)})`:`<${n.value}>`);switch(e.pathType){case"/":return t.join("/");case"|":return t.join("|");case"^":return`^${t[0]}`;case"+":return`${t[0]}+`;case"*":return`${t[0]}*`;case"?":return`${t[0]}?`}}elementToString(e){switch(e.type){case"variable":return`?${e.value}`;case"iri":return`<${e.value}>`;case"literal":let t=`"${e.value}"`;return e.language&&(t+=`@${e.language}`),e.datatype&&(t+=`^^<${e.datatype}>`),t;case"blank":return`_:${e.value}`;default:return String(e)}}expressionToString(e){switch(e.type){case"variable":return`?${e.name}`;case"literal":return typeof e.value=="string"?`"${e.value}"`:String(e.value);case"comparison":return`(${this.expressionToString(e.left)} ${e.operator} ${this.expressionToString(e.right)})`;case"logical":return e.operator==="!"?`!(${this.expressionToString(e.operands[0])})`:`(${e.operands.map(t=>this.expressionToString(t)).join(` ${e.operator} `)})`;case"arithmetic":return`(${this.expressionToString(e.left)} ${e.operator} ${this.expressionToString(e.right)})`;case"function":return`${e.function}(${e.args.map(t=>this.expressionToString(t)).join(", ")})`;case"exists":return`${e.negated?"NOT EXISTS":"EXISTS"} { ${this.toString(e.pattern,0)} }`;default:return"unknown"}}toJSON(e){return JSON.stringify(e,null,2)}};Tu.AlgebraSerializer=_p});var is=y(Au=>{"use strict";Object.defineProperty(Au,"__esModule",{value:!0});Au.SolutionMapping=void 0;var Wg=Lt(),Gg=gt(),Hg=Pr(),vp=class r{static{o(this,"SolutionMapping")}constructor(e){this.bindings=e?new Map(e):new Map}get(e){return this.bindings.get(e)}set(e,t){this.bindings.set(e,t)}has(e){return this.bindings.has(e)}variables(){return Array.from(this.bindings.keys())}getBindings(){return new Map(this.bindings)}isCompatibleWith(e){for(let[t,n]of this.bindings.entries()){let i=e.get(t);if(i!==void 0&&!this.areEqual(n,i))return!1}return!0}merge(e){if(!this.isCompatibleWith(e))return null;let t=new r(this.bindings);for(let[n,i]of e.getBindings().entries())t.set(n,i);return t}clone(){return new r(this.bindings)}areEqual(e,t){return e instanceof Wg.Literal&&t instanceof Wg.Literal?e.equals(t):e instanceof Gg.IRI&&t instanceof Gg.IRI?e.value===t.value:e instanceof Hg.BlankNode&&t instanceof Hg.BlankNode?e.id===t.id:!1}toJSON(){let e={};for(let[t,n]of this.bindings.entries())e[t]=n.toString();return e}size(){return this.bindings.size}};Au.SolutionMapping=vp});var Kg=y(Vs=>{"use strict";Object.defineProperty(Vs,"__esModule",{value:!0});Vs.PropertyPathExecutor=Vs.PropertyPathExecutorError=void 0;var y5=is(),xu=gt(),zg=Pr(),Ya=class extends Error{static{o(this,"PropertyPathExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="PropertyPathExecutorError"}};Vs.PropertyPathExecutorError=Ya;var Sp=class{static{o(this,"PropertyPathExecutor")}constructor(e){this.tripleStore=e,this.MAX_DEPTH=100}async*execute(e,t,n){let i=await this.resolveElement(e),s=this.isVariable(n)?null:await this.resolveElement(n);for(let a of i){let c=await this.evaluatePath(a,t,s);for(let u of c){let f=new y5.SolutionMapping;this.isVariable(e)&&f.set(e.value,a),this.isVariable(n)&&f.set(n.value,u),yield f}}}async*executeWithBindings(e,t){if(!this.isPropertyPath(e.predicate))throw new Ya("Predicate is not a property path");let n=this.instantiateElement(e.subject,t),i=this.instantiateElement(e.object,t);for await(let s of this.execute(n,e.predicate,i)){let a=t.merge(s);a!==null&&(yield a)}}async evaluatePath(e,t,n){switch(t.pathType){case"/":return this.evaluateSequencePath(e,t.items,n);case"|":return this.evaluateAlternativePath(e,t.items,n);case"^":return this.evaluateInversePath(e,t.items[0],n);case"+":return this.evaluateOneOrMorePath(e,t.items[0],n);case"*":return this.evaluateZeroOrMorePath(e,t.items[0],n);case"?":return this.evaluateZeroOrOnePath(e,t.items[0],n)}}async evaluateSequencePath(e,t,n){let i=new Set([e]);for(let s=0;s<t.length;s++){let a=t[s],c=s===t.length-1,u=new Set;for(let f of i){let l=await this.evaluatePathItem(f,a,c?n:null);for(let h of l)u.add(h)}if(i=u,i.size===0)break}return i}async evaluateAlternativePath(e,t,n){let i=new Set;for(let s of t){let a=await this.evaluatePathItem(e,s,n);for(let c of a)i.add(c)}return i}async evaluateInversePath(e,t,n){if(t.type==="iri"){let i=new xu.IRI(t.value),s=await this.tripleStore.match(void 0,i,e),a=new Set;for(let c of s)(n===null||this.nodeInSet(c.subject,n))&&a.add(c.subject);return a}else return this.evaluatePath(e,this.invertPath(t),n)}async evaluateOneOrMorePath(e,t,n){let i=new Set,s=new Set,a=[{node:e,depth:0}];for(;a.length>0;){let{node:c,depth:u}=a.shift();if(u>=this.MAX_DEPTH)continue;let f=await this.evaluatePathItem(c,t,null);for(let l of f){let h=this.nodeToKey(l);(n===null||this.nodeInSet(l,n))&&s.add(l),i.has(h)||(i.add(h),a.push({node:l,depth:u+1}))}}return s}async evaluateZeroOrMorePath(e,t,n){let i=await this.evaluateOneOrMorePath(e,t,n);return(n===null||this.nodeInSet(e,n))&&i.add(e),i}async evaluateZeroOrOnePath(e,t,n){let i=new Set;(n===null||this.nodeInSet(e,n))&&i.add(e);let s=await this.evaluatePathItem(e,t,n);for(let a of s)i.add(a);return i}async evaluatePathItem(e,t,n){if(t.type==="iri"){let i=new xu.IRI(t.value),s=await this.tripleStore.match(e,i,void 0),a=new Set;for(let c of s)(n===null||this.nodeInSet(c.object,n))&&a.add(c.object);return a}else return this.evaluatePath(e,t,n)}invertPath(e){switch(e.pathType){case"^":return e.items[0];case"/":return{type:"path",pathType:"/",items:[...e.items].reverse().map(n=>n.type==="iri"?{type:"path",pathType:"^",items:[n]}:this.invertPath(n))};case"|":return{type:"path",pathType:"|",items:e.items.map(n=>n.type==="iri"?{type:"path",pathType:"^",items:[n]}:this.invertPath(n))};case"+":case"*":case"?":let t=e.items[0].type==="iri"?{type:"path",pathType:"^",items:[e.items[0]]}:this.invertPath(e.items[0]);return{type:"path",pathType:e.pathType,items:[t]}}}async resolveElement(e){if(this.isVariable(e)){let n=new Set,i=await this.tripleStore.match(void 0,void 0,void 0);for(let s of i)n.add(s.subject),n.add(s.object);return n}let t=new Set;switch(e.type){case"iri":t.add(new xu.IRI(e.value));break;case"blank":t.add(new zg.BlankNode(e.value));break;default:throw new Ya(`Unsupported element type in subject/object position: ${e.type}`)}return t}instantiateElement(e,t){if(this.isVariable(e)){let n=t.get(e.value);if(n){if(n instanceof xu.IRI)return{type:"iri",value:n.value};if(n instanceof zg.BlankNode)return{type:"blank",value:n.id}}}return e}isVariable(e){return e.type==="variable"}isPropertyPath(e){return e.type==="path"}nodeToKey(e){return e.toString()}nodeInSet(e,t){let n=this.nodeToKey(e);for(let i of t)if(this.nodeToKey(i)===n)return!0;return!1}};Vs.PropertyPathExecutor=Sp});var Ep=y(qs=>{"use strict";Object.defineProperty(qs,"__esModule",{value:!0});qs.BGPExecutor=qs.BGPExecutorError=void 0;var Yg=is(),Qa=gt(),Qg=Lt(),wp=Pr(),_5=Kg(),Er=class extends Error{static{o(this,"BGPExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="BGPExecutorError"}};qs.BGPExecutorError=Er;var bp=class{static{o(this,"BGPExecutor")}constructor(e){this.tripleStore=e,this.propertyPathExecutor=new _5.PropertyPathExecutor(e)}async*execute(e){if(e.triples.length===0){yield new Yg.SolutionMapping;return}let t=this.matchTriplePattern(e.triples[0]);for(let n=1;n<e.triples.length;n++)t=this.joinWithPattern(t,e.triples[n]);for await(let n of t)yield n}async executeAll(e){let t=[];for await(let n of this.execute(e))t.push(n);return t}async*matchTriplePattern(e){if(this.isPropertyPath(e.predicate)){yield*this.propertyPathExecutor.execute(e.subject,e.predicate,e.object);return}let t=e.predicate,n=this.isVariable(e.subject)?void 0:this.toRDFTermAsSubject(e.subject),i=this.isVariable(t)?void 0:this.toRDFTermAsPredicate(t),s=this.isVariable(e.object)?void 0:this.toRDFTerm(e.object),a=await this.tripleStore.match(n,i,s);for(let c of a){let u=new Yg.SolutionMapping;this.isVariable(e.subject)&&u.set(e.subject.value,c.subject),this.isVariable(t)&&u.set(t.value,c.predicate),this.isVariable(e.object)&&u.set(e.object.value,c.object),yield u}}isPropertyPath(e){return e.type==="path"}async*joinWithPattern(e,t){let n=[];for await(let i of e)n.push(i);for(let i of n){let s=this.instantiatePattern(t,i);for await(let a of this.matchTriplePattern(s)){let c=i.merge(a);c!==null&&(yield c)}}}instantiatePattern(e,t){let n=this.isPropertyPath(e.predicate)?e.predicate:this.instantiateElement(e.predicate,t);return{subject:this.instantiateElement(e.subject,t),predicate:n,object:this.instantiateElement(e.object,t)}}instantiateElement(e,t){if(this.isVariable(e)){let n=t.get(e.value);if(n)return this.toAlgebraElement(n)}return e}isVariable(e){return e.type==="variable"}toRDFTermAsSubject(e){switch(e.type){case"iri":return new Qa.IRI(e.value);case"blank":return new wp.BlankNode(e.value);case"literal":throw new Er("Literals cannot appear in subject position");case"variable":throw new Er(`Cannot convert variable to RDF term: ${e.value}`);default:throw new Er(`Unknown element type: ${e.type}`)}}toRDFTermAsPredicate(e){switch(e.type){case"iri":return new Qa.IRI(e.value);case"literal":throw new Er("Literals cannot appear in predicate position");case"blank":throw new Er("Blank nodes cannot appear in predicate position");case"variable":throw new Er(`Cannot convert variable to RDF term: ${e.value}`);default:throw new Er(`Unknown element type: ${e.type}`)}}toRDFTerm(e){switch(e.type){case"iri":return new Qa.IRI(e.value);case"literal":return new Qg.Literal(e.value,e.datatype?new Qa.IRI(e.datatype):void 0,e.language);case"blank":return new wp.BlankNode(e.value);case"variable":throw new Er(`Cannot convert variable to RDF term: ${e.value}`);default:throw new Er(`Unknown element type: ${e.type}`)}}toAlgebraElement(e){if(e instanceof Qa.IRI)return{type:"iri",value:e.value};if(e instanceof Qg.Literal)return{type:"literal",value:e.value,datatype:e.datatype?.value,language:e.language};if(e instanceof wp.BlankNode)return{type:"blank",value:e.id};throw new Er(`Unknown RDF term type: ${e.constructor?.name||"unknown"}`)}};qs.BGPExecutor=bp});var Ap=y(Ou=>{"use strict";Object.defineProperty(Ou,"__esModule",{value:!0});Ou.BuiltInFunctions=void 0;var ht=gt(),dt=Lt(),Dr=Pr(),Tp=class r{static{o(this,"BuiltInFunctions")}static str(e){if(e===void 0)throw new Error("STR: argument is undefined");return e instanceof ht.IRI||e instanceof dt.Literal?e.value:e instanceof Dr.BlankNode?e.id:String(e)}static lang(e){if(e===void 0)throw new Error("LANG: argument is undefined");return e instanceof dt.Literal&&e.language?e.language:""}static langMatches(e,t){let n=e.toLowerCase(),i=t.toLowerCase();return i==="*"?n!=="":n===""?i==="":n===i?!0:n.startsWith(i+"-")}static datatype(e){if(e===void 0)throw new Error("DATATYPE: argument is undefined");if(e instanceof dt.Literal)return e.datatype?e.datatype:e.language?new ht.IRI("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"):new ht.IRI("http://www.w3.org/2001/XMLSchema#string");throw new Error("DATATYPE: argument must be a literal")}static bound(e){return e!==void 0}static isIRI(e){return e===void 0?!1:e instanceof ht.IRI}static isBlank(e){return e===void 0?!1:e instanceof Dr.BlankNode}static isLiteral(e){return e===void 0?!1:e instanceof dt.Literal}static isNumeric(e){if(e===void 0||!(e instanceof dt.Literal))return!1;let t=e.datatype?.value;return t?["http://www.w3.org/2001/XMLSchema#integer","http://www.w3.org/2001/XMLSchema#decimal","http://www.w3.org/2001/XMLSchema#float","http://www.w3.org/2001/XMLSchema#double","http://www.w3.org/2001/XMLSchema#nonPositiveInteger","http://www.w3.org/2001/XMLSchema#negativeInteger","http://www.w3.org/2001/XMLSchema#long","http://www.w3.org/2001/XMLSchema#int","http://www.w3.org/2001/XMLSchema#short","http://www.w3.org/2001/XMLSchema#byte","http://www.w3.org/2001/XMLSchema#nonNegativeInteger","http://www.w3.org/2001/XMLSchema#unsignedLong","http://www.w3.org/2001/XMLSchema#unsignedInt","http://www.w3.org/2001/XMLSchema#unsignedShort","http://www.w3.org/2001/XMLSchema#unsignedByte","http://www.w3.org/2001/XMLSchema#positiveInteger"].includes(t):!1}static regex(e,t,n){try{return new RegExp(t,n).test(e)}catch(i){throw new Error(`REGEX: invalid pattern '${t}': ${i.message}`)}}static compare(e,t,n){let i=this.toComparableValue(e),s=this.toComparableValue(t);switch(n){case"=":return i===s;case"!=":return i!==s;case"<":return i<s;case">":return i>s;case"<=":return i<=s;case">=":return i>=s;default:throw new Error(`Unknown comparison operator: ${n}`)}}static toComparableValue(e){if(typeof e=="string"||typeof e=="number")return e;if(e instanceof dt.Literal){let t=e.datatype?.value;if(t?.includes("#integer")||t?.includes("#decimal")||t?.includes("#double")){let n=parseFloat(e.value);if(!isNaN(n))return n}return e.value}return e instanceof ht.IRI?e.value:e instanceof Dr.BlankNode?e.id:String(e)}static contains(e,t){return e.includes(t)}static strStarts(e,t){return e.startsWith(t)}static strEnds(e,t){return e.endsWith(t)}static strlen(e){return e.length}static ucase(e){return e.toUpperCase()}static lcase(e){return e.toLowerCase()}static substr(e,t,n){let i=t-1;if(i<0){if(n!==void 0){let s=n+i;return s<=0?"":e.substring(0,s)}return e}return n!==void 0?e.substring(i,i+n):e.substring(i)}static strBefore(e,t){if(t==="")return"";let n=e.indexOf(t);return n===-1?"":e.substring(0,n)}static strAfter(e,t){if(t==="")return e;let n=e.indexOf(t);return n===-1?"":e.substring(n+t.length)}static concat(...e){return e.join("")}static replace(e,t,n,i){try{let s=new RegExp(t,i||"g");return e.replace(s,n)}catch(s){throw new Error(`REPLACE: invalid pattern '${t}': ${s.message}`)}}static parseDate(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`PARSEDATE: invalid date string '${e}'`);return t.getTime()}static dateBefore(e,t){let n=this.parseDate(e),i=this.parseDate(t);return n<i}static dateAfter(e,t){let n=this.parseDate(e),i=this.parseDate(t);return n>i}static dateInRange(e,t,n){let i=this.parseDate(e),s=this.parseDate(t),a=this.parseDate(n);return i>=s&&i<=a}static dateDiffMinutes(e,t){let n=this.parseDate(e),i=this.parseDate(t),s=Math.abs(i-n);return Math.round(s/(1e3*60))}static dateDiffHours(e,t){let n=this.parseDate(e),i=this.parseDate(t),s=Math.abs(i-n);return Math.round(s/(1e3*60*60)*100)/100}static logicalAnd(e){return e.every(t=>t===!0)}static logicalOr(e){return e.some(t=>t===!0)}static logicalNot(e){return!e}static year(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`YEAR: invalid date string '${e}'`);return t.getFullYear()}static month(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`MONTH: invalid date string '${e}'`);return t.getMonth()+1}static day(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`DAY: invalid date string '${e}'`);return t.getDate()}static hours(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`HOURS: invalid date string '${e}'`);return t.getHours()}static minutes(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`MINUTES: invalid date string '${e}'`);return t.getMinutes()}static seconds(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`SECONDS: invalid date string '${e}'`);return t.getSeconds()+t.getMilliseconds()/1e3}static timezone(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`TIMEZONE: invalid date string '${e}'`);if(e.endsWith("Z"))return"PT0S";let n=e.match(/([+-]\d{2}):?(\d{2})$/);if(n){let u=parseInt(n[1],10),f=parseInt(n[2],10),l=u>=0?"":"-",h=Math.abs(u);return f===0?`${l}PT${h}H`:`${l}PT${h}H${f}M`}let i=-t.getTimezoneOffset(),s=Math.floor(Math.abs(i)/60),a=Math.abs(i)%60,c=i>=0?"":"-";return a===0?`${c}PT${s}H`:`${c}PT${s}H${a}M`}static now(){return new Date().toISOString()}static msToMinutes(e){return Math.round(e/(1e3*60))}static msToHours(e){return Math.round(e/(1e3*60*60)*100)/100}static msToSeconds(e){return Math.round(e/1e3)}static abs(e){return Math.abs(e)}static round(e){return Math.round(e)}static ceil(e){return Math.ceil(e)}static floor(e){return Math.floor(e)}static rand(){return Math.random()}static coalesce(e){for(let t of e)if(t!=null)return t}static if(e,t,n){return e?t:n}static xsdDateTime(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`xsd:dateTime: invalid date string '${e}'`);return new dt.Literal(t.toISOString(),new ht.IRI("http://www.w3.org/2001/XMLSchema#dateTime"))}static xsdInteger(e){let t=parseInt(e,10);if(isNaN(t))throw new Error(`xsd:integer: cannot convert '${e}' to integer`);return new dt.Literal(String(t),new ht.IRI("http://www.w3.org/2001/XMLSchema#integer"))}static xsdDecimal(e){let t=parseFloat(e);if(isNaN(t))throw new Error(`xsd:decimal: cannot convert '${e}' to decimal`);return new dt.Literal(String(t),new ht.IRI("http://www.w3.org/2001/XMLSchema#decimal"))}static encodeForUri(e){return encodeURIComponent(e)}static md5(e){return require("crypto").createHash("md5").update(e).digest("hex")}static sha1(e){return require("crypto").createHash("sha1").update(e).digest("hex")}static sha256(e){return require("crypto").createHash("sha256").update(e).digest("hex")}static sha384(e){return require("crypto").createHash("sha384").update(e).digest("hex")}static sha512(e){return require("crypto").createHash("sha512").update(e).digest("hex")}static iri(e){if(e===void 0)throw new Error("IRI: argument is undefined");if(e instanceof ht.IRI)return e;if(e instanceof dt.Literal)return new ht.IRI(e.value);throw e instanceof Dr.BlankNode?new Error("IRI: cannot convert BlankNode to IRI"):new Error("IRI: unsupported argument type")}static uri(e){return r.iri(e)}static bnode(e){if(e===void 0)return Dr.BlankNode.create();if(e instanceof dt.Literal)return new Dr.BlankNode(e.value);if(e instanceof ht.IRI)return new Dr.BlankNode(e.value);if(e instanceof Dr.BlankNode)return e;throw new Error("BNODE: unsupported label type")}static strdt(e,t){if(e===void 0)throw new Error("STRDT: lexical form is undefined");if(t===void 0)throw new Error("STRDT: datatype IRI is undefined");let n;if(e instanceof dt.Literal)n=e.value;else if(e instanceof ht.IRI)n=e.value;else if(e instanceof Dr.BlankNode)n=e.id;else throw new Error("STRDT: unsupported lexical form type");let i;if(t instanceof ht.IRI)i=t;else if(t instanceof dt.Literal)i=new ht.IRI(t.value);else throw new Error("STRDT: datatype must be an IRI");return new dt.Literal(n,i)}static strlang(e,t){if(e===void 0)throw new Error("STRLANG: lexical form is undefined");if(t===void 0)throw new Error("STRLANG: language tag is undefined");let n;if(e instanceof dt.Literal)n=e.value;else if(e instanceof ht.IRI)n=e.value;else if(e instanceof Dr.BlankNode)n=e.id;else throw new Error("STRLANG: unsupported lexical form type");let i;if(t instanceof dt.Literal)i=t.value;else if(t instanceof ht.IRI)i=t.value;else throw new Error("STRLANG: language tag must be a string");return new dt.Literal(n,void 0,i)}static uuid(){let e=r.generateUUIDv4();return new ht.IRI(`urn:uuid:${e}`)}static struuid(){let e=r.generateUUIDv4();return new dt.Literal(e,new ht.IRI("http://www.w3.org/2001/XMLSchema#string"))}static generateUUIDv4(){let t=require("crypto").randomBytes(16);t[6]=t[6]&15|64,t[8]=t[8]&63|128;let n=t.toString("hex");return`${n.slice(0,8)}-${n.slice(8,12)}-${n.slice(12,16)}-${n.slice(16,20)}-${n.slice(20)}`}static sameTerm(e,t){if(e===void 0&&t===void 0)return!0;if(e===void 0||t===void 0||e.constructor!==t.constructor)return!1;if(e instanceof ht.IRI&&t instanceof ht.IRI)return e.value===t.value;if(e instanceof Dr.BlankNode&&t instanceof Dr.BlankNode)return e.id===t.id;if(e instanceof dt.Literal&&t instanceof dt.Literal){if(e.value!==t.value||e.language!==t.language)return!1;let n=e.datatype?.value,i=t.datatype?.value;return n===i}return!1}};Ou.BuiltInFunctions=Tp});var Pu=y(Bs=>{"use strict";Object.defineProperty(Bs,"__esModule",{value:!0});Bs.FilterExecutor=Bs.FilterExecutorError=void 0;var U=Ap(),Cu=Lt(),Rt=class extends Error{static{o(this,"FilterExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="FilterExecutorError"}};Bs.FilterExecutorError=Rt;var xp=class{static{o(this,"FilterExecutor")}constructor(){this.existsEvaluator=null}setExistsEvaluator(e){this.existsEvaluator=e}async*execute(e,t){let n=this.expressionContainsExists(e.expression);for await(let i of t)try{let s;n?s=await this.evaluateExpressionAsync(e.expression,i):s=this.evaluateExpression(e.expression,i),s===!0&&(yield i)}catch{continue}}expressionContainsExists(e){if(e.type==="exists")return!0;if(e.type==="logical")return e.operands.some(t=>this.expressionContainsExists(t));if(e.type==="comparison")return this.expressionContainsExists(e.left)||this.expressionContainsExists(e.right);if(e.type==="in"){let t=e;return this.expressionContainsExists(t.expression)||t.list.some(n=>this.expressionContainsExists(n))}return!1}async executeAll(e,t){let n=[];async function*i(){for(let s of t)yield s}o(i,"generator");for await(let s of this.execute(e,i()))n.push(s);return n}evaluateExpression(e,t){let n=e;if(n.termType)switch(n.termType){case"Variable":return t.get(n.value);case"Literal":return n.value;case"NamedNode":return n.value;default:throw new Rt(`Unsupported termType: ${n.termType}`)}switch(e.type){case"comparison":return this.evaluateComparison(e,t);case"logical":return this.evaluateLogical(e,t);case"arithmetic":return this.evaluateArithmetic(e,t);case"function":case"functionCall":return this.evaluateFunction(e,t);case"variable":return t.get(e.name);case"literal":return e.value;case"in":return this.evaluateIn(e,t);case"exists":throw new Rt("EXISTS expressions require async evaluation. Use evaluateExpressionAsync instead.");default:throw new Rt(`Unsupported expression type: ${e.type}, expr.termType=${n.termType}`)}}async evaluateExpressionAsync(e,t){return e.type==="exists"?this.evaluateExists(e,t):e.type==="logical"?this.evaluateLogicalAsync(e,t):this.evaluateExpression(e,t)}async evaluateExists(e,t){if(!this.existsEvaluator)throw new Rt("EXISTS evaluator not set. Call setExistsEvaluator before evaluating EXISTS expressions.");let n=await this.existsEvaluator(e.pattern,t);return e.negated?!n:n}async evaluateLogicalAsync(e,t){if(e.operator==="!"){let i=await this.evaluateExpressionAsync(e.operands[0],t);return U.BuiltInFunctions.logicalNot(i)}let n=[];for(let i of e.operands){let s=await this.evaluateExpressionAsync(i,t);n.push(s)}if(e.operator==="&&")return U.BuiltInFunctions.logicalAnd(n);if(e.operator==="||")return U.BuiltInFunctions.logicalOr(n);throw new Rt(`Unknown logical operator: ${e.operator}`)}evaluateComparison(e,t){let n=this.evaluateExpression(e.left,t),i=this.evaluateExpression(e.right,t);return U.BuiltInFunctions.compare(n,i,e.operator)}evaluateLogical(e,t){if(e.operator==="!"){let i=this.evaluateExpression(e.operands[0],t);return U.BuiltInFunctions.logicalNot(i)}let n=e.operands.map(i=>this.evaluateExpression(i,t));if(e.operator==="&&")return U.BuiltInFunctions.logicalAnd(n);if(e.operator==="||")return U.BuiltInFunctions.logicalOr(n);throw new Rt(`Unknown logical operator: ${e.operator}`)}evaluateIn(e,t){let n=this.evaluateExpression(e.expression,t),i=e.list.some(s=>{let a=this.evaluateExpression(s,t);return U.BuiltInFunctions.compare(n,a,"=")});return e.negated?!i:i}evaluateArithmetic(e,t){let n=this.evaluateExpression(e.left,t),i=this.evaluateExpression(e.right,t),s=this.toNumericValue(n),a=this.toNumericValue(i);if(e.operator==="-"&&this.isDateTimeValue(n)&&this.isDateTimeValue(i)){let c=this.parseDateTimeToMs(n),u=this.parseDateTimeToMs(i);return c-u}switch(e.operator){case"+":return s+a;case"-":return s-a;case"*":return s*a;case"/":if(a===0)throw new Rt("Division by zero");return s/a;default:throw new Rt(`Unknown arithmetic operator: ${e.operator}`)}}toNumericValue(e){if(typeof e=="number")return e;if(e instanceof Cu.Literal){let t=e.datatype?.value||"";if(t.includes("#integer")||t.includes("#decimal")||t.includes("#double")||t.includes("#float")){let i=parseFloat(e.value);if(!isNaN(i))return i}let n=parseFloat(e.value);if(!isNaN(n))return n}if(typeof e=="string"){let t=parseFloat(e);if(!isNaN(t))return t}if(e&&typeof e=="object"&&"value"in e){let t=parseFloat(String(e.value));if(!isNaN(t))return t}throw new Rt(`Cannot convert to number: ${e}`)}isDateTimeValue(e){if(e instanceof Cu.Literal){let t=e.datatype?.value||"";return t.includes("#dateTime")||t.includes("#date")?!0:/^\d{4}-\d{2}-\d{2}(T|\s)/.test(e.value)}return typeof e=="string"?/^\d{4}-\d{2}-\d{2}(T|\s)/.test(e):!1}parseDateTimeToMs(e){let t;if(e instanceof Cu.Literal)t=e.value;else if(typeof e=="string")t=e;else if(e&&typeof e=="object"&&"value"in e)t=String(e.value);else throw new Rt(`Cannot parse dateTime: ${e}`);let n=new Date(t);if(isNaN(n.getTime()))throw new Rt(`Invalid dateTime format: ${t}`);return n.getTime()}evaluateFunction(e,t){let n;if(typeof e.function=="string")n=e.function.toLowerCase();else if(e.function&&typeof e.function=="object"&&"value"in e.function){let i=e.function.value;n=((i.includes("#")?i.split("#").pop():i.split("/").pop())||i).toLowerCase()}else throw new Rt(`Unknown function format: ${e.function}`);switch(n){case"str":let i=this.getTermFromExpression(e.args[0],t);return U.BuiltInFunctions.str(i);case"lang":let s=this.getTermFromExpression(e.args[0],t);return U.BuiltInFunctions.lang(s);case"datatype":let a=this.getTermFromExpression(e.args[0],t);return U.BuiltInFunctions.datatype(a).value;case"bound":if(e.args[0].type==="variable"){let ge=t.get(e.args[0].name);return U.BuiltInFunctions.bound(ge)}return!0;case"isiri":case"isuri":let c=this.getTermFromExpression(e.args[0],t);return U.BuiltInFunctions.isIRI(c);case"isblank":let u=this.getTermFromExpression(e.args[0],t);return U.BuiltInFunctions.isBlank(u);case"isliteral":let f=this.getTermFromExpression(e.args[0],t);return U.BuiltInFunctions.isLiteral(f);case"regex":let l=this.getStringValue(this.evaluateExpression(e.args[0],t)),h=this.getStringValue(this.evaluateExpression(e.args[1],t)),p=e.args[2]?this.getStringValue(this.evaluateExpression(e.args[2],t)):void 0;return U.BuiltInFunctions.regex(l,h,p);case"langmatches":let g=this.getStringValue(this.evaluateExpression(e.args[0],t)),w=this.getStringValue(this.evaluateExpression(e.args[1],t));return U.BuiltInFunctions.langMatches(g,w);case"contains":let S=this.getStringValue(this.evaluateExpression(e.args[0],t)),x=this.getStringValue(this.evaluateExpression(e.args[1],t));return U.BuiltInFunctions.contains(S,x);case"strstarts":let P=this.getStringValue(this.evaluateExpression(e.args[0],t)),F=this.getStringValue(this.evaluateExpression(e.args[1],t));return U.BuiltInFunctions.strStarts(P,F);case"strends":let L=this.getStringValue(this.evaluateExpression(e.args[0],t)),$=this.getStringValue(this.evaluateExpression(e.args[1],t));return U.BuiltInFunctions.strEnds(L,$);case"strlen":let K=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.strlen(K);case"ucase":let Fe=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.ucase(Fe);case"lcase":let Xe=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.lcase(Xe);case"substr":let at=this.getStringValue(this.evaluateExpression(e.args[0],t)),B=Number(this.evaluateExpression(e.args[1],t));if(e.args[2]){let ge=Number(this.evaluateExpression(e.args[2],t));return U.BuiltInFunctions.substr(at,B,ge)}return U.BuiltInFunctions.substr(at,B);case"strbefore":let ce=this.getStringValue(this.evaluateExpression(e.args[0],t)),Ce=this.getStringValue(this.evaluateExpression(e.args[1],t));return U.BuiltInFunctions.strBefore(ce,Ce);case"strafter":let Ze=this.getStringValue(this.evaluateExpression(e.args[0],t)),Ge=this.getStringValue(this.evaluateExpression(e.args[1],t));return U.BuiltInFunctions.strAfter(Ze,Ge);case"concat":let ze=e.args.map(ge=>this.getStringValue(this.evaluateExpression(ge,t)));return U.BuiltInFunctions.concat(...ze);case"replace":let Ne=this.getStringValue(this.evaluateExpression(e.args[0],t)),ke=this.getStringValue(this.evaluateExpression(e.args[1],t)),Pe=this.getStringValue(this.evaluateExpression(e.args[2],t)),G=e.args[3]?this.getStringValue(this.evaluateExpression(e.args[3],t)):void 0;return U.BuiltInFunctions.replace(Ne,ke,Pe,G);case"parsedate":let D=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.parseDate(D);case"datebefore":let je=this.getStringValue(this.evaluateExpression(e.args[0],t)),Be=this.getStringValue(this.evaluateExpression(e.args[1],t));return U.BuiltInFunctions.dateBefore(je,Be);case"dateafter":let j=this.getStringValue(this.evaluateExpression(e.args[0],t)),le=this.getStringValue(this.evaluateExpression(e.args[1],t));return U.BuiltInFunctions.dateAfter(j,le);case"dateinrange":let be=this.getStringValue(this.evaluateExpression(e.args[0],t)),W=this.getStringValue(this.evaluateExpression(e.args[1],t)),Ee=this.getStringValue(this.evaluateExpression(e.args[2],t));return U.BuiltInFunctions.dateInRange(be,W,Ee);case"datediffminutes":let Te=this.getStringValue(this.evaluateExpression(e.args[0],t)),_e=this.getStringValue(this.evaluateExpression(e.args[1],t));return U.BuiltInFunctions.dateDiffMinutes(Te,_e);case"datediffhours":let Ae=this.getStringValue(this.evaluateExpression(e.args[0],t)),ue=this.getStringValue(this.evaluateExpression(e.args[1],t));return U.BuiltInFunctions.dateDiffHours(Ae,ue);case"year":let ve=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.year(ve);case"month":let fe=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.month(fe);case"day":let Se=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.day(Se);case"hours":let xe=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.hours(xe);case"minutes":let J=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.minutes(J);case"seconds":let te=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.seconds(te);case"timezone":case"tz":let re=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.timezone(re);case"now":return U.BuiltInFunctions.now();case"datetime":case"xsd:datetime":{let ge=this.evaluateExpression(e.args[0],t);return U.BuiltInFunctions.xsdDateTime(this.getStringValue(ge))}case"integer":case"xsd:integer":{let ge=this.evaluateExpression(e.args[0],t);return U.BuiltInFunctions.xsdInteger(this.getStringValue(ge))}case"decimal":case"xsd:decimal":{let ge=this.evaluateExpression(e.args[0],t);return U.BuiltInFunctions.xsdDecimal(this.getStringValue(ge))}case"mstominutes":let X=Number(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.msToMinutes(X);case"mstohours":let Z=Number(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.msToHours(Z);case"mstoseconds":let ee=Number(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.msToSeconds(ee);case"abs":let Q=Number(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.abs(Q);case"round":let ne=Number(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.round(ne);case"ceil":let ie=Number(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.ceil(ie);case"floor":let se=Number(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.floor(se);case"rand":return U.BuiltInFunctions.rand();case"coalesce":for(let ge of e.args)try{let $e=this.evaluateExpression(ge,t);if($e!=null)return $e}catch{continue}return;case"if":if(!e.args||e.args.length!==3)throw new Rt("IF requires exactly 3 arguments");let ae=this.evaluateExpression(e.args[0],t);return this.toBoolean(ae)?this.evaluateExpression(e.args[1],t):this.evaluateExpression(e.args[2],t);case"encode_for_uri":let oe=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.encodeForUri(oe);case"isnumeric":let De=this.getTermFromExpression(e.args[0],t);return U.BuiltInFunctions.isNumeric(De);case"sameterm":let Oe=this.getTermFromExpression(e.args[0],t),me=this.getTermFromExpression(e.args[1],t);return U.BuiltInFunctions.sameTerm(Oe,me);case"md5":let _=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.md5(_);case"sha1":let v=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.sha1(v);case"sha256":let b=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.sha256(b);case"sha384":let C=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.sha384(C);case"sha512":let V=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.sha512(V);default:throw new Rt(`Unknown function: ${n}`)}}getTermFromExpression(e,t){if(e.type==="variable")return t.get(e.name)}getStringValue(e){return e==null?"":typeof e=="object"&&"value"in e?String(e.value):String(e)}toBoolean(e){if(typeof e=="boolean")return e;if(typeof e=="number")return!isNaN(e)&&e!==0;if(typeof e=="string")return e.length>0;if(e instanceof Cu.Literal){let t=e.datatype?.value||"";if(t.includes("#boolean"))return e.value==="true"||e.value==="1";if(t.includes("#integer")||t.includes("#decimal")||t.includes("#double")||t.includes("#float")){let n=parseFloat(e.value);return!isNaN(n)&&n!==0}return e.value.length>0}return!!e}};Bs.FilterExecutor=xp});var Cp=y(Fu=>{"use strict";Object.defineProperty(Fu,"__esModule",{value:!0});Fu.OptionalExecutor=void 0;var Op=class{static{o(this,"OptionalExecutor")}async*execute(e,t){let n=[];for await(let s of e)n.push(s);let i=[];for await(let s of t)i.push(s);for(let s of n){let a=!1;for(let c of i){let u=s.merge(c);u!==null&&(yield u,a=!0)}a||(yield s)}}async executeAll(e,t){let n=[];async function*i(){for(let a of e)yield a}o(i,"generateLeft");async function*s(){for(let a of t)yield a}o(s,"generateRight");for await(let a of this.execute(i(),s()))n.push(a);return n}};Fu.OptionalExecutor=Op});var Fp=y(Iu=>{"use strict";Object.defineProperty(Iu,"__esModule",{value:!0});Iu.UnionExecutor=void 0;var Pp=class{static{o(this,"UnionExecutor")}async*execute(e,t){let n=new Set;for await(let i of e){let s=this.getSolutionKey(i);n.has(s)||(n.add(s),yield i)}for await(let i of t){let s=this.getSolutionKey(i);n.has(s)||(n.add(s),yield i)}}async executeAll(e,t){let n=[];async function*i(){for(let a of e)yield a}o(i,"generateLeft");async function*s(){for(let a of t)yield a}o(s,"generateRight");for await(let a of this.execute(i(),s()))n.push(a);return n}getSolutionKey(e){let t=e.toJSON();return Object.keys(t).sort().map(i=>`${i}=${t[i]}`).join("|")}};Iu.UnionExecutor=Pp});var Rp=y(Ru=>{"use strict";Object.defineProperty(Ru,"__esModule",{value:!0});Ru.ConstructExecutor=void 0;var v5=qi(),Jg=gt(),S5=Lt(),w5=Pr(),Ip=class{static{o(this,"ConstructExecutor")}async execute(e,t){let n=[],i=new Set;for(let s of t)for(let a of e)try{let c=this.instantiateTriple(a,s),u=`${c.subject.toString()}|${c.predicate.toString()}|${c.object.toString()}`;i.has(u)||(i.add(u),n.push(c))}catch{continue}return n}instantiateTriple(e,t){if(this.isPropertyPath(e.predicate))throw new Error("Property paths are not supported in CONSTRUCT templates");let n=this.instantiateElement(e.subject,t),i=this.instantiateElement(e.predicate,t),s=this.instantiateElement(e.object,t);return new v5.Triple(n,i,s)}isPropertyPath(e){return e.type==="path"}instantiateElement(e,t){if(e.type==="variable"){let n=t.get(e.value);if(!n)throw new Error(`Unbound variable: ${e.value}`);return n}if(e.type==="iri")return new Jg.IRI(e.value);if(e.type==="literal")return new S5.Literal(e.value,e.datatype?new Jg.IRI(e.datatype):void 0,e.language);if(e.type==="blank")return new w5.BlankNode(e.value);throw new Error(`Unknown element type: ${e.type}`)}};Ru.ConstructExecutor=Ip});var Xg=y(Du=>{"use strict";Object.defineProperty(Du,"__esModule",{value:!0});Du.DescribeExecutor=void 0;var b5=gt(),Dp=class{static{o(this,"DescribeExecutor")}constructor(e){this.tripleStore=e}async execute(e){let t=[],n=new Set;for(let i of e){let s=await this.describeResource(i);for(let a of s){let c=`${a.subject.toString()}|${a.predicate.toString()}|${a.object.toString()}`;n.has(c)||(n.add(c),t.push(a))}}return t}async describeResource(e){let t=[],n=await this.tripleStore.match(e,void 0,void 0);t.push(...n);let i=await this.tripleStore.match(void 0,void 0,e);return t.push(...i),t}async describeByIRI(e){let t=new b5.IRI(e);return this.execute([t])}};Du.DescribeExecutor=Dp});var Zg=y(Nu=>{"use strict";Object.defineProperty(Nu,"__esModule",{value:!0});Nu.MinusExecutor=void 0;var Np=class{static{o(this,"MinusExecutor")}async*execute(e,t){let n=[];for await(let s of e)n.push(s);let i=[];for await(let s of t)i.push(s);for(let s of n){let a=!1;for(let c of i)if(this.areCompatible(s,c)){a=!0;break}a||(yield s)}}async executeAll(e,t){let n=[];async function*i(){for(let a of e)yield a}o(i,"generateLeft");async function*s(){for(let a of t)yield a}o(s,"generateRight");for await(let a of this.execute(i(),s()))n.push(a);return n}areCompatible(e,t){let n=e.variables(),i=new Set(t.variables()),s=n.filter(a=>i.has(a));if(s.length===0)return!1;for(let a of s){let c=e.get(a),u=t.get(a);if(c===void 0||u===void 0||c.toString()!==u.toString())return!1}return!0}};Nu.MinusExecutor=Np});var ty=y(Us=>{"use strict";Object.defineProperty(Us,"__esModule",{value:!0});Us.ValuesExecutor=Us.ValuesExecutorError=void 0;var E5=is(),ey=gt(),T5=Lt(),ku=class extends Error{static{o(this,"ValuesExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="ValuesExecutorError"}};Us.ValuesExecutorError=ku;var kp=class{static{o(this,"ValuesExecutor")}async*execute(e){if(e.bindings.length!==0)for(let t of e.bindings)yield this.createSolutionMapping(t)}async executeAll(e){let t=[];for await(let n of this.execute(e))t.push(n);return t}createSolutionMapping(e){let t=new E5.SolutionMapping;for(let[n,i]of Object.entries(e)){let s=this.toRDFTerm(i);t.set(n,s)}return t}toRDFTerm(e){if(e.type==="iri")return new ey.IRI(e.value);if(e.type==="literal")return new T5.Literal(e.value,e.datatype?new ey.IRI(e.datatype):void 0,e.language);throw new ku(`Unknown term type: ${e.type}`)}};Us.ValuesExecutor=kp});var ny=y($s=>{"use strict";Object.defineProperty($s,"__esModule",{value:!0});$s.AggregateExecutor=$s.AggregateExecutorError=void 0;var mr=Lt(),Mp=gt(),A5=Pu(),ry=new Mp.IRI("http://www.w3.org/2001/XMLSchema#integer"),Ja=new Mp.IRI("http://www.w3.org/2001/XMLSchema#decimal"),ss=new Mp.IRI("http://www.w3.org/2001/XMLSchema#string"),ju=class extends Error{static{o(this,"AggregateExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="AggregateExecutorError"}};$s.AggregateExecutorError=ju;var jp=class{static{o(this,"AggregateExecutor")}constructor(){this.filterExecutor=new A5.FilterExecutor}execute(e,t){let n=this.groupSolutions(t,e.variables),i=[];for(let[s,a]of n.entries()){let c=new Map;for(let l of e.variables)if(a.length>0){let h=a[0].get(l);h&&c.set(l,h)}for(let l of e.aggregates){let h=this.computeAggregate(l.expression,a);c.set(l.variable,h)}let{SolutionMapping:u}=is(),f=new u;for(let[l,h]of c.entries())f.set(l,h);i.push(f)}if(i.length===0&&e.aggregates.length>0){let s=this.createEmptyAggregateResult(e);s&&i.push(s)}return i}groupSolutions(e,t){let n=new Map;if(t.length===0)return n.set("",e),n;for(let i of e){let s=this.computeGroupKey(i,t),a=n.get(s);a?a.push(i):n.set(s,[i])}return n}computeGroupKey(e,t){return t.map(n=>{let i=e.get(n);return i?this.termToString(i):""}).join("|")}termToString(e){if(e&&typeof e=="object"){if("value"in e)return String(e.value);if("id"in e)return String(e.id)}return String(e)}computeAggregate(e,t){let n=this.extractValues(e,t);switch(e.aggregation){case"count":{let i=this.computeCount(n,e.distinct);return new mr.Literal(String(i),ry)}case"sum":{let i=this.computeSum(n);return new mr.Literal(String(i),Ja)}case"avg":{let i=this.computeAvg(n);return new mr.Literal(String(i),Ja)}case"min":{let i=this.computeMin(n);return i===void 0?new mr.Literal("",ss):typeof i=="number"?new mr.Literal(String(i),Ja):new mr.Literal(String(i),ss)}case"max":{let i=this.computeMax(n);return i===void 0?new mr.Literal("",ss):typeof i=="number"?new mr.Literal(String(i),Ja):new mr.Literal(String(i),ss)}case"group_concat":{let i=this.computeGroupConcat(n,e.separator||" ",e.distinct);return new mr.Literal(i||" ",ss)}default:throw new ju(`Unknown aggregation function: ${e.aggregation}`)}}extractValues(e,t){if(!e.expression)return t.map(()=>1);let n=[];for(let i of t){let s=this.evaluateExpression(e.expression,i);s!=null&&n.push(s)}return n}evaluateExpression(e,t){if(e.type==="variable"){let n=t.get(e.name);return n==null?void 0:typeof n=="number"||typeof n=="string"||typeof n=="boolean"?n:typeof n=="object"&&"value"in n?n.value:n}if(e.type==="literal")return e.value;try{return this.filterExecutor.evaluateExpression(e,t)}catch{return}}computeCount(e,t){return t?new Set(e.map(n=>String(n))).size:e.length}computeSum(e){return e.map(n=>parseFloat(String(n))).filter(n=>!isNaN(n)).reduce((n,i)=>n+i,0)}computeAvg(e){let t=e.map(n=>parseFloat(String(n))).filter(n=>!isNaN(n));return t.length===0?0:t.reduce((n,i)=>n+i,0)/t.length}computeMin(e){if(e.length===0)return;let t=e.map(i=>parseFloat(String(i))).filter(i=>!isNaN(i));if(t.length>0)return Math.min(...t);let n=e.map(i=>String(i));return n.reduce((i,s)=>s<i?s:i,n[0])}computeMax(e){if(e.length===0)return;let t=e.map(i=>parseFloat(String(i))).filter(i=>!isNaN(i));if(t.length>0)return Math.max(...t);let n=e.map(i=>String(i));return n.reduce((i,s)=>s>i?s:i,n[0])}computeGroupConcat(e,t,n){let i=e.map(s=>String(s));return n&&(i=[...new Set(i)]),i.join(t)}createEmptyAggregateResult(e){let{SolutionMapping:t}=is(),n=new t;for(let i of e.aggregates)switch(i.expression.aggregation){case"count":n.set(i.variable,new mr.Literal("0",ry));break;case"sum":case"avg":n.set(i.variable,new mr.Literal("0",Ja));break;case"group_concat":n.set(i.variable,new mr.Literal(" ",ss));break;default:n.set(i.variable,new mr.Literal("",ss))}return n}};$s.AggregateExecutor=jp});var iy=y(Gs=>{"use strict";Object.defineProperty(Gs,"__esModule",{value:!0});Gs.QueryExecutor=Gs.QueryExecutorError=void 0;var x5=Ep(),O5=Pu(),C5=Cp(),P5=Fp(),F5=Zg(),I5=ty(),R5=ny(),D5=Rp(),Ws=class extends Error{static{o(this,"QueryExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="QueryExecutorError"}};Gs.QueryExecutorError=Ws;var Lp=class{static{o(this,"QueryExecutor")}constructor(e){this.bgpExecutor=new x5.BGPExecutor(e),this.filterExecutor=new O5.FilterExecutor,this.optionalExecutor=new C5.OptionalExecutor,this.unionExecutor=new P5.UnionExecutor,this.minusExecutor=new F5.MinusExecutor,this.valuesExecutor=new I5.ValuesExecutor,this.aggregateExecutor=new R5.AggregateExecutor,this.constructExecutor=new D5.ConstructExecutor,this.filterExecutor.setExistsEvaluator(async(t,n)=>this.evaluateExistsPattern(t,n))}async evaluateExistsPattern(e,t){for await(let n of this.execute(e))if(t.merge(n)!==null)return!0;return!1}async executeAll(e){let t=[];for await(let n of this.execute(e))t.push(n);return t}async*execute(e){switch(e.type){case"bgp":yield*this.executeBGP(e);break;case"filter":yield*this.executeFilter(e);break;case"join":yield*this.executeJoin(e);break;case"leftjoin":yield*this.executeLeftJoin(e);break;case"union":yield*this.executeUnion(e);break;case"minus":yield*this.executeMinus(e);break;case"values":yield*this.executeValues(e);break;case"project":yield*this.executeProject(e);break;case"orderby":yield*this.executeOrderBy(e);break;case"slice":yield*this.executeSlice(e);break;case"distinct":yield*this.executeDistinct(e);break;case"reduced":yield*this.executeReduced(e);break;case"group":yield*this.executeGroup(e);break;case"extend":yield*this.executeExtend(e);break;case"subquery":yield*this.executeSubquery(e);break;default:throw new Ws(`Unknown operation type: ${e.type}`)}}async*executeBGP(e){yield*this.bgpExecutor.execute(e)}async*executeFilter(e){let t=this.execute(e.input);yield*this.filterExecutor.execute(e,t)}async*executeJoin(e){let t=[];for await(let n of this.execute(e.left))t.push(n);for(let n of t)for await(let i of this.execute(e.right)){let s=n.merge(i);s!==null&&(yield s)}}async*executeLeftJoin(e){let t=[];for await(let a of this.execute(e.left))t.push(a);let n=[];for await(let a of this.execute(e.right))n.push(a);async function*i(){for(let a of t)yield a}o(i,"leftGen");async function*s(){for(let a of n)yield a}o(s,"rightGen"),yield*this.optionalExecutor.execute(i(),s())}async*executeUnion(e){let t=[];for await(let a of this.execute(e.left))t.push(a);let n=[];for await(let a of this.execute(e.right))n.push(a);async function*i(){for(let a of t)yield a}o(i,"leftGen");async function*s(){for(let a of n)yield a}o(s,"rightGen"),yield*this.unionExecutor.execute(i(),s())}async*executeMinus(e){let t=[];for await(let a of this.execute(e.left))t.push(a);let n=[];for await(let a of this.execute(e.right))n.push(a);async function*i(){for(let a of t)yield a}o(i,"leftGen");async function*s(){for(let a of n)yield a}o(s,"rightGen"),yield*this.minusExecutor.execute(i(),s())}async*executeValues(e){yield*this.valuesExecutor.execute(e)}async*executeProject(e){for await(let t of this.execute(e.input))yield t}async*executeOrderBy(e){let t=[];for await(let n of this.execute(e.input))t.push(n);t.sort((n,i)=>{for(let s of e.comparators){let a=this.getExpressionValue(s.expression,n),c=this.getExpressionValue(s.expression,i),u=0;if(a===void 0&&c===void 0?u=0:a===void 0?u=1:c===void 0?u=-1:typeof a=="number"&&typeof c=="number"?u=a-c:u=String(a).localeCompare(String(c)),s.descending&&(u=-u),u!==0)return u}return 0});for(let n of t)yield n}async*executeSlice(e){let t=0,n=e.offset??0,i=e.limit;for await(let s of this.execute(e.input)){if(t>=n){if(i!==void 0&&t-n>=i)break;yield s}t++}}async*executeDistinct(e){let t=new Set;for await(let n of this.execute(e.input)){let i=this.getSolutionKey(n);t.has(i)||(t.add(i),yield n)}}async*executeReduced(e){let t=new Set;for await(let n of this.execute(e.input)){let i=this.getSolutionKey(n);t.has(i)||(t.add(i),yield n)}}async*executeGroup(e){let t=[];for await(let i of this.execute(e.input))t.push(i);let n=this.aggregateExecutor.execute(e,t);for(let i of n)yield i}async*executeExtend(e){for await(let t of this.execute(e.input)){let n=t.clone(),i=this.evaluateExtendExpression(e.expression,t);i!==void 0&&n.set(e.variable,i),yield n}}async*executeSubquery(e){yield*this.execute(e.query)}evaluateExtendExpression(e,t){if(e.type!=="aggregate")try{return this.filterExecutor.evaluateExpression(e,t)}catch{return}}getExpressionValue(e,t){if(e.type==="variable"){let n=t.get(e.name);return n?n.value??n.id??String(n):void 0}return e.value}getSolutionKey(e){let t=e.toJSON();return Object.keys(t).sort().map(i=>`${i}=${t[i]}`).join("|")}isConstructQuery(e){return e.type==="construct"}async executeConstruct(e){if(e.type!=="construct")throw new Ws("executeConstruct requires a CONSTRUCT operation");let t=await this.executeAll(e.where);return this.constructExecutor.execute(e.template,t)}isAskQuery(e){return e.type==="ask"}async executeAsk(e){if(e.type!=="ask")throw new Ws("executeAsk requires an ASK operation");for await(let t of this.execute(e.where))return!0;return!1}};Gs.QueryExecutor=Lp});var ay=y(Mu=>{"use strict";Object.defineProperty(Mu,"__esModule",{value:!0});Mu.AggregateFunctions=void 0;var Vp=Lt(),sy=gt(),qp=class{static{o(this,"AggregateFunctions")}static count(e,t){if(!t)return e.length;let n=0;for(let i of e)i.has(t)&&n++;return n}static countDistinct(e,t){let n=new Set;for(let i of e){let s=i.get(t);s&&n.add(s.toString())}return n.size}static sum(e,t){let n=0;for(let i of e){let s=i.get(t);if(s instanceof Vp.Literal){let a=this.toNumber(s);isNaN(a)||(n+=a)}}return n}static avg(e,t){let n=this.sum(e,t),i=this.count(e,t);return i>0?n/i:0}static min(e,t){let n=null;for(let i of e){let s=i.get(t);if(!s)continue;let a=this.toComparable(s);(n===null||a<n)&&(n=a)}return n}static max(e,t){let n=null;for(let i of e){let s=i.get(t);if(!s)continue;let a=this.toComparable(s);(n===null||a>n)&&(n=a)}return n}static groupConcat(e,t,n=" "){let i=[];for(let s of e){let a=s.get(t);a&&(a instanceof Vp.Literal||a instanceof sy.IRI?i.push(a.value):i.push(a.toString()))}return i.join(n)}static toNumber(e){let t=e.datatype?.value;return t?.includes("#integer")||t?.includes("#decimal")||t?.includes("#double"),parseFloat(e.value)}static toComparable(e){if(e instanceof Vp.Literal){let t=this.toNumber(e);return isNaN(t)?e.value:t}return e instanceof sy.IRI?e.value:String(e)}};Mu.AggregateFunctions=qp});var oy=y(Lu=>{"use strict";Object.defineProperty(Lu,"__esModule",{value:!0});Lu.QueryPlanCache=void 0;var N5=Qd(),Bp=class{static{o(this,"QueryPlanCache")}constructor(e=100){this.hits=0,this.misses=0,this.cache=new N5.LRUCache(e)}get(e){let t=this.normalizeQuery(e),n=this.cache.get(t);return n!==void 0?this.hits++:this.misses++,n}set(e,t){let n=this.normalizeQuery(e);this.cache.set(n,t)}has(e){let t=this.normalizeQuery(e);return this.cache.get(t)!==void 0}clear(){this.cache.clear()}getStats(){let e=this.hits+this.misses;return{hits:this.hits,misses:this.misses,hitRate:e>0?this.hits/e:0,size:this.cache.size()}}resetStats(){this.hits=0,this.misses=0}normalizeQuery(e){return e.replace(/\s+/g," ").trim()}};Lu.QueryPlanCache=Bp});var cy=y(Hs=>{"use strict";Object.defineProperty(Hs,"__esModule",{value:!0});Hs.FileAlreadyExistsError=Hs.FileNotFoundError=void 0;var Up=class extends Error{static{o(this,"FileNotFoundError")}constructor(e){super(`File not found: ${e}`),this.name="FileNotFoundError"}};Hs.FileNotFoundError=Up;var $p=class extends Error{static{o(this,"FileAlreadyExistsError")}constructor(e){super(`File already exists: ${e}`),this.name="FileAlreadyExistsError"}};Hs.FileAlreadyExistsError=$p});var uy=y(yi=>{"use strict";Object.defineProperty(yi,"__esModule",{value:!0});yi.container=void 0;yi.registerCoreServices=sO;yi.createChildContainer=aO;yi.getContainer=oO;yi.resetContainer=cO;uf();var Xa=Ye();Object.defineProperty(yi,"container",{enumerable:!0,get:o(function(){return Xa.container},"get")});var et=rt(),k5=Kh(),j5=Gc(),M5=xd(),L5=Hc(),V5=_d(),q5=Qh(),B5=rd(),U5=ed(),$5=Jc(),W5=Xc(),G5=hd(),H5=pd(),z5=Sd(),K5=ld(),Y5=Cd(),Q5=Rd(),J5=Fd(),X5=ad(),Z5=cd(),eO=Td(),tO=bd(),rO=tp(),nO=id(),iO=Nd();function sO(r){let e=r||Xa.container;e.registerSingleton(et.DI_TOKENS.TaskFrontmatterGenerator,j5.TaskFrontmatterGenerator),e.registerSingleton(et.DI_TOKENS.DynamicFrontmatterGenerator,M5.DynamicFrontmatterGenerator),e.registerSingleton(et.DI_TOKENS.AlgorithmExtractor,L5.AlgorithmExtractor),e.registerSingleton(et.DI_TOKENS.EffortStatusWorkflow,$5.EffortStatusWorkflow),e.registerSingleton(et.DI_TOKENS.StatusTimestampService,W5.StatusTimestampService),e.registerSingleton(et.DI_TOKENS.TaskStatusService,U5.TaskStatusService),e.registerSingleton(et.DI_TOKENS.TaskCreationService,k5.TaskCreationService),e.registerSingleton(et.DI_TOKENS.ProjectCreationService,q5.ProjectCreationService),e.registerSingleton(et.DI_TOKENS.AreaCreationService,B5.AreaCreationService),e.registerSingleton(et.DI_TOKENS.ClassCreationService,X5.ClassCreationService),e.registerSingleton(et.DI_TOKENS.ConceptCreationService,Z5.ConceptCreationService),e.registerSingleton(et.DI_TOKENS.FleetingNoteCreationService,eO.FleetingNoteCreationService),e.registerSingleton(et.DI_TOKENS.SupervisionCreationService,tO.SupervisionCreationService),e.registerSingleton(et.DI_TOKENS.PropertyCleanupService,V5.PropertyCleanupService),e.registerSingleton(et.DI_TOKENS.FolderRepairService,G5.FolderRepairService),e.registerSingleton(et.DI_TOKENS.LabelToAliasService,H5.LabelToAliasService),e.registerSingleton(et.DI_TOKENS.RenameToUidService,z5.RenameToUidService),e.registerSingleton(et.DI_TOKENS.PlanningService,Y5.PlanningService),e.registerSingleton(et.DI_TOKENS.EffortVotingService,K5.EffortVotingService),e.registerSingleton(et.DI_TOKENS.SessionEventService,Q5.SessionEventService),e.registerSingleton(et.DI_TOKENS.AssetConversionService,J5.AssetConversionService),e.registerSingleton(et.DI_TOKENS.NoteToRDFConverter,rO.NoteToRDFConverter),e.registerSingleton(et.DI_TOKENS.AreaHierarchyBuilder,nO.AreaHierarchyBuilder),e.registerSingleton(et.DI_TOKENS.URIConstructionService,iO.URIConstructionService)}o(sO,"registerCoreServices");function aO(){return Xa.container.createChildContainer()}o(aO,"createChildContainer");function oO(){return Xa.container}o(oO,"getContainer");function cO(){Xa.container.reset()}o(cO,"resetContainer")});var xn=y(Vu=>{"use strict";Object.defineProperty(Vu,"__esModule",{value:!0});Vu.ErrorCode=void 0;var ly;(function(r){r[r.INVALID_INPUT=1e3]="INVALID_INPUT",r[r.INVALID_FORMAT=1001]="INVALID_FORMAT",r[r.MISSING_REQUIRED_FIELD=1002]="MISSING_REQUIRED_FIELD",r[r.INVALID_SCHEMA=1003]="INVALID_SCHEMA",r[r.NETWORK_ERROR=2e3]="NETWORK_ERROR",r[r.REQUEST_TIMEOUT=2001]="REQUEST_TIMEOUT",r[r.CONNECTION_FAILED=2002]="CONNECTION_FAILED",r[r.FILE_READ_ERROR=2003]="FILE_READ_ERROR",r[r.FILE_WRITE_ERROR=2004]="FILE_WRITE_ERROR",r[r.INVALID_STATE=3e3]="INVALID_STATE",r[r.INVALID_TRANSITION=3001]="INVALID_TRANSITION",r[r.OPERATION_FAILED=3002]="OPERATION_FAILED",r[r.CONCURRENT_MODIFICATION=3003]="CONCURRENT_MODIFICATION",r[r.PERMISSION_DENIED=4e3]="PERMISSION_DENIED",r[r.UNAUTHORIZED=4001]="UNAUTHORIZED",r[r.FORBIDDEN=4003]="FORBIDDEN",r[r.NOT_FOUND=5e3]="NOT_FOUND",r[r.RESOURCE_EXHAUSTED=5001]="RESOURCE_EXHAUSTED",r[r.ALREADY_EXISTS=5002]="ALREADY_EXISTS",r[r.UNKNOWN_ERROR=9e3]="UNKNOWN_ERROR",r[r.INTERNAL_ERROR=9001]="INTERNAL_ERROR"})(ly||(Vu.ErrorCode=ly={}))});var On=y(qu=>{"use strict";Object.defineProperty(qu,"__esModule",{value:!0});qu.ApplicationError=void 0;var Wp=class extends Error{static{o(this,"ApplicationError")}constructor(e,t){super(e),this.name=this.constructor.name,this.context=t,this.timestamp=new Date,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}format(){let e=`\u274C ${this.name}: ${this.message}`;if(this.guidance&&(e+=`

\u{1F4A1} ${this.guidance}`),this.context&&Object.keys(this.context).length>0){e+=`

\u{1F4CB} Context:`;for(let[t,n]of Object.entries(this.context))e+=`
  ${t}: ${JSON.stringify(n)}`}return e}toJSON(){return{name:this.name,message:this.message,code:this.code,retriable:this.retriable,timestamp:this.timestamp.toISOString(),context:this.context,stack:this.stack}}};qu.ApplicationError=Wp});var fy=y(Bu=>{"use strict";Object.defineProperty(Bu,"__esModule",{value:!0});Bu.ValidationError=void 0;var uO=On(),lO=xn(),Gp=class extends uO.ApplicationError{static{o(this,"ValidationError")}constructor(e,t){super(e,t),this.code=lO.ErrorCode.INVALID_INPUT,this.retriable=!1,this.guidance=`Check the input data for correctness.
Common issues:
  \u2022 Missing required fields
  \u2022 Invalid data format or type
  \u2022 Values outside allowed range
  \u2022 Schema validation failed`}};Bu.ValidationError=Gp});var hy=y(Uu=>{"use strict";Object.defineProperty(Uu,"__esModule",{value:!0});Uu.NetworkError=void 0;var fO=On(),hO=xn(),Hp=class extends fO.ApplicationError{static{o(this,"NetworkError")}constructor(e,t){super(e,t),this.code=hO.ErrorCode.NETWORK_ERROR,this.retriable=!0,this.guidance=`This is typically a transient network issue.
To resolve:
  \u2022 Check your internet connection
  \u2022 Retry the operation
  \u2022 Verify external services are available
  \u2022 Check firewall/proxy settings`}};Uu.NetworkError=Hp});var dy=y($u=>{"use strict";Object.defineProperty($u,"__esModule",{value:!0});$u.StateTransitionError=void 0;var dO=On(),pO=xn(),zp=class extends dO.ApplicationError{static{o(this,"StateTransitionError")}constructor(e,t){super(e,t),this.code=pO.ErrorCode.INVALID_TRANSITION,this.retriable=!1,this.guidance=`The requested state transition is not allowed.
To fix:
  \u2022 Check the current state of the resource
  \u2022 Verify the transition is valid for this workflow
  \u2022 Review state machine documentation
  \u2022 Ensure no concurrent modifications occurred`}};$u.StateTransitionError=zp});var py=y(Wu=>{"use strict";Object.defineProperty(Wu,"__esModule",{value:!0});Wu.PermissionError=void 0;var mO=On(),gO=xn(),Kp=class extends mO.ApplicationError{static{o(this,"PermissionError")}constructor(e,t){super(e,t),this.code=gO.ErrorCode.PERMISSION_DENIED,this.retriable=!1,this.guidance=`You don't have permission to perform this operation.
To resolve:
  \u2022 Check file/directory permissions
  \u2022 Verify you're authenticated
  \u2022 Ensure you have sufficient privileges
  \u2022 Contact administrator if access is needed`}};Wu.PermissionError=Kp});var my=y(Gu=>{"use strict";Object.defineProperty(Gu,"__esModule",{value:!0});Gu.NotFoundError=void 0;var yO=On(),_O=xn(),Yp=class extends yO.ApplicationError{static{o(this,"NotFoundError")}constructor(e,t){super(e,t),this.code=_O.ErrorCode.NOT_FOUND,this.retriable=!1,this.guidance=`The requested resource could not be found.
To resolve:
  \u2022 Verify the resource path/ID is correct
  \u2022 Check the resource exists
  \u2022 Ensure proper file extension (.md for notes)
  \u2022 Verify resource hasn't been deleted`}};Gu.NotFoundError=Yp});var gy=y(Hu=>{"use strict";Object.defineProperty(Hu,"__esModule",{value:!0});Hu.ResourceExhaustedError=void 0;var vO=On(),SO=xn(),Qp=class extends vO.ApplicationError{static{o(this,"ResourceExhaustedError")}constructor(e,t){super(e,t),this.code=SO.ErrorCode.RESOURCE_EXHAUSTED,this.retriable=!0,this.guidance=`A resource limit has been exceeded.
To resolve:
  \u2022 Free up system resources (memory, disk space)
  \u2022 Reduce the size of your request
  \u2022 Wait and retry (for rate limits)
  \u2022 Close unused files/connections
  \u2022 Paginate large queries`}};Hu.ResourceExhaustedError=Qp});var yy=y(zu=>{"use strict";Object.defineProperty(zu,"__esModule",{value:!0});zu.ServiceError=void 0;var wO=On(),bO=xn(),Jp=class extends wO.ApplicationError{static{o(this,"ServiceError")}constructor(e,t){super(e,t),this.code=bO.ErrorCode.INTERNAL_ERROR,this.retriable=!1,this.guidance=`This is an internal service error.
To resolve:
  \u2022 Check service initialization parameters
  \u2022 Verify all required dependencies are available
  \u2022 Review service logs for detailed error information
  \u2022 Contact support if the issue persists`}};zu.ServiceError=Jp});var _y=y(pt=>{"use strict";Object.defineProperty(pt,"__esModule",{value:!0});pt.ServiceError=pt.ResourceExhaustedError=pt.NotFoundError=pt.PermissionError=pt.StateTransitionError=pt.NetworkError=pt.ValidationError=pt.ApplicationError=pt.ErrorCode=void 0;var EO=xn();Object.defineProperty(pt,"ErrorCode",{enumerable:!0,get:o(function(){return EO.ErrorCode},"get")});var TO=On();Object.defineProperty(pt,"ApplicationError",{enumerable:!0,get:o(function(){return TO.ApplicationError},"get")});var AO=fy();Object.defineProperty(pt,"ValidationError",{enumerable:!0,get:o(function(){return AO.ValidationError},"get")});var xO=hy();Object.defineProperty(pt,"NetworkError",{enumerable:!0,get:o(function(){return xO.NetworkError},"get")});var OO=dy();Object.defineProperty(pt,"StateTransitionError",{enumerable:!0,get:o(function(){return OO.StateTransitionError},"get")});var CO=py();Object.defineProperty(pt,"PermissionError",{enumerable:!0,get:o(function(){return CO.PermissionError},"get")});var PO=my();Object.defineProperty(pt,"NotFoundError",{enumerable:!0,get:o(function(){return PO.NotFoundError},"get")});var FO=gy();Object.defineProperty(pt,"ResourceExhaustedError",{enumerable:!0,get:o(function(){return FO.ResourceExhaustedError},"get")});var IO=yy();Object.defineProperty(pt,"ServiceError",{enumerable:!0,get:o(function(){return IO.ServiceError},"get")})});var vy=y(Ku=>{"use strict";Object.defineProperty(Ku,"__esModule",{value:!0});Ku.ApplicationErrorHandler=void 0;var Xp=On(),RO=xn(),Zp=class{static{o(this,"ApplicationErrorHandler")}constructor(e={},t,n){this.logger=t,this.notifier=n,this.telemetryHooks=new Set,this.retryConfig={maxRetries:e.maxRetries??3,initialDelayMs:e.initialDelayMs??1e3,backoffMultiplier:e.backoffMultiplier??2,maxDelayMs:e.maxDelayMs??1e4}}handle(e,t){let n=this.ensureApplicationError(e,t);return this.notifier&&this.notifier.error(n.message),this.callTelemetryHooks("onError",n,t),this.formatError(n)}async executeWithRetry(e,t){let n,i=0;for(;i<=this.retryConfig.maxRetries;)try{return await e()}catch(s){if(n=this.ensureApplicationError(s,t),!n.retriable||i>=this.retryConfig.maxRetries)throw this.callTelemetryHooks("onError",n,t),i>=this.retryConfig.maxRetries&&n.retriable&&this.callTelemetryHooks("onRetryExhausted",n,i+1),n;let a=this.calculateDelay(i);this.callTelemetryHooks("onRetry",n,i+1,a),this.logger?.debug(`Retrying after ${a}ms (attempt ${i+1}/${this.retryConfig.maxRetries})`),await this.sleep(a),i++}throw n}registerTelemetryHook(e){this.telemetryHooks.add(e)}unregisterTelemetryHook(e){this.telemetryHooks.delete(e)}ensureApplicationError(e,t){if(e instanceof Xp.ApplicationError){if(t){let i=e,s={...e.context,...t};return new class extends Xp.ApplicationError{constructor(){super(...arguments),this.code=i.code,this.retriable=i.retriable,this.guidance=i.guidance}}(e.message,s)}return e}return new class extends Xp.ApplicationError{static{o(this,"UnknownError")}constructor(s,a){super(s,{originalError:a.name,...t}),this.code=RO.ErrorCode.UNKNOWN_ERROR,this.retriable=!1,this.guidance="An unexpected error occurred"}}(e.message,e)}formatError(e){let t=[];return t.push(`\u274C ${e.name}: ${e.message}`),e.guidance&&t.push(`\u{1F4A1} ${e.guidance}`),e.context&&Object.keys(e.context).length>0&&t.push(`Context: ${JSON.stringify(e.context,null,2)}`),t.join(`
`)}calculateDelay(e){let t=this.retryConfig.initialDelayMs*Math.pow(this.retryConfig.backoffMultiplier,e);return Math.min(t,this.retryConfig.maxDelayMs)}sleep(e){return new Promise(t=>setTimeout(t,e))}callTelemetryHooks(e,...t){for(let n of this.telemetryHooks)try{let i=n[e];i&&i.apply(n,t)}catch(i){console.error("Error in telemetry hook:",i)}}};Ku.ApplicationErrorHandler=Zp});var Sy=y(Yu=>{"use strict";Object.defineProperty(Yu,"__esModule",{value:!0});Yu.ApplicationErrorHandler=void 0;var DO=vy();Object.defineProperty(Yu,"ApplicationErrorHandler",{enumerable:!0,get:o(function(){return DO.ApplicationErrorHandler},"get")})});var _i=y(T=>{"use strict";var NO=T&&T.__createBinding||(Object.create?(function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:o(function(){return e[t]},"get")}),Object.defineProperty(r,n,i)}):(function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]})),Cn=T&&T.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&NO(e,r,t)};Object.defineProperty(T,"__esModule",{value:!0});T.DescribeExecutor=T.ConstructExecutor=T.UnionExecutor=T.OptionalExecutor=T.FilterExecutor=T.BGPExecutor=T.AlgebraSerializer=T.AlgebraOptimizer=T.AlgebraTranslator=T.SPARQLParseError=T.SPARQLParser=T.NoteToRDFConverter=T.RDFVocabularyMapper=T.InMemoryTripleStore=T.RDFSerializer=T.EffortSortingHelpers=T.MetadataExtractor=T.MetadataHelpers=T.WikiLinkHelpers=T.DateFormatter=T.FrontmatterService=T.URIConstructionService=T.SessionEventService=T.AssetConversionService=T.PlanningService=T.AlgorithmExtractor=T.DynamicFrontmatterGenerator=T.TaskFrontmatterGenerator=T.FleetingNoteCreationService=T.SupervisionCreationService=T.StatusTimestampService=T.RenameToUidService=T.PropertyCleanupService=T.LoggingService=T.LabelToAliasService=T.FolderRepairService=T.EffortVotingService=T.EffortStatusWorkflow=T.ConceptCreationService=T.ClassCreationService=T.AreaHierarchyBuilder=T.AreaCreationService=T.TaskStatusService=T.ProjectCreationService=T.TaskCreationService=T.extractPropertyLabel=T.uriToPropertyName=T.propertyNameToUri=T.rangeToFieldType=T.PropertyFieldType=void 0;T.container=T.resetContainer=T.getContainer=T.createChildContainer=T.registerCoreServices=T.DI_TOKENS=T.FileAlreadyExistsError=T.FileNotFoundError=T.CaseWhenTransformerError=T.CaseWhenTransformer=T.QueryPlanCache=T.AggregateFunctions=T.BuiltInFunctions=T.SolutionMapping=T.QueryExecutor=void 0;Cn(Of(),T);Cn(Cf(),T);Cn(f0(),T);Cn(d0(),T);Cn(m0(),T);Cn(y0(),T);Cn(v0(),T);Cn(N0(),T);var wy=j0();Object.defineProperty(T,"PropertyFieldType",{enumerable:!0,get:o(function(){return wy.PropertyFieldType},"get")});Object.defineProperty(T,"rangeToFieldType",{enumerable:!0,get:o(function(){return wy.rangeToFieldType},"get")});var em=L0();Object.defineProperty(T,"propertyNameToUri",{enumerable:!0,get:o(function(){return em.propertyNameToUri},"get")});Object.defineProperty(T,"uriToPropertyName",{enumerable:!0,get:o(function(){return em.uriToPropertyName},"get")});Object.defineProperty(T,"extractPropertyLabel",{enumerable:!0,get:o(function(){return em.extractPropertyLabel},"get")});var kO=Kh();Object.defineProperty(T,"TaskCreationService",{enumerable:!0,get:o(function(){return kO.TaskCreationService},"get")});var jO=Qh();Object.defineProperty(T,"ProjectCreationService",{enumerable:!0,get:o(function(){return jO.ProjectCreationService},"get")});var MO=ed();Object.defineProperty(T,"TaskStatusService",{enumerable:!0,get:o(function(){return MO.TaskStatusService},"get")});var LO=rd();Object.defineProperty(T,"AreaCreationService",{enumerable:!0,get:o(function(){return LO.AreaCreationService},"get")});var VO=id();Object.defineProperty(T,"AreaHierarchyBuilder",{enumerable:!0,get:o(function(){return VO.AreaHierarchyBuilder},"get")});var qO=ad();Object.defineProperty(T,"ClassCreationService",{enumerable:!0,get:o(function(){return qO.ClassCreationService},"get")});var BO=cd();Object.defineProperty(T,"ConceptCreationService",{enumerable:!0,get:o(function(){return BO.ConceptCreationService},"get")});var UO=Jc();Object.defineProperty(T,"EffortStatusWorkflow",{enumerable:!0,get:o(function(){return UO.EffortStatusWorkflow},"get")});var $O=ld();Object.defineProperty(T,"EffortVotingService",{enumerable:!0,get:o(function(){return $O.EffortVotingService},"get")});var WO=hd();Object.defineProperty(T,"FolderRepairService",{enumerable:!0,get:o(function(){return WO.FolderRepairService},"get")});var GO=pd();Object.defineProperty(T,"LabelToAliasService",{enumerable:!0,get:o(function(){return GO.LabelToAliasService},"get")});var HO=md();Object.defineProperty(T,"LoggingService",{enumerable:!0,get:o(function(){return HO.LoggingService},"get")});var zO=_d();Object.defineProperty(T,"PropertyCleanupService",{enumerable:!0,get:o(function(){return zO.PropertyCleanupService},"get")});var KO=Sd();Object.defineProperty(T,"RenameToUidService",{enumerable:!0,get:o(function(){return KO.RenameToUidService},"get")});var YO=Xc();Object.defineProperty(T,"StatusTimestampService",{enumerable:!0,get:o(function(){return YO.StatusTimestampService},"get")});var QO=bd();Object.defineProperty(T,"SupervisionCreationService",{enumerable:!0,get:o(function(){return QO.SupervisionCreationService},"get")});var JO=Td();Object.defineProperty(T,"FleetingNoteCreationService",{enumerable:!0,get:o(function(){return JO.FleetingNoteCreationService},"get")});var XO=Gc();Object.defineProperty(T,"TaskFrontmatterGenerator",{enumerable:!0,get:o(function(){return XO.TaskFrontmatterGenerator},"get")});var ZO=xd();Object.defineProperty(T,"DynamicFrontmatterGenerator",{enumerable:!0,get:o(function(){return ZO.DynamicFrontmatterGenerator},"get")});var eC=Hc();Object.defineProperty(T,"AlgorithmExtractor",{enumerable:!0,get:o(function(){return eC.AlgorithmExtractor},"get")});var tC=Cd();Object.defineProperty(T,"PlanningService",{enumerable:!0,get:o(function(){return tC.PlanningService},"get")});var rC=Fd();Object.defineProperty(T,"AssetConversionService",{enumerable:!0,get:o(function(){return rC.AssetConversionService},"get")});var nC=Rd();Object.defineProperty(T,"SessionEventService",{enumerable:!0,get:o(function(){return nC.SessionEventService},"get")});var iC=Nd();Object.defineProperty(T,"URIConstructionService",{enumerable:!0,get:o(function(){return iC.URIConstructionService},"get")});var sC=Ps();Object.defineProperty(T,"FrontmatterService",{enumerable:!0,get:o(function(){return sC.FrontmatterService},"get")});var aC=pr();Object.defineProperty(T,"DateFormatter",{enumerable:!0,get:o(function(){return aC.DateFormatter},"get")});var oC=Bi();Object.defineProperty(T,"WikiLinkHelpers",{enumerable:!0,get:o(function(){return oC.WikiLinkHelpers},"get")});var cC=Br();Object.defineProperty(T,"MetadataHelpers",{enumerable:!0,get:o(function(){return cC.MetadataHelpers},"get")});var uC=$a();Object.defineProperty(T,"MetadataExtractor",{enumerable:!0,get:o(function(){return uC.MetadataExtractor},"get")});var lC=hg();Object.defineProperty(T,"EffortSortingHelpers",{enumerable:!0,get:o(function(){return lC.EffortSortingHelpers},"get")});var fC=vg();Object.defineProperty(T,"RDFSerializer",{enumerable:!0,get:o(function(){return fC.RDFSerializer},"get")});var hC=wg();Object.defineProperty(T,"InMemoryTripleStore",{enumerable:!0,get:o(function(){return hC.InMemoryTripleStore},"get")});var dC=Eg();Object.defineProperty(T,"RDFVocabularyMapper",{enumerable:!0,get:o(function(){return dC.RDFVocabularyMapper},"get")});var pC=tp();Object.defineProperty(T,"NoteToRDFConverter",{enumerable:!0,get:o(function(){return pC.NoteToRDFConverter},"get")});var by=qg();Object.defineProperty(T,"SPARQLParser",{enumerable:!0,get:o(function(){return by.SPARQLParser},"get")});Object.defineProperty(T,"SPARQLParseError",{enumerable:!0,get:o(function(){return by.SPARQLParseError},"get")});var mC=Bg();Object.defineProperty(T,"AlgebraTranslator",{enumerable:!0,get:o(function(){return mC.AlgebraTranslator},"get")});var gC=Ug();Object.defineProperty(T,"AlgebraOptimizer",{enumerable:!0,get:o(function(){return gC.AlgebraOptimizer},"get")});var yC=$g();Object.defineProperty(T,"AlgebraSerializer",{enumerable:!0,get:o(function(){return yC.AlgebraSerializer},"get")});var _C=Ep();Object.defineProperty(T,"BGPExecutor",{enumerable:!0,get:o(function(){return _C.BGPExecutor},"get")});var vC=Pu();Object.defineProperty(T,"FilterExecutor",{enumerable:!0,get:o(function(){return vC.FilterExecutor},"get")});var SC=Cp();Object.defineProperty(T,"OptionalExecutor",{enumerable:!0,get:o(function(){return SC.OptionalExecutor},"get")});var wC=Fp();Object.defineProperty(T,"UnionExecutor",{enumerable:!0,get:o(function(){return wC.UnionExecutor},"get")});var bC=Rp();Object.defineProperty(T,"ConstructExecutor",{enumerable:!0,get:o(function(){return bC.ConstructExecutor},"get")});var EC=Xg();Object.defineProperty(T,"DescribeExecutor",{enumerable:!0,get:o(function(){return EC.DescribeExecutor},"get")});var TC=iy();Object.defineProperty(T,"QueryExecutor",{enumerable:!0,get:o(function(){return TC.QueryExecutor},"get")});var AC=is();Object.defineProperty(T,"SolutionMapping",{enumerable:!0,get:o(function(){return AC.SolutionMapping},"get")});var xC=Ap();Object.defineProperty(T,"BuiltInFunctions",{enumerable:!0,get:o(function(){return xC.BuiltInFunctions},"get")});var OC=ay();Object.defineProperty(T,"AggregateFunctions",{enumerable:!0,get:o(function(){return OC.AggregateFunctions},"get")});var CC=oy();Object.defineProperty(T,"QueryPlanCache",{enumerable:!0,get:o(function(){return CC.QueryPlanCache},"get")});var Ey=pp();Object.defineProperty(T,"CaseWhenTransformer",{enumerable:!0,get:o(function(){return Ey.CaseWhenTransformer},"get")});Object.defineProperty(T,"CaseWhenTransformerError",{enumerable:!0,get:o(function(){return Ey.CaseWhenTransformerError},"get")});var Ty=cy();Object.defineProperty(T,"FileNotFoundError",{enumerable:!0,get:o(function(){return Ty.FileNotFoundError},"get")});Object.defineProperty(T,"FileAlreadyExistsError",{enumerable:!0,get:o(function(){return Ty.FileAlreadyExistsError},"get")});var PC=rt();Object.defineProperty(T,"DI_TOKENS",{enumerable:!0,get:o(function(){return PC.DI_TOKENS},"get")});var Za=uy();Object.defineProperty(T,"registerCoreServices",{enumerable:!0,get:o(function(){return Za.registerCoreServices},"get")});Object.defineProperty(T,"createChildContainer",{enumerable:!0,get:o(function(){return Za.createChildContainer},"get")});Object.defineProperty(T,"getContainer",{enumerable:!0,get:o(function(){return Za.getContainer},"get")});Object.defineProperty(T,"resetContainer",{enumerable:!0,get:o(function(){return Za.resetContainer},"get")});Object.defineProperty(T,"container",{enumerable:!0,get:o(function(){return Za.container},"get")});Cn(_y(),T);Cn(Sy(),T)});var wt=y(tm=>{"use strict";tm.fromCallback=function(r){return Object.defineProperty(function(...e){if(typeof e[e.length-1]=="function")r.apply(this,e);else return new Promise((t,n)=>{e.push((i,s)=>i!=null?n(i):t(s)),r.apply(this,e)})},"name",{value:r.name})};tm.fromPromise=function(r){return Object.defineProperty(function(...e){let t=e[e.length-1];if(typeof t!="function")return r.apply(this,e);e.pop(),r.apply(this,e).then(n=>t(null,n),t)},"name",{value:r.name})}});var xy=y((EM,Ay)=>{var vi=require("constants"),FC=process.cwd,Qu=null,IC=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return Qu||(Qu=FC.call(process)),Qu};try{process.cwd()}catch{}typeof process.chdir=="function"&&(rm=process.chdir,process.chdir=function(r){Qu=null,rm.call(process,r)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,rm));var rm;Ay.exports=RC;function RC(r){vi.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&e(r),r.lutimes||t(r),r.chown=s(r.chown),r.fchown=s(r.fchown),r.lchown=s(r.lchown),r.chmod=n(r.chmod),r.fchmod=n(r.fchmod),r.lchmod=n(r.lchmod),r.chownSync=a(r.chownSync),r.fchownSync=a(r.fchownSync),r.lchownSync=a(r.lchownSync),r.chmodSync=i(r.chmodSync),r.fchmodSync=i(r.fchmodSync),r.lchmodSync=i(r.lchmodSync),r.stat=c(r.stat),r.fstat=c(r.fstat),r.lstat=c(r.lstat),r.statSync=u(r.statSync),r.fstatSync=u(r.fstatSync),r.lstatSync=u(r.lstatSync),r.chmod&&!r.lchmod&&(r.lchmod=function(l,h,p){p&&process.nextTick(p)},r.lchmodSync=function(){}),r.chown&&!r.lchown&&(r.lchown=function(l,h,p,g){g&&process.nextTick(g)},r.lchownSync=function(){}),IC==="win32"&&(r.rename=typeof r.rename!="function"?r.rename:(function(l){function h(p,g,w){var S=Date.now(),x=0;l(p,g,o(function P(F){if(F&&(F.code==="EACCES"||F.code==="EPERM"||F.code==="EBUSY")&&Date.now()-S<6e4){setTimeout(function(){r.stat(g,function(L,$){L&&L.code==="ENOENT"?l(p,g,P):w(F)})},x),x<100&&(x+=10);return}w&&w(F)},"CB"))}return o(h,"rename"),Object.setPrototypeOf&&Object.setPrototypeOf(h,l),h})(r.rename)),r.read=typeof r.read!="function"?r.read:(function(l){function h(p,g,w,S,x,P){var F;if(P&&typeof P=="function"){var L=0;F=o(function($,K,Fe){if($&&$.code==="EAGAIN"&&L<10)return L++,l.call(r,p,g,w,S,x,F);P.apply(this,arguments)},"callback")}return l.call(r,p,g,w,S,x,F)}return o(h,"read"),Object.setPrototypeOf&&Object.setPrototypeOf(h,l),h})(r.read),r.readSync=typeof r.readSync!="function"?r.readSync:(function(l){return function(h,p,g,w,S){for(var x=0;;)try{return l.call(r,h,p,g,w,S)}catch(P){if(P.code==="EAGAIN"&&x<10){x++;continue}throw P}}})(r.readSync);function e(l){l.lchmod=function(h,p,g){l.open(h,vi.O_WRONLY|vi.O_SYMLINK,p,function(w,S){if(w){g&&g(w);return}l.fchmod(S,p,function(x){l.close(S,function(P){g&&g(x||P)})})})},l.lchmodSync=function(h,p){var g=l.openSync(h,vi.O_WRONLY|vi.O_SYMLINK,p),w=!0,S;try{S=l.fchmodSync(g,p),w=!1}finally{if(w)try{l.closeSync(g)}catch{}else l.closeSync(g)}return S}}o(e,"patchLchmod");function t(l){vi.hasOwnProperty("O_SYMLINK")&&l.futimes?(l.lutimes=function(h,p,g,w){l.open(h,vi.O_SYMLINK,function(S,x){if(S){w&&w(S);return}l.futimes(x,p,g,function(P){l.close(x,function(F){w&&w(P||F)})})})},l.lutimesSync=function(h,p,g){var w=l.openSync(h,vi.O_SYMLINK),S,x=!0;try{S=l.futimesSync(w,p,g),x=!1}finally{if(x)try{l.closeSync(w)}catch{}else l.closeSync(w)}return S}):l.futimes&&(l.lutimes=function(h,p,g,w){w&&process.nextTick(w)},l.lutimesSync=function(){})}o(t,"patchLutimes");function n(l){return l&&function(h,p,g){return l.call(r,h,p,function(w){f(w)&&(w=null),g&&g.apply(this,arguments)})}}o(n,"chmodFix");function i(l){return l&&function(h,p){try{return l.call(r,h,p)}catch(g){if(!f(g))throw g}}}o(i,"chmodFixSync");function s(l){return l&&function(h,p,g,w){return l.call(r,h,p,g,function(S){f(S)&&(S=null),w&&w.apply(this,arguments)})}}o(s,"chownFix");function a(l){return l&&function(h,p,g){try{return l.call(r,h,p,g)}catch(w){if(!f(w))throw w}}}o(a,"chownFixSync");function c(l){return l&&function(h,p,g){typeof p=="function"&&(g=p,p=null);function w(S,x){x&&(x.uid<0&&(x.uid+=4294967296),x.gid<0&&(x.gid+=4294967296)),g&&g.apply(this,arguments)}return o(w,"callback"),p?l.call(r,h,p,w):l.call(r,h,w)}}o(c,"statFix");function u(l){return l&&function(h,p){var g=p?l.call(r,h,p):l.call(r,h);return g&&(g.uid<0&&(g.uid+=4294967296),g.gid<0&&(g.gid+=4294967296)),g}}o(u,"statFixSync");function f(l){if(!l||l.code==="ENOSYS")return!0;var h=!process.getuid||process.getuid()!==0;return!!(h&&(l.code==="EINVAL"||l.code==="EPERM"))}o(f,"chownErOk")}o(RC,"patch")});var Py=y((AM,Cy)=>{var Oy=require("stream").Stream;Cy.exports=DC;function DC(r){return{ReadStream:e,WriteStream:t};function e(n,i){if(!(this instanceof e))return new e(n,i);Oy.call(this);var s=this;this.path=n,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,i=i||{};for(var a=Object.keys(i),c=0,u=a.length;c<u;c++){var f=a[c];this[f]=i[f]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){s._read()});return}r.open(this.path,this.flags,this.mode,function(l,h){if(l){s.emit("error",l),s.readable=!1;return}s.fd=h,s.emit("open",h),s._read()})}function t(n,i){if(!(this instanceof t))return new t(n,i);Oy.call(this),this.path=n,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,i=i||{};for(var s=Object.keys(i),a=0,c=s.length;a<c;a++){var u=s[a];this[u]=i[u]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=r.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}o(DC,"legacy")});var Iy=y((OM,Fy)=>{"use strict";Fy.exports=kC;var NC=Object.getPrototypeOf||function(r){return r.__proto__};function kC(r){if(r===null||typeof r!="object")return r;if(r instanceof Object)var e={__proto__:NC(r)};else var e=Object.create(null);return Object.getOwnPropertyNames(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}),e}o(kC,"clone")});var Ks=y((PM,sm)=>{var nt=require("fs"),jC=xy(),MC=Py(),LC=Iy(),Ju=require("util"),Dt,Zu;typeof Symbol=="function"&&typeof Symbol.for=="function"?(Dt=Symbol.for("graceful-fs.queue"),Zu=Symbol.for("graceful-fs.previous")):(Dt="___graceful-fs.queue",Zu="___graceful-fs.previous");function VC(){}o(VC,"noop");function Ny(r,e){Object.defineProperty(r,Dt,{get:o(function(){return e},"get")})}o(Ny,"publishQueue");var as=VC;Ju.debuglog?as=Ju.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(as=o(function(){var r=Ju.format.apply(Ju,arguments);r="GFS4: "+r.split(/\n/).join(`
GFS4: `),console.error(r)},"debug"));nt[Dt]||(Ry=global[Dt]||[],Ny(nt,Ry),nt.close=(function(r){function e(t,n){return r.call(nt,t,function(i){i||Dy(),typeof n=="function"&&n.apply(this,arguments)})}return o(e,"close"),Object.defineProperty(e,Zu,{value:r}),e})(nt.close),nt.closeSync=(function(r){function e(t){r.apply(nt,arguments),Dy()}return o(e,"closeSync"),Object.defineProperty(e,Zu,{value:r}),e})(nt.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){as(nt[Dt]),require("assert").equal(nt[Dt].length,0)}));var Ry;global[Dt]||Ny(global,nt[Dt]);sm.exports=nm(LC(nt));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!nt.__patched&&(sm.exports=nm(nt),nt.__patched=!0);function nm(r){jC(r),r.gracefulify=nm,r.createReadStream=K,r.createWriteStream=Fe;var e=r.readFile;r.readFile=t;function t(B,ce,Ce){return typeof ce=="function"&&(Ce=ce,ce=null),Ze(B,ce,Ce);function Ze(Ge,ze,Ne,ke){return e(Ge,ze,function(Pe){Pe&&(Pe.code==="EMFILE"||Pe.code==="ENFILE")?zs([Ze,[Ge,ze,Ne],Pe,ke||Date.now(),Date.now()]):typeof Ne=="function"&&Ne.apply(this,arguments)})}o(Ze,"go$readFile")}o(t,"readFile");var n=r.writeFile;r.writeFile=i;function i(B,ce,Ce,Ze){return typeof Ce=="function"&&(Ze=Ce,Ce=null),Ge(B,ce,Ce,Ze);function Ge(ze,Ne,ke,Pe,G){return n(ze,Ne,ke,function(D){D&&(D.code==="EMFILE"||D.code==="ENFILE")?zs([Ge,[ze,Ne,ke,Pe],D,G||Date.now(),Date.now()]):typeof Pe=="function"&&Pe.apply(this,arguments)})}o(Ge,"go$writeFile")}o(i,"writeFile");var s=r.appendFile;s&&(r.appendFile=a);function a(B,ce,Ce,Ze){return typeof Ce=="function"&&(Ze=Ce,Ce=null),Ge(B,ce,Ce,Ze);function Ge(ze,Ne,ke,Pe,G){return s(ze,Ne,ke,function(D){D&&(D.code==="EMFILE"||D.code==="ENFILE")?zs([Ge,[ze,Ne,ke,Pe],D,G||Date.now(),Date.now()]):typeof Pe=="function"&&Pe.apply(this,arguments)})}o(Ge,"go$appendFile")}o(a,"appendFile");var c=r.copyFile;c&&(r.copyFile=u);function u(B,ce,Ce,Ze){return typeof Ce=="function"&&(Ze=Ce,Ce=0),Ge(B,ce,Ce,Ze);function Ge(ze,Ne,ke,Pe,G){return c(ze,Ne,ke,function(D){D&&(D.code==="EMFILE"||D.code==="ENFILE")?zs([Ge,[ze,Ne,ke,Pe],D,G||Date.now(),Date.now()]):typeof Pe=="function"&&Pe.apply(this,arguments)})}o(Ge,"go$copyFile")}o(u,"copyFile");var f=r.readdir;r.readdir=h;var l=/^v[0-5]\./;function h(B,ce,Ce){typeof ce=="function"&&(Ce=ce,ce=null);var Ze=l.test(process.version)?o(function(Ne,ke,Pe,G){return f(Ne,Ge(Ne,ke,Pe,G))},"go$readdir"):o(function(Ne,ke,Pe,G){return f(Ne,ke,Ge(Ne,ke,Pe,G))},"go$readdir");return Ze(B,ce,Ce);function Ge(ze,Ne,ke,Pe){return function(G,D){G&&(G.code==="EMFILE"||G.code==="ENFILE")?zs([Ze,[ze,Ne,ke],G,Pe||Date.now(),Date.now()]):(D&&D.sort&&D.sort(),typeof ke=="function"&&ke.call(this,G,D))}}}if(o(h,"readdir"),process.version.substr(0,4)==="v0.8"){var p=MC(r);P=p.ReadStream,L=p.WriteStream}var g=r.ReadStream;g&&(P.prototype=Object.create(g.prototype),P.prototype.open=F);var w=r.WriteStream;w&&(L.prototype=Object.create(w.prototype),L.prototype.open=$),Object.defineProperty(r,"ReadStream",{get:o(function(){return P},"get"),set:o(function(B){P=B},"set"),enumerable:!0,configurable:!0}),Object.defineProperty(r,"WriteStream",{get:o(function(){return L},"get"),set:o(function(B){L=B},"set"),enumerable:!0,configurable:!0});var S=P;Object.defineProperty(r,"FileReadStream",{get:o(function(){return S},"get"),set:o(function(B){S=B},"set"),enumerable:!0,configurable:!0});var x=L;Object.defineProperty(r,"FileWriteStream",{get:o(function(){return x},"get"),set:o(function(B){x=B},"set"),enumerable:!0,configurable:!0});function P(B,ce){return this instanceof P?(g.apply(this,arguments),this):P.apply(Object.create(P.prototype),arguments)}o(P,"ReadStream");function F(){var B=this;at(B.path,B.flags,B.mode,function(ce,Ce){ce?(B.autoClose&&B.destroy(),B.emit("error",ce)):(B.fd=Ce,B.emit("open",Ce),B.read())})}o(F,"ReadStream$open");function L(B,ce){return this instanceof L?(w.apply(this,arguments),this):L.apply(Object.create(L.prototype),arguments)}o(L,"WriteStream");function $(){var B=this;at(B.path,B.flags,B.mode,function(ce,Ce){ce?(B.destroy(),B.emit("error",ce)):(B.fd=Ce,B.emit("open",Ce))})}o($,"WriteStream$open");function K(B,ce){return new r.ReadStream(B,ce)}o(K,"createReadStream");function Fe(B,ce){return new r.WriteStream(B,ce)}o(Fe,"createWriteStream");var Xe=r.open;r.open=at;function at(B,ce,Ce,Ze){return typeof Ce=="function"&&(Ze=Ce,Ce=null),Ge(B,ce,Ce,Ze);function Ge(ze,Ne,ke,Pe,G){return Xe(ze,Ne,ke,function(D,je){D&&(D.code==="EMFILE"||D.code==="ENFILE")?zs([Ge,[ze,Ne,ke,Pe],D,G||Date.now(),Date.now()]):typeof Pe=="function"&&Pe.apply(this,arguments)})}o(Ge,"go$open")}return o(at,"open"),r}o(nm,"patch");function zs(r){as("ENQUEUE",r[0].name,r[1]),nt[Dt].push(r),im()}o(zs,"enqueue");var Xu;function Dy(){for(var r=Date.now(),e=0;e<nt[Dt].length;++e)nt[Dt][e].length>2&&(nt[Dt][e][3]=r,nt[Dt][e][4]=r);im()}o(Dy,"resetQueue");function im(){if(clearTimeout(Xu),Xu=void 0,nt[Dt].length!==0){var r=nt[Dt].shift(),e=r[0],t=r[1],n=r[2],i=r[3],s=r[4];if(i===void 0)as("RETRY",e.name,t),e.apply(null,t);else if(Date.now()-i>=6e4){as("TIMEOUT",e.name,t);var a=t.pop();typeof a=="function"&&a.call(null,n)}else{var c=Date.now()-s,u=Math.max(s-i,1),f=Math.min(u*1.2,100);c>=f?(as("RETRY",e.name,t),e.apply(null,t.concat([i]))):nt[Dt].push(r)}Xu===void 0&&(Xu=setTimeout(im,0))}}o(im,"retry")});var tr=y(Jn=>{"use strict";var ky=wt().fromCallback,er=Ks(),qC=["access","appendFile","chmod","chown","close","copyFile","cp","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","glob","lchmod","lchown","lutimes","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","statfs","symlink","truncate","unlink","utimes","writeFile"].filter(r=>typeof er[r]=="function");Object.assign(Jn,er);qC.forEach(r=>{Jn[r]=ky(er[r])});Jn.exists=function(r,e){return typeof e=="function"?er.exists(r,e):new Promise(t=>er.exists(r,t))};Jn.read=function(r,e,t,n,i,s){return typeof s=="function"?er.read(r,e,t,n,i,s):new Promise((a,c)=>{er.read(r,e,t,n,i,(u,f,l)=>{if(u)return c(u);a({bytesRead:f,buffer:l})})})};Jn.write=function(r,e,...t){return typeof t[t.length-1]=="function"?er.write(r,e,...t):new Promise((n,i)=>{er.write(r,e,...t,(s,a,c)=>{if(s)return i(s);n({bytesWritten:a,buffer:c})})})};Jn.readv=function(r,e,...t){return typeof t[t.length-1]=="function"?er.readv(r,e,...t):new Promise((n,i)=>{er.readv(r,e,...t,(s,a,c)=>{if(s)return i(s);n({bytesRead:a,buffers:c})})})};Jn.writev=function(r,e,...t){return typeof t[t.length-1]=="function"?er.writev(r,e,...t):new Promise((n,i)=>{er.writev(r,e,...t,(s,a,c)=>{if(s)return i(s);n({bytesWritten:a,buffers:c})})})};typeof er.realpath.native=="function"?Jn.realpath.native=ky(er.realpath.native):process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")});var My=y((RM,jy)=>{"use strict";var BC=require("path");jy.exports.checkPath=o(function(e){if(process.platform==="win32"&&/[<>:"|?*]/.test(e.replace(BC.parse(e).root,""))){let n=new Error(`Path contains invalid characters: ${e}`);throw n.code="EINVAL",n}},"checkPath")});var By=y((NM,am)=>{"use strict";var Ly=tr(),{checkPath:Vy}=My(),qy=o(r=>{let e={mode:511};return typeof r=="number"?r:{...e,...r}.mode},"getMode");am.exports.makeDir=async(r,e)=>(Vy(r),Ly.mkdir(r,{mode:qy(e),recursive:!0}));am.exports.makeDirSync=(r,e)=>(Vy(r),Ly.mkdirSync(r,{mode:qy(e),recursive:!0}))});var cn=y((jM,Uy)=>{"use strict";var UC=wt().fromPromise,{makeDir:$C,makeDirSync:om}=By(),cm=UC($C);Uy.exports={mkdirs:cm,mkdirsSync:om,mkdirp:cm,mkdirpSync:om,ensureDir:cm,ensureDirSync:om}});var Si=y((MM,Wy)=>{"use strict";var WC=wt().fromPromise,$y=tr();function GC(r){return $y.access(r).then(()=>!0).catch(()=>!1)}o(GC,"pathExists");Wy.exports={pathExists:WC(GC),pathExistsSync:$y.existsSync}});var um=y((VM,Gy)=>{"use strict";var Ys=tr(),HC=wt().fromPromise;async function zC(r,e,t){let n=await Ys.open(r,"r+"),i=null;try{await Ys.futimes(n,e,t)}finally{try{await Ys.close(n)}catch(s){i=s}}if(i)throw i}o(zC,"utimesMillis");function KC(r,e,t){let n=Ys.openSync(r,"r+");return Ys.futimesSync(n,e,t),Ys.closeSync(n)}o(KC,"utimesMillisSync");Gy.exports={utimesMillis:HC(zC),utimesMillisSync:KC}});var os=y((BM,Yy)=>{"use strict";var Qs=tr(),bt=require("path"),Hy=wt().fromPromise;function YC(r,e,t){let n=t.dereference?i=>Qs.stat(i,{bigint:!0}):i=>Qs.lstat(i,{bigint:!0});return Promise.all([n(r),n(e).catch(i=>{if(i.code==="ENOENT")return null;throw i})]).then(([i,s])=>({srcStat:i,destStat:s}))}o(YC,"getStats");function QC(r,e,t){let n,i=t.dereference?a=>Qs.statSync(a,{bigint:!0}):a=>Qs.lstatSync(a,{bigint:!0}),s=i(r);try{n=i(e)}catch(a){if(a.code==="ENOENT")return{srcStat:s,destStat:null};throw a}return{srcStat:s,destStat:n}}o(QC,"getStatsSync");async function JC(r,e,t,n){let{srcStat:i,destStat:s}=await YC(r,e,n);if(s){if(eo(i,s)){let a=bt.basename(r),c=bt.basename(e);if(t==="move"&&a!==c&&a.toLowerCase()===c.toLowerCase())return{srcStat:i,destStat:s,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(i.isDirectory()&&!s.isDirectory())throw new Error(`Cannot overwrite non-directory '${e}' with directory '${r}'.`);if(!i.isDirectory()&&s.isDirectory())throw new Error(`Cannot overwrite directory '${e}' with non-directory '${r}'.`)}if(i.isDirectory()&&lm(r,e))throw new Error(el(r,e,t));return{srcStat:i,destStat:s}}o(JC,"checkPaths");function XC(r,e,t,n){let{srcStat:i,destStat:s}=QC(r,e,n);if(s){if(eo(i,s)){let a=bt.basename(r),c=bt.basename(e);if(t==="move"&&a!==c&&a.toLowerCase()===c.toLowerCase())return{srcStat:i,destStat:s,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(i.isDirectory()&&!s.isDirectory())throw new Error(`Cannot overwrite non-directory '${e}' with directory '${r}'.`);if(!i.isDirectory()&&s.isDirectory())throw new Error(`Cannot overwrite directory '${e}' with non-directory '${r}'.`)}if(i.isDirectory()&&lm(r,e))throw new Error(el(r,e,t));return{srcStat:i,destStat:s}}o(XC,"checkPathsSync");async function zy(r,e,t,n){let i=bt.resolve(bt.dirname(r)),s=bt.resolve(bt.dirname(t));if(s===i||s===bt.parse(s).root)return;let a;try{a=await Qs.stat(s,{bigint:!0})}catch(c){if(c.code==="ENOENT")return;throw c}if(eo(e,a))throw new Error(el(r,t,n));return zy(r,e,s,n)}o(zy,"checkParentPaths");function Ky(r,e,t,n){let i=bt.resolve(bt.dirname(r)),s=bt.resolve(bt.dirname(t));if(s===i||s===bt.parse(s).root)return;let a;try{a=Qs.statSync(s,{bigint:!0})}catch(c){if(c.code==="ENOENT")return;throw c}if(eo(e,a))throw new Error(el(r,t,n));return Ky(r,e,s,n)}o(Ky,"checkParentPathsSync");function eo(r,e){return e.ino!==void 0&&e.dev!==void 0&&e.ino===r.ino&&e.dev===r.dev}o(eo,"areIdentical");function lm(r,e){let t=bt.resolve(r).split(bt.sep).filter(i=>i),n=bt.resolve(e).split(bt.sep).filter(i=>i);return t.every((i,s)=>n[s]===i)}o(lm,"isSrcSubdir");function el(r,e,t){return`Cannot ${t} '${r}' to a subdirectory of itself, '${e}'.`}o(el,"errMsg");Yy.exports={checkPaths:Hy(JC),checkPathsSync:XC,checkParentPaths:Hy(zy),checkParentPathsSync:Ky,isSrcSubdir:lm,areIdentical:eo}});var Jy=y(($M,Qy)=>{"use strict";async function ZC(r,e){let t=[];for await(let n of r)t.push(e(n).then(()=>null,i=>i??new Error("unknown error")));await Promise.all(t.map(n=>n.then(i=>{if(i!==null)throw i})))}o(ZC,"asyncIteratorConcurrentProcess");Qy.exports={asyncIteratorConcurrentProcess:ZC}});var r3=y((GM,t3)=>{"use strict";var Bt=tr(),to=require("path"),{mkdirs:e9}=cn(),{pathExists:t9}=Si(),{utimesMillis:r9}=um(),ro=os(),{asyncIteratorConcurrentProcess:n9}=Jy();async function i9(r,e,t={}){typeof t=="function"&&(t={filter:t}),t.clobber="clobber"in t?!!t.clobber:!0,t.overwrite="overwrite"in t?!!t.overwrite:t.clobber,t.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0001");let{srcStat:n,destStat:i}=await ro.checkPaths(r,e,"copy",t);if(await ro.checkParentPaths(r,n,e,"copy"),!await Zy(r,e,t))return;let a=to.dirname(e);await t9(a)||await e9(a),await e3(i,r,e,t)}o(i9,"copy");async function Zy(r,e,t){return t.filter?t.filter(r,e):!0}o(Zy,"runFilter");async function e3(r,e,t,n){let s=await(n.dereference?Bt.stat:Bt.lstat)(e);if(s.isDirectory())return c9(s,r,e,t,n);if(s.isFile()||s.isCharacterDevice()||s.isBlockDevice())return s9(s,r,e,t,n);if(s.isSymbolicLink())return u9(r,e,t,n);throw s.isSocket()?new Error(`Cannot copy a socket file: ${e}`):s.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${e}`):new Error(`Unknown file: ${e}`)}o(e3,"getStatsAndPerformCopy");async function s9(r,e,t,n,i){if(!e)return Xy(r,t,n,i);if(i.overwrite)return await Bt.unlink(n),Xy(r,t,n,i);if(i.errorOnExist)throw new Error(`'${n}' already exists`)}o(s9,"onFile");async function Xy(r,e,t,n){if(await Bt.copyFile(e,t),n.preserveTimestamps){a9(r.mode)&&await o9(t,r.mode);let i=await Bt.stat(e);await r9(t,i.atime,i.mtime)}return Bt.chmod(t,r.mode)}o(Xy,"copyFile");function a9(r){return(r&128)===0}o(a9,"fileIsNotWritable");function o9(r,e){return Bt.chmod(r,e|128)}o(o9,"makeFileWritable");async function c9(r,e,t,n,i){e||await Bt.mkdir(n),await n9(await Bt.opendir(t),async s=>{let a=to.join(t,s.name),c=to.join(n,s.name);if(await Zy(a,c,i)){let{destStat:f}=await ro.checkPaths(a,c,"copy",i);await e3(f,a,c,i)}}),e||await Bt.chmod(n,r.mode)}o(c9,"onDir");async function u9(r,e,t,n){let i=await Bt.readlink(e);if(n.dereference&&(i=to.resolve(process.cwd(),i)),!r)return Bt.symlink(i,t);let s=null;try{s=await Bt.readlink(t)}catch(a){if(a.code==="EINVAL"||a.code==="UNKNOWN")return Bt.symlink(i,t);throw a}if(n.dereference&&(s=to.resolve(process.cwd(),s)),ro.isSrcSubdir(i,s))throw new Error(`Cannot copy '${i}' to a subdirectory of itself, '${s}'.`);if(ro.isSrcSubdir(s,i))throw new Error(`Cannot overwrite '${s}' with '${i}'.`);return await Bt.unlink(t),Bt.symlink(i,t)}o(u9,"onLink");t3.exports=i9});var o3=y((zM,a3)=>{"use strict";var rr=Ks(),no=require("path"),l9=cn().mkdirsSync,f9=um().utimesMillisSync,io=os();function h9(r,e,t){typeof t=="function"&&(t={filter:t}),t=t||{},t.clobber="clobber"in t?!!t.clobber:!0,t.overwrite="overwrite"in t?!!t.overwrite:t.clobber,t.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0002");let{srcStat:n,destStat:i}=io.checkPathsSync(r,e,"copy",t);if(io.checkParentPathsSync(r,n,e,"copy"),t.filter&&!t.filter(r,e))return;let s=no.dirname(e);return rr.existsSync(s)||l9(s),n3(i,r,e,t)}o(h9,"copySync");function n3(r,e,t,n){let s=(n.dereference?rr.statSync:rr.lstatSync)(e);if(s.isDirectory())return v9(s,r,e,t,n);if(s.isFile()||s.isCharacterDevice()||s.isBlockDevice())return d9(s,r,e,t,n);if(s.isSymbolicLink())return b9(r,e,t,n);throw s.isSocket()?new Error(`Cannot copy a socket file: ${e}`):s.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${e}`):new Error(`Unknown file: ${e}`)}o(n3,"getStats");function d9(r,e,t,n,i){return e?p9(r,t,n,i):i3(r,t,n,i)}o(d9,"onFile");function p9(r,e,t,n){if(n.overwrite)return rr.unlinkSync(t),i3(r,e,t,n);if(n.errorOnExist)throw new Error(`'${t}' already exists`)}o(p9,"mayCopyFile");function i3(r,e,t,n){return rr.copyFileSync(e,t),n.preserveTimestamps&&m9(r.mode,e,t),fm(t,r.mode)}o(i3,"copyFile");function m9(r,e,t){return g9(r)&&y9(t,r),_9(e,t)}o(m9,"handleTimestamps");function g9(r){return(r&128)===0}o(g9,"fileIsNotWritable");function y9(r,e){return fm(r,e|128)}o(y9,"makeFileWritable");function fm(r,e){return rr.chmodSync(r,e)}o(fm,"setDestMode");function _9(r,e){let t=rr.statSync(r);return f9(e,t.atime,t.mtime)}o(_9,"setDestTimestamps");function v9(r,e,t,n,i){return e?s3(t,n,i):S9(r.mode,t,n,i)}o(v9,"onDir");function S9(r,e,t,n){return rr.mkdirSync(t),s3(e,t,n),fm(t,r)}o(S9,"mkDirAndCopy");function s3(r,e,t){let n=rr.opendirSync(r);try{let i;for(;(i=n.readSync())!==null;)w9(i.name,r,e,t)}finally{n.closeSync()}}o(s3,"copyDir");function w9(r,e,t,n){let i=no.join(e,r),s=no.join(t,r);if(n.filter&&!n.filter(i,s))return;let{destStat:a}=io.checkPathsSync(i,s,"copy",n);return n3(a,i,s,n)}o(w9,"copyDirItem");function b9(r,e,t,n){let i=rr.readlinkSync(e);if(n.dereference&&(i=no.resolve(process.cwd(),i)),r){let s;try{s=rr.readlinkSync(t)}catch(a){if(a.code==="EINVAL"||a.code==="UNKNOWN")return rr.symlinkSync(i,t);throw a}if(n.dereference&&(s=no.resolve(process.cwd(),s)),io.isSrcSubdir(i,s))throw new Error(`Cannot copy '${i}' to a subdirectory of itself, '${s}'.`);if(io.isSrcSubdir(s,i))throw new Error(`Cannot overwrite '${s}' with '${i}'.`);return E9(i,t)}else return rr.symlinkSync(i,t)}o(b9,"onLink");function E9(r,e){return rr.unlinkSync(e),rr.symlinkSync(r,e)}o(E9,"copyLink");a3.exports=h9});var tl=y((YM,c3)=>{"use strict";var T9=wt().fromPromise;c3.exports={copy:T9(r3()),copySync:o3()}});var so=y((QM,l3)=>{"use strict";var u3=Ks(),A9=wt().fromCallback;function x9(r,e){u3.rm(r,{recursive:!0,force:!0},e)}o(x9,"remove");function O9(r){u3.rmSync(r,{recursive:!0,force:!0})}o(O9,"removeSync");l3.exports={remove:A9(x9),removeSync:O9}});var _3=y((XM,y3)=>{"use strict";var C9=wt().fromPromise,d3=tr(),p3=require("path"),m3=cn(),g3=so(),f3=C9(o(async function(e){let t;try{t=await d3.readdir(e)}catch{return m3.mkdirs(e)}return Promise.all(t.map(n=>g3.remove(p3.join(e,n))))},"emptyDir"));function h3(r){let e;try{e=d3.readdirSync(r)}catch{return m3.mkdirsSync(r)}e.forEach(t=>{t=p3.join(r,t),g3.removeSync(t)})}o(h3,"emptyDirSync");y3.exports={emptyDirSync:h3,emptydirSync:h3,emptyDir:f3,emptydir:f3}});var b3=y((eL,w3)=>{"use strict";var P9=wt().fromPromise,v3=require("path"),Xn=tr(),S3=cn();async function F9(r){let e;try{e=await Xn.stat(r)}catch{}if(e&&e.isFile())return;let t=v3.dirname(r),n=null;try{n=await Xn.stat(t)}catch(i){if(i.code==="ENOENT"){await S3.mkdirs(t),await Xn.writeFile(r,"");return}else throw i}n.isDirectory()?await Xn.writeFile(r,""):await Xn.readdir(t)}o(F9,"createFile");function I9(r){let e;try{e=Xn.statSync(r)}catch{}if(e&&e.isFile())return;let t=v3.dirname(r);try{Xn.statSync(t).isDirectory()||Xn.readdirSync(t)}catch(n){if(n&&n.code==="ENOENT")S3.mkdirsSync(t);else throw n}Xn.writeFileSync(r,"")}o(I9,"createFileSync");w3.exports={createFile:P9(F9),createFileSync:I9}});var O3=y((rL,x3)=>{"use strict";var R9=wt().fromPromise,E3=require("path"),wi=tr(),T3=cn(),{pathExists:D9}=Si(),{areIdentical:A3}=os();async function N9(r,e){let t;try{t=await wi.lstat(e)}catch{}let n;try{n=await wi.lstat(r)}catch(a){throw a.message=a.message.replace("lstat","ensureLink"),a}if(t&&A3(n,t))return;let i=E3.dirname(e);await D9(i)||await T3.mkdirs(i),await wi.link(r,e)}o(N9,"createLink");function k9(r,e){let t;try{t=wi.lstatSync(e)}catch{}try{let s=wi.lstatSync(r);if(t&&A3(s,t))return}catch(s){throw s.message=s.message.replace("lstat","ensureLink"),s}let n=E3.dirname(e);return wi.existsSync(n)||T3.mkdirsSync(n),wi.linkSync(r,e)}o(k9,"createLinkSync");x3.exports={createLink:R9(N9),createLinkSync:k9}});var P3=y((iL,C3)=>{"use strict";var bi=require("path"),ao=tr(),{pathExists:j9}=Si(),M9=wt().fromPromise;async function L9(r,e){if(bi.isAbsolute(r)){try{await ao.lstat(r)}catch(s){throw s.message=s.message.replace("lstat","ensureSymlink"),s}return{toCwd:r,toDst:r}}let t=bi.dirname(e),n=bi.join(t,r);if(await j9(n))return{toCwd:n,toDst:r};try{await ao.lstat(r)}catch(s){throw s.message=s.message.replace("lstat","ensureSymlink"),s}return{toCwd:r,toDst:bi.relative(t,r)}}o(L9,"symlinkPaths");function V9(r,e){if(bi.isAbsolute(r)){if(!ao.existsSync(r))throw new Error("absolute srcpath does not exist");return{toCwd:r,toDst:r}}let t=bi.dirname(e),n=bi.join(t,r);if(ao.existsSync(n))return{toCwd:n,toDst:r};if(!ao.existsSync(r))throw new Error("relative srcpath does not exist");return{toCwd:r,toDst:bi.relative(t,r)}}o(V9,"symlinkPathsSync");C3.exports={symlinkPaths:M9(L9),symlinkPathsSync:V9}});var R3=y((aL,I3)=>{"use strict";var F3=tr(),q9=wt().fromPromise;async function B9(r,e){if(e)return e;let t;try{t=await F3.lstat(r)}catch{return"file"}return t&&t.isDirectory()?"dir":"file"}o(B9,"symlinkType");function U9(r,e){if(e)return e;let t;try{t=F3.lstatSync(r)}catch{return"file"}return t&&t.isDirectory()?"dir":"file"}o(U9,"symlinkTypeSync");I3.exports={symlinkType:q9(B9),symlinkTypeSync:U9}});var j3=y((cL,k3)=>{"use strict";var $9=wt().fromPromise,D3=require("path"),Pn=tr(),{mkdirs:W9,mkdirsSync:G9}=cn(),{symlinkPaths:H9,symlinkPathsSync:z9}=P3(),{symlinkType:K9,symlinkTypeSync:Y9}=R3(),{pathExists:Q9}=Si(),{areIdentical:N3}=os();async function J9(r,e,t){let n;try{n=await Pn.lstat(e)}catch{}if(n&&n.isSymbolicLink()){let[c,u]=await Promise.all([Pn.stat(r),Pn.stat(e)]);if(N3(c,u))return}let i=await H9(r,e);r=i.toDst;let s=await K9(i.toCwd,t),a=D3.dirname(e);return await Q9(a)||await W9(a),Pn.symlink(r,e,s)}o(J9,"createSymlink");function X9(r,e,t){let n;try{n=Pn.lstatSync(e)}catch{}if(n&&n.isSymbolicLink()){let c=Pn.statSync(r),u=Pn.statSync(e);if(N3(c,u))return}let i=z9(r,e);r=i.toDst,t=Y9(i.toCwd,t);let s=D3.dirname(e);return Pn.existsSync(s)||G9(s),Pn.symlinkSync(r,e,t)}o(X9,"createSymlinkSync");k3.exports={createSymlink:$9(J9),createSymlinkSync:X9}});var W3=y((lL,$3)=>{"use strict";var{createFile:M3,createFileSync:L3}=b3(),{createLink:V3,createLinkSync:q3}=O3(),{createSymlink:B3,createSymlinkSync:U3}=j3();$3.exports={createFile:M3,createFileSync:L3,ensureFile:M3,ensureFileSync:L3,createLink:V3,createLinkSync:q3,ensureLink:V3,ensureLinkSync:q3,createSymlink:B3,createSymlinkSync:U3,ensureSymlink:B3,ensureSymlinkSync:U3}});var rl=y((fL,G3)=>{function Z9(r,{EOL:e=`
`,finalEOL:t=!0,replacer:n=null,spaces:i}={}){let s=t?e:"";return JSON.stringify(r,n,i).replace(/\n/g,e)+s}o(Z9,"stringify");function e7(r){return Buffer.isBuffer(r)&&(r=r.toString("utf8")),r.replace(/^\uFEFF/,"")}o(e7,"stripBom");G3.exports={stringify:Z9,stripBom:e7}});var Y3=y((dL,K3)=>{var Js;try{Js=Ks()}catch{Js=require("fs")}var nl=wt(),{stringify:H3,stripBom:z3}=rl();async function t7(r,e={}){typeof e=="string"&&(e={encoding:e});let t=e.fs||Js,n="throws"in e?e.throws:!0,i=await nl.fromCallback(t.readFile)(r,e);i=z3(i);let s;try{s=JSON.parse(i,e?e.reviver:null)}catch(a){if(n)throw a.message=`${r}: ${a.message}`,a;return null}return s}o(t7,"_readFile");var r7=nl.fromPromise(t7);function n7(r,e={}){typeof e=="string"&&(e={encoding:e});let t=e.fs||Js,n="throws"in e?e.throws:!0;try{let i=t.readFileSync(r,e);return i=z3(i),JSON.parse(i,e.reviver)}catch(i){if(n)throw i.message=`${r}: ${i.message}`,i;return null}}o(n7,"readFileSync");async function i7(r,e,t={}){let n=t.fs||Js,i=H3(e,t);await nl.fromCallback(n.writeFile)(r,i,t)}o(i7,"_writeFile");var s7=nl.fromPromise(i7);function a7(r,e,t={}){let n=t.fs||Js,i=H3(e,t);return n.writeFileSync(r,i,t)}o(a7,"writeFileSync");K3.exports={readFile:r7,readFileSync:n7,writeFile:s7,writeFileSync:a7}});var J3=y((mL,Q3)=>{"use strict";var il=Y3();Q3.exports={readJson:il.readFile,readJsonSync:il.readFileSync,writeJson:il.writeFile,writeJsonSync:il.writeFileSync}});var sl=y((gL,e_)=>{"use strict";var o7=wt().fromPromise,hm=tr(),X3=require("path"),Z3=cn(),c7=Si().pathExists;async function u7(r,e,t="utf-8"){let n=X3.dirname(r);return await c7(n)||await Z3.mkdirs(n),hm.writeFile(r,e,t)}o(u7,"outputFile");function l7(r,...e){let t=X3.dirname(r);hm.existsSync(t)||Z3.mkdirsSync(t),hm.writeFileSync(r,...e)}o(l7,"outputFileSync");e_.exports={outputFile:o7(u7),outputFileSync:l7}});var r_=y((_L,t_)=>{"use strict";var{stringify:f7}=rl(),{outputFile:h7}=sl();async function d7(r,e,t={}){let n=f7(e,t);await h7(r,n,t)}o(d7,"outputJson");t_.exports=d7});var i_=y((SL,n_)=>{"use strict";var{stringify:p7}=rl(),{outputFileSync:m7}=sl();function g7(r,e,t){let n=p7(e,t);m7(r,n,t)}o(g7,"outputJsonSync");n_.exports=g7});var a_=y((bL,s_)=>{"use strict";var y7=wt().fromPromise,nr=J3();nr.outputJson=y7(r_());nr.outputJsonSync=i_();nr.outputJSON=nr.outputJson;nr.outputJSONSync=nr.outputJsonSync;nr.writeJSON=nr.writeJson;nr.writeJSONSync=nr.writeJsonSync;nr.readJSON=nr.readJson;nr.readJSONSync=nr.readJsonSync;s_.exports=nr});var f_=y((EL,l_)=>{"use strict";var _7=tr(),o_=require("path"),{copy:v7}=tl(),{remove:u_}=so(),{mkdirp:S7}=cn(),{pathExists:w7}=Si(),c_=os();async function b7(r,e,t={}){let n=t.overwrite||t.clobber||!1,{srcStat:i,isChangingCase:s=!1}=await c_.checkPaths(r,e,"move",t);await c_.checkParentPaths(r,i,e,"move");let a=o_.dirname(e);return o_.parse(a).root!==a&&await S7(a),E7(r,e,n,s)}o(b7,"move");async function E7(r,e,t,n){if(!n){if(t)await u_(e);else if(await w7(e))throw new Error("dest already exists.")}try{await _7.rename(r,e)}catch(i){if(i.code!=="EXDEV")throw i;await T7(r,e,t)}}o(E7,"doRename");async function T7(r,e,t){return await v7(r,e,{overwrite:t,errorOnExist:!0,preserveTimestamps:!0}),u_(r)}o(T7,"moveAcrossDevice");l_.exports=b7});var g_=y((AL,m_)=>{"use strict";var d_=Ks(),pm=require("path"),A7=tl().copySync,p_=so().removeSync,x7=cn().mkdirpSync,h_=os();function O7(r,e,t){t=t||{};let n=t.overwrite||t.clobber||!1,{srcStat:i,isChangingCase:s=!1}=h_.checkPathsSync(r,e,"move",t);return h_.checkParentPathsSync(r,i,e,"move"),C7(e)||x7(pm.dirname(e)),P7(r,e,n,s)}o(O7,"moveSync");function C7(r){let e=pm.dirname(r);return pm.parse(e).root===e}o(C7,"isParentRoot");function P7(r,e,t,n){if(n)return dm(r,e,t);if(t)return p_(e),dm(r,e,t);if(d_.existsSync(e))throw new Error("dest already exists.");return dm(r,e,t)}o(P7,"doRename");function dm(r,e,t){try{d_.renameSync(r,e)}catch(n){if(n.code!=="EXDEV")throw n;return F7(r,e,t)}}o(dm,"rename");function F7(r,e,t){return A7(r,e,{overwrite:t,errorOnExist:!0,preserveTimestamps:!0}),p_(r)}o(F7,"moveAcrossDevice");m_.exports=O7});var __=y((OL,y_)=>{"use strict";var I7=wt().fromPromise;y_.exports={move:I7(f_()),moveSync:g_()}});var Xs=y((CL,v_)=>{"use strict";v_.exports={...tr(),...tl(),..._3(),...W3(),...a_(),...cn(),...__(),...sl(),...Si(),...so()}});var Cv=y((aq,Ov)=>{"use strict";Ov.exports=Av;function Av(r,e,t){r instanceof RegExp&&(r=Tv(r,t)),e instanceof RegExp&&(e=Tv(e,t));var n=xv(r,e,t);return n&&{start:n[0],end:n[1],pre:t.slice(0,n[0]),body:t.slice(n[0]+r.length,n[1]),post:t.slice(n[1]+e.length)}}o(Av,"balanced");function Tv(r,e){var t=e.match(r);return t?t[0]:null}o(Tv,"maybeMatch");Av.range=xv;function xv(r,e,t){var n,i,s,a,c,u=t.indexOf(r),f=t.indexOf(e,u+1),l=u;if(u>=0&&f>0){if(r===e)return[u,f];for(n=[],s=t.length;l>=0&&!c;)l==u?(n.push(l),u=t.indexOf(r,l+1)):n.length==1?c=[n.pop(),f]:(i=n.pop(),i<s&&(s=i,a=f),f=t.indexOf(e,l+1)),l=u<f&&u>=0?u:f;n.length&&(c=[s,a])}return c}o(xv,"range")});var jv=y((cq,kv)=>{var Pv=Cv();kv.exports=nF;var Fv="\0SLASH"+Math.random()+"\0",Iv="\0OPEN"+Math.random()+"\0",Im="\0CLOSE"+Math.random()+"\0",Rv="\0COMMA"+Math.random()+"\0",Dv="\0PERIOD"+Math.random()+"\0";function Fm(r){return parseInt(r,10)==r?parseInt(r,10):r.charCodeAt(0)}o(Fm,"numeric");function tF(r){return r.split("\\\\").join(Fv).split("\\{").join(Iv).split("\\}").join(Im).split("\\,").join(Rv).split("\\.").join(Dv)}o(tF,"escapeBraces");function rF(r){return r.split(Fv).join("\\").split(Iv).join("{").split(Im).join("}").split(Rv).join(",").split(Dv).join(".")}o(rF,"unescapeBraces");function Nv(r){if(!r)return[""];var e=[],t=Pv("{","}",r);if(!t)return r.split(",");var n=t.pre,i=t.body,s=t.post,a=n.split(",");a[a.length-1]+="{"+i+"}";var c=Nv(s);return s.length&&(a[a.length-1]+=c.shift(),a.push.apply(a,c)),e.push.apply(e,a),e}o(Nv,"parseCommaParts");function nF(r){return r?(r.substr(0,2)==="{}"&&(r="\\{\\}"+r.substr(2)),yo(tF(r),!0).map(rF)):[]}o(nF,"expandTop");function iF(r){return"{"+r+"}"}o(iF,"embrace");function sF(r){return/^-?0\d/.test(r)}o(sF,"isPadded");function aF(r,e){return r<=e}o(aF,"lte");function oF(r,e){return r>=e}o(oF,"gte");function yo(r,e){var t=[],n=Pv("{","}",r);if(!n)return[r];var i=n.pre,s=n.post.length?yo(n.post,!1):[""];if(/\$$/.test(n.pre))for(var a=0;a<s.length;a++){var c=i+"{"+n.body+"}"+s[a];t.push(c)}else{var u=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(n.body),f=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(n.body),l=u||f,h=n.body.indexOf(",")>=0;if(!l&&!h)return n.post.match(/,(?!,).*\}/)?(r=n.pre+"{"+n.body+Im+n.post,yo(r)):[r];var p;if(l)p=n.body.split(/\.\./);else if(p=Nv(n.body),p.length===1&&(p=yo(p[0],!1).map(iF),p.length===1))return s.map(function(ce){return n.pre+p[0]+ce});var g;if(l){var w=Fm(p[0]),S=Fm(p[1]),x=Math.max(p[0].length,p[1].length),P=p.length==3?Math.abs(Fm(p[2])):1,F=aF,L=S<w;L&&(P*=-1,F=oF);var $=p.some(sF);g=[];for(var K=w;F(K,S);K+=P){var Fe;if(f)Fe=String.fromCharCode(K),Fe==="\\"&&(Fe="");else if(Fe=String(K),$){var Xe=x-Fe.length;if(Xe>0){var at=new Array(Xe+1).join("0");K<0?Fe="-"+at+Fe.slice(1):Fe=at+Fe}}g.push(Fe)}}else{g=[];for(var B=0;B<p.length;B++)g.push.apply(g,yo(p[B],!1))}for(var B=0;B<g.length;B++)for(var a=0;a<s.length;a++){var c=i+g[B]+s[a];(!e||l||c)&&t.push(c)}}return t}o(yo,"expand")});var s$=Qe(uf());var o0=Qe(a0(),1),{program:q8,createCommand:B8,createArgument:U8,createOption:$8,CommanderError:W8,InvalidArgumentError:G8,InvalidOptionArgumentError:H8,Command:Sn,Argument:z8,Option:K8,Help:Y8}=o0.default;var go=require("fs"),Pm=require("path"),ar=Qe(_i());var _t=Qe(Xs()),$t=Qe(require("path"));function k_(r){return typeof r>"u"||r===null}o(k_,"isNothing");function R7(r){return typeof r=="object"&&r!==null}o(R7,"isObject");function D7(r){return Array.isArray(r)?r:k_(r)?[]:[r]}o(D7,"toArray");function N7(r,e){var t,n,i,s;if(e)for(s=Object.keys(e),t=0,n=s.length;t<n;t+=1)i=s[t],r[i]=e[i];return r}o(N7,"extend");function k7(r,e){var t="",n;for(n=0;n<e;n+=1)t+=r;return t}o(k7,"repeat");function j7(r){return r===0&&Number.NEGATIVE_INFINITY===1/r}o(j7,"isNegativeZero");var M7=k_,L7=R7,V7=D7,q7=k7,B7=j7,U7=N7,yt={isNothing:M7,isObject:L7,toArray:V7,repeat:q7,isNegativeZero:B7,extend:U7};function j_(r,e){var t="",n=r.reason||"(unknown reason)";return r.mark?(r.mark.name&&(t+='in "'+r.mark.name+'" '),t+="("+(r.mark.line+1)+":"+(r.mark.column+1)+")",!e&&r.mark.snippet&&(t+=`

`+r.mark.snippet),n+" "+t):n}o(j_,"formatError");function co(r,e){Error.call(this),this.name="YAMLException",this.reason=r,this.mark=e,this.message=j_(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}o(co,"YAMLException$1");co.prototype=Object.create(Error.prototype);co.prototype.constructor=co;co.prototype.toString=o(function(e){return this.name+": "+j_(this,e)},"toString");var ir=co;function mm(r,e,t,n,i){var s="",a="",c=Math.floor(i/2)-1;return n-e>c&&(s=" ... ",e=n-c+s.length),t-n>c&&(a=" ...",t=n+c-a.length),{str:s+r.slice(e,t).replace(/\t/g,"\u2192")+a,pos:n-e+s.length}}o(mm,"getLine");function gm(r,e){return yt.repeat(" ",e-r.length)+r}o(gm,"padStart");function $7(r,e){if(e=Object.create(e||null),!r.buffer)return null;e.maxLength||(e.maxLength=79),typeof e.indent!="number"&&(e.indent=1),typeof e.linesBefore!="number"&&(e.linesBefore=3),typeof e.linesAfter!="number"&&(e.linesAfter=2);for(var t=/\r?\n|\r|\0/g,n=[0],i=[],s,a=-1;s=t.exec(r.buffer);)i.push(s.index),n.push(s.index+s[0].length),r.position<=s.index&&a<0&&(a=n.length-2);a<0&&(a=n.length-1);var c="",u,f,l=Math.min(r.line+e.linesAfter,i.length).toString().length,h=e.maxLength-(e.indent+l+3);for(u=1;u<=e.linesBefore&&!(a-u<0);u++)f=mm(r.buffer,n[a-u],i[a-u],r.position-(n[a]-n[a-u]),h),c=yt.repeat(" ",e.indent)+gm((r.line-u+1).toString(),l)+" | "+f.str+`
`+c;for(f=mm(r.buffer,n[a],i[a],r.position,h),c+=yt.repeat(" ",e.indent)+gm((r.line+1).toString(),l)+" | "+f.str+`
`,c+=yt.repeat("-",e.indent+l+3+f.pos)+`^
`,u=1;u<=e.linesAfter&&!(a+u>=i.length);u++)f=mm(r.buffer,n[a+u],i[a+u],r.position-(n[a]-n[a+u]),h),c+=yt.repeat(" ",e.indent)+gm((r.line+u+1).toString(),l)+" | "+f.str+`
`;return c.replace(/\n$/,"")}o($7,"makeSnippet");var W7=$7,G7=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],H7=["scalar","sequence","mapping"];function z7(r){var e={};return r!==null&&Object.keys(r).forEach(function(t){r[t].forEach(function(n){e[String(n)]=t})}),e}o(z7,"compileStyleAliases");function K7(r,e){if(e=e||{},Object.keys(e).forEach(function(t){if(G7.indexOf(t)===-1)throw new ir('Unknown option "'+t+'" is met in definition of "'+r+'" YAML type.')}),this.options=e,this.tag=r,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(t){return t},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.representName=e.representName||null,this.defaultStyle=e.defaultStyle||null,this.multi=e.multi||!1,this.styleAliases=z7(e.styleAliases||null),H7.indexOf(this.kind)===-1)throw new ir('Unknown kind "'+this.kind+'" is specified for "'+r+'" YAML type.')}o(K7,"Type$1");var Nt=K7;function S_(r,e){var t=[];return r[e].forEach(function(n){var i=t.length;t.forEach(function(s,a){s.tag===n.tag&&s.kind===n.kind&&s.multi===n.multi&&(i=a)}),t[i]=n}),t}o(S_,"compileList");function Y7(){var r={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},e,t;function n(i){i.multi?(r.multi[i.kind].push(i),r.multi.fallback.push(i)):r[i.kind][i.tag]=r.fallback[i.tag]=i}for(o(n,"collectType"),e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(n);return r}o(Y7,"compileMap");function _m(r){return this.extend(r)}o(_m,"Schema$1");_m.prototype.extend=o(function(e){var t=[],n=[];if(e instanceof Nt)n.push(e);else if(Array.isArray(e))n=n.concat(e);else if(e&&(Array.isArray(e.implicit)||Array.isArray(e.explicit)))e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(n=n.concat(e.explicit));else throw new ir("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");t.forEach(function(s){if(!(s instanceof Nt))throw new ir("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&s.loadKind!=="scalar")throw new ir("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new ir("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(s){if(!(s instanceof Nt))throw new ir("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var i=Object.create(_m.prototype);return i.implicit=(this.implicit||[]).concat(t),i.explicit=(this.explicit||[]).concat(n),i.compiledImplicit=S_(i,"implicit"),i.compiledExplicit=S_(i,"explicit"),i.compiledTypeMap=Y7(i.compiledImplicit,i.compiledExplicit),i},"extend");var M_=_m,L_=new Nt("tag:yaml.org,2002:str",{kind:"scalar",construct:o(function(r){return r!==null?r:""},"construct")}),V_=new Nt("tag:yaml.org,2002:seq",{kind:"sequence",construct:o(function(r){return r!==null?r:[]},"construct")}),q_=new Nt("tag:yaml.org,2002:map",{kind:"mapping",construct:o(function(r){return r!==null?r:{}},"construct")}),B_=new M_({explicit:[L_,V_,q_]});function Q7(r){if(r===null)return!0;var e=r.length;return e===1&&r==="~"||e===4&&(r==="null"||r==="Null"||r==="NULL")}o(Q7,"resolveYamlNull");function J7(){return null}o(J7,"constructYamlNull");function X7(r){return r===null}o(X7,"isNull");var U_=new Nt("tag:yaml.org,2002:null",{kind:"scalar",resolve:Q7,construct:J7,predicate:X7,represent:{canonical:o(function(){return"~"},"canonical"),lowercase:o(function(){return"null"},"lowercase"),uppercase:o(function(){return"NULL"},"uppercase"),camelcase:o(function(){return"Null"},"camelcase"),empty:o(function(){return""},"empty")},defaultStyle:"lowercase"});function Z7(r){if(r===null)return!1;var e=r.length;return e===4&&(r==="true"||r==="True"||r==="TRUE")||e===5&&(r==="false"||r==="False"||r==="FALSE")}o(Z7,"resolveYamlBoolean");function e6(r){return r==="true"||r==="True"||r==="TRUE"}o(e6,"constructYamlBoolean");function t6(r){return Object.prototype.toString.call(r)==="[object Boolean]"}o(t6,"isBoolean");var $_=new Nt("tag:yaml.org,2002:bool",{kind:"scalar",resolve:Z7,construct:e6,predicate:t6,represent:{lowercase:o(function(r){return r?"true":"false"},"lowercase"),uppercase:o(function(r){return r?"TRUE":"FALSE"},"uppercase"),camelcase:o(function(r){return r?"True":"False"},"camelcase")},defaultStyle:"lowercase"});function r6(r){return 48<=r&&r<=57||65<=r&&r<=70||97<=r&&r<=102}o(r6,"isHexCode");function n6(r){return 48<=r&&r<=55}o(n6,"isOctCode");function i6(r){return 48<=r&&r<=57}o(i6,"isDecCode");function s6(r){if(r===null)return!1;var e=r.length,t=0,n=!1,i;if(!e)return!1;if(i=r[t],(i==="-"||i==="+")&&(i=r[++t]),i==="0"){if(t+1===e)return!0;if(i=r[++t],i==="b"){for(t++;t<e;t++)if(i=r[t],i!=="_"){if(i!=="0"&&i!=="1")return!1;n=!0}return n&&i!=="_"}if(i==="x"){for(t++;t<e;t++)if(i=r[t],i!=="_"){if(!r6(r.charCodeAt(t)))return!1;n=!0}return n&&i!=="_"}if(i==="o"){for(t++;t<e;t++)if(i=r[t],i!=="_"){if(!n6(r.charCodeAt(t)))return!1;n=!0}return n&&i!=="_"}}if(i==="_")return!1;for(;t<e;t++)if(i=r[t],i!=="_"){if(!i6(r.charCodeAt(t)))return!1;n=!0}return!(!n||i==="_")}o(s6,"resolveYamlInteger");function a6(r){var e=r,t=1,n;if(e.indexOf("_")!==-1&&(e=e.replace(/_/g,"")),n=e[0],(n==="-"||n==="+")&&(n==="-"&&(t=-1),e=e.slice(1),n=e[0]),e==="0")return 0;if(n==="0"){if(e[1]==="b")return t*parseInt(e.slice(2),2);if(e[1]==="x")return t*parseInt(e.slice(2),16);if(e[1]==="o")return t*parseInt(e.slice(2),8)}return t*parseInt(e,10)}o(a6,"constructYamlInteger");function o6(r){return Object.prototype.toString.call(r)==="[object Number]"&&r%1===0&&!yt.isNegativeZero(r)}o(o6,"isInteger");var W_=new Nt("tag:yaml.org,2002:int",{kind:"scalar",resolve:s6,construct:a6,predicate:o6,represent:{binary:o(function(r){return r>=0?"0b"+r.toString(2):"-0b"+r.toString(2).slice(1)},"binary"),octal:o(function(r){return r>=0?"0o"+r.toString(8):"-0o"+r.toString(8).slice(1)},"octal"),decimal:o(function(r){return r.toString(10)},"decimal"),hexadecimal:o(function(r){return r>=0?"0x"+r.toString(16).toUpperCase():"-0x"+r.toString(16).toUpperCase().slice(1)},"hexadecimal")},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),c6=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function u6(r){return!(r===null||!c6.test(r)||r[r.length-1]==="_")}o(u6,"resolveYamlFloat");function l6(r){var e,t;return e=r.replace(/_/g,"").toLowerCase(),t=e[0]==="-"?-1:1,"+-".indexOf(e[0])>=0&&(e=e.slice(1)),e===".inf"?t===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:e===".nan"?NaN:t*parseFloat(e,10)}o(l6,"constructYamlFloat");var f6=/^[-+]?[0-9]+e/;function h6(r,e){var t;if(isNaN(r))switch(e){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===r)switch(e){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===r)switch(e){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(yt.isNegativeZero(r))return"-0.0";return t=r.toString(10),f6.test(t)?t.replace("e",".e"):t}o(h6,"representYamlFloat");function d6(r){return Object.prototype.toString.call(r)==="[object Number]"&&(r%1!==0||yt.isNegativeZero(r))}o(d6,"isFloat");var G_=new Nt("tag:yaml.org,2002:float",{kind:"scalar",resolve:u6,construct:l6,predicate:d6,represent:h6,defaultStyle:"lowercase"}),H_=B_.extend({implicit:[U_,$_,W_,G_]}),z_=H_,K_=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),Y_=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function p6(r){return r===null?!1:K_.exec(r)!==null||Y_.exec(r)!==null}o(p6,"resolveYamlTimestamp");function m6(r){var e,t,n,i,s,a,c,u=0,f=null,l,h,p;if(e=K_.exec(r),e===null&&(e=Y_.exec(r)),e===null)throw new Error("Date resolve error");if(t=+e[1],n=+e[2]-1,i=+e[3],!e[4])return new Date(Date.UTC(t,n,i));if(s=+e[4],a=+e[5],c=+e[6],e[7]){for(u=e[7].slice(0,3);u.length<3;)u+="0";u=+u}return e[9]&&(l=+e[10],h=+(e[11]||0),f=(l*60+h)*6e4,e[9]==="-"&&(f=-f)),p=new Date(Date.UTC(t,n,i,s,a,c,u)),f&&p.setTime(p.getTime()-f),p}o(m6,"constructYamlTimestamp");function g6(r){return r.toISOString()}o(g6,"representYamlTimestamp");var Q_=new Nt("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:p6,construct:m6,instanceOf:Date,represent:g6});function y6(r){return r==="<<"||r===null}o(y6,"resolveYamlMerge");var J_=new Nt("tag:yaml.org,2002:merge",{kind:"scalar",resolve:y6}),Em=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function _6(r){if(r===null)return!1;var e,t,n=0,i=r.length,s=Em;for(t=0;t<i;t++)if(e=s.indexOf(r.charAt(t)),!(e>64)){if(e<0)return!1;n+=6}return n%8===0}o(_6,"resolveYamlBinary");function v6(r){var e,t,n=r.replace(/[\r\n=]/g,""),i=n.length,s=Em,a=0,c=[];for(e=0;e<i;e++)e%4===0&&e&&(c.push(a>>16&255),c.push(a>>8&255),c.push(a&255)),a=a<<6|s.indexOf(n.charAt(e));return t=i%4*6,t===0?(c.push(a>>16&255),c.push(a>>8&255),c.push(a&255)):t===18?(c.push(a>>10&255),c.push(a>>2&255)):t===12&&c.push(a>>4&255),new Uint8Array(c)}o(v6,"constructYamlBinary");function S6(r){var e="",t=0,n,i,s=r.length,a=Em;for(n=0;n<s;n++)n%3===0&&n&&(e+=a[t>>18&63],e+=a[t>>12&63],e+=a[t>>6&63],e+=a[t&63]),t=(t<<8)+r[n];return i=s%3,i===0?(e+=a[t>>18&63],e+=a[t>>12&63],e+=a[t>>6&63],e+=a[t&63]):i===2?(e+=a[t>>10&63],e+=a[t>>4&63],e+=a[t<<2&63],e+=a[64]):i===1&&(e+=a[t>>2&63],e+=a[t<<4&63],e+=a[64],e+=a[64]),e}o(S6,"representYamlBinary");function w6(r){return Object.prototype.toString.call(r)==="[object Uint8Array]"}o(w6,"isBinary");var X_=new Nt("tag:yaml.org,2002:binary",{kind:"scalar",resolve:_6,construct:v6,predicate:w6,represent:S6}),b6=Object.prototype.hasOwnProperty,E6=Object.prototype.toString;function T6(r){if(r===null)return!0;var e=[],t,n,i,s,a,c=r;for(t=0,n=c.length;t<n;t+=1){if(i=c[t],a=!1,E6.call(i)!=="[object Object]")return!1;for(s in i)if(b6.call(i,s))if(!a)a=!0;else return!1;if(!a)return!1;if(e.indexOf(s)===-1)e.push(s);else return!1}return!0}o(T6,"resolveYamlOmap");function A6(r){return r!==null?r:[]}o(A6,"constructYamlOmap");var Z_=new Nt("tag:yaml.org,2002:omap",{kind:"sequence",resolve:T6,construct:A6}),x6=Object.prototype.toString;function O6(r){if(r===null)return!0;var e,t,n,i,s,a=r;for(s=new Array(a.length),e=0,t=a.length;e<t;e+=1){if(n=a[e],x6.call(n)!=="[object Object]"||(i=Object.keys(n),i.length!==1))return!1;s[e]=[i[0],n[i[0]]]}return!0}o(O6,"resolveYamlPairs");function C6(r){if(r===null)return[];var e,t,n,i,s,a=r;for(s=new Array(a.length),e=0,t=a.length;e<t;e+=1)n=a[e],i=Object.keys(n),s[e]=[i[0],n[i[0]]];return s}o(C6,"constructYamlPairs");var ev=new Nt("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:O6,construct:C6}),P6=Object.prototype.hasOwnProperty;function F6(r){if(r===null)return!0;var e,t=r;for(e in t)if(P6.call(t,e)&&t[e]!==null)return!1;return!0}o(F6,"resolveYamlSet");function I6(r){return r!==null?r:{}}o(I6,"constructYamlSet");var tv=new Nt("tag:yaml.org,2002:set",{kind:"mapping",resolve:F6,construct:I6}),Tm=z_.extend({implicit:[Q_,J_],explicit:[X_,Z_,ev,tv]}),Ti=Object.prototype.hasOwnProperty,al=1,rv=2,nv=3,ol=4,ym=1,R6=2,w_=3,D6=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,N6=/[\x85\u2028\u2029]/,k6=/[,\[\]\{\}]/,iv=/^(?:!|!!|![a-z\-]+!)$/i,sv=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function b_(r){return Object.prototype.toString.call(r)}o(b_,"_class");function Fn(r){return r===10||r===13}o(Fn,"is_EOL");function us(r){return r===9||r===32}o(us,"is_WHITE_SPACE");function gr(r){return r===9||r===32||r===10||r===13}o(gr,"is_WS_OR_EOL");function ea(r){return r===44||r===91||r===93||r===123||r===125}o(ea,"is_FLOW_INDICATOR");function j6(r){var e;return 48<=r&&r<=57?r-48:(e=r|32,97<=e&&e<=102?e-97+10:-1)}o(j6,"fromHexCode");function M6(r){return r===120?2:r===117?4:r===85?8:0}o(M6,"escapedHexLen");function L6(r){return 48<=r&&r<=57?r-48:-1}o(L6,"fromDecimalCode");function E_(r){return r===48?"\0":r===97?"\x07":r===98?"\b":r===116||r===9?"	":r===110?`
`:r===118?"\v":r===102?"\f":r===114?"\r":r===101?"\x1B":r===32?" ":r===34?'"':r===47?"/":r===92?"\\":r===78?"\x85":r===95?"\xA0":r===76?"\u2028":r===80?"\u2029":""}o(E_,"simpleEscapeSequence");function V6(r){return r<=65535?String.fromCharCode(r):String.fromCharCode((r-65536>>10)+55296,(r-65536&1023)+56320)}o(V6,"charFromCodepoint");var av=new Array(256),ov=new Array(256);for(cs=0;cs<256;cs++)av[cs]=E_(cs)?1:0,ov[cs]=E_(cs);var cs;function q6(r,e){this.input=r,this.filename=e.filename||null,this.schema=e.schema||Tm,this.onWarning=e.onWarning||null,this.legacy=e.legacy||!1,this.json=e.json||!1,this.listener=e.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=r.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}o(q6,"State$1");function cv(r,e){var t={name:r.filename,buffer:r.input.slice(0,-1),position:r.position,line:r.line,column:r.position-r.lineStart};return t.snippet=W7(t),new ir(e,t)}o(cv,"generateError");function z(r,e){throw cv(r,e)}o(z,"throwError");function cl(r,e){r.onWarning&&r.onWarning.call(null,cv(r,e))}o(cl,"throwWarning");var T_={YAML:o(function(e,t,n){var i,s,a;e.version!==null&&z(e,"duplication of %YAML directive"),n.length!==1&&z(e,"YAML directive accepts exactly one argument"),i=/^([0-9]+)\.([0-9]+)$/.exec(n[0]),i===null&&z(e,"ill-formed argument of the YAML directive"),s=parseInt(i[1],10),a=parseInt(i[2],10),s!==1&&z(e,"unacceptable YAML version of the document"),e.version=n[0],e.checkLineBreaks=a<2,a!==1&&a!==2&&cl(e,"unsupported YAML version of the document")},"handleYamlDirective"),TAG:o(function(e,t,n){var i,s;n.length!==2&&z(e,"TAG directive accepts exactly two arguments"),i=n[0],s=n[1],iv.test(i)||z(e,"ill-formed tag handle (first argument) of the TAG directive"),Ti.call(e.tagMap,i)&&z(e,'there is a previously declared suffix for "'+i+'" tag handle'),sv.test(s)||z(e,"ill-formed tag prefix (second argument) of the TAG directive");try{s=decodeURIComponent(s)}catch{z(e,"tag prefix is malformed: "+s)}e.tagMap[i]=s},"handleTagDirective")};function Ei(r,e,t,n){var i,s,a,c;if(e<t){if(c=r.input.slice(e,t),n)for(i=0,s=c.length;i<s;i+=1)a=c.charCodeAt(i),a===9||32<=a&&a<=1114111||z(r,"expected valid JSON character");else D6.test(c)&&z(r,"the stream contains non-printable characters");r.result+=c}}o(Ei,"captureSegment");function A_(r,e,t,n){var i,s,a,c;for(yt.isObject(t)||z(r,"cannot merge mappings; the provided source object is unacceptable"),i=Object.keys(t),a=0,c=i.length;a<c;a+=1)s=i[a],Ti.call(e,s)||(e[s]=t[s],n[s]=!0)}o(A_,"mergeMappings");function ta(r,e,t,n,i,s,a,c,u){var f,l;if(Array.isArray(i))for(i=Array.prototype.slice.call(i),f=0,l=i.length;f<l;f+=1)Array.isArray(i[f])&&z(r,"nested arrays are not supported inside keys"),typeof i=="object"&&b_(i[f])==="[object Object]"&&(i[f]="[object Object]");if(typeof i=="object"&&b_(i)==="[object Object]"&&(i="[object Object]"),i=String(i),e===null&&(e={}),n==="tag:yaml.org,2002:merge")if(Array.isArray(s))for(f=0,l=s.length;f<l;f+=1)A_(r,e,s[f],t);else A_(r,e,s,t);else!r.json&&!Ti.call(t,i)&&Ti.call(e,i)&&(r.line=a||r.line,r.lineStart=c||r.lineStart,r.position=u||r.position,z(r,"duplicated mapping key")),i==="__proto__"?Object.defineProperty(e,i,{configurable:!0,enumerable:!0,writable:!0,value:s}):e[i]=s,delete t[i];return e}o(ta,"storeMappingPair");function Am(r){var e;e=r.input.charCodeAt(r.position),e===10?r.position++:e===13?(r.position++,r.input.charCodeAt(r.position)===10&&r.position++):z(r,"a line break is expected"),r.line+=1,r.lineStart=r.position,r.firstTabInLine=-1}o(Am,"readLineBreak");function mt(r,e,t){for(var n=0,i=r.input.charCodeAt(r.position);i!==0;){for(;us(i);)i===9&&r.firstTabInLine===-1&&(r.firstTabInLine=r.position),i=r.input.charCodeAt(++r.position);if(e&&i===35)do i=r.input.charCodeAt(++r.position);while(i!==10&&i!==13&&i!==0);if(Fn(i))for(Am(r),i=r.input.charCodeAt(r.position),n++,r.lineIndent=0;i===32;)r.lineIndent++,i=r.input.charCodeAt(++r.position);else break}return t!==-1&&n!==0&&r.lineIndent<t&&cl(r,"deficient indentation"),n}o(mt,"skipSeparationSpace");function fl(r){var e=r.position,t;return t=r.input.charCodeAt(e),!!((t===45||t===46)&&t===r.input.charCodeAt(e+1)&&t===r.input.charCodeAt(e+2)&&(e+=3,t=r.input.charCodeAt(e),t===0||gr(t)))}o(fl,"testDocumentSeparator");function xm(r,e){e===1?r.result+=" ":e>1&&(r.result+=yt.repeat(`
`,e-1))}o(xm,"writeFoldedLines");function B6(r,e,t){var n,i,s,a,c,u,f,l,h=r.kind,p=r.result,g;if(g=r.input.charCodeAt(r.position),gr(g)||ea(g)||g===35||g===38||g===42||g===33||g===124||g===62||g===39||g===34||g===37||g===64||g===96||(g===63||g===45)&&(i=r.input.charCodeAt(r.position+1),gr(i)||t&&ea(i)))return!1;for(r.kind="scalar",r.result="",s=a=r.position,c=!1;g!==0;){if(g===58){if(i=r.input.charCodeAt(r.position+1),gr(i)||t&&ea(i))break}else if(g===35){if(n=r.input.charCodeAt(r.position-1),gr(n))break}else{if(r.position===r.lineStart&&fl(r)||t&&ea(g))break;if(Fn(g))if(u=r.line,f=r.lineStart,l=r.lineIndent,mt(r,!1,-1),r.lineIndent>=e){c=!0,g=r.input.charCodeAt(r.position);continue}else{r.position=a,r.line=u,r.lineStart=f,r.lineIndent=l;break}}c&&(Ei(r,s,a,!1),xm(r,r.line-u),s=a=r.position,c=!1),us(g)||(a=r.position+1),g=r.input.charCodeAt(++r.position)}return Ei(r,s,a,!1),r.result?!0:(r.kind=h,r.result=p,!1)}o(B6,"readPlainScalar");function U6(r,e){var t,n,i;if(t=r.input.charCodeAt(r.position),t!==39)return!1;for(r.kind="scalar",r.result="",r.position++,n=i=r.position;(t=r.input.charCodeAt(r.position))!==0;)if(t===39)if(Ei(r,n,r.position,!0),t=r.input.charCodeAt(++r.position),t===39)n=r.position,r.position++,i=r.position;else return!0;else Fn(t)?(Ei(r,n,i,!0),xm(r,mt(r,!1,e)),n=i=r.position):r.position===r.lineStart&&fl(r)?z(r,"unexpected end of the document within a single quoted scalar"):(r.position++,i=r.position);z(r,"unexpected end of the stream within a single quoted scalar")}o(U6,"readSingleQuotedScalar");function $6(r,e){var t,n,i,s,a,c;if(c=r.input.charCodeAt(r.position),c!==34)return!1;for(r.kind="scalar",r.result="",r.position++,t=n=r.position;(c=r.input.charCodeAt(r.position))!==0;){if(c===34)return Ei(r,t,r.position,!0),r.position++,!0;if(c===92){if(Ei(r,t,r.position,!0),c=r.input.charCodeAt(++r.position),Fn(c))mt(r,!1,e);else if(c<256&&av[c])r.result+=ov[c],r.position++;else if((a=M6(c))>0){for(i=a,s=0;i>0;i--)c=r.input.charCodeAt(++r.position),(a=j6(c))>=0?s=(s<<4)+a:z(r,"expected hexadecimal character");r.result+=V6(s),r.position++}else z(r,"unknown escape sequence");t=n=r.position}else Fn(c)?(Ei(r,t,n,!0),xm(r,mt(r,!1,e)),t=n=r.position):r.position===r.lineStart&&fl(r)?z(r,"unexpected end of the document within a double quoted scalar"):(r.position++,n=r.position)}z(r,"unexpected end of the stream within a double quoted scalar")}o($6,"readDoubleQuotedScalar");function W6(r,e){var t=!0,n,i,s,a=r.tag,c,u=r.anchor,f,l,h,p,g,w=Object.create(null),S,x,P,F;if(F=r.input.charCodeAt(r.position),F===91)l=93,g=!1,c=[];else if(F===123)l=125,g=!0,c={};else return!1;for(r.anchor!==null&&(r.anchorMap[r.anchor]=c),F=r.input.charCodeAt(++r.position);F!==0;){if(mt(r,!0,e),F=r.input.charCodeAt(r.position),F===l)return r.position++,r.tag=a,r.anchor=u,r.kind=g?"mapping":"sequence",r.result=c,!0;t?F===44&&z(r,"expected the node content, but found ','"):z(r,"missed comma between flow collection entries"),x=S=P=null,h=p=!1,F===63&&(f=r.input.charCodeAt(r.position+1),gr(f)&&(h=p=!0,r.position++,mt(r,!0,e))),n=r.line,i=r.lineStart,s=r.position,ra(r,e,al,!1,!0),x=r.tag,S=r.result,mt(r,!0,e),F=r.input.charCodeAt(r.position),(p||r.line===n)&&F===58&&(h=!0,F=r.input.charCodeAt(++r.position),mt(r,!0,e),ra(r,e,al,!1,!0),P=r.result),g?ta(r,c,w,x,S,P,n,i,s):h?c.push(ta(r,null,w,x,S,P,n,i,s)):c.push(S),mt(r,!0,e),F=r.input.charCodeAt(r.position),F===44?(t=!0,F=r.input.charCodeAt(++r.position)):t=!1}z(r,"unexpected end of the stream within a flow collection")}o(W6,"readFlowCollection");function G6(r,e){var t,n,i=ym,s=!1,a=!1,c=e,u=0,f=!1,l,h;if(h=r.input.charCodeAt(r.position),h===124)n=!1;else if(h===62)n=!0;else return!1;for(r.kind="scalar",r.result="";h!==0;)if(h=r.input.charCodeAt(++r.position),h===43||h===45)ym===i?i=h===43?w_:R6:z(r,"repeat of a chomping mode identifier");else if((l=L6(h))>=0)l===0?z(r,"bad explicit indentation width of a block scalar; it cannot be less than one"):a?z(r,"repeat of an indentation width identifier"):(c=e+l-1,a=!0);else break;if(us(h)){do h=r.input.charCodeAt(++r.position);while(us(h));if(h===35)do h=r.input.charCodeAt(++r.position);while(!Fn(h)&&h!==0)}for(;h!==0;){for(Am(r),r.lineIndent=0,h=r.input.charCodeAt(r.position);(!a||r.lineIndent<c)&&h===32;)r.lineIndent++,h=r.input.charCodeAt(++r.position);if(!a&&r.lineIndent>c&&(c=r.lineIndent),Fn(h)){u++;continue}if(r.lineIndent<c){i===w_?r.result+=yt.repeat(`
`,s?1+u:u):i===ym&&s&&(r.result+=`
`);break}for(n?us(h)?(f=!0,r.result+=yt.repeat(`
`,s?1+u:u)):f?(f=!1,r.result+=yt.repeat(`
`,u+1)):u===0?s&&(r.result+=" "):r.result+=yt.repeat(`
`,u):r.result+=yt.repeat(`
`,s?1+u:u),s=!0,a=!0,u=0,t=r.position;!Fn(h)&&h!==0;)h=r.input.charCodeAt(++r.position);Ei(r,t,r.position,!1)}return!0}o(G6,"readBlockScalar");function x_(r,e){var t,n=r.tag,i=r.anchor,s=[],a,c=!1,u;if(r.firstTabInLine!==-1)return!1;for(r.anchor!==null&&(r.anchorMap[r.anchor]=s),u=r.input.charCodeAt(r.position);u!==0&&(r.firstTabInLine!==-1&&(r.position=r.firstTabInLine,z(r,"tab characters must not be used in indentation")),!(u!==45||(a=r.input.charCodeAt(r.position+1),!gr(a))));){if(c=!0,r.position++,mt(r,!0,-1)&&r.lineIndent<=e){s.push(null),u=r.input.charCodeAt(r.position);continue}if(t=r.line,ra(r,e,nv,!1,!0),s.push(r.result),mt(r,!0,-1),u=r.input.charCodeAt(r.position),(r.line===t||r.lineIndent>e)&&u!==0)z(r,"bad indentation of a sequence entry");else if(r.lineIndent<e)break}return c?(r.tag=n,r.anchor=i,r.kind="sequence",r.result=s,!0):!1}o(x_,"readBlockSequence");function H6(r,e,t){var n,i,s,a,c,u,f=r.tag,l=r.anchor,h={},p=Object.create(null),g=null,w=null,S=null,x=!1,P=!1,F;if(r.firstTabInLine!==-1)return!1;for(r.anchor!==null&&(r.anchorMap[r.anchor]=h),F=r.input.charCodeAt(r.position);F!==0;){if(!x&&r.firstTabInLine!==-1&&(r.position=r.firstTabInLine,z(r,"tab characters must not be used in indentation")),n=r.input.charCodeAt(r.position+1),s=r.line,(F===63||F===58)&&gr(n))F===63?(x&&(ta(r,h,p,g,w,null,a,c,u),g=w=S=null),P=!0,x=!0,i=!0):x?(x=!1,i=!0):z(r,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),r.position+=1,F=n;else{if(a=r.line,c=r.lineStart,u=r.position,!ra(r,t,rv,!1,!0))break;if(r.line===s){for(F=r.input.charCodeAt(r.position);us(F);)F=r.input.charCodeAt(++r.position);if(F===58)F=r.input.charCodeAt(++r.position),gr(F)||z(r,"a whitespace character is expected after the key-value separator within a block mapping"),x&&(ta(r,h,p,g,w,null,a,c,u),g=w=S=null),P=!0,x=!1,i=!1,g=r.tag,w=r.result;else if(P)z(r,"can not read an implicit mapping pair; a colon is missed");else return r.tag=f,r.anchor=l,!0}else if(P)z(r,"can not read a block mapping entry; a multiline key may not be an implicit key");else return r.tag=f,r.anchor=l,!0}if((r.line===s||r.lineIndent>e)&&(x&&(a=r.line,c=r.lineStart,u=r.position),ra(r,e,ol,!0,i)&&(x?w=r.result:S=r.result),x||(ta(r,h,p,g,w,S,a,c,u),g=w=S=null),mt(r,!0,-1),F=r.input.charCodeAt(r.position)),(r.line===s||r.lineIndent>e)&&F!==0)z(r,"bad indentation of a mapping entry");else if(r.lineIndent<e)break}return x&&ta(r,h,p,g,w,null,a,c,u),P&&(r.tag=f,r.anchor=l,r.kind="mapping",r.result=h),P}o(H6,"readBlockMapping");function z6(r){var e,t=!1,n=!1,i,s,a;if(a=r.input.charCodeAt(r.position),a!==33)return!1;if(r.tag!==null&&z(r,"duplication of a tag property"),a=r.input.charCodeAt(++r.position),a===60?(t=!0,a=r.input.charCodeAt(++r.position)):a===33?(n=!0,i="!!",a=r.input.charCodeAt(++r.position)):i="!",e=r.position,t){do a=r.input.charCodeAt(++r.position);while(a!==0&&a!==62);r.position<r.length?(s=r.input.slice(e,r.position),a=r.input.charCodeAt(++r.position)):z(r,"unexpected end of the stream within a verbatim tag")}else{for(;a!==0&&!gr(a);)a===33&&(n?z(r,"tag suffix cannot contain exclamation marks"):(i=r.input.slice(e-1,r.position+1),iv.test(i)||z(r,"named tag handle cannot contain such characters"),n=!0,e=r.position+1)),a=r.input.charCodeAt(++r.position);s=r.input.slice(e,r.position),k6.test(s)&&z(r,"tag suffix cannot contain flow indicator characters")}s&&!sv.test(s)&&z(r,"tag name cannot contain such characters: "+s);try{s=decodeURIComponent(s)}catch{z(r,"tag name is malformed: "+s)}return t?r.tag=s:Ti.call(r.tagMap,i)?r.tag=r.tagMap[i]+s:i==="!"?r.tag="!"+s:i==="!!"?r.tag="tag:yaml.org,2002:"+s:z(r,'undeclared tag handle "'+i+'"'),!0}o(z6,"readTagProperty");function K6(r){var e,t;if(t=r.input.charCodeAt(r.position),t!==38)return!1;for(r.anchor!==null&&z(r,"duplication of an anchor property"),t=r.input.charCodeAt(++r.position),e=r.position;t!==0&&!gr(t)&&!ea(t);)t=r.input.charCodeAt(++r.position);return r.position===e&&z(r,"name of an anchor node must contain at least one character"),r.anchor=r.input.slice(e,r.position),!0}o(K6,"readAnchorProperty");function Y6(r){var e,t,n;if(n=r.input.charCodeAt(r.position),n!==42)return!1;for(n=r.input.charCodeAt(++r.position),e=r.position;n!==0&&!gr(n)&&!ea(n);)n=r.input.charCodeAt(++r.position);return r.position===e&&z(r,"name of an alias node must contain at least one character"),t=r.input.slice(e,r.position),Ti.call(r.anchorMap,t)||z(r,'unidentified alias "'+t+'"'),r.result=r.anchorMap[t],mt(r,!0,-1),!0}o(Y6,"readAlias");function ra(r,e,t,n,i){var s,a,c,u=1,f=!1,l=!1,h,p,g,w,S,x;if(r.listener!==null&&r.listener("open",r),r.tag=null,r.anchor=null,r.kind=null,r.result=null,s=a=c=ol===t||nv===t,n&&mt(r,!0,-1)&&(f=!0,r.lineIndent>e?u=1:r.lineIndent===e?u=0:r.lineIndent<e&&(u=-1)),u===1)for(;z6(r)||K6(r);)mt(r,!0,-1)?(f=!0,c=s,r.lineIndent>e?u=1:r.lineIndent===e?u=0:r.lineIndent<e&&(u=-1)):c=!1;if(c&&(c=f||i),(u===1||ol===t)&&(al===t||rv===t?S=e:S=e+1,x=r.position-r.lineStart,u===1?c&&(x_(r,x)||H6(r,x,S))||W6(r,S)?l=!0:(a&&G6(r,S)||U6(r,S)||$6(r,S)?l=!0:Y6(r)?(l=!0,(r.tag!==null||r.anchor!==null)&&z(r,"alias node should not have any properties")):B6(r,S,al===t)&&(l=!0,r.tag===null&&(r.tag="?")),r.anchor!==null&&(r.anchorMap[r.anchor]=r.result)):u===0&&(l=c&&x_(r,x))),r.tag===null)r.anchor!==null&&(r.anchorMap[r.anchor]=r.result);else if(r.tag==="?"){for(r.result!==null&&r.kind!=="scalar"&&z(r,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+r.kind+'"'),h=0,p=r.implicitTypes.length;h<p;h+=1)if(w=r.implicitTypes[h],w.resolve(r.result)){r.result=w.construct(r.result),r.tag=w.tag,r.anchor!==null&&(r.anchorMap[r.anchor]=r.result);break}}else if(r.tag!=="!"){if(Ti.call(r.typeMap[r.kind||"fallback"],r.tag))w=r.typeMap[r.kind||"fallback"][r.tag];else for(w=null,g=r.typeMap.multi[r.kind||"fallback"],h=0,p=g.length;h<p;h+=1)if(r.tag.slice(0,g[h].tag.length)===g[h].tag){w=g[h];break}w||z(r,"unknown tag !<"+r.tag+">"),r.result!==null&&w.kind!==r.kind&&z(r,"unacceptable node kind for !<"+r.tag+'> tag; it should be "'+w.kind+'", not "'+r.kind+'"'),w.resolve(r.result,r.tag)?(r.result=w.construct(r.result,r.tag),r.anchor!==null&&(r.anchorMap[r.anchor]=r.result)):z(r,"cannot resolve a node with !<"+r.tag+"> explicit tag")}return r.listener!==null&&r.listener("close",r),r.tag!==null||r.anchor!==null||l}o(ra,"composeNode");function Q6(r){var e=r.position,t,n,i,s=!1,a;for(r.version=null,r.checkLineBreaks=r.legacy,r.tagMap=Object.create(null),r.anchorMap=Object.create(null);(a=r.input.charCodeAt(r.position))!==0&&(mt(r,!0,-1),a=r.input.charCodeAt(r.position),!(r.lineIndent>0||a!==37));){for(s=!0,a=r.input.charCodeAt(++r.position),t=r.position;a!==0&&!gr(a);)a=r.input.charCodeAt(++r.position);for(n=r.input.slice(t,r.position),i=[],n.length<1&&z(r,"directive name must not be less than one character in length");a!==0;){for(;us(a);)a=r.input.charCodeAt(++r.position);if(a===35){do a=r.input.charCodeAt(++r.position);while(a!==0&&!Fn(a));break}if(Fn(a))break;for(t=r.position;a!==0&&!gr(a);)a=r.input.charCodeAt(++r.position);i.push(r.input.slice(t,r.position))}a!==0&&Am(r),Ti.call(T_,n)?T_[n](r,n,i):cl(r,'unknown document directive "'+n+'"')}if(mt(r,!0,-1),r.lineIndent===0&&r.input.charCodeAt(r.position)===45&&r.input.charCodeAt(r.position+1)===45&&r.input.charCodeAt(r.position+2)===45?(r.position+=3,mt(r,!0,-1)):s&&z(r,"directives end mark is expected"),ra(r,r.lineIndent-1,ol,!1,!0),mt(r,!0,-1),r.checkLineBreaks&&N6.test(r.input.slice(e,r.position))&&cl(r,"non-ASCII line breaks are interpreted as content"),r.documents.push(r.result),r.position===r.lineStart&&fl(r)){r.input.charCodeAt(r.position)===46&&(r.position+=3,mt(r,!0,-1));return}if(r.position<r.length-1)z(r,"end of the stream or a document separator is expected");else return}o(Q6,"readDocument");function uv(r,e){r=String(r),e=e||{},r.length!==0&&(r.charCodeAt(r.length-1)!==10&&r.charCodeAt(r.length-1)!==13&&(r+=`
`),r.charCodeAt(0)===65279&&(r=r.slice(1)));var t=new q6(r,e),n=r.indexOf("\0");for(n!==-1&&(t.position=n,z(t,"null byte is not allowed in input")),t.input+="\0";t.input.charCodeAt(t.position)===32;)t.lineIndent+=1,t.position+=1;for(;t.position<t.length-1;)Q6(t);return t.documents}o(uv,"loadDocuments");function J6(r,e,t){e!==null&&typeof e=="object"&&typeof t>"u"&&(t=e,e=null);var n=uv(r,t);if(typeof e!="function")return n;for(var i=0,s=n.length;i<s;i+=1)e(n[i])}o(J6,"loadAll$1");function X6(r,e){var t=uv(r,e);if(t.length!==0){if(t.length===1)return t[0];throw new ir("expected a single document in the stream, but found more")}}o(X6,"load$1");var Z6=J6,eP=X6,lv={loadAll:Z6,load:eP},fv=Object.prototype.toString,hv=Object.prototype.hasOwnProperty,Om=65279,tP=9,uo=10,rP=13,nP=32,iP=33,sP=34,vm=35,aP=37,oP=38,cP=39,uP=42,dv=44,lP=45,ul=58,fP=61,hP=62,dP=63,pP=64,pv=91,mv=93,mP=96,gv=123,gP=124,yv=125,Ut={};Ut[0]="\\0";Ut[7]="\\a";Ut[8]="\\b";Ut[9]="\\t";Ut[10]="\\n";Ut[11]="\\v";Ut[12]="\\f";Ut[13]="\\r";Ut[27]="\\e";Ut[34]='\\"';Ut[92]="\\\\";Ut[133]="\\N";Ut[160]="\\_";Ut[8232]="\\L";Ut[8233]="\\P";var yP=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],_P=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function vP(r,e){var t,n,i,s,a,c,u;if(e===null)return{};for(t={},n=Object.keys(e),i=0,s=n.length;i<s;i+=1)a=n[i],c=String(e[a]),a.slice(0,2)==="!!"&&(a="tag:yaml.org,2002:"+a.slice(2)),u=r.compiledTypeMap.fallback[a],u&&hv.call(u.styleAliases,c)&&(c=u.styleAliases[c]),t[a]=c;return t}o(vP,"compileStyleMap");function SP(r){var e,t,n;if(e=r.toString(16).toUpperCase(),r<=255)t="x",n=2;else if(r<=65535)t="u",n=4;else if(r<=4294967295)t="U",n=8;else throw new ir("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+t+yt.repeat("0",n-e.length)+e}o(SP,"encodeHex");var wP=1,lo=2;function bP(r){this.schema=r.schema||Tm,this.indent=Math.max(1,r.indent||2),this.noArrayIndent=r.noArrayIndent||!1,this.skipInvalid=r.skipInvalid||!1,this.flowLevel=yt.isNothing(r.flowLevel)?-1:r.flowLevel,this.styleMap=vP(this.schema,r.styles||null),this.sortKeys=r.sortKeys||!1,this.lineWidth=r.lineWidth||80,this.noRefs=r.noRefs||!1,this.noCompatMode=r.noCompatMode||!1,this.condenseFlow=r.condenseFlow||!1,this.quotingType=r.quotingType==='"'?lo:wP,this.forceQuotes=r.forceQuotes||!1,this.replacer=typeof r.replacer=="function"?r.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}o(bP,"State");function O_(r,e){for(var t=yt.repeat(" ",e),n=0,i=-1,s="",a,c=r.length;n<c;)i=r.indexOf(`
`,n),i===-1?(a=r.slice(n),n=c):(a=r.slice(n,i+1),n=i+1),a.length&&a!==`
`&&(s+=t),s+=a;return s}o(O_,"indentString");function Sm(r,e){return`
`+yt.repeat(" ",r.indent*e)}o(Sm,"generateNextLine");function EP(r,e){var t,n,i;for(t=0,n=r.implicitTypes.length;t<n;t+=1)if(i=r.implicitTypes[t],i.resolve(e))return!0;return!1}o(EP,"testImplicitResolving");function ll(r){return r===nP||r===tP}o(ll,"isWhitespace");function fo(r){return 32<=r&&r<=126||161<=r&&r<=55295&&r!==8232&&r!==8233||57344<=r&&r<=65533&&r!==Om||65536<=r&&r<=1114111}o(fo,"isPrintable");function C_(r){return fo(r)&&r!==Om&&r!==rP&&r!==uo}o(C_,"isNsCharOrWhitespace");function P_(r,e,t){var n=C_(r),i=n&&!ll(r);return(t?n:n&&r!==dv&&r!==pv&&r!==mv&&r!==gv&&r!==yv)&&r!==vm&&!(e===ul&&!i)||C_(e)&&!ll(e)&&r===vm||e===ul&&i}o(P_,"isPlainSafe");function TP(r){return fo(r)&&r!==Om&&!ll(r)&&r!==lP&&r!==dP&&r!==ul&&r!==dv&&r!==pv&&r!==mv&&r!==gv&&r!==yv&&r!==vm&&r!==oP&&r!==uP&&r!==iP&&r!==gP&&r!==fP&&r!==hP&&r!==cP&&r!==sP&&r!==aP&&r!==pP&&r!==mP}o(TP,"isPlainSafeFirst");function AP(r){return!ll(r)&&r!==ul}o(AP,"isPlainSafeLast");function oo(r,e){var t=r.charCodeAt(e),n;return t>=55296&&t<=56319&&e+1<r.length&&(n=r.charCodeAt(e+1),n>=56320&&n<=57343)?(t-55296)*1024+n-56320+65536:t}o(oo,"codePointAt");function _v(r){var e=/^\n* /;return e.test(r)}o(_v,"needIndentIndicator");var vv=1,wm=2,Sv=3,wv=4,Zs=5;function xP(r,e,t,n,i,s,a,c){var u,f=0,l=null,h=!1,p=!1,g=n!==-1,w=-1,S=TP(oo(r,0))&&AP(oo(r,r.length-1));if(e||a)for(u=0;u<r.length;f>=65536?u+=2:u++){if(f=oo(r,u),!fo(f))return Zs;S=S&&P_(f,l,c),l=f}else{for(u=0;u<r.length;f>=65536?u+=2:u++){if(f=oo(r,u),f===uo)h=!0,g&&(p=p||u-w-1>n&&r[w+1]!==" ",w=u);else if(!fo(f))return Zs;S=S&&P_(f,l,c),l=f}p=p||g&&u-w-1>n&&r[w+1]!==" "}return!h&&!p?S&&!a&&!i(r)?vv:s===lo?Zs:wm:t>9&&_v(r)?Zs:a?s===lo?Zs:wm:p?wv:Sv}o(xP,"chooseScalarStyle");function OP(r,e,t,n,i){r.dump=(function(){if(e.length===0)return r.quotingType===lo?'""':"''";if(!r.noCompatMode&&(yP.indexOf(e)!==-1||_P.test(e)))return r.quotingType===lo?'"'+e+'"':"'"+e+"'";var s=r.indent*Math.max(1,t),a=r.lineWidth===-1?-1:Math.max(Math.min(r.lineWidth,40),r.lineWidth-s),c=n||r.flowLevel>-1&&t>=r.flowLevel;function u(f){return EP(r,f)}switch(o(u,"testAmbiguity"),xP(e,c,r.indent,a,u,r.quotingType,r.forceQuotes&&!n,i)){case vv:return e;case wm:return"'"+e.replace(/'/g,"''")+"'";case Sv:return"|"+F_(e,r.indent)+I_(O_(e,s));case wv:return">"+F_(e,r.indent)+I_(O_(CP(e,a),s));case Zs:return'"'+PP(e)+'"';default:throw new ir("impossible error: invalid scalar style")}})()}o(OP,"writeScalar");function F_(r,e){var t=_v(r)?String(e):"",n=r[r.length-1]===`
`,i=n&&(r[r.length-2]===`
`||r===`
`),s=i?"+":n?"":"-";return t+s+`
`}o(F_,"blockHeader");function I_(r){return r[r.length-1]===`
`?r.slice(0,-1):r}o(I_,"dropEndingNewline");function CP(r,e){for(var t=/(\n+)([^\n]*)/g,n=(function(){var f=r.indexOf(`
`);return f=f!==-1?f:r.length,t.lastIndex=f,R_(r.slice(0,f),e)})(),i=r[0]===`
`||r[0]===" ",s,a;a=t.exec(r);){var c=a[1],u=a[2];s=u[0]===" ",n+=c+(!i&&!s&&u!==""?`
`:"")+R_(u,e),i=s}return n}o(CP,"foldString");function R_(r,e){if(r===""||r[0]===" ")return r;for(var t=/ [^ ]/g,n,i=0,s,a=0,c=0,u="";n=t.exec(r);)c=n.index,c-i>e&&(s=a>i?a:c,u+=`
`+r.slice(i,s),i=s+1),a=c;return u+=`
`,r.length-i>e&&a>i?u+=r.slice(i,a)+`
`+r.slice(a+1):u+=r.slice(i),u.slice(1)}o(R_,"foldLine");function PP(r){for(var e="",t=0,n,i=0;i<r.length;t>=65536?i+=2:i++)t=oo(r,i),n=Ut[t],!n&&fo(t)?(e+=r[i],t>=65536&&(e+=r[i+1])):e+=n||SP(t);return e}o(PP,"escapeString");function FP(r,e,t){var n="",i=r.tag,s,a,c;for(s=0,a=t.length;s<a;s+=1)c=t[s],r.replacer&&(c=r.replacer.call(t,String(s),c)),(Zn(r,e,c,!1,!1)||typeof c>"u"&&Zn(r,e,null,!1,!1))&&(n!==""&&(n+=","+(r.condenseFlow?"":" ")),n+=r.dump);r.tag=i,r.dump="["+n+"]"}o(FP,"writeFlowSequence");function D_(r,e,t,n){var i="",s=r.tag,a,c,u;for(a=0,c=t.length;a<c;a+=1)u=t[a],r.replacer&&(u=r.replacer.call(t,String(a),u)),(Zn(r,e+1,u,!0,!0,!1,!0)||typeof u>"u"&&Zn(r,e+1,null,!0,!0,!1,!0))&&((!n||i!=="")&&(i+=Sm(r,e)),r.dump&&uo===r.dump.charCodeAt(0)?i+="-":i+="- ",i+=r.dump);r.tag=s,r.dump=i||"[]"}o(D_,"writeBlockSequence");function IP(r,e,t){var n="",i=r.tag,s=Object.keys(t),a,c,u,f,l;for(a=0,c=s.length;a<c;a+=1)l="",n!==""&&(l+=", "),r.condenseFlow&&(l+='"'),u=s[a],f=t[u],r.replacer&&(f=r.replacer.call(t,u,f)),Zn(r,e,u,!1,!1)&&(r.dump.length>1024&&(l+="? "),l+=r.dump+(r.condenseFlow?'"':"")+":"+(r.condenseFlow?"":" "),Zn(r,e,f,!1,!1)&&(l+=r.dump,n+=l));r.tag=i,r.dump="{"+n+"}"}o(IP,"writeFlowMapping");function RP(r,e,t,n){var i="",s=r.tag,a=Object.keys(t),c,u,f,l,h,p;if(r.sortKeys===!0)a.sort();else if(typeof r.sortKeys=="function")a.sort(r.sortKeys);else if(r.sortKeys)throw new ir("sortKeys must be a boolean or a function");for(c=0,u=a.length;c<u;c+=1)p="",(!n||i!=="")&&(p+=Sm(r,e)),f=a[c],l=t[f],r.replacer&&(l=r.replacer.call(t,f,l)),Zn(r,e+1,f,!0,!0,!0)&&(h=r.tag!==null&&r.tag!=="?"||r.dump&&r.dump.length>1024,h&&(r.dump&&uo===r.dump.charCodeAt(0)?p+="?":p+="? "),p+=r.dump,h&&(p+=Sm(r,e)),Zn(r,e+1,l,!0,h)&&(r.dump&&uo===r.dump.charCodeAt(0)?p+=":":p+=": ",p+=r.dump,i+=p));r.tag=s,r.dump=i||"{}"}o(RP,"writeBlockMapping");function N_(r,e,t){var n,i,s,a,c,u;for(i=t?r.explicitTypes:r.implicitTypes,s=0,a=i.length;s<a;s+=1)if(c=i[s],(c.instanceOf||c.predicate)&&(!c.instanceOf||typeof e=="object"&&e instanceof c.instanceOf)&&(!c.predicate||c.predicate(e))){if(t?c.multi&&c.representName?r.tag=c.representName(e):r.tag=c.tag:r.tag="?",c.represent){if(u=r.styleMap[c.tag]||c.defaultStyle,fv.call(c.represent)==="[object Function]")n=c.represent(e,u);else if(hv.call(c.represent,u))n=c.represent[u](e,u);else throw new ir("!<"+c.tag+'> tag resolver accepts not "'+u+'" style');r.dump=n}return!0}return!1}o(N_,"detectType");function Zn(r,e,t,n,i,s,a){r.tag=null,r.dump=t,N_(r,t,!1)||N_(r,t,!0);var c=fv.call(r.dump),u=n,f;n&&(n=r.flowLevel<0||r.flowLevel>e);var l=c==="[object Object]"||c==="[object Array]",h,p;if(l&&(h=r.duplicates.indexOf(t),p=h!==-1),(r.tag!==null&&r.tag!=="?"||p||r.indent!==2&&e>0)&&(i=!1),p&&r.usedDuplicates[h])r.dump="*ref_"+h;else{if(l&&p&&!r.usedDuplicates[h]&&(r.usedDuplicates[h]=!0),c==="[object Object]")n&&Object.keys(r.dump).length!==0?(RP(r,e,r.dump,i),p&&(r.dump="&ref_"+h+r.dump)):(IP(r,e,r.dump),p&&(r.dump="&ref_"+h+" "+r.dump));else if(c==="[object Array]")n&&r.dump.length!==0?(r.noArrayIndent&&!a&&e>0?D_(r,e-1,r.dump,i):D_(r,e,r.dump,i),p&&(r.dump="&ref_"+h+r.dump)):(FP(r,e,r.dump),p&&(r.dump="&ref_"+h+" "+r.dump));else if(c==="[object String]")r.tag!=="?"&&OP(r,r.dump,e,s,u);else{if(c==="[object Undefined]")return!1;if(r.skipInvalid)return!1;throw new ir("unacceptable kind of an object to dump "+c)}r.tag!==null&&r.tag!=="?"&&(f=encodeURI(r.tag[0]==="!"?r.tag.slice(1):r.tag).replace(/!/g,"%21"),r.tag[0]==="!"?f="!"+f:f.slice(0,18)==="tag:yaml.org,2002:"?f="!!"+f.slice(18):f="!<"+f+">",r.dump=f+" "+r.dump)}return!0}o(Zn,"writeNode");function DP(r,e){var t=[],n=[],i,s;for(bm(r,t,n),i=0,s=n.length;i<s;i+=1)e.duplicates.push(t[n[i]]);e.usedDuplicates=new Array(s)}o(DP,"getDuplicateReferences");function bm(r,e,t){var n,i,s;if(r!==null&&typeof r=="object")if(i=e.indexOf(r),i!==-1)t.indexOf(i)===-1&&t.push(i);else if(e.push(r),Array.isArray(r))for(i=0,s=r.length;i<s;i+=1)bm(r[i],e,t);else for(n=Object.keys(r),i=0,s=n.length;i<s;i+=1)bm(r[n[i]],e,t)}o(bm,"inspectNode");function NP(r,e){e=e||{};var t=new bP(e);t.noRefs||DP(r,t);var n=r;return t.replacer&&(n=t.replacer.call({"":n},"",n)),Zn(t,0,n,!0,!0)?t.dump+`
`:""}o(NP,"dump$1");var kP=NP,jP={dump:kP};function Cm(r,e){return function(){throw new Error("Function yaml."+r+" is removed in js-yaml 4. Use yaml."+e+" instead, which is now safe by default.")}}o(Cm,"renamed");var MP=Nt,LP=M_,VP=B_,qP=H_,BP=z_,UP=Tm,$P=lv.load,WP=lv.loadAll,GP=jP.dump,HP=ir,zP={binary:X_,float:G_,map:q_,null:U_,pairs:ev,set:tv,timestamp:Q_,bool:$_,int:W_,merge:J_,omap:Z_,seq:V_,str:L_},KP=Cm("safeLoad","load"),YP=Cm("safeLoadAll","loadAll"),QP=Cm("safeDump","dump"),JP={Type:MP,Schema:LP,FAILSAFE_SCHEMA:VP,JSON_SCHEMA:qP,CORE_SCHEMA:BP,DEFAULT_SCHEMA:UP,load:$P,loadAll:WP,dump:GP,YAMLException:HP,types:zP,safeLoad:KP,safeLoadAll:YP,safeDump:QP},ho=JP;var hl=class{constructor(e){this.rootPath=e}static{o(this,"FileSystemVaultAdapter")}async read(e){let t=this.resolvePath(e.path);if(!await _t.default.pathExists(t))throw new Error(`File not found: ${e.path}`);return _t.default.readFile(t,"utf-8")}async create(e,t){let n=this.resolvePath(e);if(await _t.default.pathExists(n))throw new Error(`File already exists: ${e}`);return await _t.default.ensureDir($t.default.dirname(n)),await _t.default.writeFile(n,t,"utf-8"),this.createFileObject(e)}async modify(e,t){let n=this.resolvePath(e.path);if(!await _t.default.pathExists(n))throw new Error(`File not found: ${e.path}`);await _t.default.writeFile(n,t,"utf-8")}async delete(e){let t=this.resolvePath(e.path);if(!await _t.default.pathExists(t))throw new Error(`File not found: ${e.path}`);await _t.default.remove(t)}async exists(e){let t=this.resolvePath(e);return _t.default.pathExists(t)}getAbstractFileByPath(e){let t=this.resolvePath(e);try{let n=_t.default.statSync(t);if(n.isFile())return this.createFileObject(e);if(n.isDirectory())return this.createFolderObject(e)}catch{return null}return null}getAllFiles(){let e=[];return this.walkDirectory(this.rootPath,t=>{if(t.endsWith(".md")){let n=$t.default.relative(this.rootPath,t);e.push(this.createFileObject(n))}}),e}getFrontmatter(e){try{let t=_t.default.readFileSync(this.resolvePath(e.path),"utf-8");return this.extractFrontmatter(t)}catch{return null}}async updateFrontmatter(e,t){let n=await this.read(e),i=this.extractFrontmatter(n)||{},s=t(i),a=this.replaceFrontmatter(n,s);await this.modify(e,a)}async rename(e,t){let n=this.resolvePath(e.path),i=this.resolvePath(t);if(!await _t.default.pathExists(n))throw new Error(`File not found: ${e.path}`);await _t.default.ensureDir($t.default.dirname(i)),await _t.default.move(n,i)}async createFolder(e){let t=this.resolvePath(e);await _t.default.ensureDir(t)}getFirstLinkpathDest(e,t){let n=$t.default.dirname(this.resolvePath(t)),i;if($t.default.isAbsolute(e)?i=this.resolvePath(e):i=$t.default.resolve(n,e),e.endsWith(".md")||(i+=".md"),_t.default.existsSync(i)){let s=$t.default.relative(this.rootPath,i);return this.createFileObject(s)}return null}async process(e,t){let n=await this.read(e),i=t(n);return await this.modify(e,i),i}getDefaultNewFileParent(){return{path:"",name:""}}async updateLinks(e,t,n){return Promise.resolve()}resolvePath(e){return $t.default.isAbsolute(e)?e:$t.default.join(this.rootPath,e)}createFileObject(e){let t=$t.default.basename(e),n=$t.default.basename(e,$t.default.extname(e)),i=$t.default.dirname(e);return{path:e,basename:t,name:n,parent:i!=="."?this.createFolderObject(i):null}}createFolderObject(e){return{path:e,name:$t.default.basename(e)}}extractFrontmatter(e){let t=/^---\n([\s\S]*?)\n---/,n=e.match(t);if(!n)return null;try{let i=ho.load(n[1]);return typeof i=="object"&&i!==null?i:null}catch{return null}}replaceFrontmatter(e,t){let n=ho.dump(t,{lineWidth:-1,noRefs:!0,quotingType:'"'}),i=/^---\n([\s\S]*?)\n---/;return e.match(i)?e.replace(i,`---
${n.trim()}
---`):`---
${n.trim()}
---
${e}`}walkDirectory(e,t){let n=_t.default.readdirSync(e,{withFileTypes:!0});for(let i of n){let s=$t.default.join(e,i.name);i.isDirectory()?this.walkDirectory(s,t):i.isFile()&&t(s)}}};var dl=class{static{o(this,"TableFormatter")}format(e){if(e.length===0)return"No results";let t=this.getAllVariables(e),n=e.map(i=>this.solutionToRow(i,t));return this.renderTable(t,n)}getAllVariables(e){let t=new Set;for(let n of e)for(let i of n.variables())t.add(i);return Array.from(t).sort()}solutionToRow(e,t){return t.map(n=>{let i=e.get(n);return i?this.formatValue(i.toString()):""})}formatValue(e){return e.length>50?e.substring(0,47)+"...":e}renderTable(e,t){let n=e.map((s,a)=>{let c=s.length+1,u=Math.max(...t.map(f=>f[a]?.length||0));return Math.max(c,u,10)}),i=[];i.push(this.renderSeparator(n,"top")),i.push(this.renderRow(e.map(s=>`?${s}`),n)),i.push(this.renderSeparator(n,"mid"));for(let s of t)i.push(this.renderRow(s,n));return i.push(this.renderSeparator(n,"bottom")),i.join(`
`)}renderRow(e,t){return`\u2502 ${e.map((i,s)=>i.padEnd(t[s])).join(" \u2502 ")} \u2502`}renderSeparator(e,t){let n=t==="top"?"\u250C":t==="mid"?"\u251C":"\u2514",i=t==="top"?"\u2510":t==="mid"?"\u2524":"\u2518",a=t==="mid"?"\u2500\u253C\u2500":"\u2500"+(t==="mid"?"\u253C":"\u2500")+"\u2500",c=e.map(u=>"\u2500".repeat(u+2));return`${n}${c.join(a)}${i}`}};var pl=class{static{o(this,"JsonFormatter")}format(e){let t=e.map(n=>n.toJSON());return JSON.stringify(t,null,2)}};var po=class{static{o(this,"TriplesFormatter")}formatNTriples(e){return e.map(t=>t.toString()).join(`
`)}formatTable(e){if(e.length===0)return"No triples generated.";let t=[];t.push("Subject | Predicate | Object"),t.push("------- | --------- | ------");for(let n of e){let i=this.formatNode(n.subject),s=this.formatNode(n.predicate),a=this.formatNode(n.object);t.push(`${i} | ${s} | ${a}`)}return t.join(`
`)}formatJson(e){let t=e.map(n=>({subject:this.nodeToJson(n.subject),predicate:this.nodeToJson(n.predicate),object:this.nodeToJson(n.object)}));return JSON.stringify(t,null,2)}formatNode(e){return e.value!==void 0?String(e.value):String(e)}nodeToJson(e){return"datatype"in e||"language"in e?{type:"literal",value:String(e.value),...e.datatype&&{datatype:e.datatype.value||String(e.datatype)},...e.language&&{language:e.language}}:"id"in e&&String(e.id).startsWith("_:")?{type:"bnode",value:String(e.id)}:{type:"uri",value:String(e.value)}}};function bv(r){return r.startsWith("VALIDATION_")?"validation":r.startsWith("PERMISSION_")?"permission":r.startsWith("STATE_")?"state":"internal"}o(bv,"getErrorCategory");var Wt=class{static{o(this,"ResponseBuilder")}static success(e,t){return{success:!0,data:e,...t&&{meta:t}}}static error(e,t,n,i){return{success:!1,error:{code:e,category:bv(e),message:t,exitCode:n,...i?.recovery&&{recovery:i.recovery},...i?.context&&{context:i.context},...i?.stack&&{stack:i.stack}}}}};var sr=class extends Error{static{o(this,"CLIError")}constructor(e,t,n){super(e),this.name=this.constructor.name,this.context=t,this.recoveryHint=n,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}format(){let e=`\u274C ${this.name}: ${this.message}`;if(this.guidance&&(e+=`

\u{1F4A1} ${this.guidance}`),this.context&&Object.keys(this.context).length>0){e+=`

\u{1F4CB} Context:`;for(let[t,n]of Object.entries(this.context))e+=`
  ${t}: ${JSON.stringify(n)}`}return e}toStructuredResponse(e=!1){return Wt.error(this.errorCode,this.message,this.exitCode,{recovery:this.recoveryHint||{message:this.guidance},context:this.context,stack:e?this.stack:void 0})}formatJson(e=!1){return JSON.stringify(this.toStructuredResponse(e),null,2)}};var Re=class r{static{o(this,"ErrorHandler")}static{this.outputFormat="text"}static setFormat(e){r.outputFormat=e}static getFormat(){return r.outputFormat}static isDebugMode(){return!!process.env.DEBUG}static handle(e){if(e instanceof sr){if(r.outputFormat==="json"){let i=e.toStructuredResponse(r.isDebugMode());console.log(JSON.stringify(i,null,2))}else console.error(e.format()),r.isDebugMode()&&(console.error(`
\u{1F4CD} Stack trace:`),console.error(e.stack));process.exit(e.exitCode)}let{exitCode:t,errorCode:n}=r.classifyError(e);if(r.outputFormat==="json"){let i=r.buildErrorResponse(n,e.message,t,r.isDebugMode()?e.stack:void 0);console.log(JSON.stringify(i,null,2))}else console.error(`\u274C Error: ${e.message}`),r.isDebugMode()&&console.error(e.stack);process.exit(t)}static handleWithMessage(e,t=1,n="INTERNAL_UNKNOWN"){if(r.outputFormat==="json"){let i=r.buildErrorResponse(n,e,t);console.log(JSON.stringify(i,null,2))}else console.error(`\u274C Error: ${e}`);process.exit(t)}static classifyError(e){let t=e.message.toLowerCase();return t.includes("transition")?{exitCode:6,errorCode:"STATE_INVALID_TRANSITION"}:t.includes("transaction")?{exitCode:7,errorCode:"INTERNAL_TRANSACTION_FAILED"}:t.includes("concurrent")||t.includes("modified")?{exitCode:8,errorCode:"STATE_CONCURRENT_MODIFICATION"}:e.message.includes("not found")||e.message.includes("ENOENT")?{exitCode:3,errorCode:"VALIDATION_FILE_NOT_FOUND"}:e.message.includes("EACCES")||e.message.includes("permission denied")?{exitCode:4,errorCode:"PERMISSION_DENIED"}:e.message.includes("Invalid")||e.message.includes("outside vault")||e.message.includes("Not a")?{exitCode:2,errorCode:"VALIDATION_INVALID_ARGUMENTS"}:{exitCode:1,errorCode:"INTERNAL_UNKNOWN"}}static buildErrorResponse(e,t,n,i){return Wt.error(e,t,n,{recovery:r.getRecoveryHint(e),stack:i})}static getRecoveryHint(e){switch(e){case"VALIDATION_FILE_NOT_FOUND":return{message:"Verify the file path is correct and the file exists",suggestion:"Check file path spelling and ensure the file is in the vault"};case"VALIDATION_VAULT_NOT_FOUND":return{message:"Verify the vault path is correct",suggestion:"Check --vault option or current directory"};case"VALIDATION_INVALID_ARGUMENTS":return{message:"Check command syntax and argument format",suggestion:"Use --help for usage information"};case"STATE_INVALID_TRANSITION":return{message:"The requested state transition is not allowed",suggestion:"Check the current asset state and valid transitions"};case"STATE_CONCURRENT_MODIFICATION":return{message:"File was modified by another process",suggestion:"Wait and retry the command"};case"PERMISSION_DENIED":return{message:"Check file permissions",suggestion:"Ensure you have write access to the vault"};case"INTERNAL_TRANSACTION_FAILED":return{message:"Transaction could not complete",suggestion:"Check for locked files and retry"};default:return{message:"An unexpected error occurred",suggestion:"Check the error details and retry"}}}};var mo=class extends sr{constructor(t,n){super(`File not found: ${t}`,{filepath:t,...n},{message:"Verify the file path is correct and the file exists",suggestion:`ls -la "${t}" or find . -name "$(basename ${t})"`});this.exitCode=3;this.errorCode="VALIDATION_FILE_NOT_FOUND";this.guidance=`Verify the file path is correct and the file exists.
Check:
  \u2022 File path spelling
  \u2022 File is in the vault directory
  \u2022 File has .md extension`}static{o(this,"FileNotFoundError")}};var st=class extends sr{constructor(t,n,i){let s=`Check command syntax and argument format.
Use: exocortex command --help for usage information.`;super(t,i,{message:n||"Check command syntax and argument format",suggestion:"exocortex command --help"});this.exitCode=2;this.errorCode="VALIDATION_INVALID_ARGUMENTS";this.guidance=n||s}static{o(this,"InvalidArgumentsError")}};var ls=class extends sr{constructor(t,n){super(`Vault not found: ${t}`,{vaultPath:t,...n},{message:"Verify the vault path is correct and the directory exists",suggestion:`ls -la "${t}" or check --vault option`});this.exitCode=3;this.errorCode="VALIDATION_VAULT_NOT_FOUND";this.guidance=`The specified vault directory does not exist.
Check:
  \u2022 Path spelling and case sensitivity
  \u2022 Directory exists and is accessible
  \u2022 You have read permissions for the directory`}static{o(this,"VaultNotFoundError")}};function Ev(){return new Sn("query").description("Execute SPARQL query against Obsidian vault").argument("<query>","SPARQL query string or path to .sparql file").option("--vault <path>","Path to Obsidian vault",process.cwd()).option("--format <type>","Output format: table|json|csv|ntriples","table").option("--output <type>","Response format: text|json (for MCP tools)","text").option("--explain","Show optimized query plan").option("--stats","Show execution statistics").option("--no-optimize","Disable query optimization").action(async(r,e)=>{let t=e.output||"text";Re.setFormat(t);try{let n=Date.now(),i=XP(r),s=(0,Pm.resolve)(e.vault);if(!(0,go.existsSync)(s))throw new ls(s);t==="text"&&console.log(`\u{1F4E6} Loading vault: ${s}...`);let a=Date.now(),c=new hl(s),f=await new ar.NoteToRDFConverter(c).convertVault(),l=new ar.InMemoryTripleStore;await l.addAll(f);let h=Date.now()-a;t==="text"&&(console.log(`\u2705 Loaded ${f.length} triples in ${h}ms
`),console.log("\u{1F50D} Parsing SPARQL query..."));let g=new ar.SPARQLParser().parse(i);t==="text"&&console.log("\u{1F504} Translating to algebra...");let S=new ar.AlgebraTranslator().translate(g);if(!e.noOptimize&&S.type!=="construct")S=new ar.AlgebraOptimizer().optimize(S);else if(!e.noOptimize&&S.type==="construct"){let F=new ar.AlgebraOptimizer;S.where=F.optimize(S.where)}if(e.explain&&t==="text"){console.log("\u{1F4CA} Query Plan:");let F=new ar.AlgebraSerializer;S.type==="construct"?(console.log("CONSTRUCT Template:"),console.log("  (template patterns)"),console.log("WHERE:"),console.log(F.toString(S.where))):console.log(F.toString(S)),console.log()}t==="text"&&console.log("\u{1F3AF} Executing query...");let x=Date.now(),P=new ar.QueryExecutor(l);if(P.isConstructQuery(S)){let F=await P.executeConstruct(S),L=Date.now()-x,$=Date.now()-n;if(t==="json"){let K=new po,Fe={query:i,count:F.length,triples:JSON.parse(K.formatJson(F))},Xe=Wt.success(Fe,{durationMs:$,itemCount:F.length,loadDurationMs:h,execDurationMs:L,triplesScanned:f.length});console.log(JSON.stringify(Xe,null,2))}else console.log(`\u2705 Generated ${F.length} triple(s) in ${L}ms
`),F.length>0?eF(F,e.format):console.log("No triples generated."),e.stats&&(console.log(`
\u{1F4CA} Execution Statistics:`),console.log(`  Vault loading: ${h}ms`),console.log(`  Query execution: ${L}ms`),console.log(`  Total time: ${$}ms`),console.log(`  Triples scanned: ${f.length}`),console.log(`  Triples generated: ${F.length}`))}else{let F=await P.executeAll(S),L=Date.now()-x,$=Date.now()-n;if(t==="json"){let K=F.map(at=>at.toJSON()),Fe={query:i,count:F.length,bindings:K},Xe=Wt.success(Fe,{durationMs:$,itemCount:F.length,loadDurationMs:h,execDurationMs:L,triplesScanned:f.length});console.log(JSON.stringify(Xe,null,2))}else console.log(`\u2705 Found ${F.length} result(s) in ${L}ms
`),F.length>0?ZP(F,e.format):console.log("No results found."),e.stats&&(console.log(`
\u{1F4CA} Execution Statistics:`),console.log(`  Vault loading: ${h}ms`),console.log(`  Query execution: ${L}ms`),console.log(`  Total time: ${$}ms`),console.log(`  Triples scanned: ${f.length}`),console.log(`  Results returned: ${F.length}`))}}catch(n){Re.handle(n)}})}o(Ev,"sparqlQueryCommand");function XP(r){if(r.includes("SELECT")||r.includes("CONSTRUCT"))return r;let e=(0,Pm.resolve)(r);return(0,go.existsSync)(e)?(0,go.readFileSync)(e,"utf-8"):r}o(XP,"loadQuery");function ZP(r,e){switch(e){case"json":let t=new pl;console.log(t.format(r));break;case"table":default:let n=new dl;console.log(n.format(r));break}}o(ZP,"formatSelectResults");function eF(r,e){let t=new po;switch(e){case"json":console.log(t.formatJson(r));break;case"ntriples":console.log(t.formatNTriples(r));break;case"table":default:console.log(t.formatTable(r));break}}o(eF,"formatConstructResults");var PS=require("path");var vt=Qe(Xs()),Pi=Qe(require("path"));var Wv=Qe(jv(),1);var _o=o(r=>{if(typeof r!="string")throw new TypeError("invalid pattern");if(r.length>65536)throw new TypeError("pattern is too long")},"assertValidPattern");var cF={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},vo=o(r=>r.replace(/[[\]\\-]/g,"\\$&"),"braceEscape"),uF=o(r=>r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"regexpEscape"),Mv=o(r=>r.join(""),"rangesToString"),Lv=o((r,e)=>{let t=e;if(r.charAt(t)!=="[")throw new Error("not in a brace expression");let n=[],i=[],s=t+1,a=!1,c=!1,u=!1,f=!1,l=t,h="";e:for(;s<r.length;){let S=r.charAt(s);if((S==="!"||S==="^")&&s===t+1){f=!0,s++;continue}if(S==="]"&&a&&!u){l=s+1;break}if(a=!0,S==="\\"&&!u){u=!0,s++;continue}if(S==="["&&!u){for(let[x,[P,F,L]]of Object.entries(cF))if(r.startsWith(x,s)){if(h)return["$.",!1,r.length-t,!0];s+=x.length,L?i.push(P):n.push(P),c=c||F;continue e}}if(u=!1,h){S>h?n.push(vo(h)+"-"+vo(S)):S===h&&n.push(vo(S)),h="",s++;continue}if(r.startsWith("-]",s+1)){n.push(vo(S+"-")),s+=2;continue}if(r.startsWith("-",s+1)){h=S,s+=2;continue}n.push(vo(S)),s++}if(l<s)return["",!1,0,!1];if(!n.length&&!i.length)return["$.",!1,r.length-t,!0];if(i.length===0&&n.length===1&&/^\\?.$/.test(n[0])&&!f){let S=n[0].length===2?n[0].slice(-1):n[0];return[uF(S),!1,l-t,!1]}let p="["+(f?"^":"")+Mv(n)+"]",g="["+(f?"":"^")+Mv(i)+"]";return[n.length&&i.length?"("+p+"|"+g+")":n.length?p:g,c,l-t,!0]},"parseClass");var un=o((r,{windowsPathsNoEscape:e=!1}={})=>e?r.replace(/\[([^\/\\])\]/g,"$1"):r.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1"),"unescape");var lF=new Set(["!","?","+","*","@"]),Vv=o(r=>lF.has(r),"isExtglobType"),fF="(?!(?:^|/)\\.\\.?(?:$|/))",ml="(?!\\.)",hF=new Set(["[","."]),dF=new Set(["..","."]),pF=new Set("().*{}+?[]^$\\!"),mF=o(r=>r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"regExpEscape"),Rm="[^/]",qv=Rm+"*?",Bv=Rm+"+?",na=class r{static{o(this,"AST")}type;#e;#t;#s=!1;#n=[];#a;#S;#u;#f=!1;#o;#c;#i=!1;constructor(e,t,n={}){this.type=e,e&&(this.#t=!0),this.#a=t,this.#e=this.#a?this.#a.#e:this,this.#o=this.#e===this?n:this.#e.#o,this.#u=this.#e===this?[]:this.#e.#u,e==="!"&&!this.#e.#f&&this.#u.push(this),this.#S=this.#a?this.#a.#n.length:0}get hasMagic(){if(this.#t!==void 0)return this.#t;for(let e of this.#n)if(typeof e!="string"&&(e.type||e.hasMagic))return this.#t=!0;return this.#t}toString(){return this.#c!==void 0?this.#c:this.type?this.#c=this.type+"("+this.#n.map(e=>String(e)).join("|")+")":this.#c=this.#n.map(e=>String(e)).join("")}#g(){if(this!==this.#e)throw new Error("should only call on root");if(this.#f)return this;this.toString(),this.#f=!0;let e;for(;e=this.#u.pop();){if(e.type!=="!")continue;let t=e,n=t.#a;for(;n;){for(let i=t.#S+1;!n.type&&i<n.#n.length;i++)for(let s of e.#n){if(typeof s=="string")throw new Error("string part in extglob AST??");s.copyIn(n.#n[i])}t=n,n=t.#a}}return this}push(...e){for(let t of e)if(t!==""){if(typeof t!="string"&&!(t instanceof r&&t.#a===this))throw new Error("invalid part: "+t);this.#n.push(t)}}toJSON(){let e=this.type===null?this.#n.slice().map(t=>typeof t=="string"?t:t.toJSON()):[this.type,...this.#n.map(t=>t.toJSON())];return this.isStart()&&!this.type&&e.unshift([]),this.isEnd()&&(this===this.#e||this.#e.#f&&this.#a?.type==="!")&&e.push({}),e}isStart(){if(this.#e===this)return!0;if(!this.#a?.isStart())return!1;if(this.#S===0)return!0;let e=this.#a;for(let t=0;t<this.#S;t++){let n=e.#n[t];if(!(n instanceof r&&n.type==="!"))return!1}return!0}isEnd(){if(this.#e===this||this.#a?.type==="!")return!0;if(!this.#a?.isEnd())return!1;if(!this.type)return this.#a?.isEnd();let e=this.#a?this.#a.#n.length:0;return this.#S===e-1}copyIn(e){typeof e=="string"?this.push(e):this.push(e.clone(this))}clone(e){let t=new r(this.type,e);for(let n of this.#n)t.copyIn(n);return t}static#y(e,t,n,i){let s=!1,a=!1,c=-1,u=!1;if(t.type===null){let g=n,w="";for(;g<e.length;){let S=e.charAt(g++);if(s||S==="\\"){s=!s,w+=S;continue}if(a){g===c+1?(S==="^"||S==="!")&&(u=!0):S==="]"&&!(g===c+2&&u)&&(a=!1),w+=S;continue}else if(S==="["){a=!0,c=g,u=!1,w+=S;continue}if(!i.noext&&Vv(S)&&e.charAt(g)==="("){t.push(w),w="";let x=new r(S,t);g=r.#y(e,x,g,i),t.push(x);continue}w+=S}return t.push(w),g}let f=n+1,l=new r(null,t),h=[],p="";for(;f<e.length;){let g=e.charAt(f++);if(s||g==="\\"){s=!s,p+=g;continue}if(a){f===c+1?(g==="^"||g==="!")&&(u=!0):g==="]"&&!(f===c+2&&u)&&(a=!1),p+=g;continue}else if(g==="["){a=!0,c=f,u=!1,p+=g;continue}if(Vv(g)&&e.charAt(f)==="("){l.push(p),p="";let w=new r(g,l);l.push(w),f=r.#y(e,w,f,i);continue}if(g==="|"){l.push(p),p="",h.push(l),l=new r(null,t);continue}if(g===")")return p===""&&t.#n.length===0&&(t.#i=!0),l.push(p),p="",t.push(...h,l),f;p+=g}return t.type=null,t.#t=void 0,t.#n=[e.substring(n-1)],f}static fromGlob(e,t={}){let n=new r(null,void 0,t);return r.#y(e,n,0,t),n}toMMPattern(){if(this!==this.#e)return this.#e.toMMPattern();let e=this.toString(),[t,n,i,s]=this.toRegExpSource();if(!(i||this.#t||this.#o.nocase&&!this.#o.nocaseMagicOnly&&e.toUpperCase()!==e.toLowerCase()))return n;let c=(this.#o.nocase?"i":"")+(s?"u":"");return Object.assign(new RegExp(`^${t}$`,c),{_src:t,_glob:e})}get options(){return this.#o}toRegExpSource(e){let t=e??!!this.#o.dot;if(this.#e===this&&this.#g(),!this.type){let u=this.isStart()&&this.isEnd(),f=this.#n.map(g=>{let[w,S,x,P]=typeof g=="string"?r.#h(g,this.#t,u):g.toRegExpSource(e);return this.#t=this.#t||x,this.#s=this.#s||P,w}).join(""),l="";if(this.isStart()&&typeof this.#n[0]=="string"&&!(this.#n.length===1&&dF.has(this.#n[0]))){let w=hF,S=t&&w.has(f.charAt(0))||f.startsWith("\\.")&&w.has(f.charAt(2))||f.startsWith("\\.\\.")&&w.has(f.charAt(4)),x=!t&&!e&&w.has(f.charAt(0));l=S?fF:x?ml:""}let h="";return this.isEnd()&&this.#e.#f&&this.#a?.type==="!"&&(h="(?:$|\\/)"),[l+f+h,un(f),this.#t=!!this.#t,this.#s]}let n=this.type==="*"||this.type==="+",i=this.type==="!"?"(?:(?!(?:":"(?:",s=this.#d(t);if(this.isStart()&&this.isEnd()&&!s&&this.type!=="!"){let u=this.toString();return this.#n=[u],this.type=null,this.#t=void 0,[u,un(this.toString()),!1,!1]}let a=!n||e||t||!ml?"":this.#d(!0);a===s&&(a=""),a&&(s=`(?:${s})(?:${a})*?`);let c="";if(this.type==="!"&&this.#i)c=(this.isStart()&&!t?ml:"")+Bv;else{let u=this.type==="!"?"))"+(this.isStart()&&!t&&!e?ml:"")+qv+")":this.type==="@"?")":this.type==="?"?")?":this.type==="+"&&a?")":this.type==="*"&&a?")?":`)${this.type}`;c=i+s+u}return[c,un(s),this.#t=!!this.#t,this.#s]}#d(e){return this.#n.map(t=>{if(typeof t=="string")throw new Error("string type in extglob ast??");let[n,i,s,a]=t.toRegExpSource(e);return this.#s=this.#s||a,n}).filter(t=>!(this.isStart()&&this.isEnd())||!!t).join("|")}static#h(e,t,n=!1){let i=!1,s="",a=!1;for(let c=0;c<e.length;c++){let u=e.charAt(c);if(i){i=!1,s+=(pF.has(u)?"\\":"")+u;continue}if(u==="\\"){c===e.length-1?s+="\\\\":i=!0;continue}if(u==="["){let[f,l,h,p]=Lv(e,c);if(h){s+=f,a=a||l,c+=h-1,t=t||p;continue}}if(u==="*"){n&&e==="*"?s+=Bv:s+=qv,t=!0;continue}if(u==="?"){s+=Rm,t=!0;continue}s+=mF(u)}return[s,un(e),!!t,a]}};var ia=o((r,{windowsPathsNoEscape:e=!1}={})=>e?r.replace(/[?*()[\]]/g,"[$&]"):r.replace(/[?*()[\]\\]/g,"\\$&"),"escape");var jt=o((r,e,t={})=>(_o(e),!t.nocomment&&e.charAt(0)==="#"?!1:new Ar(e,t).match(r)),"minimatch"),gF=/^\*+([^+@!?\*\[\(]*)$/,yF=o(r=>e=>!e.startsWith(".")&&e.endsWith(r),"starDotExtTest"),_F=o(r=>e=>e.endsWith(r),"starDotExtTestDot"),vF=o(r=>(r=r.toLowerCase(),e=>!e.startsWith(".")&&e.toLowerCase().endsWith(r)),"starDotExtTestNocase"),SF=o(r=>(r=r.toLowerCase(),e=>e.toLowerCase().endsWith(r)),"starDotExtTestNocaseDot"),wF=/^\*+\.\*+$/,bF=o(r=>!r.startsWith(".")&&r.includes("."),"starDotStarTest"),EF=o(r=>r!=="."&&r!==".."&&r.includes("."),"starDotStarTestDot"),TF=/^\.\*+$/,AF=o(r=>r!=="."&&r!==".."&&r.startsWith("."),"dotStarTest"),xF=/^\*+$/,OF=o(r=>r.length!==0&&!r.startsWith("."),"starTest"),CF=o(r=>r.length!==0&&r!=="."&&r!=="..","starTestDot"),PF=/^\?+([^+@!?\*\[\(]*)?$/,FF=o(([r,e=""])=>{let t=Gv([r]);return e?(e=e.toLowerCase(),n=>t(n)&&n.toLowerCase().endsWith(e)):t},"qmarksTestNocase"),IF=o(([r,e=""])=>{let t=Hv([r]);return e?(e=e.toLowerCase(),n=>t(n)&&n.toLowerCase().endsWith(e)):t},"qmarksTestNocaseDot"),RF=o(([r,e=""])=>{let t=Hv([r]);return e?n=>t(n)&&n.endsWith(e):t},"qmarksTestDot"),DF=o(([r,e=""])=>{let t=Gv([r]);return e?n=>t(n)&&n.endsWith(e):t},"qmarksTest"),Gv=o(([r])=>{let e=r.length;return t=>t.length===e&&!t.startsWith(".")},"qmarksTestNoExt"),Hv=o(([r])=>{let e=r.length;return t=>t.length===e&&t!=="."&&t!==".."},"qmarksTestNoExtDot"),zv=typeof process=="object"&&process?typeof process.env=="object"&&process.env&&process.env.__MINIMATCH_TESTING_PLATFORM__||process.platform:"posix",Uv={win32:{sep:"\\"},posix:{sep:"/"}},NF=zv==="win32"?Uv.win32.sep:Uv.posix.sep;jt.sep=NF;var kt=Symbol("globstar **");jt.GLOBSTAR=kt;var kF="[^/]",jF=kF+"*?",MF="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",LF="(?:(?!(?:\\/|^)\\.).)*?",VF=o((r,e={})=>t=>jt(t,r,e),"filter");jt.filter=VF;var Nr=o((r,e={})=>Object.assign({},r,e),"ext"),qF=o(r=>{if(!r||typeof r!="object"||!Object.keys(r).length)return jt;let e=jt;return Object.assign(o((n,i,s={})=>e(n,i,Nr(r,s)),"m"),{Minimatch:class extends e.Minimatch{static{o(this,"Minimatch")}constructor(i,s={}){super(i,Nr(r,s))}static defaults(i){return e.defaults(Nr(r,i)).Minimatch}},AST:class extends e.AST{static{o(this,"AST")}constructor(i,s,a={}){super(i,s,Nr(r,a))}static fromGlob(i,s={}){return e.AST.fromGlob(i,Nr(r,s))}},unescape:o((n,i={})=>e.unescape(n,Nr(r,i)),"unescape"),escape:o((n,i={})=>e.escape(n,Nr(r,i)),"escape"),filter:o((n,i={})=>e.filter(n,Nr(r,i)),"filter"),defaults:o(n=>e.defaults(Nr(r,n)),"defaults"),makeRe:o((n,i={})=>e.makeRe(n,Nr(r,i)),"makeRe"),braceExpand:o((n,i={})=>e.braceExpand(n,Nr(r,i)),"braceExpand"),match:o((n,i,s={})=>e.match(n,i,Nr(r,s)),"match"),sep:e.sep,GLOBSTAR:kt})},"defaults");jt.defaults=qF;var Kv=o((r,e={})=>(_o(r),e.nobrace||!/\{(?:(?!\{).)*\}/.test(r)?[r]:(0,Wv.default)(r)),"braceExpand");jt.braceExpand=Kv;var BF=o((r,e={})=>new Ar(r,e).makeRe(),"makeRe");jt.makeRe=BF;var UF=o((r,e,t={})=>{let n=new Ar(e,t);return r=r.filter(i=>n.match(i)),n.options.nonull&&!r.length&&r.push(e),r},"match");jt.match=UF;var $v=/[?*]|[+@!]\(.*?\)|\[|\]/,$F=o(r=>r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"regExpEscape"),Ar=class{static{o(this,"Minimatch")}options;set;pattern;windowsPathsNoEscape;nonegate;negate;comment;empty;preserveMultipleSlashes;partial;globSet;globParts;nocase;isWindows;platform;windowsNoMagicRoot;regexp;constructor(e,t={}){_o(e),t=t||{},this.options=t,this.pattern=e,this.platform=t.platform||zv,this.isWindows=this.platform==="win32",this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!t.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!t.nonegate,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=t.windowsNoMagicRoot!==void 0?t.windowsNoMagicRoot:!!(this.isWindows&&this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1)return!0;for(let e of this.set)for(let t of e)if(typeof t!="string")return!0;return!1}debug(...e){}make(){let e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate(),this.globSet=[...new Set(this.braceExpand())],t.debug&&(this.debug=(...s)=>console.error(...s)),this.debug(this.pattern,this.globSet);let n=this.globSet.map(s=>this.slashSplit(s));this.globParts=this.preprocess(n),this.debug(this.pattern,this.globParts);let i=this.globParts.map((s,a,c)=>{if(this.isWindows&&this.windowsNoMagicRoot){let u=s[0]===""&&s[1]===""&&(s[2]==="?"||!$v.test(s[2]))&&!$v.test(s[3]),f=/^[a-z]:/i.test(s[0]);if(u)return[...s.slice(0,4),...s.slice(4).map(l=>this.parse(l))];if(f)return[s[0],...s.slice(1).map(l=>this.parse(l))]}return s.map(u=>this.parse(u))});if(this.debug(this.pattern,i),this.set=i.filter(s=>s.indexOf(!1)===-1),this.isWindows)for(let s=0;s<this.set.length;s++){let a=this.set[s];a[0]===""&&a[1]===""&&this.globParts[s][2]==="?"&&typeof a[3]=="string"&&/^[a-z]:$/i.test(a[3])&&(a[2]="?")}this.debug(this.pattern,this.set)}preprocess(e){if(this.options.noglobstar)for(let n=0;n<e.length;n++)for(let i=0;i<e[n].length;i++)e[n][i]==="**"&&(e[n][i]="*");let{optimizationLevel:t=1}=this.options;return t>=2?(e=this.firstPhasePreProcess(e),e=this.secondPhasePreProcess(e)):t>=1?e=this.levelOneOptimize(e):e=this.adjascentGlobstarOptimize(e),e}adjascentGlobstarOptimize(e){return e.map(t=>{let n=-1;for(;(n=t.indexOf("**",n+1))!==-1;){let i=n;for(;t[i+1]==="**";)i++;i!==n&&t.splice(n,i-n)}return t})}levelOneOptimize(e){return e.map(t=>(t=t.reduce((n,i)=>{let s=n[n.length-1];return i==="**"&&s==="**"?n:i===".."&&s&&s!==".."&&s!=="."&&s!=="**"?(n.pop(),n):(n.push(i),n)},[]),t.length===0?[""]:t))}levelTwoFileOptimize(e){Array.isArray(e)||(e=this.slashSplit(e));let t=!1;do{if(t=!1,!this.preserveMultipleSlashes){for(let i=1;i<e.length-1;i++){let s=e[i];i===1&&s===""&&e[0]===""||(s==="."||s==="")&&(t=!0,e.splice(i,1),i--)}e[0]==="."&&e.length===2&&(e[1]==="."||e[1]==="")&&(t=!0,e.pop())}let n=0;for(;(n=e.indexOf("..",n+1))!==-1;){let i=e[n-1];i&&i!=="."&&i!==".."&&i!=="**"&&(t=!0,e.splice(n-1,2),n-=2)}}while(t);return e.length===0?[""]:e}firstPhasePreProcess(e){let t=!1;do{t=!1;for(let n of e){let i=-1;for(;(i=n.indexOf("**",i+1))!==-1;){let a=i;for(;n[a+1]==="**";)a++;a>i&&n.splice(i+1,a-i);let c=n[i+1],u=n[i+2],f=n[i+3];if(c!==".."||!u||u==="."||u===".."||!f||f==="."||f==="..")continue;t=!0,n.splice(i,1);let l=n.slice(0);l[i]="**",e.push(l),i--}if(!this.preserveMultipleSlashes){for(let a=1;a<n.length-1;a++){let c=n[a];a===1&&c===""&&n[0]===""||(c==="."||c==="")&&(t=!0,n.splice(a,1),a--)}n[0]==="."&&n.length===2&&(n[1]==="."||n[1]==="")&&(t=!0,n.pop())}let s=0;for(;(s=n.indexOf("..",s+1))!==-1;){let a=n[s-1];if(a&&a!=="."&&a!==".."&&a!=="**"){t=!0;let u=s===1&&n[s+1]==="**"?["."]:[];n.splice(s-1,2,...u),n.length===0&&n.push(""),s-=2}}}}while(t);return e}secondPhasePreProcess(e){for(let t=0;t<e.length-1;t++)for(let n=t+1;n<e.length;n++){let i=this.partsMatch(e[t],e[n],!this.preserveMultipleSlashes);if(i){e[t]=[],e[n]=i;break}}return e.filter(t=>t.length)}partsMatch(e,t,n=!1){let i=0,s=0,a=[],c="";for(;i<e.length&&s<t.length;)if(e[i]===t[s])a.push(c==="b"?t[s]:e[i]),i++,s++;else if(n&&e[i]==="**"&&t[s]===e[i+1])a.push(e[i]),i++;else if(n&&t[s]==="**"&&e[i]===t[s+1])a.push(t[s]),s++;else if(e[i]==="*"&&t[s]&&(this.options.dot||!t[s].startsWith("."))&&t[s]!=="**"){if(c==="b")return!1;c="a",a.push(e[i]),i++,s++}else if(t[s]==="*"&&e[i]&&(this.options.dot||!e[i].startsWith("."))&&e[i]!=="**"){if(c==="a")return!1;c="b",a.push(t[s]),i++,s++}else return!1;return e.length===t.length&&a}parseNegate(){if(this.nonegate)return;let e=this.pattern,t=!1,n=0;for(let i=0;i<e.length&&e.charAt(i)==="!";i++)t=!t,n++;n&&(this.pattern=e.slice(n)),this.negate=t}matchOne(e,t,n=!1){let i=this.options;if(this.isWindows){let S=typeof e[0]=="string"&&/^[a-z]:$/i.test(e[0]),x=!S&&e[0]===""&&e[1]===""&&e[2]==="?"&&/^[a-z]:$/i.test(e[3]),P=typeof t[0]=="string"&&/^[a-z]:$/i.test(t[0]),F=!P&&t[0]===""&&t[1]===""&&t[2]==="?"&&typeof t[3]=="string"&&/^[a-z]:$/i.test(t[3]),L=x?3:S?0:void 0,$=F?3:P?0:void 0;if(typeof L=="number"&&typeof $=="number"){let[K,Fe]=[e[L],t[$]];K.toLowerCase()===Fe.toLowerCase()&&(t[$]=K,$>L?t=t.slice($):L>$&&(e=e.slice(L)))}}let{optimizationLevel:s=1}=this.options;s>=2&&(e=this.levelTwoFileOptimize(e)),this.debug("matchOne",this,{file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var a=0,c=0,u=e.length,f=t.length;a<u&&c<f;a++,c++){this.debug("matchOne loop");var l=t[c],h=e[a];if(this.debug(t,l,h),l===!1)return!1;if(l===kt){this.debug("GLOBSTAR",[t,l,h]);var p=a,g=c+1;if(g===f){for(this.debug("** at the end");a<u;a++)if(e[a]==="."||e[a]===".."||!i.dot&&e[a].charAt(0)===".")return!1;return!0}for(;p<u;){var w=e[p];if(this.debug(`
globstar while`,e,p,t,g,w),this.matchOne(e.slice(p),t.slice(g),n))return this.debug("globstar found match!",p,u,w),!0;if(w==="."||w===".."||!i.dot&&w.charAt(0)==="."){this.debug("dot detected!",e,p,t,g);break}this.debug("globstar swallow a segment, and continue"),p++}return!!(n&&(this.debug(`
>>> no match, partial?`,e,p,t,g),p===u))}let S;if(typeof l=="string"?(S=h===l,this.debug("string match",l,h,S)):(S=l.test(h),this.debug("pattern match",l,h,S)),!S)return!1}if(a===u&&c===f)return!0;if(a===u)return n;if(c===f)return a===u-1&&e[a]==="";throw new Error("wtf?")}braceExpand(){return Kv(this.pattern,this.options)}parse(e){_o(e);let t=this.options;if(e==="**")return kt;if(e==="")return"";let n,i=null;(n=e.match(xF))?i=t.dot?CF:OF:(n=e.match(gF))?i=(t.nocase?t.dot?SF:vF:t.dot?_F:yF)(n[1]):(n=e.match(PF))?i=(t.nocase?t.dot?IF:FF:t.dot?RF:DF)(n):(n=e.match(wF))?i=t.dot?EF:bF:(n=e.match(TF))&&(i=AF);let s=na.fromGlob(e,this.options).toMMPattern();return i&&typeof s=="object"&&Reflect.defineProperty(s,"test",{value:i}),s}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let e=this.set;if(!e.length)return this.regexp=!1,this.regexp;let t=this.options,n=t.noglobstar?jF:t.dot?MF:LF,i=new Set(t.nocase?["i"]:[]),s=e.map(u=>{let f=u.map(l=>{if(l instanceof RegExp)for(let h of l.flags.split(""))i.add(h);return typeof l=="string"?$F(l):l===kt?kt:l._src});return f.forEach((l,h)=>{let p=f[h+1],g=f[h-1];l!==kt||g===kt||(g===void 0?p!==void 0&&p!==kt?f[h+1]="(?:\\/|"+n+"\\/)?"+p:f[h]=n:p===void 0?f[h-1]=g+"(?:\\/|"+n+")?":p!==kt&&(f[h-1]=g+"(?:\\/|\\/"+n+"\\/)"+p,f[h+1]=kt))}),f.filter(l=>l!==kt).join("/")}).join("|"),[a,c]=e.length>1?["(?:",")"]:["",""];s="^"+a+s+c+"$",this.negate&&(s="^(?!"+s+").+$");try{this.regexp=new RegExp(s,[...i].join(""))}catch{this.regexp=!1}return this.regexp}slashSplit(e){return this.preserveMultipleSlashes?e.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(e)?["",...e.split(/\/+/)]:e.split(/\/+/)}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;let n=this.options;this.isWindows&&(e=e.split("\\").join("/"));let i=this.slashSplit(e);this.debug(this.pattern,"split",i);let s=this.set;this.debug(this.pattern,"set",s);let a=i[i.length-1];if(!a)for(let c=i.length-2;!a&&c>=0;c--)a=i[c];for(let c=0;c<s.length;c++){let u=s[c],f=i;if(n.matchBase&&u.length===1&&(f=[a]),this.matchOne(f,u,t))return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}static defaults(e){return jt.defaults(e).Minimatch}};jt.AST=na;jt.Minimatch=Ar;jt.escape=ia;jt.unescape=un;var _S=require("node:url");var sa=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,Qv=new Set,Dm=typeof process=="object"&&process?process:{},Jv=o((r,e,t,n)=>{typeof Dm.emitWarning=="function"?Dm.emitWarning(r,e,t,n):console.error(`[${t}] ${e}: ${r}`)},"emitWarning"),gl=globalThis.AbortController,Yv=globalThis.AbortSignal;if(typeof gl>"u"){Yv=class{static{o(this,"AbortSignal")}onabort;_onabort=[];reason;aborted=!1;addEventListener(n,i){this._onabort.push(i)}},gl=class{static{o(this,"AbortController")}constructor(){e()}signal=new Yv;abort(n){if(!this.signal.aborted){this.signal.reason=n,this.signal.aborted=!0;for(let i of this.signal._onabort)i(n);this.signal.onabort?.(n)}}};let r=Dm.env?.LRU_CACHE_IGNORE_AC_WARNING!=="1",e=o(()=>{r&&(r=!1,Jv("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))},"warnACPolyfill")}var WF=o(r=>!Qv.has(r),"shouldWarn"),kq=Symbol("type"),Ai=o(r=>r&&r===Math.floor(r)&&r>0&&isFinite(r),"isPosInt"),Xv=o(r=>Ai(r)?r<=Math.pow(2,8)?Uint8Array:r<=Math.pow(2,16)?Uint16Array:r<=Math.pow(2,32)?Uint32Array:r<=Number.MAX_SAFE_INTEGER?aa:null:null,"getUintArray"),aa=class extends Array{static{o(this,"ZeroArray")}constructor(e){super(e),this.fill(0)}},Nm=class r{static{o(this,"Stack")}heap;length;static#e=!1;static create(e){let t=Xv(e);if(!t)return[];r.#e=!0;let n=new r(e,t);return r.#e=!1,n}constructor(e,t){if(!r.#e)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}},So=class r{static{o(this,"LRUCache")}#e;#t;#s;#n;#a;#S;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#u;#f;#o;#c;#i;#g;#y;#d;#h;#E;#m;#T;#A;#v;#w;#b;#p;static unsafeExposeInternals(e){return{starts:e.#A,ttls:e.#v,sizes:e.#T,keyMap:e.#o,keyList:e.#c,valList:e.#i,next:e.#g,prev:e.#y,get head(){return e.#d},get tail(){return e.#h},free:e.#E,isBackgroundFetch:o(t=>e.#l(t),"isBackgroundFetch"),backgroundFetch:o((t,n,i,s)=>e.#L(t,n,i,s),"backgroundFetch"),moveToTail:o(t=>e.#q(t),"moveToTail"),indexes:o(t=>e.#O(t),"indexes"),rindexes:o(t=>e.#C(t),"rindexes"),isStale:o(t=>e.#_(t),"isStale")}}get max(){return this.#e}get maxSize(){return this.#t}get calculatedSize(){return this.#f}get size(){return this.#u}get fetchMethod(){return this.#a}get memoMethod(){return this.#S}get dispose(){return this.#s}get disposeAfter(){return this.#n}constructor(e){let{max:t=0,ttl:n,ttlResolution:i=1,ttlAutopurge:s,updateAgeOnGet:a,updateAgeOnHas:c,allowStale:u,dispose:f,disposeAfter:l,noDisposeOnSet:h,noUpdateTTL:p,maxSize:g=0,maxEntrySize:w=0,sizeCalculation:S,fetchMethod:x,memoMethod:P,noDeleteOnFetchRejection:F,noDeleteOnStaleGet:L,allowStaleOnFetchRejection:$,allowStaleOnFetchAbort:K,ignoreFetchAbort:Fe}=e;if(t!==0&&!Ai(t))throw new TypeError("max option must be a nonnegative integer");let Xe=t?Xv(t):Array;if(!Xe)throw new Error("invalid max value: "+t);if(this.#e=t,this.#t=g,this.maxEntrySize=w||this.#t,this.sizeCalculation=S,this.sizeCalculation){if(!this.#t&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(P!==void 0&&typeof P!="function")throw new TypeError("memoMethod must be a function if defined");if(this.#S=P,x!==void 0&&typeof x!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.#a=x,this.#b=!!x,this.#o=new Map,this.#c=new Array(t).fill(void 0),this.#i=new Array(t).fill(void 0),this.#g=new Xe(t),this.#y=new Xe(t),this.#d=0,this.#h=0,this.#E=Nm.create(t),this.#u=0,this.#f=0,typeof f=="function"&&(this.#s=f),typeof l=="function"?(this.#n=l,this.#m=[]):(this.#n=void 0,this.#m=void 0),this.#w=!!this.#s,this.#p=!!this.#n,this.noDisposeOnSet=!!h,this.noUpdateTTL=!!p,this.noDeleteOnFetchRejection=!!F,this.allowStaleOnFetchRejection=!!$,this.allowStaleOnFetchAbort=!!K,this.ignoreFetchAbort=!!Fe,this.maxEntrySize!==0){if(this.#t!==0&&!Ai(this.#t))throw new TypeError("maxSize must be a positive integer if specified");if(!Ai(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#F()}if(this.allowStale=!!u,this.noDeleteOnStaleGet=!!L,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!c,this.ttlResolution=Ai(i)||i===0?i:1,this.ttlAutopurge=!!s,this.ttl=n||0,this.ttl){if(!Ai(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#P()}if(this.#e===0&&this.ttl===0&&this.#t===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#e&&!this.#t){let at="LRU_CACHE_UNBOUNDED";WF(at)&&(Qv.add(at),Jv("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",at,r))}}getRemainingTTL(e){return this.#o.has(e)?1/0:0}#P(){let e=new aa(this.#e),t=new aa(this.#e);this.#v=e,this.#A=t,this.#R=(s,a,c=sa.now())=>{if(t[s]=a!==0?c:0,e[s]=a,a!==0&&this.ttlAutopurge){let u=setTimeout(()=>{this.#_(s)&&this.#I(this.#c[s],"expire")},a+1);u.unref&&u.unref()}},this.#x=s=>{t[s]=e[s]!==0?sa.now():0},this.#r=(s,a)=>{if(e[a]){let c=e[a],u=t[a];if(!c||!u)return;s.ttl=c,s.start=u,s.now=n||i();let f=s.now-u;s.remainingTTL=c-f}};let n=0,i=o(()=>{let s=sa.now();if(this.ttlResolution>0){n=s;let a=setTimeout(()=>n=0,this.ttlResolution);a.unref&&a.unref()}return s},"getNow");this.getRemainingTTL=s=>{let a=this.#o.get(s);if(a===void 0)return 0;let c=e[a],u=t[a];if(!c||!u)return 1/0;let f=(n||i())-u;return c-f},this.#_=s=>{let a=t[s],c=e[s];return!!c&&!!a&&(n||i())-a>c}}#x=o(()=>{},"#updateItemAge");#r=o(()=>{},"#statusTTL");#R=o(()=>{},"#setItemTTL");#_=o(()=>!1,"#isStale");#F(){let e=new aa(this.#e);this.#f=0,this.#T=e,this.#D=t=>{this.#f-=e[t],e[t]=0},this.#k=(t,n,i,s)=>{if(this.#l(n))return 0;if(!Ai(i))if(s){if(typeof s!="function")throw new TypeError("sizeCalculation must be a function");if(i=s(n,t),!Ai(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i},this.#N=(t,n,i)=>{if(e[t]=n,this.#t){let s=this.#t-e[t];for(;this.#f>s;)this.#M(!0)}this.#f+=e[t],i&&(i.entrySize=n,i.totalCalculatedSize=this.#f)}}#D=o(e=>{},"#removeItemSize");#N=o((e,t,n)=>{},"#addItemSize");#k=o((e,t,n,i)=>{if(n||i)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0},"#requireSize");*#O({allowStale:e=this.allowStale}={}){if(this.#u)for(let t=this.#h;!(!this.#j(t)||((e||!this.#_(t))&&(yield t),t===this.#d));)t=this.#y[t]}*#C({allowStale:e=this.allowStale}={}){if(this.#u)for(let t=this.#d;!(!this.#j(t)||((e||!this.#_(t))&&(yield t),t===this.#h));)t=this.#g[t]}#j(e){return e!==void 0&&this.#o.get(this.#c[e])===e}*entries(){for(let e of this.#O())this.#i[e]!==void 0&&this.#c[e]!==void 0&&!this.#l(this.#i[e])&&(yield[this.#c[e],this.#i[e]])}*rentries(){for(let e of this.#C())this.#i[e]!==void 0&&this.#c[e]!==void 0&&!this.#l(this.#i[e])&&(yield[this.#c[e],this.#i[e]])}*keys(){for(let e of this.#O()){let t=this.#c[e];t!==void 0&&!this.#l(this.#i[e])&&(yield t)}}*rkeys(){for(let e of this.#C()){let t=this.#c[e];t!==void 0&&!this.#l(this.#i[e])&&(yield t)}}*values(){for(let e of this.#O())this.#i[e]!==void 0&&!this.#l(this.#i[e])&&(yield this.#i[e])}*rvalues(){for(let e of this.#C())this.#i[e]!==void 0&&!this.#l(this.#i[e])&&(yield this.#i[e])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(e,t={}){for(let n of this.#O()){let i=this.#i[n],s=this.#l(i)?i.__staleWhileFetching:i;if(s!==void 0&&e(s,this.#c[n],this))return this.get(this.#c[n],t)}}forEach(e,t=this){for(let n of this.#O()){let i=this.#i[n],s=this.#l(i)?i.__staleWhileFetching:i;s!==void 0&&e.call(t,s,this.#c[n],this)}}rforEach(e,t=this){for(let n of this.#C()){let i=this.#i[n],s=this.#l(i)?i.__staleWhileFetching:i;s!==void 0&&e.call(t,s,this.#c[n],this)}}purgeStale(){let e=!1;for(let t of this.#C({allowStale:!0}))this.#_(t)&&(this.#I(this.#c[t],"expire"),e=!0);return e}info(e){let t=this.#o.get(e);if(t===void 0)return;let n=this.#i[t],i=this.#l(n)?n.__staleWhileFetching:n;if(i===void 0)return;let s={value:i};if(this.#v&&this.#A){let a=this.#v[t],c=this.#A[t];if(a&&c){let u=a-(sa.now()-c);s.ttl=u,s.start=Date.now()}}return this.#T&&(s.size=this.#T[t]),s}dump(){let e=[];for(let t of this.#O({allowStale:!0})){let n=this.#c[t],i=this.#i[t],s=this.#l(i)?i.__staleWhileFetching:i;if(s===void 0||n===void 0)continue;let a={value:s};if(this.#v&&this.#A){a.ttl=this.#v[t];let c=sa.now()-this.#A[t];a.start=Math.floor(Date.now()-c)}this.#T&&(a.size=this.#T[t]),e.unshift([n,a])}return e}load(e){this.clear();for(let[t,n]of e){if(n.start){let i=Date.now()-n.start;n.start=sa.now()-i}this.set(t,n.value,n)}}set(e,t,n={}){if(t===void 0)return this.delete(e),this;let{ttl:i=this.ttl,start:s,noDisposeOnSet:a=this.noDisposeOnSet,sizeCalculation:c=this.sizeCalculation,status:u}=n,{noUpdateTTL:f=this.noUpdateTTL}=n,l=this.#k(e,t,n.size||0,c);if(this.maxEntrySize&&l>this.maxEntrySize)return u&&(u.set="miss",u.maxEntrySizeExceeded=!0),this.#I(e,"set"),this;let h=this.#u===0?void 0:this.#o.get(e);if(h===void 0)h=this.#u===0?this.#h:this.#E.length!==0?this.#E.pop():this.#u===this.#e?this.#M(!1):this.#u,this.#c[h]=e,this.#i[h]=t,this.#o.set(e,h),this.#g[this.#h]=h,this.#y[h]=this.#h,this.#h=h,this.#u++,this.#N(h,l,u),u&&(u.set="add"),f=!1;else{this.#q(h);let p=this.#i[h];if(t!==p){if(this.#b&&this.#l(p)){p.__abortController.abort(new Error("replaced"));let{__staleWhileFetching:g}=p;g!==void 0&&!a&&(this.#w&&this.#s?.(g,e,"set"),this.#p&&this.#m?.push([g,e,"set"]))}else a||(this.#w&&this.#s?.(p,e,"set"),this.#p&&this.#m?.push([p,e,"set"]));if(this.#D(h),this.#N(h,l,u),this.#i[h]=t,u){u.set="replace";let g=p&&this.#l(p)?p.__staleWhileFetching:p;g!==void 0&&(u.oldValue=g)}}else u&&(u.set="update")}if(i!==0&&!this.#v&&this.#P(),this.#v&&(f||this.#R(h,i,s),u&&this.#r(u,h)),!a&&this.#p&&this.#m){let p=this.#m,g;for(;g=p?.shift();)this.#n?.(...g)}return this}pop(){try{for(;this.#u;){let e=this.#i[this.#d];if(this.#M(!0),this.#l(e)){if(e.__staleWhileFetching)return e.__staleWhileFetching}else if(e!==void 0)return e}}finally{if(this.#p&&this.#m){let e=this.#m,t;for(;t=e?.shift();)this.#n?.(...t)}}}#M(e){let t=this.#d,n=this.#c[t],i=this.#i[t];return this.#b&&this.#l(i)?i.__abortController.abort(new Error("evicted")):(this.#w||this.#p)&&(this.#w&&this.#s?.(i,n,"evict"),this.#p&&this.#m?.push([i,n,"evict"])),this.#D(t),e&&(this.#c[t]=void 0,this.#i[t]=void 0,this.#E.push(t)),this.#u===1?(this.#d=this.#h=0,this.#E.length=0):this.#d=this.#g[t],this.#o.delete(n),this.#u--,t}has(e,t={}){let{updateAgeOnHas:n=this.updateAgeOnHas,status:i}=t,s=this.#o.get(e);if(s!==void 0){let a=this.#i[s];if(this.#l(a)&&a.__staleWhileFetching===void 0)return!1;if(this.#_(s))i&&(i.has="stale",this.#r(i,s));else return n&&this.#x(s),i&&(i.has="hit",this.#r(i,s)),!0}else i&&(i.has="miss");return!1}peek(e,t={}){let{allowStale:n=this.allowStale}=t,i=this.#o.get(e);if(i===void 0||!n&&this.#_(i))return;let s=this.#i[i];return this.#l(s)?s.__staleWhileFetching:s}#L(e,t,n,i){let s=t===void 0?void 0:this.#i[t];if(this.#l(s))return s;let a=new gl,{signal:c}=n;c?.addEventListener("abort",()=>a.abort(c.reason),{signal:a.signal});let u={signal:a.signal,options:n,context:i},f=o((S,x=!1)=>{let{aborted:P}=a.signal,F=n.ignoreFetchAbort&&S!==void 0;if(n.status&&(P&&!x?(n.status.fetchAborted=!0,n.status.fetchError=a.signal.reason,F&&(n.status.fetchAbortIgnored=!0)):n.status.fetchResolved=!0),P&&!F&&!x)return h(a.signal.reason);let L=g;return this.#i[t]===g&&(S===void 0?L.__staleWhileFetching?this.#i[t]=L.__staleWhileFetching:this.#I(e,"fetch"):(n.status&&(n.status.fetchUpdated=!0),this.set(e,S,u.options))),S},"cb"),l=o(S=>(n.status&&(n.status.fetchRejected=!0,n.status.fetchError=S),h(S)),"eb"),h=o(S=>{let{aborted:x}=a.signal,P=x&&n.allowStaleOnFetchAbort,F=P||n.allowStaleOnFetchRejection,L=F||n.noDeleteOnFetchRejection,$=g;if(this.#i[t]===g&&(!L||$.__staleWhileFetching===void 0?this.#I(e,"fetch"):P||(this.#i[t]=$.__staleWhileFetching)),F)return n.status&&$.__staleWhileFetching!==void 0&&(n.status.returnedStale=!0),$.__staleWhileFetching;if($.__returned===$)throw S},"fetchFail"),p=o((S,x)=>{let P=this.#a?.(e,s,u);P&&P instanceof Promise&&P.then(F=>S(F===void 0?void 0:F),x),a.signal.addEventListener("abort",()=>{(!n.ignoreFetchAbort||n.allowStaleOnFetchAbort)&&(S(void 0),n.allowStaleOnFetchAbort&&(S=o(F=>f(F,!0),"res")))})},"pcall");n.status&&(n.status.fetchDispatched=!0);let g=new Promise(p).then(f,l),w=Object.assign(g,{__abortController:a,__staleWhileFetching:s,__returned:void 0});return t===void 0?(this.set(e,w,{...u.options,status:void 0}),t=this.#o.get(e)):this.#i[t]=w,w}#l(e){if(!this.#b)return!1;let t=e;return!!t&&t instanceof Promise&&t.hasOwnProperty("__staleWhileFetching")&&t.__abortController instanceof gl}async fetch(e,t={}){let{allowStale:n=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,ttl:a=this.ttl,noDisposeOnSet:c=this.noDisposeOnSet,size:u=0,sizeCalculation:f=this.sizeCalculation,noUpdateTTL:l=this.noUpdateTTL,noDeleteOnFetchRejection:h=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:p=this.allowStaleOnFetchRejection,ignoreFetchAbort:g=this.ignoreFetchAbort,allowStaleOnFetchAbort:w=this.allowStaleOnFetchAbort,context:S,forceRefresh:x=!1,status:P,signal:F}=t;if(!this.#b)return P&&(P.fetch="get"),this.get(e,{allowStale:n,updateAgeOnGet:i,noDeleteOnStaleGet:s,status:P});let L={allowStale:n,updateAgeOnGet:i,noDeleteOnStaleGet:s,ttl:a,noDisposeOnSet:c,size:u,sizeCalculation:f,noUpdateTTL:l,noDeleteOnFetchRejection:h,allowStaleOnFetchRejection:p,allowStaleOnFetchAbort:w,ignoreFetchAbort:g,status:P,signal:F},$=this.#o.get(e);if($===void 0){P&&(P.fetch="miss");let K=this.#L(e,$,L,S);return K.__returned=K}else{let K=this.#i[$];if(this.#l(K)){let ce=n&&K.__staleWhileFetching!==void 0;return P&&(P.fetch="inflight",ce&&(P.returnedStale=!0)),ce?K.__staleWhileFetching:K.__returned=K}let Fe=this.#_($);if(!x&&!Fe)return P&&(P.fetch="hit"),this.#q($),i&&this.#x($),P&&this.#r(P,$),K;let Xe=this.#L(e,$,L,S),B=Xe.__staleWhileFetching!==void 0&&n;return P&&(P.fetch=Fe?"stale":"refresh",B&&Fe&&(P.returnedStale=!0)),B?Xe.__staleWhileFetching:Xe.__returned=Xe}}async forceFetch(e,t={}){let n=await this.fetch(e,t);if(n===void 0)throw new Error("fetch() returned undefined");return n}memo(e,t={}){let n=this.#S;if(!n)throw new Error("no memoMethod provided to constructor");let{context:i,forceRefresh:s,...a}=t,c=this.get(e,a);if(!s&&c!==void 0)return c;let u=n(e,c,{options:a,context:i});return this.set(e,u,a),u}get(e,t={}){let{allowStale:n=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,status:a}=t,c=this.#o.get(e);if(c!==void 0){let u=this.#i[c],f=this.#l(u);return a&&this.#r(a,c),this.#_(c)?(a&&(a.get="stale"),f?(a&&n&&u.__staleWhileFetching!==void 0&&(a.returnedStale=!0),n?u.__staleWhileFetching:void 0):(s||this.#I(e,"expire"),a&&n&&(a.returnedStale=!0),n?u:void 0)):(a&&(a.get="hit"),f?u.__staleWhileFetching:(this.#q(c),i&&this.#x(c),u))}else a&&(a.get="miss")}#V(e,t){this.#y[t]=e,this.#g[e]=t}#q(e){e!==this.#h&&(e===this.#d?this.#d=this.#g[e]:this.#V(this.#y[e],this.#g[e]),this.#V(this.#h,e),this.#h=e)}delete(e){return this.#I(e,"delete")}#I(e,t){let n=!1;if(this.#u!==0){let i=this.#o.get(e);if(i!==void 0)if(n=!0,this.#u===1)this.#B(t);else{this.#D(i);let s=this.#i[i];if(this.#l(s)?s.__abortController.abort(new Error("deleted")):(this.#w||this.#p)&&(this.#w&&this.#s?.(s,e,t),this.#p&&this.#m?.push([s,e,t])),this.#o.delete(e),this.#c[i]=void 0,this.#i[i]=void 0,i===this.#h)this.#h=this.#y[i];else if(i===this.#d)this.#d=this.#g[i];else{let a=this.#y[i];this.#g[a]=this.#g[i];let c=this.#g[i];this.#y[c]=this.#y[i]}this.#u--,this.#E.push(i)}}if(this.#p&&this.#m?.length){let i=this.#m,s;for(;s=i?.shift();)this.#n?.(...s)}return n}clear(){return this.#B("delete")}#B(e){for(let t of this.#C({allowStale:!0})){let n=this.#i[t];if(this.#l(n))n.__abortController.abort(new Error("deleted"));else{let i=this.#c[t];this.#w&&this.#s?.(n,i,e),this.#p&&this.#m?.push([n,i,e])}}if(this.#o.clear(),this.#i.fill(void 0),this.#c.fill(void 0),this.#v&&this.#A&&(this.#v.fill(0),this.#A.fill(0)),this.#T&&this.#T.fill(0),this.#d=0,this.#h=0,this.#E.length=0,this.#f=0,this.#u=0,this.#p&&this.#m){let t=this.#m,n;for(;n=t?.shift();)this.#n?.(...n)}}};var ua=require("node:path"),cS=require("node:url"),Dn=require("fs"),e8=Qe(require("node:fs"),1),Ci=require("node:fs/promises");var El=require("node:events"),Bm=Qe(require("node:stream"),1),nS=require("node:string_decoder");var Zv=typeof process=="object"&&process?process:{stdout:null,stderr:null},GF=o(r=>!!r&&typeof r=="object"&&(r instanceof Oi||r instanceof Bm.default||HF(r)||zF(r)),"isStream"),HF=o(r=>!!r&&typeof r=="object"&&r instanceof El.EventEmitter&&typeof r.pipe=="function"&&r.pipe!==Bm.default.Writable.prototype.pipe,"isReadable"),zF=o(r=>!!r&&typeof r=="object"&&r instanceof El.EventEmitter&&typeof r.write=="function"&&typeof r.end=="function","isWritable"),ti=Symbol("EOF"),ri=Symbol("maybeEmitEnd"),xi=Symbol("emittedEnd"),yl=Symbol("emittingEnd"),wo=Symbol("emittedError"),_l=Symbol("closed"),eS=Symbol("read"),vl=Symbol("flush"),tS=Symbol("flushChunk"),ln=Symbol("encoding"),oa=Symbol("decoder"),Et=Symbol("flowing"),bo=Symbol("paused"),ca=Symbol("resume"),Tt=Symbol("buffer"),or=Symbol("pipes"),At=Symbol("bufferLength"),km=Symbol("bufferPush"),Sl=Symbol("bufferShift"),Gt=Symbol("objectMode"),ut=Symbol("destroyed"),jm=Symbol("error"),Mm=Symbol("emitData"),rS=Symbol("emitEnd"),Lm=Symbol("emitEnd2"),In=Symbol("async"),Vm=Symbol("abort"),wl=Symbol("aborted"),Eo=Symbol("signal"),fs=Symbol("dataListeners"),xr=Symbol("discarded"),To=o(r=>Promise.resolve().then(r),"defer"),KF=o(r=>r(),"nodefer"),YF=o(r=>r==="end"||r==="finish"||r==="prefinish","isEndish"),QF=o(r=>r instanceof ArrayBuffer||!!r&&typeof r=="object"&&r.constructor&&r.constructor.name==="ArrayBuffer"&&r.byteLength>=0,"isArrayBufferLike"),JF=o(r=>!Buffer.isBuffer(r)&&ArrayBuffer.isView(r),"isArrayBufferView"),bl=class{static{o(this,"Pipe")}src;dest;opts;ondrain;constructor(e,t,n){this.src=e,this.dest=t,this.opts=n,this.ondrain=()=>e[ca](),this.dest.on("drain",this.ondrain)}unpipe(){this.dest.removeListener("drain",this.ondrain)}proxyErrors(e){}end(){this.unpipe(),this.opts.end&&this.dest.end()}},qm=class extends bl{static{o(this,"PipeProxyErrors")}unpipe(){this.src.removeListener("error",this.proxyErrors),super.unpipe()}constructor(e,t,n){super(e,t,n),this.proxyErrors=i=>t.emit("error",i),e.on("error",this.proxyErrors)}},XF=o(r=>!!r.objectMode,"isObjectModeOptions"),ZF=o(r=>!r.objectMode&&!!r.encoding&&r.encoding!=="buffer","isEncodingOptions"),Oi=class extends El.EventEmitter{static{o(this,"Minipass")}[Et]=!1;[bo]=!1;[or]=[];[Tt]=[];[Gt];[ln];[In];[oa];[ti]=!1;[xi]=!1;[yl]=!1;[_l]=!1;[wo]=null;[At]=0;[ut]=!1;[Eo];[wl]=!1;[fs]=0;[xr]=!1;writable=!0;readable=!0;constructor(...e){let t=e[0]||{};if(super(),t.objectMode&&typeof t.encoding=="string")throw new TypeError("Encoding and objectMode may not be used together");XF(t)?(this[Gt]=!0,this[ln]=null):ZF(t)?(this[ln]=t.encoding,this[Gt]=!1):(this[Gt]=!1,this[ln]=null),this[In]=!!t.async,this[oa]=this[ln]?new nS.StringDecoder(this[ln]):null,t&&t.debugExposeBuffer===!0&&Object.defineProperty(this,"buffer",{get:o(()=>this[Tt],"get")}),t&&t.debugExposePipes===!0&&Object.defineProperty(this,"pipes",{get:o(()=>this[or],"get")});let{signal:n}=t;n&&(this[Eo]=n,n.aborted?this[Vm]():n.addEventListener("abort",()=>this[Vm]()))}get bufferLength(){return this[At]}get encoding(){return this[ln]}set encoding(e){throw new Error("Encoding must be set at instantiation time")}setEncoding(e){throw new Error("Encoding must be set at instantiation time")}get objectMode(){return this[Gt]}set objectMode(e){throw new Error("objectMode must be set at instantiation time")}get async(){return this[In]}set async(e){this[In]=this[In]||!!e}[Vm](){this[wl]=!0,this.emit("abort",this[Eo]?.reason),this.destroy(this[Eo]?.reason)}get aborted(){return this[wl]}set aborted(e){}write(e,t,n){if(this[wl])return!1;if(this[ti])throw new Error("write after end");if(this[ut])return this.emit("error",Object.assign(new Error("Cannot call write after a stream was destroyed"),{code:"ERR_STREAM_DESTROYED"})),!0;typeof t=="function"&&(n=t,t="utf8"),t||(t="utf8");let i=this[In]?To:KF;if(!this[Gt]&&!Buffer.isBuffer(e)){if(JF(e))e=Buffer.from(e.buffer,e.byteOffset,e.byteLength);else if(QF(e))e=Buffer.from(e);else if(typeof e!="string")throw new Error("Non-contiguous data written to non-objectMode stream")}return this[Gt]?(this[Et]&&this[At]!==0&&this[vl](!0),this[Et]?this.emit("data",e):this[km](e),this[At]!==0&&this.emit("readable"),n&&i(n),this[Et]):e.length?(typeof e=="string"&&!(t===this[ln]&&!this[oa]?.lastNeed)&&(e=Buffer.from(e,t)),Buffer.isBuffer(e)&&this[ln]&&(e=this[oa].write(e)),this[Et]&&this[At]!==0&&this[vl](!0),this[Et]?this.emit("data",e):this[km](e),this[At]!==0&&this.emit("readable"),n&&i(n),this[Et]):(this[At]!==0&&this.emit("readable"),n&&i(n),this[Et])}read(e){if(this[ut])return null;if(this[xr]=!1,this[At]===0||e===0||e&&e>this[At])return this[ri](),null;this[Gt]&&(e=null),this[Tt].length>1&&!this[Gt]&&(this[Tt]=[this[ln]?this[Tt].join(""):Buffer.concat(this[Tt],this[At])]);let t=this[eS](e||null,this[Tt][0]);return this[ri](),t}[eS](e,t){if(this[Gt])this[Sl]();else{let n=t;e===n.length||e===null?this[Sl]():typeof n=="string"?(this[Tt][0]=n.slice(e),t=n.slice(0,e),this[At]-=e):(this[Tt][0]=n.subarray(e),t=n.subarray(0,e),this[At]-=e)}return this.emit("data",t),!this[Tt].length&&!this[ti]&&this.emit("drain"),t}end(e,t,n){return typeof e=="function"&&(n=e,e=void 0),typeof t=="function"&&(n=t,t="utf8"),e!==void 0&&this.write(e,t),n&&this.once("end",n),this[ti]=!0,this.writable=!1,(this[Et]||!this[bo])&&this[ri](),this}[ca](){this[ut]||(!this[fs]&&!this[or].length&&(this[xr]=!0),this[bo]=!1,this[Et]=!0,this.emit("resume"),this[Tt].length?this[vl]():this[ti]?this[ri]():this.emit("drain"))}resume(){return this[ca]()}pause(){this[Et]=!1,this[bo]=!0,this[xr]=!1}get destroyed(){return this[ut]}get flowing(){return this[Et]}get paused(){return this[bo]}[km](e){this[Gt]?this[At]+=1:this[At]+=e.length,this[Tt].push(e)}[Sl](){return this[Gt]?this[At]-=1:this[At]-=this[Tt][0].length,this[Tt].shift()}[vl](e=!1){do;while(this[tS](this[Sl]())&&this[Tt].length);!e&&!this[Tt].length&&!this[ti]&&this.emit("drain")}[tS](e){return this.emit("data",e),this[Et]}pipe(e,t){if(this[ut])return e;this[xr]=!1;let n=this[xi];return t=t||{},e===Zv.stdout||e===Zv.stderr?t.end=!1:t.end=t.end!==!1,t.proxyErrors=!!t.proxyErrors,n?t.end&&e.end():(this[or].push(t.proxyErrors?new qm(this,e,t):new bl(this,e,t)),this[In]?To(()=>this[ca]()):this[ca]()),e}unpipe(e){let t=this[or].find(n=>n.dest===e);t&&(this[or].length===1?(this[Et]&&this[fs]===0&&(this[Et]=!1),this[or]=[]):this[or].splice(this[or].indexOf(t),1),t.unpipe())}addListener(e,t){return this.on(e,t)}on(e,t){let n=super.on(e,t);if(e==="data")this[xr]=!1,this[fs]++,!this[or].length&&!this[Et]&&this[ca]();else if(e==="readable"&&this[At]!==0)super.emit("readable");else if(YF(e)&&this[xi])super.emit(e),this.removeAllListeners(e);else if(e==="error"&&this[wo]){let i=t;this[In]?To(()=>i.call(this,this[wo])):i.call(this,this[wo])}return n}removeListener(e,t){return this.off(e,t)}off(e,t){let n=super.off(e,t);return e==="data"&&(this[fs]=this.listeners("data").length,this[fs]===0&&!this[xr]&&!this[or].length&&(this[Et]=!1)),n}removeAllListeners(e){let t=super.removeAllListeners(e);return(e==="data"||e===void 0)&&(this[fs]=0,!this[xr]&&!this[or].length&&(this[Et]=!1)),t}get emittedEnd(){return this[xi]}[ri](){!this[yl]&&!this[xi]&&!this[ut]&&this[Tt].length===0&&this[ti]&&(this[yl]=!0,this.emit("end"),this.emit("prefinish"),this.emit("finish"),this[_l]&&this.emit("close"),this[yl]=!1)}emit(e,...t){let n=t[0];if(e!=="error"&&e!=="close"&&e!==ut&&this[ut])return!1;if(e==="data")return!this[Gt]&&!n?!1:this[In]?(To(()=>this[Mm](n)),!0):this[Mm](n);if(e==="end")return this[rS]();if(e==="close"){if(this[_l]=!0,!this[xi]&&!this[ut])return!1;let s=super.emit("close");return this.removeAllListeners("close"),s}else if(e==="error"){this[wo]=n,super.emit(jm,n);let s=!this[Eo]||this.listeners("error").length?super.emit("error",n):!1;return this[ri](),s}else if(e==="resume"){let s=super.emit("resume");return this[ri](),s}else if(e==="finish"||e==="prefinish"){let s=super.emit(e);return this.removeAllListeners(e),s}let i=super.emit(e,...t);return this[ri](),i}[Mm](e){for(let n of this[or])n.dest.write(e)===!1&&this.pause();let t=this[xr]?!1:super.emit("data",e);return this[ri](),t}[rS](){return this[xi]?!1:(this[xi]=!0,this.readable=!1,this[In]?(To(()=>this[Lm]()),!0):this[Lm]())}[Lm](){if(this[oa]){let t=this[oa].end();if(t){for(let n of this[or])n.dest.write(t);this[xr]||super.emit("data",t)}}for(let t of this[or])t.end();let e=super.emit("end");return this.removeAllListeners("end"),e}async collect(){let e=Object.assign([],{dataLength:0});this[Gt]||(e.dataLength=0);let t=this.promise();return this.on("data",n=>{e.push(n),this[Gt]||(e.dataLength+=n.length)}),await t,e}async concat(){if(this[Gt])throw new Error("cannot concat in objectMode");let e=await this.collect();return this[ln]?e.join(""):Buffer.concat(e,e.dataLength)}async promise(){return new Promise((e,t)=>{this.on(ut,()=>t(new Error("stream destroyed"))),this.on("error",n=>t(n)),this.on("end",()=>e())})}[Symbol.asyncIterator](){this[xr]=!1;let e=!1,t=o(async()=>(this.pause(),e=!0,{value:void 0,done:!0}),"stop");return{next:o(()=>{if(e)return t();let i=this.read();if(i!==null)return Promise.resolve({done:!1,value:i});if(this[ti])return t();let s,a,c=o(h=>{this.off("data",u),this.off("end",f),this.off(ut,l),t(),a(h)},"onerr"),u=o(h=>{this.off("error",c),this.off("end",f),this.off(ut,l),this.pause(),s({value:h,done:!!this[ti]})},"ondata"),f=o(()=>{this.off("error",c),this.off("data",u),this.off(ut,l),t(),s({done:!0,value:void 0})},"onend"),l=o(()=>c(new Error("stream destroyed")),"ondestroy");return new Promise((h,p)=>{a=p,s=h,this.once(ut,l),this.once("error",c),this.once("end",f),this.once("data",u)})},"next"),throw:t,return:t,[Symbol.asyncIterator](){return this}}}[Symbol.iterator](){this[xr]=!1;let e=!1,t=o(()=>(this.pause(),this.off(jm,t),this.off(ut,t),this.off("end",t),e=!0,{done:!0,value:void 0}),"stop"),n=o(()=>{if(e)return t();let i=this.read();return i===null?t():{done:!1,value:i}},"next");return this.once("end",t),this.once(jm,t),this.once(ut,t),{next:n,throw:t,return:t,[Symbol.iterator](){return this}}}destroy(e){if(this[ut])return e?this.emit("error",e):this.emit(ut),this;this[ut]=!0,this[xr]=!0,this[Tt].length=0,this[At]=0;let t=this;return typeof t.close=="function"&&!this[_l]&&t.close(),e?this.emit("error",e):this.emit(ut),this}static get isStream(){return GF}};var t8=Dn.realpathSync.native,xo={lstatSync:Dn.lstatSync,readdir:Dn.readdir,readdirSync:Dn.readdirSync,readlinkSync:Dn.readlinkSync,realpathSync:t8,promises:{lstat:Ci.lstat,readdir:Ci.readdir,readlink:Ci.readlink,realpath:Ci.realpath}},uS=o(r=>!r||r===xo||r===e8?xo:{...xo,...r,promises:{...xo.promises,...r.promises||{}}},"fsFromOption"),lS=/^\\\\\?\\([a-z]:)\\?$/i,r8=o(r=>r.replace(/\//g,"\\").replace(lS,"$1\\"),"uncToDrive"),n8=/[\\\/]/,jr=0,fS=1,hS=2,Rn=4,dS=6,pS=8,hs=10,mS=12,kr=15,Ao=~kr,Um=16,iS=32,Oo=64,fn=128,Tl=256,xl=512,sS=Oo|fn|xl,i8=1023,$m=o(r=>r.isFile()?pS:r.isDirectory()?Rn:r.isSymbolicLink()?hs:r.isCharacterDevice()?hS:r.isBlockDevice()?dS:r.isSocket()?mS:r.isFIFO()?fS:jr,"entToType"),aS=new Map,Co=o(r=>{let e=aS.get(r);if(e)return e;let t=r.normalize("NFKD");return aS.set(r,t),t},"normalize"),oS=new Map,Al=o(r=>{let e=oS.get(r);if(e)return e;let t=Co(r.toLowerCase());return oS.set(r,t),t},"normalizeNocase"),Ol=class extends So{static{o(this,"ResolveCache")}constructor(){super({max:256})}},Wm=class extends So{static{o(this,"ChildrenCache")}constructor(e=16*1024){super({maxSize:e,sizeCalculation:o(t=>t.length+1,"sizeCalculation")})}},gS=Symbol("PathScurry setAsCwd"),Ht=class{static{o(this,"PathBase")}name;root;roots;parent;nocase;isCWD=!1;#e;#t;get dev(){return this.#t}#s;get mode(){return this.#s}#n;get nlink(){return this.#n}#a;get uid(){return this.#a}#S;get gid(){return this.#S}#u;get rdev(){return this.#u}#f;get blksize(){return this.#f}#o;get ino(){return this.#o}#c;get size(){return this.#c}#i;get blocks(){return this.#i}#g;get atimeMs(){return this.#g}#y;get mtimeMs(){return this.#y}#d;get ctimeMs(){return this.#d}#h;get birthtimeMs(){return this.#h}#E;get atime(){return this.#E}#m;get mtime(){return this.#m}#T;get ctime(){return this.#T}#A;get birthtime(){return this.#A}#v;#w;#b;#p;#P;#x;#r;#R;#_;#F;get parentPath(){return(this.parent||this).fullpath()}get path(){return this.parentPath}constructor(e,t=jr,n,i,s,a,c){this.name=e,this.#v=s?Al(e):Co(e),this.#r=t&i8,this.nocase=s,this.roots=i,this.root=n||this,this.#R=a,this.#b=c.fullpath,this.#P=c.relative,this.#x=c.relativePosix,this.parent=c.parent,this.parent?this.#e=this.parent.#e:this.#e=uS(c.fs)}depth(){return this.#w!==void 0?this.#w:this.parent?this.#w=this.parent.depth()+1:this.#w=0}childrenCache(){return this.#R}resolve(e){if(!e)return this;let t=this.getRootString(e),i=e.substring(t.length).split(this.splitSep);return t?this.getRoot(t).#D(i):this.#D(i)}#D(e){let t=this;for(let n of e)t=t.child(n);return t}children(){let e=this.#R.get(this);if(e)return e;let t=Object.assign([],{provisional:0});return this.#R.set(this,t),this.#r&=~Um,t}child(e,t){if(e===""||e===".")return this;if(e==="..")return this.parent||this;let n=this.children(),i=this.nocase?Al(e):Co(e);for(let u of n)if(u.#v===i)return u;let s=this.parent?this.sep:"",a=this.#b?this.#b+s+e:void 0,c=this.newChild(e,jr,{...t,parent:this,fullpath:a});return this.canReaddir()||(c.#r|=fn),n.push(c),c}relative(){if(this.isCWD)return"";if(this.#P!==void 0)return this.#P;let e=this.name,t=this.parent;if(!t)return this.#P=this.name;let n=t.relative();return n+(!n||!t.parent?"":this.sep)+e}relativePosix(){if(this.sep==="/")return this.relative();if(this.isCWD)return"";if(this.#x!==void 0)return this.#x;let e=this.name,t=this.parent;if(!t)return this.#x=this.fullpathPosix();let n=t.relativePosix();return n+(!n||!t.parent?"":"/")+e}fullpath(){if(this.#b!==void 0)return this.#b;let e=this.name,t=this.parent;if(!t)return this.#b=this.name;let i=t.fullpath()+(t.parent?this.sep:"")+e;return this.#b=i}fullpathPosix(){if(this.#p!==void 0)return this.#p;if(this.sep==="/")return this.#p=this.fullpath();if(!this.parent){let i=this.fullpath().replace(/\\/g,"/");return/^[a-z]:\//i.test(i)?this.#p=`//?/${i}`:this.#p=i}let e=this.parent,t=e.fullpathPosix(),n=t+(!t||!e.parent?"":"/")+this.name;return this.#p=n}isUnknown(){return(this.#r&kr)===jr}isType(e){return this[`is${e}`]()}getType(){return this.isUnknown()?"Unknown":this.isDirectory()?"Directory":this.isFile()?"File":this.isSymbolicLink()?"SymbolicLink":this.isFIFO()?"FIFO":this.isCharacterDevice()?"CharacterDevice":this.isBlockDevice()?"BlockDevice":this.isSocket()?"Socket":"Unknown"}isFile(){return(this.#r&kr)===pS}isDirectory(){return(this.#r&kr)===Rn}isCharacterDevice(){return(this.#r&kr)===hS}isBlockDevice(){return(this.#r&kr)===dS}isFIFO(){return(this.#r&kr)===fS}isSocket(){return(this.#r&kr)===mS}isSymbolicLink(){return(this.#r&hs)===hs}lstatCached(){return this.#r&iS?this:void 0}readlinkCached(){return this.#_}realpathCached(){return this.#F}readdirCached(){let e=this.children();return e.slice(0,e.provisional)}canReadlink(){if(this.#_)return!0;if(!this.parent)return!1;let e=this.#r&kr;return!(e!==jr&&e!==hs||this.#r&Tl||this.#r&fn)}calledReaddir(){return!!(this.#r&Um)}isENOENT(){return!!(this.#r&fn)}isNamed(e){return this.nocase?this.#v===Al(e):this.#v===Co(e)}async readlink(){let e=this.#_;if(e)return e;if(this.canReadlink()&&this.parent)try{let t=await this.#e.promises.readlink(this.fullpath()),n=(await this.parent.realpath())?.resolve(t);if(n)return this.#_=n}catch(t){this.#l(t.code);return}}readlinkSync(){let e=this.#_;if(e)return e;if(this.canReadlink()&&this.parent)try{let t=this.#e.readlinkSync(this.fullpath()),n=this.parent.realpathSync()?.resolve(t);if(n)return this.#_=n}catch(t){this.#l(t.code);return}}#N(e){this.#r|=Um;for(let t=e.provisional;t<e.length;t++){let n=e[t];n&&n.#k()}}#k(){this.#r&fn||(this.#r=(this.#r|fn)&Ao,this.#O())}#O(){let e=this.children();e.provisional=0;for(let t of e)t.#k()}#C(){this.#r|=xl,this.#j()}#j(){if(this.#r&Oo)return;let e=this.#r;(e&kr)===Rn&&(e&=Ao),this.#r=e|Oo,this.#O()}#M(e=""){e==="ENOTDIR"||e==="EPERM"?this.#j():e==="ENOENT"?this.#k():this.children().provisional=0}#L(e=""){e==="ENOTDIR"?this.parent.#j():e==="ENOENT"&&this.#k()}#l(e=""){let t=this.#r;t|=Tl,e==="ENOENT"&&(t|=fn),(e==="EINVAL"||e==="UNKNOWN")&&(t&=Ao),this.#r=t,e==="ENOTDIR"&&this.parent&&this.parent.#j()}#V(e,t){return this.#I(e,t)||this.#q(e,t)}#q(e,t){let n=$m(e),i=this.newChild(e.name,n,{parent:this}),s=i.#r&kr;return s!==Rn&&s!==hs&&s!==jr&&(i.#r|=Oo),t.unshift(i),t.provisional++,i}#I(e,t){for(let n=t.provisional;n<t.length;n++){let i=t[n];if((this.nocase?Al(e.name):Co(e.name))===i.#v)return this.#B(e,i,n,t)}}#B(e,t,n,i){let s=t.name;return t.#r=t.#r&Ao|$m(e),s!==e.name&&(t.name=e.name),n!==i.provisional&&(n===i.length-1?i.pop():i.splice(n,1),i.unshift(t)),i.provisional++,t}async lstat(){if((this.#r&fn)===0)try{return this.#G(await this.#e.promises.lstat(this.fullpath())),this}catch(e){this.#L(e.code)}}lstatSync(){if((this.#r&fn)===0)try{return this.#G(this.#e.lstatSync(this.fullpath())),this}catch(e){this.#L(e.code)}}#G(e){let{atime:t,atimeMs:n,birthtime:i,birthtimeMs:s,blksize:a,blocks:c,ctime:u,ctimeMs:f,dev:l,gid:h,ino:p,mode:g,mtime:w,mtimeMs:S,nlink:x,rdev:P,size:F,uid:L}=e;this.#E=t,this.#g=n,this.#A=i,this.#h=s,this.#f=a,this.#i=c,this.#T=u,this.#d=f,this.#t=l,this.#S=h,this.#o=p,this.#s=g,this.#m=w,this.#y=S,this.#n=x,this.#u=P,this.#c=F,this.#a=L;let $=$m(e);this.#r=this.#r&Ao|$|iS,$!==jr&&$!==Rn&&$!==hs&&(this.#r|=Oo)}#$=[];#W=!1;#H(e){this.#W=!1;let t=this.#$.slice();this.#$.length=0,t.forEach(n=>n(null,e))}readdirCB(e,t=!1){if(!this.canReaddir()){t?e(null,[]):queueMicrotask(()=>e(null,[]));return}let n=this.children();if(this.calledReaddir()){let s=n.slice(0,n.provisional);t?e(null,s):queueMicrotask(()=>e(null,s));return}if(this.#$.push(e),this.#W)return;this.#W=!0;let i=this.fullpath();this.#e.readdir(i,{withFileTypes:!0},(s,a)=>{if(s)this.#M(s.code),n.provisional=0;else{for(let c of a)this.#V(c,n);this.#N(n)}this.#H(n.slice(0,n.provisional))})}#U;async readdir(){if(!this.canReaddir())return[];let e=this.children();if(this.calledReaddir())return e.slice(0,e.provisional);let t=this.fullpath();if(this.#U)await this.#U;else{let n=o(()=>{},"resolve");this.#U=new Promise(i=>n=i);try{for(let i of await this.#e.promises.readdir(t,{withFileTypes:!0}))this.#V(i,e);this.#N(e)}catch(i){this.#M(i.code),e.provisional=0}this.#U=void 0,n()}return e.slice(0,e.provisional)}readdirSync(){if(!this.canReaddir())return[];let e=this.children();if(this.calledReaddir())return e.slice(0,e.provisional);let t=this.fullpath();try{for(let n of this.#e.readdirSync(t,{withFileTypes:!0}))this.#V(n,e);this.#N(e)}catch(n){this.#M(n.code),e.provisional=0}return e.slice(0,e.provisional)}canReaddir(){if(this.#r&sS)return!1;let e=kr&this.#r;return e===jr||e===Rn||e===hs}shouldWalk(e,t){return(this.#r&Rn)===Rn&&!(this.#r&sS)&&!e.has(this)&&(!t||t(this))}async realpath(){if(this.#F)return this.#F;if(!((xl|Tl|fn)&this.#r))try{let e=await this.#e.promises.realpath(this.fullpath());return this.#F=this.resolve(e)}catch{this.#C()}}realpathSync(){if(this.#F)return this.#F;if(!((xl|Tl|fn)&this.#r))try{let e=this.#e.realpathSync(this.fullpath());return this.#F=this.resolve(e)}catch{this.#C()}}[gS](e){if(e===this)return;e.isCWD=!1,this.isCWD=!0;let t=new Set([]),n=[],i=this;for(;i&&i.parent;)t.add(i),i.#P=n.join(this.sep),i.#x=n.join("/"),i=i.parent,n.push("..");for(i=e;i&&i.parent&&!t.has(i);)i.#P=void 0,i.#x=void 0,i=i.parent}},Cl=class r extends Ht{static{o(this,"PathWin32")}sep="\\";splitSep=n8;constructor(e,t=jr,n,i,s,a,c){super(e,t,n,i,s,a,c)}newChild(e,t=jr,n={}){return new r(e,t,this.root,this.roots,this.nocase,this.childrenCache(),n)}getRootString(e){return ua.win32.parse(e).root}getRoot(e){if(e=r8(e.toUpperCase()),e===this.root.name)return this.root;for(let[t,n]of Object.entries(this.roots))if(this.sameRoot(e,t))return this.roots[e]=n;return this.roots[e]=new la(e,this).root}sameRoot(e,t=this.root.name){return e=e.toUpperCase().replace(/\//g,"\\").replace(lS,"$1\\"),e===t}},Pl=class r extends Ht{static{o(this,"PathPosix")}splitSep="/";sep="/";constructor(e,t=jr,n,i,s,a,c){super(e,t,n,i,s,a,c)}getRootString(e){return e.startsWith("/")?"/":""}getRoot(e){return this.root}newChild(e,t=jr,n={}){return new r(e,t,this.root,this.roots,this.nocase,this.childrenCache(),n)}},Fl=class{static{o(this,"PathScurryBase")}root;rootPath;roots;cwd;#e;#t;#s;nocase;#n;constructor(e=process.cwd(),t,n,{nocase:i,childrenCacheSize:s=16*1024,fs:a=xo}={}){this.#n=uS(a),(e instanceof URL||e.startsWith("file://"))&&(e=(0,cS.fileURLToPath)(e));let c=t.resolve(e);this.roots=Object.create(null),this.rootPath=this.parseRootPath(c),this.#e=new Ol,this.#t=new Ol,this.#s=new Wm(s);let u=c.substring(this.rootPath.length).split(n);if(u.length===1&&!u[0]&&u.pop(),i===void 0)throw new TypeError("must provide nocase setting to PathScurryBase ctor");this.nocase=i,this.root=this.newRoot(this.#n),this.roots[this.rootPath]=this.root;let f=this.root,l=u.length-1,h=t.sep,p=this.rootPath,g=!1;for(let w of u){let S=l--;f=f.child(w,{relative:new Array(S).fill("..").join(h),relativePosix:new Array(S).fill("..").join("/"),fullpath:p+=(g?"":h)+w}),g=!0}this.cwd=f}depth(e=this.cwd){return typeof e=="string"&&(e=this.cwd.resolve(e)),e.depth()}childrenCache(){return this.#s}resolve(...e){let t="";for(let s=e.length-1;s>=0;s--){let a=e[s];if(!(!a||a===".")&&(t=t?`${a}/${t}`:a,this.isAbsolute(a)))break}let n=this.#e.get(t);if(n!==void 0)return n;let i=this.cwd.resolve(t).fullpath();return this.#e.set(t,i),i}resolvePosix(...e){let t="";for(let s=e.length-1;s>=0;s--){let a=e[s];if(!(!a||a===".")&&(t=t?`${a}/${t}`:a,this.isAbsolute(a)))break}let n=this.#t.get(t);if(n!==void 0)return n;let i=this.cwd.resolve(t).fullpathPosix();return this.#t.set(t,i),i}relative(e=this.cwd){return typeof e=="string"&&(e=this.cwd.resolve(e)),e.relative()}relativePosix(e=this.cwd){return typeof e=="string"&&(e=this.cwd.resolve(e)),e.relativePosix()}basename(e=this.cwd){return typeof e=="string"&&(e=this.cwd.resolve(e)),e.name}dirname(e=this.cwd){return typeof e=="string"&&(e=this.cwd.resolve(e)),(e.parent||e).fullpath()}async readdir(e=this.cwd,t={withFileTypes:!0}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e,e=this.cwd);let{withFileTypes:n}=t;if(e.canReaddir()){let i=await e.readdir();return n?i:i.map(s=>s.name)}else return[]}readdirSync(e=this.cwd,t={withFileTypes:!0}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e,e=this.cwd);let{withFileTypes:n=!0}=t;return e.canReaddir()?n?e.readdirSync():e.readdirSync().map(i=>i.name):[]}async lstat(e=this.cwd){return typeof e=="string"&&(e=this.cwd.resolve(e)),e.lstat()}lstatSync(e=this.cwd){return typeof e=="string"&&(e=this.cwd.resolve(e)),e.lstatSync()}async readlink(e=this.cwd,{withFileTypes:t}={withFileTypes:!1}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e.withFileTypes,e=this.cwd);let n=await e.readlink();return t?n:n?.fullpath()}readlinkSync(e=this.cwd,{withFileTypes:t}={withFileTypes:!1}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e.withFileTypes,e=this.cwd);let n=e.readlinkSync();return t?n:n?.fullpath()}async realpath(e=this.cwd,{withFileTypes:t}={withFileTypes:!1}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e.withFileTypes,e=this.cwd);let n=await e.realpath();return t?n:n?.fullpath()}realpathSync(e=this.cwd,{withFileTypes:t}={withFileTypes:!1}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e.withFileTypes,e=this.cwd);let n=e.realpathSync();return t?n:n?.fullpath()}async walk(e=this.cwd,t={}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e,e=this.cwd);let{withFileTypes:n=!0,follow:i=!1,filter:s,walkFilter:a}=t,c=[];(!s||s(e))&&c.push(n?e:e.fullpath());let u=new Set,f=o((h,p)=>{u.add(h),h.readdirCB((g,w)=>{if(g)return p(g);let S=w.length;if(!S)return p();let x=o(()=>{--S===0&&p()},"next");for(let P of w)(!s||s(P))&&c.push(n?P:P.fullpath()),i&&P.isSymbolicLink()?P.realpath().then(F=>F?.isUnknown()?F.lstat():F).then(F=>F?.shouldWalk(u,a)?f(F,x):x()):P.shouldWalk(u,a)?f(P,x):x()},!0)},"walk"),l=e;return new Promise((h,p)=>{f(l,g=>{if(g)return p(g);h(c)})})}walkSync(e=this.cwd,t={}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e,e=this.cwd);let{withFileTypes:n=!0,follow:i=!1,filter:s,walkFilter:a}=t,c=[];(!s||s(e))&&c.push(n?e:e.fullpath());let u=new Set([e]);for(let f of u){let l=f.readdirSync();for(let h of l){(!s||s(h))&&c.push(n?h:h.fullpath());let p=h;if(h.isSymbolicLink()){if(!(i&&(p=h.realpathSync())))continue;p.isUnknown()&&p.lstatSync()}p.shouldWalk(u,a)&&u.add(p)}}return c}[Symbol.asyncIterator](){return this.iterate()}iterate(e=this.cwd,t={}){return typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e,e=this.cwd),this.stream(e,t)[Symbol.asyncIterator]()}[Symbol.iterator](){return this.iterateSync()}*iterateSync(e=this.cwd,t={}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e,e=this.cwd);let{withFileTypes:n=!0,follow:i=!1,filter:s,walkFilter:a}=t;(!s||s(e))&&(yield n?e:e.fullpath());let c=new Set([e]);for(let u of c){let f=u.readdirSync();for(let l of f){(!s||s(l))&&(yield n?l:l.fullpath());let h=l;if(l.isSymbolicLink()){if(!(i&&(h=l.realpathSync())))continue;h.isUnknown()&&h.lstatSync()}h.shouldWalk(c,a)&&c.add(h)}}}stream(e=this.cwd,t={}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e,e=this.cwd);let{withFileTypes:n=!0,follow:i=!1,filter:s,walkFilter:a}=t,c=new Oi({objectMode:!0});(!s||s(e))&&c.write(n?e:e.fullpath());let u=new Set,f=[e],l=0,h=o(()=>{let p=!1;for(;!p;){let g=f.shift();if(!g){l===0&&c.end();return}l++,u.add(g);let w=o((x,P,F=!1)=>{if(x)return c.emit("error",x);if(i&&!F){let L=[];for(let $ of P)$.isSymbolicLink()&&L.push($.realpath().then(K=>K?.isUnknown()?K.lstat():K));if(L.length){Promise.all(L).then(()=>w(null,P,!0));return}}for(let L of P)L&&(!s||s(L))&&(c.write(n?L:L.fullpath())||(p=!0));l--;for(let L of P){let $=L.realpathCached()||L;$.shouldWalk(u,a)&&f.push($)}p&&!c.flowing?c.once("drain",h):S||h()},"onReaddir"),S=!0;g.readdirCB(w,!0),S=!1}},"process");return h(),c}streamSync(e=this.cwd,t={}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e,e=this.cwd);let{withFileTypes:n=!0,follow:i=!1,filter:s,walkFilter:a}=t,c=new Oi({objectMode:!0}),u=new Set;(!s||s(e))&&c.write(n?e:e.fullpath());let f=[e],l=0,h=o(()=>{let p=!1;for(;!p;){let g=f.shift();if(!g){l===0&&c.end();return}l++,u.add(g);let w=g.readdirSync();for(let S of w)(!s||s(S))&&(c.write(n?S:S.fullpath())||(p=!0));l--;for(let S of w){let x=S;if(S.isSymbolicLink()){if(!(i&&(x=S.realpathSync())))continue;x.isUnknown()&&x.lstatSync()}x.shouldWalk(u,a)&&f.push(x)}}p&&!c.flowing&&c.once("drain",h)},"process");return h(),c}chdir(e=this.cwd){let t=this.cwd;this.cwd=typeof e=="string"?this.cwd.resolve(e):e,this.cwd[gS](t)}},la=class extends Fl{static{o(this,"PathScurryWin32")}sep="\\";constructor(e=process.cwd(),t={}){let{nocase:n=!0}=t;super(e,ua.win32,"\\",{...t,nocase:n}),this.nocase=n;for(let i=this.cwd;i;i=i.parent)i.nocase=this.nocase}parseRootPath(e){return ua.win32.parse(e).root.toUpperCase()}newRoot(e){return new Cl(this.rootPath,Rn,void 0,this.roots,this.nocase,this.childrenCache(),{fs:e})}isAbsolute(e){return e.startsWith("/")||e.startsWith("\\")||/^[a-z]:(\/|\\)/i.test(e)}},fa=class extends Fl{static{o(this,"PathScurryPosix")}sep="/";constructor(e=process.cwd(),t={}){let{nocase:n=!1}=t;super(e,ua.posix,"/",{...t,nocase:n}),this.nocase=n}parseRootPath(e){return"/"}newRoot(e){return new Pl(this.rootPath,Rn,void 0,this.roots,this.nocase,this.childrenCache(),{fs:e})}isAbsolute(e){return e.startsWith("/")}},Po=class extends fa{static{o(this,"PathScurryDarwin")}constructor(e=process.cwd(),t={}){let{nocase:n=!0}=t;super(e,{...t,nocase:n})}},Uq=process.platform==="win32"?Cl:Pl,yS=process.platform==="win32"?la:process.platform==="darwin"?Po:fa;var s8=o(r=>r.length>=1,"isPatternList"),a8=o(r=>r.length>=1,"isGlobList"),ha=class r{static{o(this,"Pattern")}#e;#t;#s;length;#n;#a;#S;#u;#f;#o;#c=!0;constructor(e,t,n,i){if(!s8(e))throw new TypeError("empty pattern list");if(!a8(t))throw new TypeError("empty glob list");if(t.length!==e.length)throw new TypeError("mismatched pattern list and glob list lengths");if(this.length=e.length,n<0||n>=this.length)throw new TypeError("index out of range");if(this.#e=e,this.#t=t,this.#s=n,this.#n=i,this.#s===0){if(this.isUNC()){let[s,a,c,u,...f]=this.#e,[l,h,p,g,...w]=this.#t;f[0]===""&&(f.shift(),w.shift());let S=[s,a,c,u,""].join("/"),x=[l,h,p,g,""].join("/");this.#e=[S,...f],this.#t=[x,...w],this.length=this.#e.length}else if(this.isDrive()||this.isAbsolute()){let[s,...a]=this.#e,[c,...u]=this.#t;a[0]===""&&(a.shift(),u.shift());let f=s+"/",l=c+"/";this.#e=[f,...a],this.#t=[l,...u],this.length=this.#e.length}}}pattern(){return this.#e[this.#s]}isString(){return typeof this.#e[this.#s]=="string"}isGlobstar(){return this.#e[this.#s]===kt}isRegExp(){return this.#e[this.#s]instanceof RegExp}globString(){return this.#S=this.#S||(this.#s===0?this.isAbsolute()?this.#t[0]+this.#t.slice(1).join("/"):this.#t.join("/"):this.#t.slice(this.#s).join("/"))}hasMore(){return this.length>this.#s+1}rest(){return this.#a!==void 0?this.#a:this.hasMore()?(this.#a=new r(this.#e,this.#t,this.#s+1,this.#n),this.#a.#o=this.#o,this.#a.#f=this.#f,this.#a.#u=this.#u,this.#a):this.#a=null}isUNC(){let e=this.#e;return this.#f!==void 0?this.#f:this.#f=this.#n==="win32"&&this.#s===0&&e[0]===""&&e[1]===""&&typeof e[2]=="string"&&!!e[2]&&typeof e[3]=="string"&&!!e[3]}isDrive(){let e=this.#e;return this.#u!==void 0?this.#u:this.#u=this.#n==="win32"&&this.#s===0&&this.length>1&&typeof e[0]=="string"&&/^[a-z]:$/i.test(e[0])}isAbsolute(){let e=this.#e;return this.#o!==void 0?this.#o:this.#o=e[0]===""&&e.length>1||this.isDrive()||this.isUNC()}root(){let e=this.#e[0];return typeof e=="string"&&this.isAbsolute()&&this.#s===0?e:""}checkFollowGlobstar(){return!(this.#s===0||!this.isGlobstar()||!this.#c)}markFollowGlobstar(){return this.#s===0||!this.isGlobstar()||!this.#c?!1:(this.#c=!1,!0)}};var o8=typeof process=="object"&&process&&typeof process.platform=="string"?process.platform:"linux",da=class{static{o(this,"Ignore")}relative;relativeChildren;absolute;absoluteChildren;platform;mmopts;constructor(e,{nobrace:t,nocase:n,noext:i,noglobstar:s,platform:a=o8}){this.relative=[],this.absolute=[],this.relativeChildren=[],this.absoluteChildren=[],this.platform=a,this.mmopts={dot:!0,nobrace:t,nocase:n,noext:i,noglobstar:s,optimizationLevel:2,platform:a,nocomment:!0,nonegate:!0};for(let c of e)this.add(c)}add(e){let t=new Ar(e,this.mmopts);for(let n=0;n<t.set.length;n++){let i=t.set[n],s=t.globParts[n];if(!i||!s)throw new Error("invalid pattern object");for(;i[0]==="."&&s[0]===".";)i.shift(),s.shift();let a=new ha(i,s,0,this.platform),c=new Ar(a.globString(),this.mmopts),u=s[s.length-1]==="**",f=a.isAbsolute();f?this.absolute.push(c):this.relative.push(c),u&&(f?this.absoluteChildren.push(c):this.relativeChildren.push(c))}}ignored(e){let t=e.fullpath(),n=`${t}/`,i=e.relative()||".",s=`${i}/`;for(let a of this.relative)if(a.match(i)||a.match(s))return!0;for(let a of this.absolute)if(a.match(t)||a.match(n))return!0;return!1}childrenIgnored(e){let t=e.fullpath()+"/",n=(e.relative()||".")+"/";for(let i of this.relativeChildren)if(i.match(n))return!0;for(let i of this.absoluteChildren)if(i.match(t))return!0;return!1}};var Gm=class r{static{o(this,"HasWalkedCache")}store;constructor(e=new Map){this.store=e}copy(){return new r(new Map(this.store))}hasWalked(e,t){return this.store.get(e.fullpath())?.has(t.globString())}storeWalked(e,t){let n=e.fullpath(),i=this.store.get(n);i?i.add(t.globString()):this.store.set(n,new Set([t.globString()]))}},Hm=class{static{o(this,"MatchRecord")}store=new Map;add(e,t,n){let i=(t?2:0)|(n?1:0),s=this.store.get(e);this.store.set(e,s===void 0?i:i&s)}entries(){return[...this.store.entries()].map(([e,t])=>[e,!!(t&2),!!(t&1)])}},zm=class{static{o(this,"SubWalks")}store=new Map;add(e,t){if(!e.canReaddir())return;let n=this.store.get(e);n?n.find(i=>i.globString()===t.globString())||n.push(t):this.store.set(e,[t])}get(e){let t=this.store.get(e);if(!t)throw new Error("attempting to walk unknown path");return t}entries(){return this.keys().map(e=>[e,this.store.get(e)])}keys(){return[...this.store.keys()].filter(e=>e.canReaddir())}},Fo=class r{static{o(this,"Processor")}hasWalkedCache;matches=new Hm;subwalks=new zm;patterns;follow;dot;opts;constructor(e,t){this.opts=e,this.follow=!!e.follow,this.dot=!!e.dot,this.hasWalkedCache=t?t.copy():new Gm}processPatterns(e,t){this.patterns=t;let n=t.map(i=>[e,i]);for(let[i,s]of n){this.hasWalkedCache.storeWalked(i,s);let a=s.root(),c=s.isAbsolute()&&this.opts.absolute!==!1;if(a){i=i.resolve(a==="/"&&this.opts.root!==void 0?this.opts.root:a);let h=s.rest();if(h)s=h;else{this.matches.add(i,!0,!1);continue}}if(i.isENOENT())continue;let u,f,l=!1;for(;typeof(u=s.pattern())=="string"&&(f=s.rest());)i=i.resolve(u),s=f,l=!0;if(u=s.pattern(),f=s.rest(),l){if(this.hasWalkedCache.hasWalked(i,s))continue;this.hasWalkedCache.storeWalked(i,s)}if(typeof u=="string"){let h=u===".."||u===""||u===".";this.matches.add(i.resolve(u),c,h);continue}else if(u===kt){(!i.isSymbolicLink()||this.follow||s.checkFollowGlobstar())&&this.subwalks.add(i,s);let h=f?.pattern(),p=f?.rest();if(!f||(h===""||h===".")&&!p)this.matches.add(i,c,h===""||h===".");else if(h===".."){let g=i.parent||i;p?this.hasWalkedCache.hasWalked(g,p)||this.subwalks.add(g,p):this.matches.add(g,c,!0)}}else u instanceof RegExp&&this.subwalks.add(i,s)}return this}subwalkTargets(){return this.subwalks.keys()}child(){return new r(this.opts,this.hasWalkedCache)}filterEntries(e,t){let n=this.subwalks.get(e),i=this.child();for(let s of t)for(let a of n){let c=a.isAbsolute(),u=a.pattern(),f=a.rest();u===kt?i.testGlobstar(s,a,f,c):u instanceof RegExp?i.testRegExp(s,u,f,c):i.testString(s,u,f,c)}return i}testGlobstar(e,t,n,i){if((this.dot||!e.name.startsWith("."))&&(t.hasMore()||this.matches.add(e,i,!1),e.canReaddir()&&(this.follow||!e.isSymbolicLink()?this.subwalks.add(e,t):e.isSymbolicLink()&&(n&&t.checkFollowGlobstar()?this.subwalks.add(e,n):t.markFollowGlobstar()&&this.subwalks.add(e,t)))),n){let s=n.pattern();if(typeof s=="string"&&s!==".."&&s!==""&&s!==".")this.testString(e,s,n.rest(),i);else if(s===".."){let a=e.parent||e;this.subwalks.add(a,n)}else s instanceof RegExp&&this.testRegExp(e,s,n.rest(),i)}}testRegExp(e,t,n,i){t.test(e.name)&&(n?this.subwalks.add(e,n):this.matches.add(e,i,!1))}testString(e,t,n,i){e.isNamed(t)&&(n?this.subwalks.add(e,n):this.matches.add(e,i,!1))}};var c8=o((r,e)=>typeof r=="string"?new da([r],e):Array.isArray(r)?new da(r,e):r,"makeIgnore"),Il=class{static{o(this,"GlobUtil")}path;patterns;opts;seen=new Set;paused=!1;aborted=!1;#e=[];#t;#s;signal;maxDepth;includeChildMatches;constructor(e,t,n){if(this.patterns=e,this.path=t,this.opts=n,this.#s=!n.posix&&n.platform==="win32"?"\\":"/",this.includeChildMatches=n.includeChildMatches!==!1,(n.ignore||!this.includeChildMatches)&&(this.#t=c8(n.ignore??[],n),!this.includeChildMatches&&typeof this.#t.add!="function")){let i="cannot ignore child matches, ignore lacks add() method.";throw new Error(i)}this.maxDepth=n.maxDepth||1/0,n.signal&&(this.signal=n.signal,this.signal.addEventListener("abort",()=>{this.#e.length=0}))}#n(e){return this.seen.has(e)||!!this.#t?.ignored?.(e)}#a(e){return!!this.#t?.childrenIgnored?.(e)}pause(){this.paused=!0}resume(){if(this.signal?.aborted)return;this.paused=!1;let e;for(;!this.paused&&(e=this.#e.shift());)e()}onResume(e){this.signal?.aborted||(this.paused?this.#e.push(e):e())}async matchCheck(e,t){if(t&&this.opts.nodir)return;let n;if(this.opts.realpath){if(n=e.realpathCached()||await e.realpath(),!n)return;e=n}let s=e.isUnknown()||this.opts.stat?await e.lstat():e;if(this.opts.follow&&this.opts.nodir&&s?.isSymbolicLink()){let a=await s.realpath();a&&(a.isUnknown()||this.opts.stat)&&await a.lstat()}return this.matchCheckTest(s,t)}matchCheckTest(e,t){return e&&(this.maxDepth===1/0||e.depth()<=this.maxDepth)&&(!t||e.canReaddir())&&(!this.opts.nodir||!e.isDirectory())&&(!this.opts.nodir||!this.opts.follow||!e.isSymbolicLink()||!e.realpathCached()?.isDirectory())&&!this.#n(e)?e:void 0}matchCheckSync(e,t){if(t&&this.opts.nodir)return;let n;if(this.opts.realpath){if(n=e.realpathCached()||e.realpathSync(),!n)return;e=n}let s=e.isUnknown()||this.opts.stat?e.lstatSync():e;if(this.opts.follow&&this.opts.nodir&&s?.isSymbolicLink()){let a=s.realpathSync();a&&(a?.isUnknown()||this.opts.stat)&&a.lstatSync()}return this.matchCheckTest(s,t)}matchFinish(e,t){if(this.#n(e))return;if(!this.includeChildMatches&&this.#t?.add){let s=`${e.relativePosix()}/**`;this.#t.add(s)}let n=this.opts.absolute===void 0?t:this.opts.absolute;this.seen.add(e);let i=this.opts.mark&&e.isDirectory()?this.#s:"";if(this.opts.withFileTypes)this.matchEmit(e);else if(n){let s=this.opts.posix?e.fullpathPosix():e.fullpath();this.matchEmit(s+i)}else{let s=this.opts.posix?e.relativePosix():e.relative(),a=this.opts.dotRelative&&!s.startsWith(".."+this.#s)?"."+this.#s:"";this.matchEmit(s?a+s+i:"."+i)}}async match(e,t,n){let i=await this.matchCheck(e,n);i&&this.matchFinish(i,t)}matchSync(e,t,n){let i=this.matchCheckSync(e,n);i&&this.matchFinish(i,t)}walkCB(e,t,n){this.signal?.aborted&&n(),this.walkCB2(e,t,new Fo(this.opts),n)}walkCB2(e,t,n,i){if(this.#a(e))return i();if(this.signal?.aborted&&i(),this.paused){this.onResume(()=>this.walkCB2(e,t,n,i));return}n.processPatterns(e,t);let s=1,a=o(()=>{--s===0&&i()},"next");for(let[c,u,f]of n.matches.entries())this.#n(c)||(s++,this.match(c,u,f).then(()=>a()));for(let c of n.subwalkTargets()){if(this.maxDepth!==1/0&&c.depth()>=this.maxDepth)continue;s++;let u=c.readdirCached();c.calledReaddir()?this.walkCB3(c,u,n,a):c.readdirCB((f,l)=>this.walkCB3(c,l,n,a),!0)}a()}walkCB3(e,t,n,i){n=n.filterEntries(e,t);let s=1,a=o(()=>{--s===0&&i()},"next");for(let[c,u,f]of n.matches.entries())this.#n(c)||(s++,this.match(c,u,f).then(()=>a()));for(let[c,u]of n.subwalks.entries())s++,this.walkCB2(c,u,n.child(),a);a()}walkCBSync(e,t,n){this.signal?.aborted&&n(),this.walkCB2Sync(e,t,new Fo(this.opts),n)}walkCB2Sync(e,t,n,i){if(this.#a(e))return i();if(this.signal?.aborted&&i(),this.paused){this.onResume(()=>this.walkCB2Sync(e,t,n,i));return}n.processPatterns(e,t);let s=1,a=o(()=>{--s===0&&i()},"next");for(let[c,u,f]of n.matches.entries())this.#n(c)||this.matchSync(c,u,f);for(let c of n.subwalkTargets()){if(this.maxDepth!==1/0&&c.depth()>=this.maxDepth)continue;s++;let u=c.readdirSync();this.walkCB3Sync(c,u,n,a)}a()}walkCB3Sync(e,t,n,i){n=n.filterEntries(e,t);let s=1,a=o(()=>{--s===0&&i()},"next");for(let[c,u,f]of n.matches.entries())this.#n(c)||this.matchSync(c,u,f);for(let[c,u]of n.subwalks.entries())s++,this.walkCB2Sync(c,u,n.child(),a);a()}},Io=class extends Il{static{o(this,"GlobWalker")}matches=new Set;constructor(e,t,n){super(e,t,n)}matchEmit(e){this.matches.add(e)}async walk(){if(this.signal?.aborted)throw this.signal.reason;return this.path.isUnknown()&&await this.path.lstat(),await new Promise((e,t)=>{this.walkCB(this.path,this.patterns,()=>{this.signal?.aborted?t(this.signal.reason):e(this.matches)})}),this.matches}walkSync(){if(this.signal?.aborted)throw this.signal.reason;return this.path.isUnknown()&&this.path.lstatSync(),this.walkCBSync(this.path,this.patterns,()=>{if(this.signal?.aborted)throw this.signal.reason}),this.matches}},Ro=class extends Il{static{o(this,"GlobStream")}results;constructor(e,t,n){super(e,t,n),this.results=new Oi({signal:this.signal,objectMode:!0}),this.results.on("drain",()=>this.resume()),this.results.on("resume",()=>this.resume())}matchEmit(e){this.results.write(e),this.results.flowing||this.pause()}stream(){let e=this.path;return e.isUnknown()?e.lstat().then(()=>{this.walkCB(e,this.patterns,()=>this.results.end())}):this.walkCB(e,this.patterns,()=>this.results.end()),this.results}streamSync(){return this.path.isUnknown()&&this.path.lstatSync(),this.walkCBSync(this.path,this.patterns,()=>this.results.end()),this.results}};var u8=typeof process=="object"&&process&&typeof process.platform=="string"?process.platform:"linux",hn=class{static{o(this,"Glob")}absolute;cwd;root;dot;dotRelative;follow;ignore;magicalBraces;mark;matchBase;maxDepth;nobrace;nocase;nodir;noext;noglobstar;pattern;platform;realpath;scurry;stat;signal;windowsPathsNoEscape;withFileTypes;includeChildMatches;opts;patterns;constructor(e,t){if(!t)throw new TypeError("glob options required");if(this.withFileTypes=!!t.withFileTypes,this.signal=t.signal,this.follow=!!t.follow,this.dot=!!t.dot,this.dotRelative=!!t.dotRelative,this.nodir=!!t.nodir,this.mark=!!t.mark,t.cwd?(t.cwd instanceof URL||t.cwd.startsWith("file://"))&&(t.cwd=(0,_S.fileURLToPath)(t.cwd)):this.cwd="",this.cwd=t.cwd||"",this.root=t.root,this.magicalBraces=!!t.magicalBraces,this.nobrace=!!t.nobrace,this.noext=!!t.noext,this.realpath=!!t.realpath,this.absolute=t.absolute,this.includeChildMatches=t.includeChildMatches!==!1,this.noglobstar=!!t.noglobstar,this.matchBase=!!t.matchBase,this.maxDepth=typeof t.maxDepth=="number"?t.maxDepth:1/0,this.stat=!!t.stat,this.ignore=t.ignore,this.withFileTypes&&this.absolute!==void 0)throw new Error("cannot set absolute and withFileTypes:true");if(typeof e=="string"&&(e=[e]),this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(e=e.map(u=>u.replace(/\\/g,"/"))),this.matchBase){if(t.noglobstar)throw new TypeError("base matching requires globstar");e=e.map(u=>u.includes("/")?u:`./**/${u}`)}if(this.pattern=e,this.platform=t.platform||u8,this.opts={...t,platform:this.platform},t.scurry){if(this.scurry=t.scurry,t.nocase!==void 0&&t.nocase!==t.scurry.nocase)throw new Error("nocase option contradicts provided scurry option")}else{let u=t.platform==="win32"?la:t.platform==="darwin"?Po:t.platform?fa:yS;this.scurry=new u(this.cwd,{nocase:t.nocase,fs:t.fs})}this.nocase=this.scurry.nocase;let n=this.platform==="darwin"||this.platform==="win32",i={...t,dot:this.dot,matchBase:this.matchBase,nobrace:this.nobrace,nocase:this.nocase,nocaseMagicOnly:n,nocomment:!0,noext:this.noext,nonegate:!0,optimizationLevel:2,platform:this.platform,windowsPathsNoEscape:this.windowsPathsNoEscape,debug:!!this.opts.debug},s=this.pattern.map(u=>new Ar(u,i)),[a,c]=s.reduce((u,f)=>(u[0].push(...f.set),u[1].push(...f.globParts),u),[[],[]]);this.patterns=a.map((u,f)=>{let l=c[f];if(!l)throw new Error("invalid pattern object");return new ha(u,l,0,this.platform)})}async walk(){return[...await new Io(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).walk()]}walkSync(){return[...new Io(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).walkSync()]}stream(){return new Ro(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).stream()}streamSync(){return new Ro(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).streamSync()}iterateSync(){return this.streamSync()[Symbol.iterator]()}[Symbol.iterator](){return this.iterateSync()}iterate(){return this.stream()[Symbol.asyncIterator]()}[Symbol.asyncIterator](){return this.iterate()}};var Km=o((r,e={})=>{Array.isArray(r)||(r=[r]);for(let t of r)if(new Ar(t,e).hasMagic())return!0;return!1},"hasMagic");function Dl(r,e={}){return new hn(r,e).streamSync()}o(Dl,"globStreamSync");function SS(r,e={}){return new hn(r,e).stream()}o(SS,"globStream");function wS(r,e={}){return new hn(r,e).walkSync()}o(wS,"globSync");async function vS(r,e={}){return new hn(r,e).walk()}o(vS,"glob_");function Nl(r,e={}){return new hn(r,e).iterateSync()}o(Nl,"globIterateSync");function bS(r,e={}){return new hn(r,e).iterate()}o(bS,"globIterate");var l8=Dl,f8=Object.assign(SS,{sync:Dl}),h8=Nl,d8=Object.assign(bS,{sync:Nl}),p8=Object.assign(wS,{stream:Dl,iterate:Nl}),Rl=Object.assign(vS,{glob:vS,globSync:wS,sync:p8,globStream:SS,stream:f8,globStreamSync:Dl,streamSync:l8,globIterate:bS,iterate:d8,globIterateSync:Nl,iterateSync:h8,Glob:hn,hasMagic:Km,escape:ia,unescape:un});Rl.glob=Rl;var ds=Qe(_i());var pa=class{constructor(e){this.rootPath=e}static{o(this,"NodeFsAdapter")}async readFile(e){let t=this.resolvePath(e);if(!await vt.default.pathExists(t))throw new ds.FileNotFoundError(e);return vt.default.readFile(t,"utf-8")}async fileExists(e){let t=this.resolvePath(e);return vt.default.pathExists(t)}async getFileMetadata(e){let t=await this.readFile(e);return this.extractFrontmatter(t)}async createFile(e,t){let n=this.resolvePath(e);if(await vt.default.pathExists(n))throw new ds.FileAlreadyExistsError(e);return await vt.default.ensureDir(Pi.default.dirname(n)),await vt.default.writeFile(n,t,"utf-8"),e}async updateFile(e,t){let n=this.resolvePath(e);if(!await vt.default.pathExists(n))throw new ds.FileNotFoundError(e);await vt.default.writeFile(n,t,"utf-8")}async writeFile(e,t){let n=this.resolvePath(e);await vt.default.ensureDir(Pi.default.dirname(n)),await vt.default.writeFile(n,t,"utf-8")}async deleteFile(e){let t=this.resolvePath(e);if(!await vt.default.pathExists(t))throw new ds.FileNotFoundError(e);await vt.default.remove(t)}async renameFile(e,t){let n=this.resolvePath(e),i=this.resolvePath(t);if(!await vt.default.pathExists(n))throw new ds.FileNotFoundError(e);await vt.default.ensureDir(Pi.default.dirname(i)),await vt.default.move(n,i)}async createDirectory(e){let t=this.resolvePath(e);await vt.default.ensureDir(t)}async directoryExists(e){let t=this.resolvePath(e);return await vt.default.pathExists(t)?(await vt.default.stat(t)).isDirectory():!1}async getMarkdownFiles(e){let t=e?this.resolvePath(e):this.rootPath,n=Pi.default.join(t,"**/*.md");return(await Rl(n,{nodir:!0})).map(a=>Pi.default.relative(this.rootPath,a))}async findFilesByMetadata(e){let t=await this.getMarkdownFiles(),n=[];for(let i of t)try{let s=await this.getFileMetadata(i);this.matchesQuery(s,e)&&n.push(i)}catch{continue}return n}async findFileByUID(e){let t=await this.findFilesByMetadata({exo__Asset_uid:e});return t.length>0?t[0]:null}resolvePath(e){return Pi.default.isAbsolute(e)?e:Pi.default.join(this.rootPath,e)}extractFrontmatter(e){let t=/^---\n([\s\S]*?)\n---/,n=e.match(t);if(!n)return{};try{let i=ho.load(n[1]);return typeof i=="object"&&i!==null?i:{}}catch{return{}}}matchesQuery(e,t){for(let[n,i]of Object.entries(t)){let s=e[n];if(Array.isArray(s)){if(!s.some(a=>this.normalizeValue(a)===this.normalizeValue(i)))return!1}else if(this.normalizeValue(s)!==this.normalizeValue(i))return!1}return!0}normalizeValue(e){return e==null?"":String(e).replace(/["'[\]]/g,"").trim()}};var Do=Qe(require("path")),Ym=Qe(Xs());var ma=class{constructor(e){this.vaultRoot=e}static{o(this,"PathResolver")}resolve(e){if(!Do.default.isAbsolute(e))return Do.default.resolve(this.vaultRoot,e);let t=Do.default.resolve(e),n=Do.default.resolve(this.vaultRoot);if(!t.startsWith(n))throw new st(`File path ${e} is outside vault root ${this.vaultRoot}`,"Provide a file path within the vault directory.",{filepath:e,vaultRoot:this.vaultRoot});return t}validate(e){if(!Ym.default.existsSync(e))throw new mo(e);if(!Ym.default.statSync(e).isFile())throw new st(`Not a file: ${e}`,"Provide a path to a file, not a directory.",{filepath:e});if(!e.endsWith(".md"))throw new st(`Not a Markdown file: ${e}`,"Provide a path to a .md file.",{filepath:e})}getVaultRoot(){return this.vaultRoot}};var CS=Qe(_i());var ES=Qe(_i());var ni=class{static{o(this,"BaseCommandExecutor")}constructor(e){this.pathResolver=e.pathResolver,this.fsAdapter=e.fsAdapter,this.frontmatterService=e.frontmatterService,this.dryRun=e.dryRun}resolveAndValidate(e){let t=this.pathResolver.resolve(e);this.pathResolver.validate(t);let n=t.replace(this.pathResolver.getVaultRoot()+"/","");return{resolvedPath:t,relativePath:n}}getCurrentTimestamp(){return ES.DateFormatter.toLocalTimestamp(new Date)}isAssetArchived(e){if(e?.exo__Asset_isArchived===!0)return!0;let t=e?.archived;if(t==null)return!1;if(typeof t=="boolean")return t;if(typeof t=="number")return t!==0;if(typeof t=="string"){let n=t.toLowerCase().trim();return n==="true"||n==="yes"||n==="1"}return!1}extractAliasesFromFrontmatter(e){let t=e.match(/aliases:\s*\n((?:  - .*\n?)*)/);return t?t[1].split(`
`).filter(i=>i.trim()).map(i=>i.replace(/^\s*-\s*/,"").trim()):[]}};var No=class extends ni{static{o(this,"StatusCommandExecutor")}constructor(e){super(e)}async executeStart(e){try{let{relativePath:t}=this.resolveAndValidate(e),n=await this.fsAdapter.readFile(t),i=this.getCurrentTimestamp(),s=this.frontmatterService.updateProperty(n,"ems__Effort_status",'"[[ems__EffortStatusDoing]]"');s=this.frontmatterService.updateProperty(s,"ems__Effort_startTimestamp",i),await this.fsAdapter.updateFile(t,s),console.log(`\u2705 Started: ${e}`),console.log("   Status: Doing"),console.log(`   Start time: ${i}`),process.exit(0)}catch(t){Re.handle(t)}}async executeComplete(e){try{let{relativePath:t}=this.resolveAndValidate(e),n=await this.fsAdapter.readFile(t),i=this.getCurrentTimestamp(),s=this.frontmatterService.updateProperty(n,"ems__Effort_status",'"[[ems__EffortStatusDone]]"');s=this.frontmatterService.updateProperty(s,"ems__Effort_endTimestamp",i),s=this.frontmatterService.updateProperty(s,"ems__Effort_resolutionTimestamp",i),await this.fsAdapter.updateFile(t,s),console.log(`\u2705 Completed: ${e}`),console.log("   Status: Done"),console.log(`   Completion time: ${i}`),process.exit(0)}catch(t){Re.handle(t)}}async executeTrash(e){try{let{relativePath:t}=this.resolveAndValidate(e),n=await this.fsAdapter.readFile(t),i=this.getCurrentTimestamp(),s=this.frontmatterService.updateProperty(n,"ems__Effort_status",'"[[ems__EffortStatusTrashed]]"');s=this.frontmatterService.updateProperty(s,"ems__Effort_resolutionTimestamp",i),await this.fsAdapter.updateFile(t,s),console.log(`\u2705 Trashed: ${e}`),console.log("   Status: Trashed"),console.log(`   Resolution time: ${i}`),process.exit(0)}catch(t){Re.handle(t)}}async executeArchive(e){try{let{relativePath:t}=this.resolveAndValidate(e),n=await this.fsAdapter.readFile(t),i=this.frontmatterService.updateProperty(n,"archived","true");i=this.frontmatterService.removeProperty(i,"aliases"),await this.fsAdapter.updateFile(t,i),console.log(`\u2705 Archived: ${e}`),console.log("   Archived: true"),console.log("   Aliases removed"),process.exit(0)}catch(t){Re.handle(t)}}async executeMoveToBacklog(e){try{await this.updateStatus(e,"ems__EffortStatusBacklog","Backlog"),process.exit(0)}catch(t){Re.handle(t)}}async executeMoveToAnalysis(e){try{await this.updateStatus(e,"ems__EffortStatusAnalysis","Analysis"),process.exit(0)}catch(t){Re.handle(t)}}async executeMoveToToDo(e){try{await this.updateStatus(e,"ems__EffortStatusToDo","ToDo"),process.exit(0)}catch(t){Re.handle(t)}}async updateStatus(e,t,n){let{relativePath:i}=this.resolveAndValidate(e),s=await this.fsAdapter.readFile(i),a=this.frontmatterService.updateProperty(s,"ems__Effort_status",`"[[${t}]]"`);await this.fsAdapter.updateFile(i,a),console.log(`\u2705 Moved to ${n}: ${e}`),console.log(`   Status: ${n}`)}};var Mt=[];for(let r=0;r<256;++r)Mt.push((r+256).toString(16).slice(1));function TS(r,e=0){return(Mt[r[e+0]]+Mt[r[e+1]]+Mt[r[e+2]]+Mt[r[e+3]]+"-"+Mt[r[e+4]]+Mt[r[e+5]]+"-"+Mt[r[e+6]]+Mt[r[e+7]]+"-"+Mt[r[e+8]]+Mt[r[e+9]]+"-"+Mt[r[e+10]]+Mt[r[e+11]]+Mt[r[e+12]]+Mt[r[e+13]]+Mt[r[e+14]]+Mt[r[e+15]]).toLowerCase()}o(TS,"unsafeStringify");var AS=require("node:crypto");var jl=new Uint8Array(256),kl=jl.length;function Qm(){return kl>jl.length-16&&((0,AS.randomFillSync)(jl),kl=0),jl.slice(kl,kl+=16)}o(Qm,"rng");var xS=require("node:crypto"),Jm={randomUUID:xS.randomUUID};function g8(r,e,t){r=r||{};let n=r.random??r.rng?.()??Qm();if(n.length<16)throw new Error("Random bytes length must be >= 16");if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){if(t=t||0,t<0||t+16>e.length)throw new RangeError(`UUID byte range ${t}:${t+15} is out of buffer bounds`);for(let i=0;i<16;++i)e[t+i]=n[i];return e}return TS(n)}o(g8,"_v4");function y8(r,e,t){return Jm.randomUUID&&!e&&!r?Jm.randomUUID():g8(r,e,t)}o(y8,"v4");var Xm=y8;var ga=Qe(_i());var ko=class extends ni{static{o(this,"AssetCreationExecutor")}constructor(e){super(e)}async executeCreateTask(e,t,n={}){try{await this.createAsset(e,t,"ems__Task",n),process.exit(0)}catch(i){Re.handle(i)}}async executeCreateMeeting(e,t,n={}){try{await this.createAsset(e,t,"ems__Meeting",n),process.exit(0)}catch(i){Re.handle(i)}}async executeCreateProject(e,t,n={}){try{await this.createAsset(e,t,"ems__Project",n),process.exit(0)}catch(i){Re.handle(i)}}async executeCreateArea(e,t,n={}){try{await this.createAsset(e,t,"ems__Area",n),process.exit(0)}catch(i){Re.handle(i)}}async createAsset(e,t,n,i={}){if(!t||t.trim().length===0)throw new Error("Label cannot be empty");let s=t.trim(),{relativePath:a}=this.resolveAndValidate(e);if(await this.fsAdapter.fileExists(a))throw new ga.FileAlreadyExistsError(e);let u=Xm(),f=this.buildAssetFrontmatter(n,u,s,i),l=ga.MetadataHelpers.buildFileContent(f);await this.fsAdapter.createFile(a,l),console.log(`\u2705 Created ${this.getAssetTypeName(n)}: ${e}`),console.log(`   UID: ${u}`),console.log(`   Label: ${s}`),console.log(`   Class: ${n}`)}buildAssetFrontmatter(e,t,n,i={}){let s=ga.DateFormatter.toLocalTimestamp(new Date),a={exo__Asset_isDefinedBy:'"[[Ontology/EMS]]"',exo__Asset_uid:t,exo__Asset_label:n,exo__Asset_createdAt:s,exo__Instance_class:[`"[[${e}]]"`],aliases:[n]};return(e==="ems__Task"||e==="ems__Project"||e==="ems__Meeting")&&(a.ems__Effort_status='"[[ems__EffortStatusDraft]]"'),i.prototype&&(a.ems__Effort_prototype=`"[[${i.prototype}]]"`),i.area&&(a.ems__Effort_area=`"[[${i.area}]]"`),i.parent&&(a.ems__Effort_parent=`"[[${i.parent}]]"`),a}getAssetTypeName(e){return{ems__Task:"task",ems__Meeting:"meeting",ems__Project:"project",ems__Area:"area"}[e]||"asset"}};var Zm=Qe(require("path"));var OS=Qe(_i());var jo=class extends ni{static{o(this,"PropertyCommandExecutor")}constructor(e){super(e)}async executeRenameToUid(e){try{let{relativePath:t}=this.resolveAndValidate(e),n=await this.fsAdapter.getFileMetadata(t);if(!n.exo__Asset_uid)throw new Error("Asset missing exo__Asset_uid property");let i=Zm.default.basename(t,".md"),s=n.exo__Asset_uid;if(i===s&&(console.log(`\u2705 Already renamed: ${e}`),console.log(`   Current filename matches UID: ${s}.md`),process.exit(0)),!n.exo__Asset_label||n.exo__Asset_label.trim()===""){let u=await this.fsAdapter.readFile(t),f=this.frontmatterService.updateProperty(u,"exo__Asset_label",i),l=this.isAssetArchived(n),h=f;l||(h=this.frontmatterService.updateProperty(f,"aliases",`
  - ${i}`)),await this.fsAdapter.updateFile(t,h),console.log(`   Updated label: "${i}"`)}let a=Zm.default.dirname(t),c=a!=="."?`${a}/${s}.md`:`${s}.md`;await this.fsAdapter.renameFile(t,c),console.log("\u2705 Renamed to UID format"),console.log(`   Old: ${t}`),console.log(`   New: ${c}`),process.exit(0)}catch(t){Re.handle(t)}}async executeUpdateLabel(e,t){try{if(!t||t.trim().length===0)throw new Error("Label cannot be empty");let n=t.trim(),{relativePath:i}=this.resolveAndValidate(e),s=await this.fsAdapter.readFile(i),a=this.frontmatterService.updateProperty(s,"exo__Asset_label",n),c=this.frontmatterService.parse(a),u=this.extractAliasesFromFrontmatter(c.content);if(u.includes(n)||(u.length===0?a=this.frontmatterService.updateProperty(a,"aliases",`
  - ${n}`):a=this.frontmatterService.updateProperty(a,"aliases",`${u.map(f=>`
  - ${f}`).join("")}
  - ${n}`)),this.dryRun){if(console.log("\u{1F50D} DRY RUN: Preview of changes (not applied)"),console.log(`   File: ${e}`),console.log("   Changes:"),console.log(`     \u2022 exo__Asset_label: "${n}"`),u.includes(n))console.log("     \u2022 aliases: unchanged (label already present)");else{let f=u.length===0?[n]:[...u,n];console.log(`     \u2022 aliases: [${f.map(l=>`"${l}"`).join(", ")}]`)}console.log(`
\u{1F4A1} Run without --dry-run to apply changes`),process.exit(0)}await this.fsAdapter.updateFile(i,a),console.log("\u2705 Updated label"),console.log(`   File: ${e}`),console.log(`   New label: "${n}"`),console.log("   Aliases synchronized"),process.exit(0)}catch(n){Re.handle(n)}}async executeSchedule(e,t){try{await this.updatePlannedTimestamp(e,t,"ems__Effort_plannedStartTimestamp"),process.exit(0)}catch(n){Re.handle(n)}}async executeSetDeadline(e,t){try{await this.updatePlannedTimestamp(e,t,"ems__Effort_plannedEndTimestamp"),process.exit(0)}catch(n){Re.handle(n)}}async updatePlannedTimestamp(e,t,n){let{relativePath:i}=this.resolveAndValidate(e);if(!await this.fsAdapter.fileExists(i))throw new Error(`File not found: ${e}`);if(!/^\d{4}-\d{2}-\d{2}$/.test(t))throw new Error(`Invalid date format: ${t}. Expected YYYY-MM-DD (e.g., 2025-11-25)`);let a=OS.DateFormatter.toTimestampAtStartOfDay(t),c=await this.fsAdapter.readFile(i),u=this.frontmatterService.updateProperty(c,n,a);await this.fsAdapter.writeFile(i,u),console.log(`\u2705 ${n==="ems__Effort_plannedStartTimestamp"?"Scheduled":"Set deadline for"}: ${e}`),console.log(`   Date: ${t}`),console.log(`   Timestamp: ${a}`)}};var Ml=class{static{o(this,"CommandExecutor")}constructor(e,t=!1){this.context={pathResolver:new ma(e),fsAdapter:new pa(e),frontmatterService:new CS.FrontmatterService,dryRun:t},this.statusExecutor=new No(this.context),this.creationExecutor=new ko(this.context),this.propertyExecutor=new jo(this.context)}async execute(e,t,n){try{let i=this.context.pathResolver.resolve(t);this.context.pathResolver.validate(i),await this.context.fsAdapter.readFile(i.replace(this.context.pathResolver.getVaultRoot()+"/","")),console.log("\u2705 Command infrastructure verified"),console.log(`   Command: ${e}`),console.log(`   File: ${i}`),console.log(`   Vault: ${this.context.pathResolver.getVaultRoot()}`),Object.keys(n).length>0&&console.log(`   Options: ${JSON.stringify(n,null,2)}`),console.log(`
\u{1F4DD} Note: Actual command execution will be implemented in follow-up issues.`),console.log("    This PR establishes the infrastructure foundation."),process.exit(0)}catch(i){Re.handle(i)}}getVaultRoot(){return this.context.pathResolver.getVaultRoot()}async executeStart(e){return this.statusExecutor.executeStart(e)}async executeComplete(e){return this.statusExecutor.executeComplete(e)}async executeTrash(e){return this.statusExecutor.executeTrash(e)}async executeArchive(e){return this.statusExecutor.executeArchive(e)}async executeMoveToBacklog(e){return this.statusExecutor.executeMoveToBacklog(e)}async executeMoveToAnalysis(e){return this.statusExecutor.executeMoveToAnalysis(e)}async executeMoveToToDo(e){return this.statusExecutor.executeMoveToToDo(e)}async executeCreateTask(e,t,n={}){return this.creationExecutor.executeCreateTask(e,t,n)}async executeCreateMeeting(e,t,n={}){return this.creationExecutor.executeCreateMeeting(e,t,n)}async executeCreateProject(e,t,n={}){return this.creationExecutor.executeCreateProject(e,t,n)}async executeCreateArea(e,t,n={}){return this.creationExecutor.executeCreateArea(e,t,n)}async executeRenameToUid(e){return this.propertyExecutor.executeRenameToUid(e)}async executeUpdateLabel(e,t){return this.propertyExecutor.executeUpdateLabel(e,t)}async executeSchedule(e,t){return this.propertyExecutor.executeSchedule(e,t)}async executeSetDeadline(e,t){return this.propertyExecutor.executeSetDeadline(e,t)}};function zt(r,e,t,n,i){if(r==="json"){let s={command:e,filepath:t,action:n,...i&&{changes:i}},a=Wt.success(s);console.log(JSON.stringify(a,null,2))}else console.log(`\u2705 ${n}`)}o(zt,"outputResult");function ps(r,e,t,n){let i=new st(`--${e} option is required for ${t} command`,n,{command:t,missingOption:e});Re.handle(i)}o(ps,"handleMissingOption");function FS(){return new Sn("command").description("Execute plugin command on single asset").argument("<command-name>","Command to execute (rename-to-uid, start, complete, schedule, set-deadline, etc.)").argument("<filepath>","Path to asset file (relative to vault root or absolute)").option("--vault <path>","Path to Obsidian vault",process.cwd()).option("--label <value>","Asset label (required for update-label and creation commands)").option("--prototype <uid>","Prototype UID for inheritance (creation commands)").option("--area <uid>","Area UID for effort linkage (creation commands)").option("--parent <uid>","Parent UID for effort linkage (creation commands)").option("--date <value>","Date in YYYY-MM-DD format (required for schedule and set-deadline commands)").option("--dry-run","Preview changes without modifying files").option("--format <type>","Output format: text|json (default: text)","text").action(async(r,e,t)=>{let n=t.format||"text";Re.setFormat(n);try{let i=(0,PS.resolve)(t.vault),s=new Ml(i,t.dryRun);switch(r){case"rename-to-uid":await s.executeRenameToUid(e),zt(n,r,e,"Renamed file to UID-based name");break;case"update-label":t.label||ps(n,"label","update-label",'exocortex command update-label <filepath> --label "<value>"'),await s.executeUpdateLabel(e,t.label),zt(n,r,e,`Updated label to "${t.label}"`,{label:t.label});break;case"start":await s.executeStart(e),zt(n,r,e,"Started task");break;case"complete":await s.executeComplete(e),zt(n,r,e,"Completed task");break;case"trash":await s.executeTrash(e),zt(n,r,e,"Moved task to trash");break;case"archive":await s.executeArchive(e),zt(n,r,e,"Archived task");break;case"move-to-backlog":await s.executeMoveToBacklog(e),zt(n,r,e,"Moved task to backlog");break;case"move-to-analysis":await s.executeMoveToAnalysis(e),zt(n,r,e,"Moved task to analysis");break;case"move-to-todo":await s.executeMoveToToDo(e),zt(n,r,e,"Moved task to todo");break;case"create-task":t.label||ps(n,"label","create-task",'exocortex command create-task <filepath> --label "<value>"'),await s.executeCreateTask(e,t.label,{prototype:t.prototype,area:t.area,parent:t.parent}),zt(n,r,e,`Created task "${t.label}"`,{label:t.label,prototype:t.prototype,area:t.area,parent:t.parent});break;case"create-meeting":t.label||ps(n,"label","create-meeting",'exocortex command create-meeting <filepath> --label "<value>"'),await s.executeCreateMeeting(e,t.label,{prototype:t.prototype,area:t.area,parent:t.parent}),zt(n,r,e,`Created meeting "${t.label}"`,{label:t.label,prototype:t.prototype,area:t.area,parent:t.parent});break;case"create-project":t.label||ps(n,"label","create-project",'exocortex command create-project <filepath> --label "<value>"'),await s.executeCreateProject(e,t.label,{prototype:t.prototype,area:t.area,parent:t.parent}),zt(n,r,e,`Created project "${t.label}"`,{label:t.label,prototype:t.prototype,area:t.area,parent:t.parent});break;case"create-area":t.label||ps(n,"label","create-area",'exocortex command create-area <filepath> --label "<value>"'),await s.executeCreateArea(e,t.label,{prototype:t.prototype,area:t.area,parent:t.parent}),zt(n,r,e,`Created area "${t.label}"`,{label:t.label,prototype:t.prototype,area:t.area,parent:t.parent});break;case"schedule":t.date||ps(n,"date","schedule",'exocortex command schedule <filepath> --date "YYYY-MM-DD"'),await s.executeSchedule(e,t.date),zt(n,r,e,`Scheduled task for ${t.date}`,{date:t.date});break;case"set-deadline":t.date||ps(n,"date","set-deadline",'exocortex command set-deadline <filepath> --date "YYYY-MM-DD"'),await s.executeSetDeadline(e,t.date),zt(n,r,e,`Set deadline to ${t.date}`,{date:t.date});break;default:await s.execute(r,e,t),zt(n,r,e,`Executed ${r}`);break}}catch(i){Re.handle(i)}})}o(FS,"commandCommand");var RS=require("path");var ii=Qe(require("fs")),e1=Qe(require("path")),IS=require("events");var _8={watch:ii.default.watch.bind(ii.default),existsSync:ii.default.existsSync.bind(ii.default),statSync:ii.default.statSync.bind(ii.default),readFileSync:ii.default.readFileSync.bind(ii.default)},Ll=class extends IS.EventEmitter{constructor(t,n={}){super();this.watcher=null;this.debounceTimers=new Map;this.isRunning=!1;this.vaultPath=e1.default.resolve(t),this.fsAdapter=n.fsAdapter??_8,this.options={pattern:n.pattern??"**/*.md",assetType:n.assetType??"",debounceMs:n.debounceMs??100,recursive:n.recursive??!0}}static{o(this,"FileSystemWatcher")}start(){this.isRunning||(this.watcher=this.fsAdapter.watch(this.vaultPath,{recursive:this.options.recursive},(t,n)=>{n&&this.handleFileEvent(t,n.toString())}),this.watcher.on("error",t=>{this.emit("error",t)}),this.isRunning=!0,this.emit("started"))}stop(){if(this.isRunning){for(let t of this.debounceTimers.values())clearTimeout(t);this.debounceTimers.clear(),this.watcher&&(this.watcher.close(),this.watcher=null),this.isRunning=!1,this.emit("stopped")}}isWatching(){return this.isRunning}handleFileEvent(t,n){let i=e1.default.join(this.vaultPath,n),s=n;if(!this.matchesPattern(s))return;let a=this.debounceTimers.get(i);a&&clearTimeout(a);let c=setTimeout(()=>{this.debounceTimers.delete(i),this.processFileEvent(i,s)},this.options.debounceMs);this.debounceTimers.set(i,c)}processFileEvent(t,n){let i=this.fsAdapter.existsSync(t),s;if(!i)s="delete";else{let u=this.fsAdapter.statSync(t);s=Date.now()-u.birthtimeMs<1e3?"create":"modify"}let a;if(i&&t.endsWith(".md")&&(a=this.extractAssetType(t)),this.options.assetType&&a!==this.options.assetType)return;let c={type:s,path:t,relativePath:n,timestamp:new Date().toISOString(),assetType:a};this.emit("change",c)}matchesPattern(t){return this.options.pattern?jt(t,this.options.pattern):!0}extractAssetType(t){try{let i=this.fsAdapter.readFileSync(t,"utf-8").match(/^---\n([\s\S]*?)\n---/);if(!i)return;let a=i[1].match(/exo__Instance_class:\s*(?:\[?"?\[\[([^\]]+)\]\]"?\]?|"?\[\[([^\]]+)\]\]"?)/);return a?a[1]||a[2]:void 0}catch{return}}};var t1=Qe(require("fs"));function DS(){return new Sn("watch").description("Watch vault for file changes and emit NDJSON events").option("--vault <path>","Path to Obsidian vault",process.cwd()).option("--pattern <glob>","Glob pattern to filter files (e.g., '*.md', 'tasks/**')").option("--asset-type <type>","Filter by asset type (e.g., 'ems__Task', 'ems__Project')").option("--debounce <ms>","Debounce interval in milliseconds","100").action(async r=>{Re.setFormat("json");try{let e=(0,RS.resolve)(r.vault);if(!t1.default.existsSync(e))throw new ls(e);if(!t1.default.statSync(e).isDirectory())throw new st(`Vault path is not a directory: ${e}`,"Provide a path to a directory, not a file",{vaultPath:e});let t=parseInt(r.debounce?.toString()??"100",10);if(isNaN(t)||t<0)throw new st("--debounce must be a non-negative integer","Use a positive integer value for debounce",{debounce:r.debounce});let n=new Ll(e,{pattern:r.pattern,assetType:r.assetType,debounceMs:t});n.on("change",s=>{console.log(JSON.stringify(s))}),n.on("error",s=>{let a=Wt.error("INTERNAL_OPERATION_FAILED",s.message,5,{recovery:{message:"Check file permissions and vault access",suggestion:"Ensure the vault directory is accessible"}});console.log(JSON.stringify(a))});let i=o(()=>{n.stop(),process.exit(0)},"shutdown");process.on("SIGINT",i),process.on("SIGTERM",i),console.error(`Watching vault: ${e}`),r.pattern&&console.error(`  Pattern filter: ${r.pattern}`),r.assetType&&console.error(`  Asset type filter: ${r.assetType}`),console.error(`  Debounce: ${t}ms`),console.error("Press Ctrl+C to stop"),n.start()}catch(e){Re.handle(e)}})}o(DS,"watchCommand");var n1=require("path"),i1=Qe(Xs());var ya=Qe(_i());var dn=Qe(Xs()),r1=Qe(require("crypto"));var Vl=class{constructor(){this.backups=new Map;this.fileHashes=new Map}static{o(this,"TransactionManager")}async begin(e){if(!dn.default.existsSync(e))throw new Error(`Cannot backup non-existent file: ${e}`);let t=await dn.default.readFile(e,"utf-8"),n=r1.default.createHash("sha256").update(t).digest("hex");this.fileHashes.set(e,n);let i=`${e}.backup.${Date.now()}`;await dn.default.writeFile(i,t,"utf-8"),this.backups.set(e,i)}async verify(e){let t=this.fileHashes.get(e);if(!t)return!0;if(!dn.default.existsSync(e))return!1;let n=await dn.default.readFile(e,"utf-8");return r1.default.createHash("sha256").update(n).digest("hex")===t}async commit(){for(let e of this.backups.values())dn.default.existsSync(e)&&await dn.default.remove(e);this.backups.clear(),this.fileHashes.clear()}async rollback(){for(let[e,t]of this.backups.entries())dn.default.existsSync(t)&&(await dn.default.copy(t,e,{overwrite:!0}),await dn.default.remove(t));this.backups.clear(),this.fileHashes.clear()}getTrackedFiles(){return Array.from(this.backups.keys())}};var Mo=class{static{o(this,"BatchExecutor")}constructor(e,t=!1){this.pathResolver=new ma(e),this.fsAdapter=new pa(e),this.frontmatterService=new ya.FrontmatterService,this.transactionManager=new Vl,this.dryRun=t}async executeBatch(e,t=!1){let n=Date.now(),i=[],s=0,a=0,c=!1;if(e.length===0)return{success:!0,total:0,succeeded:0,failed:0,results:[],durationMs:Date.now()-n,atomic:t};if(t&&!this.dryRun)try{await this.backupAllFiles(e)}catch(f){return{success:!1,total:e.length,succeeded:0,failed:e.length,results:e.map(l=>({success:!1,command:l.command,filepath:l.filepath,error:`Backup failed: ${f.message}`})),durationMs:Date.now()-n,atomic:t}}for(let f of e){let l=await this.executeSingleOperation(f);if(i.push(l),l.success)s++;else if(a++,t&&!this.dryRun){await this.transactionManager.rollback(),c=!0;let h=i.length;for(let p=h;p<e.length;p++)i.push({success:!1,command:e[p].command,filepath:e[p].filepath,error:"Not executed due to atomic rollback"}),a++;return{success:!1,total:e.length,succeeded:0,failed:e.length,results:i,durationMs:Date.now()-n,atomic:t,rolledBack:!0}}}return t&&!this.dryRun&&!c&&await this.transactionManager.commit(),{success:a===0,total:e.length,succeeded:s,failed:a,results:i,durationMs:Date.now()-n,atomic:t,...t&&{rolledBack:c}}}static parseInput(e){try{let t=JSON.parse(e);if(!Array.isArray(t))throw new st("Batch input must be a JSON array of operations",`exo batch --input '[{"command":"start","filepath":"task.md"}]'`);for(let n of t){if(!n.command||typeof n.command!="string")throw new st('Each operation must have a "command" string property','{"command":"start","filepath":"task.md"}');if(!n.filepath||typeof n.filepath!="string")throw new st('Each operation must have a "filepath" string property','{"command":"start","filepath":"task.md"}')}return t}catch(t){throw t instanceof st?t:new st(`Failed to parse batch input: ${t.message}`,`exo batch --input '[{"command":"start","filepath":"task.md"}]'`)}}async backupAllFiles(e){let t=new Set;for(let n of e){let i=this.pathResolver.resolve(n.filepath);t.add(i)}for(let n of t)await this.transactionManager.begin(n)}async executeSingleOperation(e){try{let t=this.pathResolver.resolve(e.filepath);this.pathResolver.validate(t);let n=t.replace(this.pathResolver.getVaultRoot()+"/",""),i=await this.fsAdapter.readFile(n);if(this.dryRun)return{success:!0,command:e.command,filepath:e.filepath,action:`Would execute ${e.command} (dry-run)`};switch(e.command){case"start":return await this.executeStart(n,e);case"complete":return await this.executeComplete(n,e);case"trash":return await this.executeTrash(n,e);case"archive":return await this.executeArchive(n,e);case"move-to-backlog":return await this.executeStatusUpdate(n,e,"ems__EffortStatusBacklog","Moved to backlog");case"move-to-analysis":return await this.executeStatusUpdate(n,e,"ems__EffortStatusAnalysis","Moved to analysis");case"move-to-todo":return await this.executeStatusUpdate(n,e,"ems__EffortStatusToDo","Moved to todo");case"update-label":return await this.executeUpdateLabel(n,e);case"schedule":return await this.executeSchedule(n,e);case"set-deadline":return await this.executeSetDeadline(n,e);default:return{success:!1,command:e.command,filepath:e.filepath,error:`Unknown command: ${e.command}`}}}catch(t){return{success:!1,command:e.command,filepath:e.filepath,error:t.message}}}getCurrentTimestamp(){return ya.DateFormatter.toLocalTimestamp(new Date)}async executeStart(e,t){let n=await this.fsAdapter.readFile(e),i=this.getCurrentTimestamp(),s=this.frontmatterService.updateProperty(n,"ems__Effort_status",'"[[ems__EffortStatusDoing]]"');return s=this.frontmatterService.updateProperty(s,"ems__Effort_startTimestamp",i),await this.fsAdapter.updateFile(e,s),{success:!0,command:t.command,filepath:t.filepath,action:"Started task",changes:{status:"Doing",startTimestamp:i}}}async executeComplete(e,t){let n=await this.fsAdapter.readFile(e),i=this.getCurrentTimestamp(),s=this.frontmatterService.updateProperty(n,"ems__Effort_status",'"[[ems__EffortStatusDone]]"');return s=this.frontmatterService.updateProperty(s,"ems__Effort_endTimestamp",i),s=this.frontmatterService.updateProperty(s,"ems__Effort_resolutionTimestamp",i),await this.fsAdapter.updateFile(e,s),{success:!0,command:t.command,filepath:t.filepath,action:"Completed task",changes:{status:"Done",endTimestamp:i,resolutionTimestamp:i}}}async executeTrash(e,t){let n=await this.fsAdapter.readFile(e),i=this.getCurrentTimestamp(),s=this.frontmatterService.updateProperty(n,"ems__Effort_status",'"[[ems__EffortStatusTrashed]]"');return s=this.frontmatterService.updateProperty(s,"ems__Effort_resolutionTimestamp",i),await this.fsAdapter.updateFile(e,s),{success:!0,command:t.command,filepath:t.filepath,action:"Trashed task",changes:{status:"Trashed",resolutionTimestamp:i}}}async executeArchive(e,t){let n=await this.fsAdapter.readFile(e),i=this.frontmatterService.updateProperty(n,"archived","true");return i=this.frontmatterService.removeProperty(i,"aliases"),await this.fsAdapter.updateFile(e,i),{success:!0,command:t.command,filepath:t.filepath,action:"Archived task",changes:{archived:!0,aliasesRemoved:!0}}}async executeStatusUpdate(e,t,n,i){let s=await this.fsAdapter.readFile(e),a=this.frontmatterService.updateProperty(s,"ems__Effort_status",`"[[${n}]]"`);return await this.fsAdapter.updateFile(e,a),{success:!0,command:t.command,filepath:t.filepath,action:i,changes:{status:n.replace("ems__EffortStatus","")}}}async executeUpdateLabel(e,t){let n=t.options?.label;if(!n||n.trim()==="")return{success:!1,command:t.command,filepath:t.filepath,error:'Missing required option: "label"'};let i=n.trim(),s=await this.fsAdapter.readFile(e),a=this.frontmatterService.updateProperty(s,"exo__Asset_label",`"${i}"`);return await this.fsAdapter.updateFile(e,a),{success:!0,command:t.command,filepath:t.filepath,action:`Updated label to "${i}"`,changes:{label:i}}}async executeSchedule(e,t){let n=t.options?.date;if(!n)return{success:!1,command:t.command,filepath:t.filepath,error:'Missing required option: "date"'};if(!/^\d{4}-\d{2}-\d{2}$/.test(n))return{success:!1,command:t.command,filepath:t.filepath,error:`Invalid date format: ${n}. Expected YYYY-MM-DD`};let i=await this.fsAdapter.readFile(e),s=ya.DateFormatter.toTimestampAtStartOfDay(n),a=this.frontmatterService.updateProperty(i,"ems__Effort_scheduledTimestamp",s);return await this.fsAdapter.updateFile(e,a),{success:!0,command:t.command,filepath:t.filepath,action:`Scheduled for ${n}`,changes:{scheduledTimestamp:s}}}async executeSetDeadline(e,t){let n=t.options?.date;if(!n)return{success:!1,command:t.command,filepath:t.filepath,error:'Missing required option: "date"'};if(!/^\d{4}-\d{2}-\d{2}$/.test(n))return{success:!1,command:t.command,filepath:t.filepath,error:`Invalid date format: ${n}. Expected YYYY-MM-DD`};let i=await this.fsAdapter.readFile(e),s=ya.DateFormatter.toTimestampAtStartOfDay(n),a=this.frontmatterService.updateProperty(i,"ems__Effort_deadlineTimestamp",s);return await this.fsAdapter.updateFile(e,a),{success:!0,command:t.command,filepath:t.filepath,action:`Set deadline to ${n}`,changes:{deadlineTimestamp:s}}}};function v8(r,e){if(r==="json"){let t=Wt.success(e,{durationMs:e.durationMs,itemCount:e.total});console.log(JSON.stringify(t,null,2))}else{if(console.log(`
\u{1F4E6} Batch Execution ${e.success?"Complete":"Failed"}`),console.log(`   Total: ${e.total} operations`),console.log(`   \u2705 Succeeded: ${e.succeeded}`),console.log(`   \u274C Failed: ${e.failed}`),console.log(`   \u23F1\uFE0F  Duration: ${e.durationMs}ms`),e.atomic&&console.log(`   \u{1F512} Atomic mode: ${e.rolledBack?"Rolled back":"Committed"}`),e.failed>0){console.log(`
\u{1F4CB} Failed Operations:`);for(let t of e.results.filter(n=>!n.success))console.log(`   \u274C ${t.command} ${t.filepath}: ${t.error}`)}if(e.succeeded>0&&r==="text"){console.log(`
\u{1F4CB} Successful Operations:`);for(let t of e.results.filter(n=>n.success))console.log(`   \u2705 ${t.command} ${t.filepath}: ${t.action}`)}}}o(v8,"outputResult");function NS(){return new Sn("batch").description("Execute multiple operations in a single CLI invocation").option("--vault <path>","Path to Obsidian vault",process.cwd()).option("--input <json>","JSON array of operations to execute").option("--file <path>","Path to JSON file containing operations").option("--atomic","All-or-nothing execution (rollback on any failure)").option("--dry-run","Preview changes without modifying files").option("--format <type>","Output format: text|json (default: text)","text").action(async r=>{let e=r.format||"text";Re.setFormat(e);try{let t=(0,n1.resolve)(r.vault),n;if(r.input)n=r.input;else if(r.file){let c=(0,n1.resolve)(r.file);if(!i1.default.existsSync(c))throw new st(`Batch file not found: ${c}`,"exocortex batch --file operations.json");n=await i1.default.readFile(c,"utf-8")}else throw new st("Either --input or --file option is required",`exocortex batch --input '[{"command":"start","filepath":"task.md"}]' or exocortex batch --file operations.json`);let i=Mo.parseInput(n);if(i.length===0)throw new st("Batch input contains no operations",`exocortex batch --input '[{"command":"start","filepath":"task.md"}]'`);let a=await new Mo(t,r.dryRun).executeBatch(i,r.atomic);v8(e,a),process.exit(a.success?0:5)}catch(t){Re.handle(t)}})}o(NS,"batchCommand");var _a=new Sn;_a.name("exocortex").description("CLI tool for Exocortex knowledge management system").version("0.1.0");_a.command("sparql").description("SPARQL query execution").addCommand(Ev());_a.addCommand(FS());_a.addCommand(DS());_a.addCommand(NS());_a.parse();
/*! Bundled license information:

reflect-metadata/Reflect.js:
  (*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** *)

tslib/tslib.es6.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)

js-yaml/dist/js-yaml.mjs:
  (*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT *)
*/
