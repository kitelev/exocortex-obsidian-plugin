import { Command } from "commander";
import chalk from "chalk";
import ora from "ora";
import * as path from "path";
import { TaskStatusService } from "@exocortex/core";
import { FileSystemVaultAdapter } from "../adapters/FileSystemVaultAdapter.js";
export function statusCommand() {
    const cmd = new Command("todo");
    cmd
        .description("Move task to ToDo status")
        .requiredOption("-t, --task <path>", "Path to task file")
        .option("-r, --root <path>", "Root directory of vault", process.cwd())
        .action(async (options) => {
        const spinner = ora("Updating task status to ToDo...").start();
        try {
            const adapter = new FileSystemVaultAdapter(options.root);
            const service = new TaskStatusService(adapter);
            const taskPath = path.relative(options.root, options.task);
            const taskFile = adapter.getAbstractFileByPath(taskPath);
            if (!taskFile || !('extension' in taskFile)) {
                throw new Error(`Task file not found: ${options.task}`);
            }
            await service.moveToToDo(taskFile);
            spinner.succeed(chalk.green(`Task status updated to ToDo: ${taskPath}`));
        }
        catch (error) {
            spinner.fail(chalk.red(`Failed to update status: ${error.message}`));
            process.exit(1);
        }
    });
    return cmd;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhdHVzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2NvbW1hbmRzL3N0YXR1cy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBQ3BDLE9BQU8sS0FBSyxNQUFNLE9BQU8sQ0FBQztBQUMxQixPQUFPLEdBQUcsTUFBTSxLQUFLLENBQUM7QUFDdEIsT0FBTyxLQUFLLElBQUksTUFBTSxNQUFNLENBQUM7QUFDN0IsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDcEQsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sdUNBQXVDLENBQUM7QUFFL0UsTUFBTSxVQUFVLGFBQWE7SUFDM0IsTUFBTSxHQUFHLEdBQUcsSUFBSSxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7SUFFaEMsR0FBRztTQUNBLFdBQVcsQ0FBQywwQkFBMEIsQ0FBQztTQUN2QyxjQUFjLENBQUMsbUJBQW1CLEVBQUUsbUJBQW1CLENBQUM7U0FDeEQsTUFBTSxDQUFDLG1CQUFtQixFQUFFLHlCQUF5QixFQUFFLE9BQU8sQ0FBQyxHQUFHLEVBQUUsQ0FBQztTQUNyRSxNQUFNLENBQUMsS0FBSyxFQUFFLE9BQU8sRUFBRSxFQUFFO1FBQ3hCLE1BQU0sT0FBTyxHQUFHLEdBQUcsQ0FBQyxpQ0FBaUMsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDO1FBRS9ELElBQUksQ0FBQztZQUNILE1BQU0sT0FBTyxHQUFHLElBQUksc0JBQXNCLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3pELE1BQU0sT0FBTyxHQUFHLElBQUksaUJBQWlCLENBQUMsT0FBTyxDQUFDLENBQUM7WUFFL0MsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUMzRCxNQUFNLFFBQVEsR0FBRyxPQUFPLENBQUMscUJBQXFCLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDekQsSUFBSSxDQUFDLFFBQVEsSUFBSSxDQUFDLENBQUMsV0FBVyxJQUFJLFFBQVEsQ0FBQyxFQUFFLENBQUM7Z0JBQzVDLE1BQU0sSUFBSSxLQUFLLENBQUMsd0JBQXdCLE9BQU8sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO1lBQzFELENBQUM7WUFFRCxNQUFNLE9BQU8sQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLENBQUM7WUFFbkMsT0FBTyxDQUFDLE9BQU8sQ0FDYixLQUFLLENBQUMsS0FBSyxDQUFDLGdDQUFnQyxRQUFRLEVBQUUsQ0FBQyxDQUN4RCxDQUFDO1FBQ0osQ0FBQztRQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7WUFDZixPQUFPLENBQUMsSUFBSSxDQUNWLEtBQUssQ0FBQyxHQUFHLENBQUMsNEJBQTZCLEtBQWUsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUNsRSxDQUFDO1lBQ0YsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNsQixDQUFDO0lBQ0gsQ0FBQyxDQUFDLENBQUM7SUFFTCxPQUFPLEdBQUcsQ0FBQztBQUNiLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21tYW5kIH0gZnJvbSBcImNvbW1hbmRlclwiO1xuaW1wb3J0IGNoYWxrIGZyb20gXCJjaGFsa1wiO1xuaW1wb3J0IG9yYSBmcm9tIFwib3JhXCI7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gXCJwYXRoXCI7XG5pbXBvcnQgeyBUYXNrU3RhdHVzU2VydmljZSB9IGZyb20gXCJAZXhvY29ydGV4L2NvcmVcIjtcbmltcG9ydCB7IEZpbGVTeXN0ZW1WYXVsdEFkYXB0ZXIgfSBmcm9tIFwiLi4vYWRhcHRlcnMvRmlsZVN5c3RlbVZhdWx0QWRhcHRlci5qc1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gc3RhdHVzQ29tbWFuZCgpOiBDb21tYW5kIHtcbiAgY29uc3QgY21kID0gbmV3IENvbW1hbmQoXCJ0b2RvXCIpO1xuXG4gIGNtZFxuICAgIC5kZXNjcmlwdGlvbihcIk1vdmUgdGFzayB0byBUb0RvIHN0YXR1c1wiKVxuICAgIC5yZXF1aXJlZE9wdGlvbihcIi10LCAtLXRhc2sgPHBhdGg+XCIsIFwiUGF0aCB0byB0YXNrIGZpbGVcIilcbiAgICAub3B0aW9uKFwiLXIsIC0tcm9vdCA8cGF0aD5cIiwgXCJSb290IGRpcmVjdG9yeSBvZiB2YXVsdFwiLCBwcm9jZXNzLmN3ZCgpKVxuICAgIC5hY3Rpb24oYXN5bmMgKG9wdGlvbnMpID0+IHtcbiAgICAgIGNvbnN0IHNwaW5uZXIgPSBvcmEoXCJVcGRhdGluZyB0YXNrIHN0YXR1cyB0byBUb0RvLi4uXCIpLnN0YXJ0KCk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGFkYXB0ZXIgPSBuZXcgRmlsZVN5c3RlbVZhdWx0QWRhcHRlcihvcHRpb25zLnJvb3QpO1xuICAgICAgICBjb25zdCBzZXJ2aWNlID0gbmV3IFRhc2tTdGF0dXNTZXJ2aWNlKGFkYXB0ZXIpO1xuXG4gICAgICAgIGNvbnN0IHRhc2tQYXRoID0gcGF0aC5yZWxhdGl2ZShvcHRpb25zLnJvb3QsIG9wdGlvbnMudGFzayk7XG4gICAgICAgIGNvbnN0IHRhc2tGaWxlID0gYWRhcHRlci5nZXRBYnN0cmFjdEZpbGVCeVBhdGgodGFza1BhdGgpO1xuICAgICAgICBpZiAoIXRhc2tGaWxlIHx8ICEoJ2V4dGVuc2lvbicgaW4gdGFza0ZpbGUpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUYXNrIGZpbGUgbm90IGZvdW5kOiAke29wdGlvbnMudGFza31gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHNlcnZpY2UubW92ZVRvVG9Ebyh0YXNrRmlsZSk7XG5cbiAgICAgICAgc3Bpbm5lci5zdWNjZWVkKFxuICAgICAgICAgIGNoYWxrLmdyZWVuKGBUYXNrIHN0YXR1cyB1cGRhdGVkIHRvIFRvRG86ICR7dGFza1BhdGh9YCksXG4gICAgICAgICk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBzcGlubmVyLmZhaWwoXG4gICAgICAgICAgY2hhbGsucmVkKGBGYWlsZWQgdG8gdXBkYXRlIHN0YXR1czogJHsoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2V9YCksXG4gICAgICAgICk7XG4gICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICByZXR1cm4gY21kO1xufVxuIl19