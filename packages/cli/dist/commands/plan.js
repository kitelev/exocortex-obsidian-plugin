import { Command } from "commander";
import chalk from "chalk";
import ora from "ora";
import { PlanningService } from "@exocortex/core";
import { FileSystemVaultAdapter } from "../adapters/FileSystemVaultAdapter.js";
import * as path from "path";
export function planCommand() {
    const cmd = new Command("today");
    cmd
        .description("Plan task for today")
        .requiredOption("-t, --task <path>", "Path to task file")
        .option("-r, --root <path>", "Root directory of vault", process.cwd())
        .action(async (options) => {
        const spinner = ora("Planning task for today...").start();
        try {
            const adapter = new FileSystemVaultAdapter(options.root);
            const service = new PlanningService(adapter);
            const taskPath = path.relative(options.root, options.task);
            await service.planOnToday(taskPath);
            spinner.succeed(chalk.green(`Task planned for today: ${taskPath}`));
        }
        catch (error) {
            spinner.fail(chalk.red(`Failed to plan task: ${error.message}`));
            process.exit(1);
        }
    });
    return cmd;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGxhbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb21tYW5kcy9wbGFuLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFDcEMsT0FBTyxLQUFLLE1BQU0sT0FBTyxDQUFDO0FBQzFCLE9BQU8sR0FBRyxNQUFNLEtBQUssQ0FBQztBQUN0QixPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDbEQsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sdUNBQXVDLENBQUM7QUFDL0UsT0FBTyxLQUFLLElBQUksTUFBTSxNQUFNLENBQUM7QUFFN0IsTUFBTSxVQUFVLFdBQVc7SUFDekIsTUFBTSxHQUFHLEdBQUcsSUFBSSxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7SUFFakMsR0FBRztTQUNBLFdBQVcsQ0FBQyxxQkFBcUIsQ0FBQztTQUNsQyxjQUFjLENBQUMsbUJBQW1CLEVBQUUsbUJBQW1CLENBQUM7U0FDeEQsTUFBTSxDQUFDLG1CQUFtQixFQUFFLHlCQUF5QixFQUFFLE9BQU8sQ0FBQyxHQUFHLEVBQUUsQ0FBQztTQUNyRSxNQUFNLENBQUMsS0FBSyxFQUFFLE9BQU8sRUFBRSxFQUFFO1FBQ3hCLE1BQU0sT0FBTyxHQUFHLEdBQUcsQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDO1FBRTFELElBQUksQ0FBQztZQUNILE1BQU0sT0FBTyxHQUFHLElBQUksc0JBQXNCLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3pELE1BQU0sT0FBTyxHQUFHLElBQUksZUFBZSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBRTdDLE1BQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDM0QsTUFBTSxPQUFPLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBRXBDLE9BQU8sQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQywyQkFBMkIsUUFBUSxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQ3RFLENBQUM7UUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1lBQ2YsT0FBTyxDQUFDLElBQUksQ0FDVixLQUFLLENBQUMsR0FBRyxDQUFDLHdCQUF5QixLQUFlLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FDOUQsQ0FBQztZQUNGLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbEIsQ0FBQztJQUNILENBQUMsQ0FBQyxDQUFDO0lBRUwsT0FBTyxHQUFHLENBQUM7QUFDYixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tbWFuZCB9IGZyb20gXCJjb21tYW5kZXJcIjtcbmltcG9ydCBjaGFsayBmcm9tIFwiY2hhbGtcIjtcbmltcG9ydCBvcmEgZnJvbSBcIm9yYVwiO1xuaW1wb3J0IHsgUGxhbm5pbmdTZXJ2aWNlIH0gZnJvbSBcIkBleG9jb3J0ZXgvY29yZVwiO1xuaW1wb3J0IHsgRmlsZVN5c3RlbVZhdWx0QWRhcHRlciB9IGZyb20gXCIuLi9hZGFwdGVycy9GaWxlU3lzdGVtVmF1bHRBZGFwdGVyLmpzXCI7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gXCJwYXRoXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBwbGFuQ29tbWFuZCgpOiBDb21tYW5kIHtcbiAgY29uc3QgY21kID0gbmV3IENvbW1hbmQoXCJ0b2RheVwiKTtcblxuICBjbWRcbiAgICAuZGVzY3JpcHRpb24oXCJQbGFuIHRhc2sgZm9yIHRvZGF5XCIpXG4gICAgLnJlcXVpcmVkT3B0aW9uKFwiLXQsIC0tdGFzayA8cGF0aD5cIiwgXCJQYXRoIHRvIHRhc2sgZmlsZVwiKVxuICAgIC5vcHRpb24oXCItciwgLS1yb290IDxwYXRoPlwiLCBcIlJvb3QgZGlyZWN0b3J5IG9mIHZhdWx0XCIsIHByb2Nlc3MuY3dkKCkpXG4gICAgLmFjdGlvbihhc3luYyAob3B0aW9ucykgPT4ge1xuICAgICAgY29uc3Qgc3Bpbm5lciA9IG9yYShcIlBsYW5uaW5nIHRhc2sgZm9yIHRvZGF5Li4uXCIpLnN0YXJ0KCk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGFkYXB0ZXIgPSBuZXcgRmlsZVN5c3RlbVZhdWx0QWRhcHRlcihvcHRpb25zLnJvb3QpO1xuICAgICAgICBjb25zdCBzZXJ2aWNlID0gbmV3IFBsYW5uaW5nU2VydmljZShhZGFwdGVyKTtcblxuICAgICAgICBjb25zdCB0YXNrUGF0aCA9IHBhdGgucmVsYXRpdmUob3B0aW9ucy5yb290LCBvcHRpb25zLnRhc2spO1xuICAgICAgICBhd2FpdCBzZXJ2aWNlLnBsYW5PblRvZGF5KHRhc2tQYXRoKTtcblxuICAgICAgICBzcGlubmVyLnN1Y2NlZWQoY2hhbGsuZ3JlZW4oYFRhc2sgcGxhbm5lZCBmb3IgdG9kYXk6ICR7dGFza1BhdGh9YCkpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgc3Bpbm5lci5mYWlsKFxuICAgICAgICAgIGNoYWxrLnJlZChgRmFpbGVkIHRvIHBsYW4gdGFzazogJHsoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2V9YCksXG4gICAgICAgICk7XG4gICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICByZXR1cm4gY21kO1xufVxuIl19