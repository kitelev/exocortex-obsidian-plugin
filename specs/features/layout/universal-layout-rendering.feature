# language: ru
Функция: Рендеринг Universal Layout

  Как пользователь Exocortex плагина
  Я хочу видеть связанные заметки в структурированном виде
  Чтобы эффективно работать с семантической сетью знаний

  Предыстория:
    Дано Obsidian vault с установленным Exocortex плагином
    И существует заметка "Мой Проект" с метаданными:
      | Свойство              | Значение        |
      | exo__Instance_class   | [[ems__Project]] |
      | exo__Asset_isArchived | false           |

  Сценарий: Отображение таблицы связанных заметок
    Дано у меня открыта заметка "Мой Проект"
    И существуют связанные заметки:
      | Название       | exo__Instance_class | Связь        |
      | Задача 1       | [[ems__Task]]       | exo__Parent  |
      | Задача 2       | [[ems__Task]]       | exo__Parent  |
      | Область работ  | [[ems__Area]]       | body         |
    Когда я добавляю блок кода с типом "exocortex-universal"
    И блок содержит конфигурацию:
      """yaml
      layout: table
      showProperties:
        - exo__Instance_class
      """
    Тогда я вижу таблицу со следующими колонками:
      | Name | exo__Instance_class | Relation Type | Modified |
    И таблица содержит 3 строки
    И заголовки колонок "Name" и "exo__Instance_class" имеют класс "sortable"

  Сценарий: Колонка Instance Class содержит кликабельные ссылки
    Дано у меня открыта заметка "Мой Проект"
    И существует связанная заметка "Задача 1" с метаданными:
      | Свойство            | Значение      |
      | exo__Instance_class | [[ems__Task]] |
    Когда я добавляю блок кода с типом "exocortex-universal"
    И блок содержит конфигурацию:
      """yaml
      layout: table
      showProperties:
        - exo__Instance_class
      """
    Тогда в колонке "exo__Instance_class" я вижу элемент <a>
    И элемент <a> имеет текст "ems__Task"
    И элемент <a> имеет класс "internal-link"
    И при клике на элемент <a> открывается заметка "ems__Task"
    И элемент <a> НЕ содержит символы "[[" или "]]"

  Сценарий: Сортировка по колонке Name
    Дано у меня открыта заметка "Мой Проект"
    И существуют связанные заметки:
      | Название  | exo__Instance_class |
      | Задача C  | [[ems__Task]]       |
      | Задача A  | [[ems__Task]]       |
      | Задача B  | [[ems__Task]]       |
    И я добавил блок кода с типом "exocortex-universal"
    И блок содержит конфигурацию "layout: table"
    Когда я кликаю на заголовок колонки "Name"
    Тогда таблица сортируется по возрастанию
    И порядок строк:
      | Задача A |
      | Задача B |
      | Задача C |
    Когда я снова кликаю на заголовок колонки "Name"
    Тогда таблица сортируется по убыванию
    И порядок строк:
      | Задача C |
      | Задача B |
      | Задача A |

  Сценарий: Сортировка по колонке Instance Class
    Дано у меня открыта заметка "Мой Проект"
    И существуют связанные заметки:
      | Название  | exo__Instance_class |
      | Заметка 1 | [[ems__Task]]       |
      | Заметка 2 | [[ems__Area]]       |
      | Заметка 3 | [[ems__Project]]    |
    И я добавил блок кода с типом "exocortex-universal"
    Когда я кликаю на заголовок колонки "exo__Instance_class"
    Тогда строки сортируются по значению Instance Class
    И заголовок "exo__Instance_class" имеет класс "sorted-asc"
    И заголовок "exo__Instance_class" содержит символ "▲"

  Сценарий: Индикаторы сортировки
    Дано у меня открыта заметка с Universal Layout таблицей
    Когда я кликаю на заголовок "Name"
    Тогда заголовок "Name" имеет класс "sorted-asc"
    И заголовок "Name" содержит символ "▲"
    Когда я снова кликаю на заголовок "Name"
    Тогда заголовок "Name" имеет класс "sorted-desc"
    И заголовок "Name" содержит символ "▼"
    И символ "▲" исчезает

  Сценарий: Фильтрация архивных заметок
    Дано у меня открыта заметка "Мой Проект"
    И существуют связанные заметки:
      | Название       | exo__Asset_isArchived |
      | Активная       | false                 |
      | Архивная       | true                  |
      | Ещё активная   | false                 |
    Когда я добавляю блок кода с типом "exocortex-universal"
    Тогда таблица содержит 2 строки
    И я вижу заметки "Активная" и "Ещё активная"
    И я НЕ вижу заметку "Архивная"

  Сценарий: Отображение дополнительных свойств
    Дано у меня открыта заметка "Мой Проект"
    И существует связанная заметка "Задача 1" с метаданными:
      | Свойство            | Значение        |
      | exo__Instance_class | [[ems__Task]]   |
      | exo__Status         | В работе        |
      | exo__Priority       | Высокий         |
    Когда я добавляю блок кода с конфигурацией:
      """yaml
      layout: table
      showProperties:
        - exo__Instance_class
        - exo__Status
        - exo__Priority
      """
    Тогда я вижу таблицу с колонками:
      | Name | exo__Instance_class | exo__Status | exo__Priority | Relation Type | Modified |
    И в строке "Задача 1" колонка "exo__Status" содержит "В работе"
    И в строке "Задача 1" колонка "exo__Priority" содержит "Высокий"

  Сценарий: Мобильная адаптация таблицы
    Дано я использую Obsidian на мобильном устройстве
    И у меня открыта заметка с Universal Layout таблицей
    Когда таблица рендерится
    Тогда элемент <table> имеет класс "mobile-responsive"
    И таблица адаптирована для сенсорного управления
